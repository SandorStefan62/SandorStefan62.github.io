function VR(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();var zn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function UR(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),n}var zR={exports:{}},K2={},WR={exports:{}},rt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tm=Symbol.for("react.element"),mV=Symbol.for("react.portal"),gV=Symbol.for("react.fragment"),yV=Symbol.for("react.strict_mode"),vV=Symbol.for("react.profiler"),xV=Symbol.for("react.provider"),wV=Symbol.for("react.context"),bV=Symbol.for("react.forward_ref"),CV=Symbol.for("react.suspense"),SV=Symbol.for("react.memo"),IV=Symbol.for("react.lazy"),yE=Symbol.iterator;function kV(t){return t===null||typeof t!="object"?null:(t=yE&&t[yE]||t["@@iterator"],typeof t=="function"?t:null)}var jR={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},GR=Object.assign,HR={};function Cd(t,e,n){this.props=t,this.context=e,this.refs=HR,this.updater=n||jR}Cd.prototype.isReactComponent={};Cd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Cd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function KR(){}KR.prototype=Cd.prototype;function mS(t,e,n){this.props=t,this.context=e,this.refs=HR,this.updater=n||jR}var gS=mS.prototype=new KR;gS.constructor=mS;GR(gS,Cd.prototype);gS.isPureReactComponent=!0;var vE=Array.isArray,qR=Object.prototype.hasOwnProperty,yS={current:null},XR={key:!0,ref:!0,__self:!0,__source:!0};function YR(t,e,n){var s,r={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)qR.call(e,s)&&!XR.hasOwnProperty(s)&&(r[s]=e[s]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:tm,type:t,key:i,ref:o,props:r,_owner:yS.current}}function TV(t,e){return{$$typeof:tm,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function vS(t){return typeof t=="object"&&t!==null&&t.$$typeof===tm}function EV(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var xE=/\/+/g;function Ix(t,e){return typeof t=="object"&&t!==null&&t.key!=null?EV(""+t.key):e.toString(36)}function Y0(t,e,n,s,r){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case tm:case mV:o=!0}}if(o)return o=t,r=r(o),t=s===""?"."+Ix(o,0):s,vE(r)?(n="",t!=null&&(n=t.replace(xE,"$&/")+"/"),Y0(r,e,n,"",function(c){return c})):r!=null&&(vS(r)&&(r=TV(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(xE,"$&/")+"/")+t)),e.push(r)),1;if(o=0,s=s===""?".":s+":",vE(t))for(var a=0;a<t.length;a++){i=t[a];var l=s+Ix(i,a);o+=Y0(i,e,n,l,r)}else if(l=kV(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=s+Ix(i,a++),o+=Y0(i,e,n,l,r);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function h0(t,e,n){if(t==null)return t;var s=[],r=0;return Y0(t,s,"","",function(i){return e.call(n,i,r++)}),s}function NV(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var er={current:null},J0={transition:null},_V={ReactCurrentDispatcher:er,ReactCurrentBatchConfig:J0,ReactCurrentOwner:yS};function JR(){throw Error("act(...) is not supported in production builds of React.")}rt.Children={map:h0,forEach:function(t,e,n){h0(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return h0(t,function(){e++}),e},toArray:function(t){return h0(t,function(e){return e})||[]},only:function(t){if(!vS(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};rt.Component=Cd;rt.Fragment=gV;rt.Profiler=vV;rt.PureComponent=mS;rt.StrictMode=yV;rt.Suspense=CV;rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_V;rt.act=JR;rt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=GR({},t.props),r=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=yS.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)qR.call(e,l)&&!XR.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];s.children=a}return{$$typeof:tm,type:t.type,key:r,ref:i,props:s,_owner:o}};rt.createContext=function(t){return t={$$typeof:wV,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:xV,_context:t},t.Consumer=t};rt.createElement=YR;rt.createFactory=function(t){var e=YR.bind(null,t);return e.type=t,e};rt.createRef=function(){return{current:null}};rt.forwardRef=function(t){return{$$typeof:bV,render:t}};rt.isValidElement=vS;rt.lazy=function(t){return{$$typeof:IV,_payload:{_status:-1,_result:t},_init:NV}};rt.memo=function(t,e){return{$$typeof:SV,type:t,compare:e===void 0?null:e}};rt.startTransition=function(t){var e=J0.transition;J0.transition={};try{t()}finally{J0.transition=e}};rt.unstable_act=JR;rt.useCallback=function(t,e){return er.current.useCallback(t,e)};rt.useContext=function(t){return er.current.useContext(t)};rt.useDebugValue=function(){};rt.useDeferredValue=function(t){return er.current.useDeferredValue(t)};rt.useEffect=function(t,e){return er.current.useEffect(t,e)};rt.useId=function(){return er.current.useId()};rt.useImperativeHandle=function(t,e,n){return er.current.useImperativeHandle(t,e,n)};rt.useInsertionEffect=function(t,e){return er.current.useInsertionEffect(t,e)};rt.useLayoutEffect=function(t,e){return er.current.useLayoutEffect(t,e)};rt.useMemo=function(t,e){return er.current.useMemo(t,e)};rt.useReducer=function(t,e,n){return er.current.useReducer(t,e,n)};rt.useRef=function(t){return er.current.useRef(t)};rt.useState=function(t){return er.current.useState(t)};rt.useSyncExternalStore=function(t,e,n){return er.current.useSyncExternalStore(t,e,n)};rt.useTransition=function(){return er.current.useTransition()};rt.version="18.3.1";WR.exports=rt;var J=WR.exports;const Xc=pS(J),$V=VR({__proto__:null,default:Xc},[J]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RV=J,AV=Symbol.for("react.element"),DV=Symbol.for("react.fragment"),PV=Object.prototype.hasOwnProperty,OV=RV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,FV={key:!0,ref:!0,__self:!0,__source:!0};function ZR(t,e,n){var s,r={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)PV.call(e,s)&&!FV.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:AV,type:t,key:i,ref:o,props:r,_owner:OV.current}}K2.Fragment=DV;K2.jsx=ZR;K2.jsxs=ZR;zR.exports=K2;var U=zR.exports,Kw={},QR={exports:{}},jr={},eA={exports:{}},tA={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,X){var ie=z.length;z.push(X);e:for(;0<ie;){var de=ie-1>>>1,he=z[de];if(0<r(he,X))z[de]=X,z[ie]=he,ie=de;else break e}}function n(z){return z.length===0?null:z[0]}function s(z){if(z.length===0)return null;var X=z[0],ie=z.pop();if(ie!==X){z[0]=ie;e:for(var de=0,he=z.length,fe=he>>>1;de<fe;){var ge=2*(de+1)-1,pe=z[ge],we=ge+1,ke=z[we];if(0>r(pe,ie))we<he&&0>r(ke,pe)?(z[de]=ke,z[we]=ie,de=we):(z[de]=pe,z[ge]=ie,de=ge);else if(we<he&&0>r(ke,ie))z[de]=ke,z[we]=ie,de=we;else break e}}return X}function r(z,X){var ie=z.sortIndex-X.sortIndex;return ie!==0?ie:z.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,d=3,f=!1,p=!1,g=!1,m=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(z){for(var X=n(c);X!==null;){if(X.callback===null)s(c);else if(X.startTime<=z)s(c),X.sortIndex=X.expirationTime,e(l,X);else break;X=n(c)}}function C(z){if(g=!1,b(z),!p)if(n(l)!==null)p=!0,j(k);else{var X=n(c);X!==null&&ee(C,X.startTime-z)}}function k(z,X){p=!1,g&&(g=!1,y(T),T=-1),f=!0;var ie=d;try{for(b(X),h=n(l);h!==null&&(!(h.expirationTime>X)||z&&!A());){var de=h.callback;if(typeof de=="function"){h.callback=null,d=h.priorityLevel;var he=de(h.expirationTime<=X);X=t.unstable_now(),typeof he=="function"?h.callback=he:h===n(l)&&s(l),b(X)}else s(l);h=n(l)}if(h!==null)var fe=!0;else{var ge=n(c);ge!==null&&ee(C,ge.startTime-X),fe=!1}return fe}finally{h=null,d=ie,f=!1}}var $=!1,I=null,T=-1,R=5,E=-1;function A(){return!(t.unstable_now()-E<R)}function F(){if(I!==null){var z=t.unstable_now();E=z;var X=!0;try{X=I(!0,z)}finally{X?P():($=!1,I=null)}}else $=!1}var P;if(typeof w=="function")P=function(){w(F)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,H=Z.port2;Z.port1.onmessage=F,P=function(){H.postMessage(null)}}else P=function(){m(F,0)};function j(z){I=z,$||($=!0,P())}function ee(z,X){T=m(function(){z(t.unstable_now())},X)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,j(k))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(z){switch(d){case 1:case 2:case 3:var X=3;break;default:X=d}var ie=d;d=X;try{return z()}finally{d=ie}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,X){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var ie=d;d=z;try{return X()}finally{d=ie}},t.unstable_scheduleCallback=function(z,X,ie){var de=t.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?de+ie:de):ie=de,z){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=ie+he,z={id:u++,callback:X,priorityLevel:z,startTime:ie,expirationTime:he,sortIndex:-1},ie>de?(z.sortIndex=ie,e(c,z),n(l)===null&&z===n(c)&&(g?(y(T),T=-1):g=!0,ee(C,ie-de))):(z.sortIndex=he,e(l,z),p||f||(p=!0,j(k))),z},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(z){var X=d;return function(){var ie=d;d=X;try{return z.apply(this,arguments)}finally{d=ie}}}})(tA);eA.exports=tA;var LV=eA.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MV=J,Ur=LV;function xe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var nA=new Set,dp={};function wu(t,e){Kh(t,e),Kh(t+"Capture",e)}function Kh(t,e){for(dp[t]=e,t=0;t<e.length;t++)nA.add(e[t])}var ha=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qw=Object.prototype.hasOwnProperty,BV=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wE={},bE={};function VV(t){return qw.call(bE,t)?!0:qw.call(wE,t)?!1:BV.test(t)?bE[t]=!0:(wE[t]=!0,!1)}function UV(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function zV(t,e,n,s){if(e===null||typeof e>"u"||UV(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function tr(t,e,n,s,r,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var hs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){hs[t]=new tr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];hs[e]=new tr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){hs[t]=new tr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){hs[t]=new tr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){hs[t]=new tr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){hs[t]=new tr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){hs[t]=new tr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){hs[t]=new tr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){hs[t]=new tr(t,5,!1,t.toLowerCase(),null,!1,!1)});var xS=/[\-:]([a-z])/g;function wS(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(xS,wS);hs[e]=new tr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(xS,wS);hs[e]=new tr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(xS,wS);hs[e]=new tr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){hs[t]=new tr(t,1,!1,t.toLowerCase(),null,!1,!1)});hs.xlinkHref=new tr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){hs[t]=new tr(t,1,!1,t.toLowerCase(),null,!0,!0)});function bS(t,e,n,s){var r=hs.hasOwnProperty(e)?hs[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(zV(e,n,r,s)&&(n=null),s||r===null?VV(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var ba=MV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,d0=Symbol.for("react.element"),fh=Symbol.for("react.portal"),ph=Symbol.for("react.fragment"),CS=Symbol.for("react.strict_mode"),Xw=Symbol.for("react.profiler"),sA=Symbol.for("react.provider"),rA=Symbol.for("react.context"),SS=Symbol.for("react.forward_ref"),Yw=Symbol.for("react.suspense"),Jw=Symbol.for("react.suspense_list"),IS=Symbol.for("react.memo"),Wa=Symbol.for("react.lazy"),iA=Symbol.for("react.offscreen"),CE=Symbol.iterator;function pf(t){return t===null||typeof t!="object"?null:(t=CE&&t[CE]||t["@@iterator"],typeof t=="function"?t:null)}var sn=Object.assign,kx;function Rf(t){if(kx===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);kx=e&&e[1]||""}return`
`+kx+t}var Tx=!1;function Ex(t,e){if(!t||Tx)return"";Tx=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var s=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){s=c}t.call(e.prototype)}else{try{throw Error()}catch(c){s=c}t()}}catch(c){if(c&&s&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),i=s.stack.split(`
`),o=r.length-1,a=i.length-1;1<=o&&0<=a&&r[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==i[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Tx=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Rf(t):""}function WV(t){switch(t.tag){case 5:return Rf(t.type);case 16:return Rf("Lazy");case 13:return Rf("Suspense");case 19:return Rf("SuspenseList");case 0:case 2:case 15:return t=Ex(t.type,!1),t;case 11:return t=Ex(t.type.render,!1),t;case 1:return t=Ex(t.type,!0),t;default:return""}}function Zw(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ph:return"Fragment";case fh:return"Portal";case Xw:return"Profiler";case CS:return"StrictMode";case Yw:return"Suspense";case Jw:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case rA:return(t.displayName||"Context")+".Consumer";case sA:return(t._context.displayName||"Context")+".Provider";case SS:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case IS:return e=t.displayName||null,e!==null?e:Zw(t.type)||"Memo";case Wa:e=t._payload,t=t._init;try{return Zw(t(e))}catch{}}return null}function jV(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Zw(e);case 8:return e===CS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Tl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function oA(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function GV(t){var e=oA(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function f0(t){t._valueTracker||(t._valueTracker=GV(t))}function aA(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=oA(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function S1(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Qw(t,e){var n=e.checked;return sn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function SE(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=Tl(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function lA(t,e){e=e.checked,e!=null&&bS(t,"checked",e,!1)}function eb(t,e){lA(t,e);var n=Tl(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?tb(t,e.type,n):e.hasOwnProperty("defaultValue")&&tb(t,e.type,Tl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function IE(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function tb(t,e,n){(e!=="number"||S1(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Af=Array.isArray;function Ah(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+Tl(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function nb(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(xe(91));return sn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function kE(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(xe(92));if(Af(n)){if(1<n.length)throw Error(xe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Tl(n)}}function cA(t,e){var n=Tl(e.value),s=Tl(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function TE(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function uA(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function sb(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?uA(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var p0,hA=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(p0=p0||document.createElement("div"),p0.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=p0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function fp(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var qf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},HV=["Webkit","ms","Moz","O"];Object.keys(qf).forEach(function(t){HV.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),qf[e]=qf[t]})});function dA(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||qf.hasOwnProperty(t)&&qf[t]?(""+e).trim():e+"px"}function fA(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=dA(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var KV=sn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function rb(t,e){if(e){if(KV[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(xe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(xe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(xe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(xe(62))}}function ib(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ob=null;function kS(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ab=null,Dh=null,Ph=null;function EE(t){if(t=rm(t)){if(typeof ab!="function")throw Error(xe(280));var e=t.stateNode;e&&(e=Z2(e),ab(t.stateNode,t.type,e))}}function pA(t){Dh?Ph?Ph.push(t):Ph=[t]:Dh=t}function mA(){if(Dh){var t=Dh,e=Ph;if(Ph=Dh=null,EE(t),e)for(t=0;t<e.length;t++)EE(e[t])}}function gA(t,e){return t(e)}function yA(){}var Nx=!1;function vA(t,e,n){if(Nx)return t(e,n);Nx=!0;try{return gA(t,e,n)}finally{Nx=!1,(Dh!==null||Ph!==null)&&(yA(),mA())}}function pp(t,e){var n=t.stateNode;if(n===null)return null;var s=Z2(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(xe(231,e,typeof n));return n}var lb=!1;if(ha)try{var mf={};Object.defineProperty(mf,"passive",{get:function(){lb=!0}}),window.addEventListener("test",mf,mf),window.removeEventListener("test",mf,mf)}catch{lb=!1}function qV(t,e,n,s,r,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Xf=!1,I1=null,k1=!1,cb=null,XV={onError:function(t){Xf=!0,I1=t}};function YV(t,e,n,s,r,i,o,a,l){Xf=!1,I1=null,qV.apply(XV,arguments)}function JV(t,e,n,s,r,i,o,a,l){if(YV.apply(this,arguments),Xf){if(Xf){var c=I1;Xf=!1,I1=null}else throw Error(xe(198));k1||(k1=!0,cb=c)}}function bu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function xA(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function NE(t){if(bu(t)!==t)throw Error(xe(188))}function ZV(t){var e=t.alternate;if(!e){if(e=bu(t),e===null)throw Error(xe(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return NE(r),t;if(i===s)return NE(r),e;i=i.sibling}throw Error(xe(188))}if(n.return!==s.return)n=r,s=i;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,s=i;break}if(a===s){o=!0,s=r,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,s=r;break}if(a===s){o=!0,s=i,n=r;break}a=a.sibling}if(!o)throw Error(xe(189))}}if(n.alternate!==s)throw Error(xe(190))}if(n.tag!==3)throw Error(xe(188));return n.stateNode.current===n?t:e}function wA(t){return t=ZV(t),t!==null?bA(t):null}function bA(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=bA(t);if(e!==null)return e;t=t.sibling}return null}var CA=Ur.unstable_scheduleCallback,_E=Ur.unstable_cancelCallback,QV=Ur.unstable_shouldYield,eU=Ur.unstable_requestPaint,gn=Ur.unstable_now,tU=Ur.unstable_getCurrentPriorityLevel,TS=Ur.unstable_ImmediatePriority,SA=Ur.unstable_UserBlockingPriority,T1=Ur.unstable_NormalPriority,nU=Ur.unstable_LowPriority,IA=Ur.unstable_IdlePriority,q2=null,mo=null;function sU(t){if(mo&&typeof mo.onCommitFiberRoot=="function")try{mo.onCommitFiberRoot(q2,t,void 0,(t.current.flags&128)===128)}catch{}}var Fi=Math.clz32?Math.clz32:oU,rU=Math.log,iU=Math.LN2;function oU(t){return t>>>=0,t===0?32:31-(rU(t)/iU|0)|0}var m0=64,g0=4194304;function Df(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function E1(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?s=Df(a):(i&=o,i!==0&&(s=Df(i)))}else o=n&~r,o!==0?s=Df(o):i!==0&&(s=Df(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-Fi(e),r=1<<n,s|=t[n],e&=~r;return s}function aU(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lU(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Fi(i),a=1<<o,l=r[o];l===-1?(!(a&n)||a&s)&&(r[o]=aU(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function ub(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function kA(){var t=m0;return m0<<=1,!(m0&4194240)&&(m0=64),t}function _x(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function nm(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Fi(e),t[e]=n}function cU(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Fi(n),i=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~i}}function ES(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-Fi(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var Nt=0;function TA(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var EA,NS,NA,_A,$A,hb=!1,y0=[],al=null,ll=null,cl=null,mp=new Map,gp=new Map,Ka=[],uU="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $E(t,e){switch(t){case"focusin":case"focusout":al=null;break;case"dragenter":case"dragleave":ll=null;break;case"mouseover":case"mouseout":cl=null;break;case"pointerover":case"pointerout":mp.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":gp.delete(e.pointerId)}}function gf(t,e,n,s,r,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=rm(e),e!==null&&NS(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function hU(t,e,n,s,r){switch(e){case"focusin":return al=gf(al,t,e,n,s,r),!0;case"dragenter":return ll=gf(ll,t,e,n,s,r),!0;case"mouseover":return cl=gf(cl,t,e,n,s,r),!0;case"pointerover":var i=r.pointerId;return mp.set(i,gf(mp.get(i)||null,t,e,n,s,r)),!0;case"gotpointercapture":return i=r.pointerId,gp.set(i,gf(gp.get(i)||null,t,e,n,s,r)),!0}return!1}function RA(t){var e=Rc(t.target);if(e!==null){var n=bu(e);if(n!==null){if(e=n.tag,e===13){if(e=xA(n),e!==null){t.blockedOn=e,$A(t.priority,function(){NA(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Z0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=db(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);ob=s,n.target.dispatchEvent(s),ob=null}else return e=rm(n),e!==null&&NS(e),t.blockedOn=n,!1;e.shift()}return!0}function RE(t,e,n){Z0(t)&&n.delete(e)}function dU(){hb=!1,al!==null&&Z0(al)&&(al=null),ll!==null&&Z0(ll)&&(ll=null),cl!==null&&Z0(cl)&&(cl=null),mp.forEach(RE),gp.forEach(RE)}function yf(t,e){t.blockedOn===e&&(t.blockedOn=null,hb||(hb=!0,Ur.unstable_scheduleCallback(Ur.unstable_NormalPriority,dU)))}function yp(t){function e(r){return yf(r,t)}if(0<y0.length){yf(y0[0],t);for(var n=1;n<y0.length;n++){var s=y0[n];s.blockedOn===t&&(s.blockedOn=null)}}for(al!==null&&yf(al,t),ll!==null&&yf(ll,t),cl!==null&&yf(cl,t),mp.forEach(e),gp.forEach(e),n=0;n<Ka.length;n++)s=Ka[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<Ka.length&&(n=Ka[0],n.blockedOn===null);)RA(n),n.blockedOn===null&&Ka.shift()}var Oh=ba.ReactCurrentBatchConfig,N1=!0;function fU(t,e,n,s){var r=Nt,i=Oh.transition;Oh.transition=null;try{Nt=1,_S(t,e,n,s)}finally{Nt=r,Oh.transition=i}}function pU(t,e,n,s){var r=Nt,i=Oh.transition;Oh.transition=null;try{Nt=4,_S(t,e,n,s)}finally{Nt=r,Oh.transition=i}}function _S(t,e,n,s){if(N1){var r=db(t,e,n,s);if(r===null)Bx(t,e,s,_1,n),$E(t,s);else if(hU(r,t,e,n,s))s.stopPropagation();else if($E(t,s),e&4&&-1<uU.indexOf(t)){for(;r!==null;){var i=rm(r);if(i!==null&&EA(i),i=db(t,e,n,s),i===null&&Bx(t,e,s,_1,n),i===r)break;r=i}r!==null&&s.stopPropagation()}else Bx(t,e,s,null,n)}}var _1=null;function db(t,e,n,s){if(_1=null,t=kS(s),t=Rc(t),t!==null)if(e=bu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=xA(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return _1=t,null}function AA(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(tU()){case TS:return 1;case SA:return 4;case T1:case nU:return 16;case IA:return 536870912;default:return 16}default:return 16}}var el=null,$S=null,Q0=null;function DA(){if(Q0)return Q0;var t,e=$S,n=e.length,s,r="value"in el?el.value:el.textContent,i=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(s=1;s<=o&&e[n-s]===r[i-s];s++);return Q0=r.slice(t,1<s?1-s:void 0)}function e1(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function v0(){return!0}function AE(){return!1}function Gr(t){function e(n,s,r,i,o){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?v0:AE,this.isPropagationStopped=AE,this}return sn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=v0)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=v0)},persist:function(){},isPersistent:v0}),e}var Sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},RS=Gr(Sd),sm=sn({},Sd,{view:0,detail:0}),mU=Gr(sm),$x,Rx,vf,X2=sn({},sm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:AS,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==vf&&(vf&&t.type==="mousemove"?($x=t.screenX-vf.screenX,Rx=t.screenY-vf.screenY):Rx=$x=0,vf=t),$x)},movementY:function(t){return"movementY"in t?t.movementY:Rx}}),DE=Gr(X2),gU=sn({},X2,{dataTransfer:0}),yU=Gr(gU),vU=sn({},sm,{relatedTarget:0}),Ax=Gr(vU),xU=sn({},Sd,{animationName:0,elapsedTime:0,pseudoElement:0}),wU=Gr(xU),bU=sn({},Sd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),CU=Gr(bU),SU=sn({},Sd,{data:0}),PE=Gr(SU),IU={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kU={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},TU={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function EU(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=TU[t])?!!e[t]:!1}function AS(){return EU}var NU=sn({},sm,{key:function(t){if(t.key){var e=IU[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=e1(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?kU[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:AS,charCode:function(t){return t.type==="keypress"?e1(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?e1(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),_U=Gr(NU),$U=sn({},X2,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),OE=Gr($U),RU=sn({},sm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:AS}),AU=Gr(RU),DU=sn({},Sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),PU=Gr(DU),OU=sn({},X2,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),FU=Gr(OU),LU=[9,13,27,32],DS=ha&&"CompositionEvent"in window,Yf=null;ha&&"documentMode"in document&&(Yf=document.documentMode);var MU=ha&&"TextEvent"in window&&!Yf,PA=ha&&(!DS||Yf&&8<Yf&&11>=Yf),FE=" ",LE=!1;function OA(t,e){switch(t){case"keyup":return LU.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function FA(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var mh=!1;function BU(t,e){switch(t){case"compositionend":return FA(e);case"keypress":return e.which!==32?null:(LE=!0,FE);case"textInput":return t=e.data,t===FE&&LE?null:t;default:return null}}function VU(t,e){if(mh)return t==="compositionend"||!DS&&OA(t,e)?(t=DA(),Q0=$S=el=null,mh=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return PA&&e.locale!=="ko"?null:e.data;default:return null}}var UU={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ME(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!UU[t.type]:e==="textarea"}function LA(t,e,n,s){pA(s),e=$1(e,"onChange"),0<e.length&&(n=new RS("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Jf=null,vp=null;function zU(t){qA(t,0)}function Y2(t){var e=vh(t);if(aA(e))return t}function WU(t,e){if(t==="change")return e}var MA=!1;if(ha){var Dx;if(ha){var Px="oninput"in document;if(!Px){var BE=document.createElement("div");BE.setAttribute("oninput","return;"),Px=typeof BE.oninput=="function"}Dx=Px}else Dx=!1;MA=Dx&&(!document.documentMode||9<document.documentMode)}function VE(){Jf&&(Jf.detachEvent("onpropertychange",BA),vp=Jf=null)}function BA(t){if(t.propertyName==="value"&&Y2(vp)){var e=[];LA(e,vp,t,kS(t)),vA(zU,e)}}function jU(t,e,n){t==="focusin"?(VE(),Jf=e,vp=n,Jf.attachEvent("onpropertychange",BA)):t==="focusout"&&VE()}function GU(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Y2(vp)}function HU(t,e){if(t==="click")return Y2(e)}function KU(t,e){if(t==="input"||t==="change")return Y2(e)}function qU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var zi=typeof Object.is=="function"?Object.is:qU;function xp(t,e){if(zi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!qw.call(e,r)||!zi(t[r],e[r]))return!1}return!0}function UE(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function zE(t,e){var n=UE(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=UE(n)}}function VA(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?VA(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function UA(){for(var t=window,e=S1();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=S1(t.document)}return e}function PS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function XU(t){var e=UA(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&VA(n.ownerDocument.documentElement,n)){if(s!==null&&PS(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!t.extend&&i>s&&(r=s,s=i,i=r),r=zE(n,i);var o=zE(n,s);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var YU=ha&&"documentMode"in document&&11>=document.documentMode,gh=null,fb=null,Zf=null,pb=!1;function WE(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;pb||gh==null||gh!==S1(s)||(s=gh,"selectionStart"in s&&PS(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Zf&&xp(Zf,s)||(Zf=s,s=$1(fb,"onSelect"),0<s.length&&(e=new RS("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=gh)))}function x0(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var yh={animationend:x0("Animation","AnimationEnd"),animationiteration:x0("Animation","AnimationIteration"),animationstart:x0("Animation","AnimationStart"),transitionend:x0("Transition","TransitionEnd")},Ox={},zA={};ha&&(zA=document.createElement("div").style,"AnimationEvent"in window||(delete yh.animationend.animation,delete yh.animationiteration.animation,delete yh.animationstart.animation),"TransitionEvent"in window||delete yh.transitionend.transition);function J2(t){if(Ox[t])return Ox[t];if(!yh[t])return t;var e=yh[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in zA)return Ox[t]=e[n];return t}var WA=J2("animationend"),jA=J2("animationiteration"),GA=J2("animationstart"),HA=J2("transitionend"),KA=new Map,jE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ll(t,e){KA.set(t,e),wu(e,[t])}for(var Fx=0;Fx<jE.length;Fx++){var Lx=jE[Fx],JU=Lx.toLowerCase(),ZU=Lx[0].toUpperCase()+Lx.slice(1);Ll(JU,"on"+ZU)}Ll(WA,"onAnimationEnd");Ll(jA,"onAnimationIteration");Ll(GA,"onAnimationStart");Ll("dblclick","onDoubleClick");Ll("focusin","onFocus");Ll("focusout","onBlur");Ll(HA,"onTransitionEnd");Kh("onMouseEnter",["mouseout","mouseover"]);Kh("onMouseLeave",["mouseout","mouseover"]);Kh("onPointerEnter",["pointerout","pointerover"]);Kh("onPointerLeave",["pointerout","pointerover"]);wu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));wu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));wu("onBeforeInput",["compositionend","keypress","textInput","paste"]);wu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));wu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));wu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QU=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pf));function GE(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,JV(s,e,void 0,t),t.currentTarget=null}function qA(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&r.isPropagationStopped())break e;GE(r,a,c),i=l}else for(o=0;o<s.length;o++){if(a=s[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&r.isPropagationStopped())break e;GE(r,a,c),i=l}}}if(k1)throw t=cb,k1=!1,cb=null,t}function jt(t,e){var n=e[xb];n===void 0&&(n=e[xb]=new Set);var s=t+"__bubble";n.has(s)||(XA(e,t,2,!1),n.add(s))}function Mx(t,e,n){var s=0;e&&(s|=4),XA(n,t,s,e)}var w0="_reactListening"+Math.random().toString(36).slice(2);function wp(t){if(!t[w0]){t[w0]=!0,nA.forEach(function(n){n!=="selectionchange"&&(QU.has(n)||Mx(n,!1,t),Mx(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[w0]||(e[w0]=!0,Mx("selectionchange",!1,e))}}function XA(t,e,n,s){switch(AA(e)){case 1:var r=fU;break;case 4:r=pU;break;default:r=_S}n=r.bind(null,e,n,t),r=void 0,!lb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Bx(t,e,n,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Rc(a),o===null)return;if(l=o.tag,l===5||l===6){s=i=o;continue e}a=a.parentNode}}s=s.return}vA(function(){var c=i,u=kS(n),h=[];e:{var d=KA.get(t);if(d!==void 0){var f=RS,p=t;switch(t){case"keypress":if(e1(n)===0)break e;case"keydown":case"keyup":f=_U;break;case"focusin":p="focus",f=Ax;break;case"focusout":p="blur",f=Ax;break;case"beforeblur":case"afterblur":f=Ax;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=DE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=yU;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=AU;break;case WA:case jA:case GA:f=wU;break;case HA:f=PU;break;case"scroll":f=mU;break;case"wheel":f=FU;break;case"copy":case"cut":case"paste":f=CU;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=OE}var g=(e&4)!==0,m=!g&&t==="scroll",y=g?d!==null?d+"Capture":null:d;g=[];for(var w=c,b;w!==null;){b=w;var C=b.stateNode;if(b.tag===5&&C!==null&&(b=C,y!==null&&(C=pp(w,y),C!=null&&g.push(bp(w,C,b)))),m)break;w=w.return}0<g.length&&(d=new f(d,p,null,n,u),h.push({event:d,listeners:g}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",d&&n!==ob&&(p=n.relatedTarget||n.fromElement)&&(Rc(p)||p[da]))break e;if((f||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?Rc(p):null,p!==null&&(m=bu(p),p!==m||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(g=DE,C="onMouseLeave",y="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(g=OE,C="onPointerLeave",y="onPointerEnter",w="pointer"),m=f==null?d:vh(f),b=p==null?d:vh(p),d=new g(C,w+"leave",f,n,u),d.target=m,d.relatedTarget=b,C=null,Rc(u)===c&&(g=new g(y,w+"enter",p,n,u),g.target=b,g.relatedTarget=m,C=g),m=C,f&&p)t:{for(g=f,y=p,w=0,b=g;b;b=Zu(b))w++;for(b=0,C=y;C;C=Zu(C))b++;for(;0<w-b;)g=Zu(g),w--;for(;0<b-w;)y=Zu(y),b--;for(;w--;){if(g===y||y!==null&&g===y.alternate)break t;g=Zu(g),y=Zu(y)}g=null}else g=null;f!==null&&HE(h,d,f,g,!1),p!==null&&m!==null&&HE(h,m,p,g,!0)}}e:{if(d=c?vh(c):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var k=WU;else if(ME(d))if(MA)k=KU;else{k=GU;var $=jU}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(k=HU);if(k&&(k=k(t,c))){LA(h,k,n,u);break e}$&&$(t,d,c),t==="focusout"&&($=d._wrapperState)&&$.controlled&&d.type==="number"&&tb(d,"number",d.value)}switch($=c?vh(c):window,t){case"focusin":(ME($)||$.contentEditable==="true")&&(gh=$,fb=c,Zf=null);break;case"focusout":Zf=fb=gh=null;break;case"mousedown":pb=!0;break;case"contextmenu":case"mouseup":case"dragend":pb=!1,WE(h,n,u);break;case"selectionchange":if(YU)break;case"keydown":case"keyup":WE(h,n,u)}var I;if(DS)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else mh?OA(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(PA&&n.locale!=="ko"&&(mh||T!=="onCompositionStart"?T==="onCompositionEnd"&&mh&&(I=DA()):(el=u,$S="value"in el?el.value:el.textContent,mh=!0)),$=$1(c,T),0<$.length&&(T=new PE(T,t,null,n,u),h.push({event:T,listeners:$}),I?T.data=I:(I=FA(n),I!==null&&(T.data=I)))),(I=MU?BU(t,n):VU(t,n))&&(c=$1(c,"onBeforeInput"),0<c.length&&(u=new PE("onBeforeInput","beforeinput",null,n,u),h.push({event:u,listeners:c}),u.data=I))}qA(h,e)})}function bp(t,e,n){return{instance:t,listener:e,currentTarget:n}}function $1(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=pp(t,n),i!=null&&s.unshift(bp(t,i,r)),i=pp(t,e),i!=null&&s.push(bp(t,i,r))),t=t.return}return s}function Zu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function HE(t,e,n,s,r){for(var i=e._reactName,o=[];n!==null&&n!==s;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&c!==null&&(a=c,r?(l=pp(n,i),l!=null&&o.unshift(bp(n,l,a))):r||(l=pp(n,i),l!=null&&o.push(bp(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var ez=/\r\n?/g,tz=/\u0000|\uFFFD/g;function KE(t){return(typeof t=="string"?t:""+t).replace(ez,`
`).replace(tz,"")}function b0(t,e,n){if(e=KE(e),KE(t)!==e&&n)throw Error(xe(425))}function R1(){}var mb=null,gb=null;function yb(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var vb=typeof setTimeout=="function"?setTimeout:void 0,nz=typeof clearTimeout=="function"?clearTimeout:void 0,qE=typeof Promise=="function"?Promise:void 0,sz=typeof queueMicrotask=="function"?queueMicrotask:typeof qE<"u"?function(t){return qE.resolve(null).then(t).catch(rz)}:vb;function rz(t){setTimeout(function(){throw t})}function Vx(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),yp(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);yp(e)}function ul(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function XE(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Id=Math.random().toString(36).slice(2),ho="__reactFiber$"+Id,Cp="__reactProps$"+Id,da="__reactContainer$"+Id,xb="__reactEvents$"+Id,iz="__reactListeners$"+Id,oz="__reactHandles$"+Id;function Rc(t){var e=t[ho];if(e)return e;for(var n=t.parentNode;n;){if(e=n[da]||n[ho]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=XE(t);t!==null;){if(n=t[ho])return n;t=XE(t)}return e}t=n,n=t.parentNode}return null}function rm(t){return t=t[ho]||t[da],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function vh(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(xe(33))}function Z2(t){return t[Cp]||null}var wb=[],xh=-1;function Ml(t){return{current:t}}function Ht(t){0>xh||(t.current=wb[xh],wb[xh]=null,xh--)}function Lt(t,e){xh++,wb[xh]=t.current,t.current=e}var El={},Ps=Ml(El),gr=Ml(!1),Yc=El;function qh(t,e){var n=t.type.contextTypes;if(!n)return El;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in n)r[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function yr(t){return t=t.childContextTypes,t!=null}function A1(){Ht(gr),Ht(Ps)}function YE(t,e,n){if(Ps.current!==El)throw Error(xe(168));Lt(Ps,e),Lt(gr,n)}function YA(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(xe(108,jV(t)||"Unknown",r));return sn({},n,s)}function D1(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||El,Yc=Ps.current,Lt(Ps,t),Lt(gr,gr.current),!0}function JE(t,e,n){var s=t.stateNode;if(!s)throw Error(xe(169));n?(t=YA(t,e,Yc),s.__reactInternalMemoizedMergedChildContext=t,Ht(gr),Ht(Ps),Lt(Ps,t)):Ht(gr),Lt(gr,n)}var Xo=null,Q2=!1,Ux=!1;function JA(t){Xo===null?Xo=[t]:Xo.push(t)}function az(t){Q2=!0,JA(t)}function Bl(){if(!Ux&&Xo!==null){Ux=!0;var t=0,e=Nt;try{var n=Xo;for(Nt=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}Xo=null,Q2=!1}catch(r){throw Xo!==null&&(Xo=Xo.slice(t+1)),CA(TS,Bl),r}finally{Nt=e,Ux=!1}}return null}var wh=[],bh=0,P1=null,O1=0,ii=[],oi=0,Jc=null,Qo=1,ea="";function bc(t,e){wh[bh++]=O1,wh[bh++]=P1,P1=t,O1=e}function ZA(t,e,n){ii[oi++]=Qo,ii[oi++]=ea,ii[oi++]=Jc,Jc=t;var s=Qo;t=ea;var r=32-Fi(s)-1;s&=~(1<<r),n+=1;var i=32-Fi(e)+r;if(30<i){var o=r-r%5;i=(s&(1<<o)-1).toString(32),s>>=o,r-=o,Qo=1<<32-Fi(e)+r|n<<r|s,ea=i+t}else Qo=1<<i|n<<r|s,ea=t}function OS(t){t.return!==null&&(bc(t,1),ZA(t,1,0))}function FS(t){for(;t===P1;)P1=wh[--bh],wh[bh]=null,O1=wh[--bh],wh[bh]=null;for(;t===Jc;)Jc=ii[--oi],ii[oi]=null,ea=ii[--oi],ii[oi]=null,Qo=ii[--oi],ii[oi]=null}var Br=null,Fr=null,Yt=!1,Ai=null;function QA(t,e){var n=li(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function ZE(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Br=t,Fr=ul(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Br=t,Fr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Jc!==null?{id:Qo,overflow:ea}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=li(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Br=t,Fr=null,!0):!1;default:return!1}}function bb(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Cb(t){if(Yt){var e=Fr;if(e){var n=e;if(!ZE(t,e)){if(bb(t))throw Error(xe(418));e=ul(n.nextSibling);var s=Br;e&&ZE(t,e)?QA(s,n):(t.flags=t.flags&-4097|2,Yt=!1,Br=t)}}else{if(bb(t))throw Error(xe(418));t.flags=t.flags&-4097|2,Yt=!1,Br=t}}}function QE(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Br=t}function C0(t){if(t!==Br)return!1;if(!Yt)return QE(t),Yt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!yb(t.type,t.memoizedProps)),e&&(e=Fr)){if(bb(t))throw eD(),Error(xe(418));for(;e;)QA(t,e),e=ul(e.nextSibling)}if(QE(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(xe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Fr=ul(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Fr=null}}else Fr=Br?ul(t.stateNode.nextSibling):null;return!0}function eD(){for(var t=Fr;t;)t=ul(t.nextSibling)}function Xh(){Fr=Br=null,Yt=!1}function LS(t){Ai===null?Ai=[t]:Ai.push(t)}var lz=ba.ReactCurrentBatchConfig;function xf(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(xe(309));var s=n.stateNode}if(!s)throw Error(xe(147,t));var r=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=r.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(xe(284));if(!n._owner)throw Error(xe(290,t))}return t}function S0(t,e){throw t=Object.prototype.toString.call(e),Error(xe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function e4(t){var e=t._init;return e(t._payload)}function tD(t){function e(y,w){if(t){var b=y.deletions;b===null?(y.deletions=[w],y.flags|=16):b.push(w)}}function n(y,w){if(!t)return null;for(;w!==null;)e(y,w),w=w.sibling;return null}function s(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function r(y,w){return y=pl(y,w),y.index=0,y.sibling=null,y}function i(y,w,b){return y.index=b,t?(b=y.alternate,b!==null?(b=b.index,b<w?(y.flags|=2,w):b):(y.flags|=2,w)):(y.flags|=1048576,w)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,w,b,C){return w===null||w.tag!==6?(w=qx(b,y.mode,C),w.return=y,w):(w=r(w,b),w.return=y,w)}function l(y,w,b,C){var k=b.type;return k===ph?u(y,w,b.props.children,C,b.key):w!==null&&(w.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Wa&&e4(k)===w.type)?(C=r(w,b.props),C.ref=xf(y,w,b),C.return=y,C):(C=a1(b.type,b.key,b.props,null,y.mode,C),C.ref=xf(y,w,b),C.return=y,C)}function c(y,w,b,C){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=Xx(b,y.mode,C),w.return=y,w):(w=r(w,b.children||[]),w.return=y,w)}function u(y,w,b,C,k){return w===null||w.tag!==7?(w=Vc(b,y.mode,C,k),w.return=y,w):(w=r(w,b),w.return=y,w)}function h(y,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=qx(""+w,y.mode,b),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case d0:return b=a1(w.type,w.key,w.props,null,y.mode,b),b.ref=xf(y,null,w),b.return=y,b;case fh:return w=Xx(w,y.mode,b),w.return=y,w;case Wa:var C=w._init;return h(y,C(w._payload),b)}if(Af(w)||pf(w))return w=Vc(w,y.mode,b,null),w.return=y,w;S0(y,w)}return null}function d(y,w,b,C){var k=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return k!==null?null:a(y,w,""+b,C);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case d0:return b.key===k?l(y,w,b,C):null;case fh:return b.key===k?c(y,w,b,C):null;case Wa:return k=b._init,d(y,w,k(b._payload),C)}if(Af(b)||pf(b))return k!==null?null:u(y,w,b,C,null);S0(y,b)}return null}function f(y,w,b,C,k){if(typeof C=="string"&&C!==""||typeof C=="number")return y=y.get(b)||null,a(w,y,""+C,k);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case d0:return y=y.get(C.key===null?b:C.key)||null,l(w,y,C,k);case fh:return y=y.get(C.key===null?b:C.key)||null,c(w,y,C,k);case Wa:var $=C._init;return f(y,w,b,$(C._payload),k)}if(Af(C)||pf(C))return y=y.get(b)||null,u(w,y,C,k,null);S0(w,C)}return null}function p(y,w,b,C){for(var k=null,$=null,I=w,T=w=0,R=null;I!==null&&T<b.length;T++){I.index>T?(R=I,I=null):R=I.sibling;var E=d(y,I,b[T],C);if(E===null){I===null&&(I=R);break}t&&I&&E.alternate===null&&e(y,I),w=i(E,w,T),$===null?k=E:$.sibling=E,$=E,I=R}if(T===b.length)return n(y,I),Yt&&bc(y,T),k;if(I===null){for(;T<b.length;T++)I=h(y,b[T],C),I!==null&&(w=i(I,w,T),$===null?k=I:$.sibling=I,$=I);return Yt&&bc(y,T),k}for(I=s(y,I);T<b.length;T++)R=f(I,y,T,b[T],C),R!==null&&(t&&R.alternate!==null&&I.delete(R.key===null?T:R.key),w=i(R,w,T),$===null?k=R:$.sibling=R,$=R);return t&&I.forEach(function(A){return e(y,A)}),Yt&&bc(y,T),k}function g(y,w,b,C){var k=pf(b);if(typeof k!="function")throw Error(xe(150));if(b=k.call(b),b==null)throw Error(xe(151));for(var $=k=null,I=w,T=w=0,R=null,E=b.next();I!==null&&!E.done;T++,E=b.next()){I.index>T?(R=I,I=null):R=I.sibling;var A=d(y,I,E.value,C);if(A===null){I===null&&(I=R);break}t&&I&&A.alternate===null&&e(y,I),w=i(A,w,T),$===null?k=A:$.sibling=A,$=A,I=R}if(E.done)return n(y,I),Yt&&bc(y,T),k;if(I===null){for(;!E.done;T++,E=b.next())E=h(y,E.value,C),E!==null&&(w=i(E,w,T),$===null?k=E:$.sibling=E,$=E);return Yt&&bc(y,T),k}for(I=s(y,I);!E.done;T++,E=b.next())E=f(I,y,T,E.value,C),E!==null&&(t&&E.alternate!==null&&I.delete(E.key===null?T:E.key),w=i(E,w,T),$===null?k=E:$.sibling=E,$=E);return t&&I.forEach(function(F){return e(y,F)}),Yt&&bc(y,T),k}function m(y,w,b,C){if(typeof b=="object"&&b!==null&&b.type===ph&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case d0:e:{for(var k=b.key,$=w;$!==null;){if($.key===k){if(k=b.type,k===ph){if($.tag===7){n(y,$.sibling),w=r($,b.props.children),w.return=y,y=w;break e}}else if($.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Wa&&e4(k)===$.type){n(y,$.sibling),w=r($,b.props),w.ref=xf(y,$,b),w.return=y,y=w;break e}n(y,$);break}else e(y,$);$=$.sibling}b.type===ph?(w=Vc(b.props.children,y.mode,C,b.key),w.return=y,y=w):(C=a1(b.type,b.key,b.props,null,y.mode,C),C.ref=xf(y,w,b),C.return=y,y=C)}return o(y);case fh:e:{for($=b.key;w!==null;){if(w.key===$)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){n(y,w.sibling),w=r(w,b.children||[]),w.return=y,y=w;break e}else{n(y,w);break}else e(y,w);w=w.sibling}w=Xx(b,y.mode,C),w.return=y,y=w}return o(y);case Wa:return $=b._init,m(y,w,$(b._payload),C)}if(Af(b))return p(y,w,b,C);if(pf(b))return g(y,w,b,C);S0(y,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(n(y,w.sibling),w=r(w,b),w.return=y,y=w):(n(y,w),w=qx(b,y.mode,C),w.return=y,y=w),o(y)):n(y,w)}return m}var Yh=tD(!0),nD=tD(!1),F1=Ml(null),L1=null,Ch=null,MS=null;function BS(){MS=Ch=L1=null}function VS(t){var e=F1.current;Ht(F1),t._currentValue=e}function Sb(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function Fh(t,e){L1=t,MS=Ch=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(dr=!0),t.firstContext=null)}function mi(t){var e=t._currentValue;if(MS!==t)if(t={context:t,memoizedValue:e,next:null},Ch===null){if(L1===null)throw Error(xe(308));Ch=t,L1.dependencies={lanes:0,firstContext:t}}else Ch=Ch.next=t;return e}var Ac=null;function US(t){Ac===null?Ac=[t]:Ac.push(t)}function sD(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,US(e)):(n.next=r.next,r.next=n),e.interleaved=n,fa(t,s)}function fa(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ja=!1;function zS(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function rD(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function aa(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function hl(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,ft&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,fa(t,n)}return r=s.interleaved,r===null?(e.next=e,US(s)):(e.next=r.next,r.next=e),s.interleaved=e,fa(t,n)}function t1(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,ES(t,n)}}function t4(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?r=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?r=i=e:i=i.next=e}else r=i=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function M1(t,e,n,s){var r=t.updateQueue;ja=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var h=r.baseState;o=0,u=c=l=null,a=i;do{var d=a.lane,f=a.eventTime;if((s&d)===d){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,g=a;switch(d=e,f=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,d=typeof p=="function"?p.call(f,h,d):p,d==null)break e;h=sn({},h,d);break e;case 2:ja=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,d=r.effects,d===null?r.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=h):u=u.next=f,o|=d;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;d=a,a=d.next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}while(!0);if(u===null&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);Qc|=o,t.lanes=o,t.memoizedState=h}}function n4(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(xe(191,r));r.call(s)}}}var im={},go=Ml(im),Sp=Ml(im),Ip=Ml(im);function Dc(t){if(t===im)throw Error(xe(174));return t}function WS(t,e){switch(Lt(Ip,e),Lt(Sp,t),Lt(go,im),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:sb(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=sb(e,t)}Ht(go),Lt(go,e)}function Jh(){Ht(go),Ht(Sp),Ht(Ip)}function iD(t){Dc(Ip.current);var e=Dc(go.current),n=sb(e,t.type);e!==n&&(Lt(Sp,t),Lt(go,n))}function jS(t){Sp.current===t&&(Ht(go),Ht(Sp))}var Qt=Ml(0);function B1(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var zx=[];function GS(){for(var t=0;t<zx.length;t++)zx[t]._workInProgressVersionPrimary=null;zx.length=0}var n1=ba.ReactCurrentDispatcher,Wx=ba.ReactCurrentBatchConfig,Zc=0,tn=null,Ln=null,qn=null,V1=!1,Qf=!1,kp=0,cz=0;function ws(){throw Error(xe(321))}function HS(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!zi(t[n],e[n]))return!1;return!0}function KS(t,e,n,s,r,i){if(Zc=i,tn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,n1.current=t===null||t.memoizedState===null?fz:pz,t=n(s,r),Qf){i=0;do{if(Qf=!1,kp=0,25<=i)throw Error(xe(301));i+=1,qn=Ln=null,e.updateQueue=null,n1.current=mz,t=n(s,r)}while(Qf)}if(n1.current=U1,e=Ln!==null&&Ln.next!==null,Zc=0,qn=Ln=tn=null,V1=!1,e)throw Error(xe(300));return t}function qS(){var t=kp!==0;return kp=0,t}function ro(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qn===null?tn.memoizedState=qn=t:qn=qn.next=t,qn}function gi(){if(Ln===null){var t=tn.alternate;t=t!==null?t.memoizedState:null}else t=Ln.next;var e=qn===null?tn.memoizedState:qn.next;if(e!==null)qn=e,Ln=t;else{if(t===null)throw Error(xe(310));Ln=t,t={memoizedState:Ln.memoizedState,baseState:Ln.baseState,baseQueue:Ln.baseQueue,queue:Ln.queue,next:null},qn===null?tn.memoizedState=qn=t:qn=qn.next=t}return qn}function Tp(t,e){return typeof e=="function"?e(t):e}function jx(t){var e=gi(),n=e.queue;if(n===null)throw Error(xe(311));n.lastRenderedReducer=t;var s=Ln,r=s.baseQueue,i=n.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,n.pending=null}if(r!==null){i=r.next,s=s.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((Zc&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),s=c.hasEagerState?c.eagerState:t(s,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=s):l=l.next=h,tn.lanes|=u,Qc|=u}c=c.next}while(c!==null&&c!==i);l===null?o=s:l.next=a,zi(s,e.memoizedState)||(dr=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do i=r.lane,tn.lanes|=i,Qc|=i,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Gx(t){var e=gi(),n=e.queue;if(n===null)throw Error(xe(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,i=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do i=t(i,o.action),o=o.next;while(o!==r);zi(i,e.memoizedState)||(dr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function oD(){}function aD(t,e){var n=tn,s=gi(),r=e(),i=!zi(s.memoizedState,r);if(i&&(s.memoizedState=r,dr=!0),s=s.queue,XS(uD.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||qn!==null&&qn.memoizedState.tag&1){if(n.flags|=2048,Ep(9,cD.bind(null,n,s,r,e),void 0,null),Jn===null)throw Error(xe(349));Zc&30||lD(n,e,r)}return r}function lD(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=tn.updateQueue,e===null?(e={lastEffect:null,stores:null},tn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function cD(t,e,n,s){e.value=n,e.getSnapshot=s,hD(e)&&dD(t)}function uD(t,e,n){return n(function(){hD(e)&&dD(t)})}function hD(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!zi(t,n)}catch{return!0}}function dD(t){var e=fa(t,1);e!==null&&Li(e,t,1,-1)}function s4(t){var e=ro();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Tp,lastRenderedState:t},e.queue=t,t=t.dispatch=dz.bind(null,tn,t),[e.memoizedState,t]}function Ep(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=tn.updateQueue,e===null?(e={lastEffect:null,stores:null},tn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function fD(){return gi().memoizedState}function s1(t,e,n,s){var r=ro();tn.flags|=t,r.memoizedState=Ep(1|e,n,void 0,s===void 0?null:s)}function ey(t,e,n,s){var r=gi();s=s===void 0?null:s;var i=void 0;if(Ln!==null){var o=Ln.memoizedState;if(i=o.destroy,s!==null&&HS(s,o.deps)){r.memoizedState=Ep(e,n,i,s);return}}tn.flags|=t,r.memoizedState=Ep(1|e,n,i,s)}function r4(t,e){return s1(8390656,8,t,e)}function XS(t,e){return ey(2048,8,t,e)}function pD(t,e){return ey(4,2,t,e)}function mD(t,e){return ey(4,4,t,e)}function gD(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function yD(t,e,n){return n=n!=null?n.concat([t]):null,ey(4,4,gD.bind(null,e,t),n)}function YS(){}function vD(t,e){var n=gi();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&HS(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function xD(t,e){var n=gi();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&HS(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function wD(t,e,n){return Zc&21?(zi(n,e)||(n=kA(),tn.lanes|=n,Qc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,dr=!0),t.memoizedState=n)}function uz(t,e){var n=Nt;Nt=n!==0&&4>n?n:4,t(!0);var s=Wx.transition;Wx.transition={};try{t(!1),e()}finally{Nt=n,Wx.transition=s}}function bD(){return gi().memoizedState}function hz(t,e,n){var s=fl(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},CD(t))SD(e,n);else if(n=sD(t,e,n,s),n!==null){var r=Ys();Li(n,t,s,r),ID(n,e,s)}}function dz(t,e,n){var s=fl(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(CD(t))SD(e,r);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(r.hasEagerState=!0,r.eagerState=a,zi(a,o)){var l=e.interleaved;l===null?(r.next=r,US(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=sD(t,e,r,s),n!==null&&(r=Ys(),Li(n,t,s,r),ID(n,e,s))}}function CD(t){var e=t.alternate;return t===tn||e!==null&&e===tn}function SD(t,e){Qf=V1=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function ID(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,ES(t,n)}}var U1={readContext:mi,useCallback:ws,useContext:ws,useEffect:ws,useImperativeHandle:ws,useInsertionEffect:ws,useLayoutEffect:ws,useMemo:ws,useReducer:ws,useRef:ws,useState:ws,useDebugValue:ws,useDeferredValue:ws,useTransition:ws,useMutableSource:ws,useSyncExternalStore:ws,useId:ws,unstable_isNewReconciler:!1},fz={readContext:mi,useCallback:function(t,e){return ro().memoizedState=[t,e===void 0?null:e],t},useContext:mi,useEffect:r4,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,s1(4194308,4,gD.bind(null,e,t),n)},useLayoutEffect:function(t,e){return s1(4194308,4,t,e)},useInsertionEffect:function(t,e){return s1(4,2,t,e)},useMemo:function(t,e){var n=ro();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=ro();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=hz.bind(null,tn,t),[s.memoizedState,t]},useRef:function(t){var e=ro();return t={current:t},e.memoizedState=t},useState:s4,useDebugValue:YS,useDeferredValue:function(t){return ro().memoizedState=t},useTransition:function(){var t=s4(!1),e=t[0];return t=uz.bind(null,t[1]),ro().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=tn,r=ro();if(Yt){if(n===void 0)throw Error(xe(407));n=n()}else{if(n=e(),Jn===null)throw Error(xe(349));Zc&30||lD(s,e,n)}r.memoizedState=n;var i={value:n,getSnapshot:e};return r.queue=i,r4(uD.bind(null,s,i,t),[t]),s.flags|=2048,Ep(9,cD.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=ro(),e=Jn.identifierPrefix;if(Yt){var n=ea,s=Qo;n=(s&~(1<<32-Fi(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=kp++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=cz++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},pz={readContext:mi,useCallback:vD,useContext:mi,useEffect:XS,useImperativeHandle:yD,useInsertionEffect:pD,useLayoutEffect:mD,useMemo:xD,useReducer:jx,useRef:fD,useState:function(){return jx(Tp)},useDebugValue:YS,useDeferredValue:function(t){var e=gi();return wD(e,Ln.memoizedState,t)},useTransition:function(){var t=jx(Tp)[0],e=gi().memoizedState;return[t,e]},useMutableSource:oD,useSyncExternalStore:aD,useId:bD,unstable_isNewReconciler:!1},mz={readContext:mi,useCallback:vD,useContext:mi,useEffect:XS,useImperativeHandle:yD,useInsertionEffect:pD,useLayoutEffect:mD,useMemo:xD,useReducer:Gx,useRef:fD,useState:function(){return Gx(Tp)},useDebugValue:YS,useDeferredValue:function(t){var e=gi();return Ln===null?e.memoizedState=t:wD(e,Ln.memoizedState,t)},useTransition:function(){var t=Gx(Tp)[0],e=gi().memoizedState;return[t,e]},useMutableSource:oD,useSyncExternalStore:aD,useId:bD,unstable_isNewReconciler:!1};function $i(t,e){if(t&&t.defaultProps){e=sn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Ib(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:sn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ty={isMounted:function(t){return(t=t._reactInternals)?bu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=Ys(),r=fl(t),i=aa(s,r);i.payload=e,n!=null&&(i.callback=n),e=hl(t,i,r),e!==null&&(Li(e,t,r,s),t1(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=Ys(),r=fl(t),i=aa(s,r);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=hl(t,i,r),e!==null&&(Li(e,t,r,s),t1(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ys(),s=fl(t),r=aa(n,s);r.tag=2,e!=null&&(r.callback=e),e=hl(t,r,s),e!==null&&(Li(e,t,s,n),t1(e,t,s))}};function i4(t,e,n,s,r,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!xp(n,s)||!xp(r,i):!0}function kD(t,e,n){var s=!1,r=El,i=e.contextType;return typeof i=="object"&&i!==null?i=mi(i):(r=yr(e)?Yc:Ps.current,s=e.contextTypes,i=(s=s!=null)?qh(t,r):El),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ty,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=i),e}function o4(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&ty.enqueueReplaceState(e,e.state,null)}function kb(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},zS(t);var i=e.contextType;typeof i=="object"&&i!==null?r.context=mi(i):(i=yr(e)?Yc:Ps.current,r.context=qh(t,i)),r.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Ib(t,e,i,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&ty.enqueueReplaceState(r,r.state,null),M1(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Zh(t,e){try{var n="",s=e;do n+=WV(s),s=s.return;while(s);var r=n}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:r,digest:null}}function Hx(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Tb(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var gz=typeof WeakMap=="function"?WeakMap:Map;function TD(t,e,n){n=aa(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){W1||(W1=!0,Fb=s),Tb(t,e)},n}function ED(t,e,n){n=aa(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){Tb(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Tb(t,e),typeof s!="function"&&(dl===null?dl=new Set([this]):dl.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function a4(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new gz;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=$z.bind(null,t,e,n),e.then(t,t))}function l4(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function c4(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=aa(-1,1),e.tag=2,hl(n,e,1))),n.lanes|=1),t)}var yz=ba.ReactCurrentOwner,dr=!1;function Gs(t,e,n,s){e.child=t===null?nD(e,null,n,s):Yh(e,t.child,n,s)}function u4(t,e,n,s,r){n=n.render;var i=e.ref;return Fh(e,r),s=KS(t,e,n,s,i,r),n=qS(),t!==null&&!dr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,pa(t,e,r)):(Yt&&n&&OS(e),e.flags|=1,Gs(t,e,s,r),e.child)}function h4(t,e,n,s,r){if(t===null){var i=n.type;return typeof i=="function"&&!rI(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,ND(t,e,i,s,r)):(t=a1(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&r)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:xp,n(o,s)&&t.ref===e.ref)return pa(t,e,r)}return e.flags|=1,t=pl(i,s),t.ref=e.ref,t.return=e,e.child=t}function ND(t,e,n,s,r){if(t!==null){var i=t.memoizedProps;if(xp(i,s)&&t.ref===e.ref)if(dr=!1,e.pendingProps=s=i,(t.lanes&r)!==0)t.flags&131072&&(dr=!0);else return e.lanes=t.lanes,pa(t,e,r)}return Eb(t,e,n,s,r)}function _D(t,e,n){var s=e.pendingProps,r=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Lt(Ih,Pr),Pr|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Lt(Ih,Pr),Pr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,Lt(Ih,Pr),Pr|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,Lt(Ih,Pr),Pr|=s;return Gs(t,e,r,n),e.child}function $D(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Eb(t,e,n,s,r){var i=yr(n)?Yc:Ps.current;return i=qh(e,i),Fh(e,r),n=KS(t,e,n,s,i,r),s=qS(),t!==null&&!dr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,pa(t,e,r)):(Yt&&s&&OS(e),e.flags|=1,Gs(t,e,n,r),e.child)}function d4(t,e,n,s,r){if(yr(n)){var i=!0;D1(e)}else i=!1;if(Fh(e,r),e.stateNode===null)r1(t,e),kD(e,n,s),kb(e,n,s,r),s=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=mi(c):(c=yr(n)?Yc:Ps.current,c=qh(e,c));var u=n.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==s||l!==c)&&o4(e,o,s,c),ja=!1;var d=e.memoizedState;o.state=d,M1(e,s,o,r),l=e.memoizedState,a!==s||d!==l||gr.current||ja?(typeof u=="function"&&(Ib(e,n,u,s),l=e.memoizedState),(a=ja||i4(e,n,a,s,d,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),o.props=s,o.state=l,o.context=c,s=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,rD(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:$i(e.type,a),o.props=c,h=e.pendingProps,d=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=mi(l):(l=yr(n)?Yc:Ps.current,l=qh(e,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||d!==l)&&o4(e,o,s,l),ja=!1,d=e.memoizedState,o.state=d,M1(e,s,o,r);var p=e.memoizedState;a!==h||d!==p||gr.current||ja?(typeof f=="function"&&(Ib(e,n,f,s),p=e.memoizedState),(c=ja||i4(e,n,c,s,d,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=p),o.props=s,o.state=p,o.context=l,s=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),s=!1)}return Nb(t,e,n,s,i,r)}function Nb(t,e,n,s,r,i){$D(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return r&&JE(e,n,!1),pa(t,e,i);s=e.stateNode,yz.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=Yh(e,t.child,null,i),e.child=Yh(e,null,a,i)):Gs(t,e,a,i),e.memoizedState=s.state,r&&JE(e,n,!0),e.child}function RD(t){var e=t.stateNode;e.pendingContext?YE(t,e.pendingContext,e.pendingContext!==e.context):e.context&&YE(t,e.context,!1),WS(t,e.containerInfo)}function f4(t,e,n,s,r){return Xh(),LS(r),e.flags|=256,Gs(t,e,n,s),e.child}var _b={dehydrated:null,treeContext:null,retryLane:0};function $b(t){return{baseLanes:t,cachePool:null,transitions:null}}function AD(t,e,n){var s=e.pendingProps,r=Qt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),Lt(Qt,r&1),t===null)return Cb(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=ry(o,s,0,null),t=Vc(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=$b(n),e.memoizedState=_b,t):JS(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return vz(t,e,o,s,a,r,n);if(i){i=s.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:s.children};return!(o&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=pl(r,l),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?i=pl(a,i):(i=Vc(i,o,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=t.child.memoizedState,o=o===null?$b(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=_b,s}return i=t.child,t=i.sibling,s=pl(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function JS(t,e){return e=ry({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function I0(t,e,n,s){return s!==null&&LS(s),Yh(e,t.child,null,n),t=JS(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function vz(t,e,n,s,r,i,o){if(n)return e.flags&256?(e.flags&=-257,s=Hx(Error(xe(422))),I0(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=ry({mode:"visible",children:s.children},r,0,null),i=Vc(i,r,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&Yh(e,t.child,null,o),e.child.memoizedState=$b(o),e.memoizedState=_b,i);if(!(e.mode&1))return I0(t,e,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,i=Error(xe(419)),s=Hx(i,s,void 0),I0(t,e,o,s)}if(a=(o&t.childLanes)!==0,dr||a){if(s=Jn,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,fa(t,r),Li(s,t,r,-1))}return sI(),s=Hx(Error(xe(421))),I0(t,e,o,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=Rz.bind(null,t),r._reactRetry=e,null):(t=i.treeContext,Fr=ul(r.nextSibling),Br=e,Yt=!0,Ai=null,t!==null&&(ii[oi++]=Qo,ii[oi++]=ea,ii[oi++]=Jc,Qo=t.id,ea=t.overflow,Jc=e),e=JS(e,s.children),e.flags|=4096,e)}function p4(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),Sb(t.return,e,n)}function Kx(t,e,n,s,r){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=r)}function DD(t,e,n){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(Gs(t,e,s.children,n),s=Qt.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&p4(t,n,e);else if(t.tag===19)p4(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(Lt(Qt,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&B1(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Kx(e,!1,r,n,i);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&B1(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Kx(e,!0,n,null,i);break;case"together":Kx(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function r1(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function pa(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Qc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(xe(153));if(e.child!==null){for(t=e.child,n=pl(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=pl(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function xz(t,e,n){switch(e.tag){case 3:RD(e),Xh();break;case 5:iD(e);break;case 1:yr(e.type)&&D1(e);break;case 4:WS(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;Lt(F1,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Lt(Qt,Qt.current&1),e.flags|=128,null):n&e.child.childLanes?AD(t,e,n):(Lt(Qt,Qt.current&1),t=pa(t,e,n),t!==null?t.sibling:null);Lt(Qt,Qt.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return DD(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Lt(Qt,Qt.current),s)break;return null;case 22:case 23:return e.lanes=0,_D(t,e,n)}return pa(t,e,n)}var PD,Rb,OD,FD;PD=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Rb=function(){};OD=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,Dc(go.current);var i=null;switch(n){case"input":r=Qw(t,r),s=Qw(t,s),i=[];break;case"select":r=sn({},r,{value:void 0}),s=sn({},s,{value:void 0}),i=[];break;case"textarea":r=nb(t,r),s=nb(t,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=R1)}rb(n,s);var o;n=null;for(c in r)if(!s.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(dp.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in s){var l=s[c];if(a=r!=null?r[c]:void 0,s.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(dp.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&jt("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};FD=function(t,e,n,s){n!==s&&(e.flags|=4)};function wf(t,e){if(!Yt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function bs(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function wz(t,e,n){var s=e.pendingProps;switch(FS(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bs(e),null;case 1:return yr(e.type)&&A1(),bs(e),null;case 3:return s=e.stateNode,Jh(),Ht(gr),Ht(Ps),GS(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(C0(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ai!==null&&(Bb(Ai),Ai=null))),Rb(t,e),bs(e),null;case 5:jS(e);var r=Dc(Ip.current);if(n=e.type,t!==null&&e.stateNode!=null)OD(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(xe(166));return bs(e),null}if(t=Dc(go.current),C0(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[ho]=e,s[Cp]=i,t=(e.mode&1)!==0,n){case"dialog":jt("cancel",s),jt("close",s);break;case"iframe":case"object":case"embed":jt("load",s);break;case"video":case"audio":for(r=0;r<Pf.length;r++)jt(Pf[r],s);break;case"source":jt("error",s);break;case"img":case"image":case"link":jt("error",s),jt("load",s);break;case"details":jt("toggle",s);break;case"input":SE(s,i),jt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},jt("invalid",s);break;case"textarea":kE(s,i),jt("invalid",s)}rb(n,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?s.textContent!==a&&(i.suppressHydrationWarning!==!0&&b0(s.textContent,a,t),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&b0(s.textContent,a,t),r=["children",""+a]):dp.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&jt("scroll",s)}switch(n){case"input":f0(s),IE(s,i,!0);break;case"textarea":f0(s),TE(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=R1)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=uA(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(n,{is:s.is}):(t=o.createElement(n),n==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,n),t[ho]=e,t[Cp]=s,PD(t,e,!1,!1),e.stateNode=t;e:{switch(o=ib(n,s),n){case"dialog":jt("cancel",t),jt("close",t),r=s;break;case"iframe":case"object":case"embed":jt("load",t),r=s;break;case"video":case"audio":for(r=0;r<Pf.length;r++)jt(Pf[r],t);r=s;break;case"source":jt("error",t),r=s;break;case"img":case"image":case"link":jt("error",t),jt("load",t),r=s;break;case"details":jt("toggle",t),r=s;break;case"input":SE(t,s),r=Qw(t,s),jt("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=sn({},s,{value:void 0}),jt("invalid",t);break;case"textarea":kE(t,s),r=nb(t,s),jt("invalid",t);break;default:r=s}rb(n,r),a=r;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?fA(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&hA(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&fp(t,l):typeof l=="number"&&fp(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(dp.hasOwnProperty(i)?l!=null&&i==="onScroll"&&jt("scroll",t):l!=null&&bS(t,i,l,o))}switch(n){case"input":f0(t),IE(t,s,!1);break;case"textarea":f0(t),TE(t);break;case"option":s.value!=null&&t.setAttribute("value",""+Tl(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?Ah(t,!!s.multiple,i,!1):s.defaultValue!=null&&Ah(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=R1)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return bs(e),null;case 6:if(t&&e.stateNode!=null)FD(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(xe(166));if(n=Dc(Ip.current),Dc(go.current),C0(e)){if(s=e.stateNode,n=e.memoizedProps,s[ho]=e,(i=s.nodeValue!==n)&&(t=Br,t!==null))switch(t.tag){case 3:b0(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&b0(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[ho]=e,e.stateNode=s}return bs(e),null;case 13:if(Ht(Qt),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Yt&&Fr!==null&&e.mode&1&&!(e.flags&128))eD(),Xh(),e.flags|=98560,i=!1;else if(i=C0(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(xe(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(xe(317));i[ho]=e}else Xh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;bs(e),i=!1}else Ai!==null&&(Bb(Ai),Ai=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||Qt.current&1?Vn===0&&(Vn=3):sI())),e.updateQueue!==null&&(e.flags|=4),bs(e),null);case 4:return Jh(),Rb(t,e),t===null&&wp(e.stateNode.containerInfo),bs(e),null;case 10:return VS(e.type._context),bs(e),null;case 17:return yr(e.type)&&A1(),bs(e),null;case 19:if(Ht(Qt),i=e.memoizedState,i===null)return bs(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)wf(i,!1);else{if(Vn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=B1(t),o!==null){for(e.flags|=128,wf(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Lt(Qt,Qt.current&1|2),e.child}t=t.sibling}i.tail!==null&&gn()>Qh&&(e.flags|=128,s=!0,wf(i,!1),e.lanes=4194304)}else{if(!s)if(t=B1(o),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),wf(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Yt)return bs(e),null}else 2*gn()-i.renderingStartTime>Qh&&n!==1073741824&&(e.flags|=128,s=!0,wf(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=gn(),e.sibling=null,n=Qt.current,Lt(Qt,s?n&1|2:n&1),e):(bs(e),null);case 22:case 23:return nI(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Pr&1073741824&&(bs(e),e.subtreeFlags&6&&(e.flags|=8192)):bs(e),null;case 24:return null;case 25:return null}throw Error(xe(156,e.tag))}function bz(t,e){switch(FS(e),e.tag){case 1:return yr(e.type)&&A1(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Jh(),Ht(gr),Ht(Ps),GS(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return jS(e),null;case 13:if(Ht(Qt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(xe(340));Xh()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ht(Qt),null;case 4:return Jh(),null;case 10:return VS(e.type._context),null;case 22:case 23:return nI(),null;case 24:return null;default:return null}}var k0=!1,Ts=!1,Cz=typeof WeakSet=="function"?WeakSet:Set,$e=null;function Sh(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){on(t,e,s)}else n.current=null}function Ab(t,e,n){try{n()}catch(s){on(t,e,s)}}var m4=!1;function Sz(t,e){if(mb=N1,t=UA(),PS(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,h=t,d=null;t:for(;;){for(var f;h!==n||r!==0&&h.nodeType!==3||(a=o+r),h!==i||s!==0&&h.nodeType!==3||(l=o+s),h.nodeType===3&&(o+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===t)break t;if(d===n&&++c===r&&(a=o),d===i&&++u===s&&(l=o),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(gb={focusedElem:t,selectionRange:n},N1=!1,$e=e;$e!==null;)if(e=$e,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,$e=t;else for(;$e!==null;){e=$e;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,m=p.memoizedState,y=e.stateNode,w=y.getSnapshotBeforeUpdate(e.elementType===e.type?g:$i(e.type,g),m);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(xe(163))}}catch(C){on(e,e.return,C)}if(t=e.sibling,t!==null){t.return=e.return,$e=t;break}$e=e.return}return p=m4,m4=!1,p}function ep(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var i=r.destroy;r.destroy=void 0,i!==void 0&&Ab(e,n,i)}r=r.next}while(r!==s)}}function ny(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function Db(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function LD(t){var e=t.alternate;e!==null&&(t.alternate=null,LD(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ho],delete e[Cp],delete e[xb],delete e[iz],delete e[oz])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function MD(t){return t.tag===5||t.tag===3||t.tag===4}function g4(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||MD(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Pb(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=R1));else if(s!==4&&(t=t.child,t!==null))for(Pb(t,e,n),t=t.sibling;t!==null;)Pb(t,e,n),t=t.sibling}function Ob(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(Ob(t,e,n),t=t.sibling;t!==null;)Ob(t,e,n),t=t.sibling}var ls=null,Ri=!1;function Ba(t,e,n){for(n=n.child;n!==null;)BD(t,e,n),n=n.sibling}function BD(t,e,n){if(mo&&typeof mo.onCommitFiberUnmount=="function")try{mo.onCommitFiberUnmount(q2,n)}catch{}switch(n.tag){case 5:Ts||Sh(n,e);case 6:var s=ls,r=Ri;ls=null,Ba(t,e,n),ls=s,Ri=r,ls!==null&&(Ri?(t=ls,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ls.removeChild(n.stateNode));break;case 18:ls!==null&&(Ri?(t=ls,n=n.stateNode,t.nodeType===8?Vx(t.parentNode,n):t.nodeType===1&&Vx(t,n),yp(t)):Vx(ls,n.stateNode));break;case 4:s=ls,r=Ri,ls=n.stateNode.containerInfo,Ri=!0,Ba(t,e,n),ls=s,Ri=r;break;case 0:case 11:case 14:case 15:if(!Ts&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Ab(n,e,o),r=r.next}while(r!==s)}Ba(t,e,n);break;case 1:if(!Ts&&(Sh(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){on(n,e,a)}Ba(t,e,n);break;case 21:Ba(t,e,n);break;case 22:n.mode&1?(Ts=(s=Ts)||n.memoizedState!==null,Ba(t,e,n),Ts=s):Ba(t,e,n);break;default:Ba(t,e,n)}}function y4(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Cz),e.forEach(function(s){var r=Az.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function Ei(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:ls=a.stateNode,Ri=!1;break e;case 3:ls=a.stateNode.containerInfo,Ri=!0;break e;case 4:ls=a.stateNode.containerInfo,Ri=!0;break e}a=a.return}if(ls===null)throw Error(xe(160));BD(i,o,r),ls=null,Ri=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){on(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)VD(e,t),e=e.sibling}function VD(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ei(e,t),so(t),s&4){try{ep(3,t,t.return),ny(3,t)}catch(g){on(t,t.return,g)}try{ep(5,t,t.return)}catch(g){on(t,t.return,g)}}break;case 1:Ei(e,t),so(t),s&512&&n!==null&&Sh(n,n.return);break;case 5:if(Ei(e,t),so(t),s&512&&n!==null&&Sh(n,n.return),t.flags&32){var r=t.stateNode;try{fp(r,"")}catch(g){on(t,t.return,g)}}if(s&4&&(r=t.stateNode,r!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&lA(r,i),ib(a,o);var c=ib(a,i);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?fA(r,h):u==="dangerouslySetInnerHTML"?hA(r,h):u==="children"?fp(r,h):bS(r,u,h,c)}switch(a){case"input":eb(r,i);break;case"textarea":cA(r,i);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Ah(r,!!i.multiple,f,!1):d!==!!i.multiple&&(i.defaultValue!=null?Ah(r,!!i.multiple,i.defaultValue,!0):Ah(r,!!i.multiple,i.multiple?[]:"",!1))}r[Cp]=i}catch(g){on(t,t.return,g)}}break;case 6:if(Ei(e,t),so(t),s&4){if(t.stateNode===null)throw Error(xe(162));r=t.stateNode,i=t.memoizedProps;try{r.nodeValue=i}catch(g){on(t,t.return,g)}}break;case 3:if(Ei(e,t),so(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{yp(e.containerInfo)}catch(g){on(t,t.return,g)}break;case 4:Ei(e,t),so(t);break;case 13:Ei(e,t),so(t),r=t.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(eI=gn())),s&4&&y4(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Ts=(c=Ts)||u,Ei(e,t),Ts=c):Ei(e,t),so(t),s&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for($e=t,u=t.child;u!==null;){for(h=$e=u;$e!==null;){switch(d=$e,f=d.child,d.tag){case 0:case 11:case 14:case 15:ep(4,d,d.return);break;case 1:Sh(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){s=d,n=d.return;try{e=s,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(g){on(s,n,g)}}break;case 5:Sh(d,d.return);break;case 22:if(d.memoizedState!==null){x4(h);continue}}f!==null?(f.return=d,$e=f):x4(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{r=h.stateNode,c?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=dA("display",o))}catch(g){on(t,t.return,g)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){on(t,t.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ei(e,t),so(t),s&4&&y4(t);break;case 21:break;default:Ei(e,t),so(t)}}function so(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(MD(n)){var s=n;break e}n=n.return}throw Error(xe(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(fp(r,""),s.flags&=-33);var i=g4(t);Ob(t,i,r);break;case 3:case 4:var o=s.stateNode.containerInfo,a=g4(t);Pb(t,a,o);break;default:throw Error(xe(161))}}catch(l){on(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Iz(t,e,n){$e=t,UD(t)}function UD(t,e,n){for(var s=(t.mode&1)!==0;$e!==null;){var r=$e,i=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||k0;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Ts;a=k0;var c=Ts;if(k0=o,(Ts=l)&&!c)for($e=r;$e!==null;)o=$e,l=o.child,o.tag===22&&o.memoizedState!==null?w4(r):l!==null?(l.return=o,$e=l):w4(r);for(;i!==null;)$e=i,UD(i),i=i.sibling;$e=r,k0=a,Ts=c}v4(t)}else r.subtreeFlags&8772&&i!==null?(i.return=r,$e=i):v4(t)}}function v4(t){for(;$e!==null;){var e=$e;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ts||ny(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Ts)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:$i(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&n4(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}n4(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&yp(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(xe(163))}Ts||e.flags&512&&Db(e)}catch(d){on(e,e.return,d)}}if(e===t){$e=null;break}if(n=e.sibling,n!==null){n.return=e.return,$e=n;break}$e=e.return}}function x4(t){for(;$e!==null;){var e=$e;if(e===t){$e=null;break}var n=e.sibling;if(n!==null){n.return=e.return,$e=n;break}$e=e.return}}function w4(t){for(;$e!==null;){var e=$e;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ny(4,e)}catch(l){on(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(l){on(e,r,l)}}var i=e.return;try{Db(e)}catch(l){on(e,i,l)}break;case 5:var o=e.return;try{Db(e)}catch(l){on(e,o,l)}}}catch(l){on(e,e.return,l)}if(e===t){$e=null;break}var a=e.sibling;if(a!==null){a.return=e.return,$e=a;break}$e=e.return}}var kz=Math.ceil,z1=ba.ReactCurrentDispatcher,ZS=ba.ReactCurrentOwner,pi=ba.ReactCurrentBatchConfig,ft=0,Jn=null,Tn=null,us=0,Pr=0,Ih=Ml(0),Vn=0,Np=null,Qc=0,sy=0,QS=0,tp=null,ur=null,eI=0,Qh=1/0,Ko=null,W1=!1,Fb=null,dl=null,T0=!1,tl=null,j1=0,np=0,Lb=null,i1=-1,o1=0;function Ys(){return ft&6?gn():i1!==-1?i1:i1=gn()}function fl(t){return t.mode&1?ft&2&&us!==0?us&-us:lz.transition!==null?(o1===0&&(o1=kA()),o1):(t=Nt,t!==0||(t=window.event,t=t===void 0?16:AA(t.type)),t):1}function Li(t,e,n,s){if(50<np)throw np=0,Lb=null,Error(xe(185));nm(t,n,s),(!(ft&2)||t!==Jn)&&(t===Jn&&(!(ft&2)&&(sy|=n),Vn===4&&qa(t,us)),vr(t,s),n===1&&ft===0&&!(e.mode&1)&&(Qh=gn()+500,Q2&&Bl()))}function vr(t,e){var n=t.callbackNode;lU(t,e);var s=E1(t,t===Jn?us:0);if(s===0)n!==null&&_E(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&_E(n),e===1)t.tag===0?az(b4.bind(null,t)):JA(b4.bind(null,t)),sz(function(){!(ft&6)&&Bl()}),n=null;else{switch(TA(s)){case 1:n=TS;break;case 4:n=SA;break;case 16:n=T1;break;case 536870912:n=IA;break;default:n=T1}n=XD(n,zD.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function zD(t,e){if(i1=-1,o1=0,ft&6)throw Error(xe(327));var n=t.callbackNode;if(Lh()&&t.callbackNode!==n)return null;var s=E1(t,t===Jn?us:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=G1(t,s);else{e=s;var r=ft;ft|=2;var i=jD();(Jn!==t||us!==e)&&(Ko=null,Qh=gn()+500,Bc(t,e));do try{Nz();break}catch(a){WD(t,a)}while(!0);BS(),z1.current=i,ft=r,Tn!==null?e=0:(Jn=null,us=0,e=Vn)}if(e!==0){if(e===2&&(r=ub(t),r!==0&&(s=r,e=Mb(t,r))),e===1)throw n=Np,Bc(t,0),qa(t,s),vr(t,gn()),n;if(e===6)qa(t,s);else{if(r=t.current.alternate,!(s&30)&&!Tz(r)&&(e=G1(t,s),e===2&&(i=ub(t),i!==0&&(s=i,e=Mb(t,i))),e===1))throw n=Np,Bc(t,0),qa(t,s),vr(t,gn()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(xe(345));case 2:Cc(t,ur,Ko);break;case 3:if(qa(t,s),(s&130023424)===s&&(e=eI+500-gn(),10<e)){if(E1(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){Ys(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=vb(Cc.bind(null,t,ur,Ko),e);break}Cc(t,ur,Ko);break;case 4:if(qa(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var o=31-Fi(s);i=1<<o,o=e[o],o>r&&(r=o),s&=~i}if(s=r,s=gn()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*kz(s/1960))-s,10<s){t.timeoutHandle=vb(Cc.bind(null,t,ur,Ko),s);break}Cc(t,ur,Ko);break;case 5:Cc(t,ur,Ko);break;default:throw Error(xe(329))}}}return vr(t,gn()),t.callbackNode===n?zD.bind(null,t):null}function Mb(t,e){var n=tp;return t.current.memoizedState.isDehydrated&&(Bc(t,e).flags|=256),t=G1(t,e),t!==2&&(e=ur,ur=n,e!==null&&Bb(e)),t}function Bb(t){ur===null?ur=t:ur.push.apply(ur,t)}function Tz(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],i=r.getSnapshot;r=r.value;try{if(!zi(i(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function qa(t,e){for(e&=~QS,e&=~sy,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Fi(e),s=1<<n;t[n]=-1,e&=~s}}function b4(t){if(ft&6)throw Error(xe(327));Lh();var e=E1(t,0);if(!(e&1))return vr(t,gn()),null;var n=G1(t,e);if(t.tag!==0&&n===2){var s=ub(t);s!==0&&(e=s,n=Mb(t,s))}if(n===1)throw n=Np,Bc(t,0),qa(t,e),vr(t,gn()),n;if(n===6)throw Error(xe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Cc(t,ur,Ko),vr(t,gn()),null}function tI(t,e){var n=ft;ft|=1;try{return t(e)}finally{ft=n,ft===0&&(Qh=gn()+500,Q2&&Bl())}}function eu(t){tl!==null&&tl.tag===0&&!(ft&6)&&Lh();var e=ft;ft|=1;var n=pi.transition,s=Nt;try{if(pi.transition=null,Nt=1,t)return t()}finally{Nt=s,pi.transition=n,ft=e,!(ft&6)&&Bl()}}function nI(){Pr=Ih.current,Ht(Ih)}function Bc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,nz(n)),Tn!==null)for(n=Tn.return;n!==null;){var s=n;switch(FS(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&A1();break;case 3:Jh(),Ht(gr),Ht(Ps),GS();break;case 5:jS(s);break;case 4:Jh();break;case 13:Ht(Qt);break;case 19:Ht(Qt);break;case 10:VS(s.type._context);break;case 22:case 23:nI()}n=n.return}if(Jn=t,Tn=t=pl(t.current,null),us=Pr=e,Vn=0,Np=null,QS=sy=Qc=0,ur=tp=null,Ac!==null){for(e=0;e<Ac.length;e++)if(n=Ac[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,i=n.pending;if(i!==null){var o=i.next;i.next=r,s.next=o}n.pending=s}Ac=null}return t}function WD(t,e){do{var n=Tn;try{if(BS(),n1.current=U1,V1){for(var s=tn.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}V1=!1}if(Zc=0,qn=Ln=tn=null,Qf=!1,kp=0,ZS.current=null,n===null||n.return===null){Vn=1,Np=e,Tn=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=us,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=l4(o);if(f!==null){f.flags&=-257,c4(f,o,a,i,e),f.mode&1&&a4(i,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var g=new Set;g.add(l),e.updateQueue=g}else p.add(l);break e}else{if(!(e&1)){a4(i,c,e),sI();break e}l=Error(xe(426))}}else if(Yt&&a.mode&1){var m=l4(o);if(m!==null){!(m.flags&65536)&&(m.flags|=256),c4(m,o,a,i,e),LS(Zh(l,a));break e}}i=l=Zh(l,a),Vn!==4&&(Vn=2),tp===null?tp=[i]:tp.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var y=TD(i,l,e);t4(i,y);break e;case 1:a=l;var w=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(dl===null||!dl.has(b)))){i.flags|=65536,e&=-e,i.lanes|=e;var C=ED(i,a,e);t4(i,C);break e}}i=i.return}while(i!==null)}HD(n)}catch(k){e=k,Tn===n&&n!==null&&(Tn=n=n.return);continue}break}while(!0)}function jD(){var t=z1.current;return z1.current=U1,t===null?U1:t}function sI(){(Vn===0||Vn===3||Vn===2)&&(Vn=4),Jn===null||!(Qc&268435455)&&!(sy&268435455)||qa(Jn,us)}function G1(t,e){var n=ft;ft|=2;var s=jD();(Jn!==t||us!==e)&&(Ko=null,Bc(t,e));do try{Ez();break}catch(r){WD(t,r)}while(!0);if(BS(),ft=n,z1.current=s,Tn!==null)throw Error(xe(261));return Jn=null,us=0,Vn}function Ez(){for(;Tn!==null;)GD(Tn)}function Nz(){for(;Tn!==null&&!QV();)GD(Tn)}function GD(t){var e=qD(t.alternate,t,Pr);t.memoizedProps=t.pendingProps,e===null?HD(t):Tn=e,ZS.current=null}function HD(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=bz(n,e),n!==null){n.flags&=32767,Tn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Vn=6,Tn=null;return}}else if(n=wz(n,e,Pr),n!==null){Tn=n;return}if(e=e.sibling,e!==null){Tn=e;return}Tn=e=t}while(e!==null);Vn===0&&(Vn=5)}function Cc(t,e,n){var s=Nt,r=pi.transition;try{pi.transition=null,Nt=1,_z(t,e,n,s)}finally{pi.transition=r,Nt=s}return null}function _z(t,e,n,s){do Lh();while(tl!==null);if(ft&6)throw Error(xe(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(xe(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(cU(t,i),t===Jn&&(Tn=Jn=null,us=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||T0||(T0=!0,XD(T1,function(){return Lh(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=pi.transition,pi.transition=null;var o=Nt;Nt=1;var a=ft;ft|=4,ZS.current=null,Sz(t,n),VD(n,t),XU(gb),N1=!!mb,gb=mb=null,t.current=n,Iz(n),eU(),ft=a,Nt=o,pi.transition=i}else t.current=n;if(T0&&(T0=!1,tl=t,j1=r),i=t.pendingLanes,i===0&&(dl=null),sU(n.stateNode),vr(t,gn()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(W1)throw W1=!1,t=Fb,Fb=null,t;return j1&1&&t.tag!==0&&Lh(),i=t.pendingLanes,i&1?t===Lb?np++:(np=0,Lb=t):np=0,Bl(),null}function Lh(){if(tl!==null){var t=TA(j1),e=pi.transition,n=Nt;try{if(pi.transition=null,Nt=16>t?16:t,tl===null)var s=!1;else{if(t=tl,tl=null,j1=0,ft&6)throw Error(xe(331));var r=ft;for(ft|=4,$e=t.current;$e!==null;){var i=$e,o=i.child;if($e.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for($e=c;$e!==null;){var u=$e;switch(u.tag){case 0:case 11:case 15:ep(8,u,i)}var h=u.child;if(h!==null)h.return=u,$e=h;else for(;$e!==null;){u=$e;var d=u.sibling,f=u.return;if(LD(u),u===c){$e=null;break}if(d!==null){d.return=f,$e=d;break}$e=f}}}var p=i.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(g!==null)}}$e=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,$e=o;else e:for(;$e!==null;){if(i=$e,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ep(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,$e=y;break e}$e=i.return}}var w=t.current;for($e=w;$e!==null;){o=$e;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,$e=b;else e:for(o=w;$e!==null;){if(a=$e,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:ny(9,a)}}catch(k){on(a,a.return,k)}if(a===o){$e=null;break e}var C=a.sibling;if(C!==null){C.return=a.return,$e=C;break e}$e=a.return}}if(ft=r,Bl(),mo&&typeof mo.onPostCommitFiberRoot=="function")try{mo.onPostCommitFiberRoot(q2,t)}catch{}s=!0}return s}finally{Nt=n,pi.transition=e}}return!1}function C4(t,e,n){e=Zh(n,e),e=TD(t,e,1),t=hl(t,e,1),e=Ys(),t!==null&&(nm(t,1,e),vr(t,e))}function on(t,e,n){if(t.tag===3)C4(t,t,n);else for(;e!==null;){if(e.tag===3){C4(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(dl===null||!dl.has(s))){t=Zh(n,t),t=ED(e,t,1),e=hl(e,t,1),t=Ys(),e!==null&&(nm(e,1,t),vr(e,t));break}}e=e.return}}function $z(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=Ys(),t.pingedLanes|=t.suspendedLanes&n,Jn===t&&(us&n)===n&&(Vn===4||Vn===3&&(us&130023424)===us&&500>gn()-eI?Bc(t,0):QS|=n),vr(t,e)}function KD(t,e){e===0&&(t.mode&1?(e=g0,g0<<=1,!(g0&130023424)&&(g0=4194304)):e=1);var n=Ys();t=fa(t,e),t!==null&&(nm(t,e,n),vr(t,n))}function Rz(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),KD(t,n)}function Az(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(xe(314))}s!==null&&s.delete(e),KD(t,n)}var qD;qD=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||gr.current)dr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return dr=!1,xz(t,e,n);dr=!!(t.flags&131072)}else dr=!1,Yt&&e.flags&1048576&&ZA(e,O1,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;r1(t,e),t=e.pendingProps;var r=qh(e,Ps.current);Fh(e,n),r=KS(null,e,s,t,r,n);var i=qS();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,yr(s)?(i=!0,D1(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,zS(e),r.updater=ty,e.stateNode=r,r._reactInternals=e,kb(e,s,t,n),e=Nb(null,e,s,!0,i,n)):(e.tag=0,Yt&&i&&OS(e),Gs(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(r1(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=Pz(s),t=$i(s,t),r){case 0:e=Eb(null,e,s,t,n);break e;case 1:e=d4(null,e,s,t,n);break e;case 11:e=u4(null,e,s,t,n);break e;case 14:e=h4(null,e,s,$i(s.type,t),n);break e}throw Error(xe(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:$i(s,r),Eb(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:$i(s,r),d4(t,e,s,r,n);case 3:e:{if(RD(e),t===null)throw Error(xe(387));s=e.pendingProps,i=e.memoizedState,r=i.element,rD(t,e),M1(e,s,null,n);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=Zh(Error(xe(423)),e),e=f4(t,e,s,n,r);break e}else if(s!==r){r=Zh(Error(xe(424)),e),e=f4(t,e,s,n,r);break e}else for(Fr=ul(e.stateNode.containerInfo.firstChild),Br=e,Yt=!0,Ai=null,n=nD(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Xh(),s===r){e=pa(t,e,n);break e}Gs(t,e,s,n)}e=e.child}return e;case 5:return iD(e),t===null&&Cb(e),s=e.type,r=e.pendingProps,i=t!==null?t.memoizedProps:null,o=r.children,yb(s,r)?o=null:i!==null&&yb(s,i)&&(e.flags|=32),$D(t,e),Gs(t,e,o,n),e.child;case 6:return t===null&&Cb(e),null;case 13:return AD(t,e,n);case 4:return WS(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=Yh(e,null,s,n):Gs(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:$i(s,r),u4(t,e,s,r,n);case 7:return Gs(t,e,e.pendingProps,n),e.child;case 8:return Gs(t,e,e.pendingProps.children,n),e.child;case 12:return Gs(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,o=r.value,Lt(F1,s._currentValue),s._currentValue=o,i!==null)if(zi(i.value,o)){if(i.children===r.children&&!gr.current){e=pa(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(i.tag===1){l=aa(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Sb(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(xe(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Sb(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Gs(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,Fh(e,n),r=mi(r),s=s(r),e.flags|=1,Gs(t,e,s,n),e.child;case 14:return s=e.type,r=$i(s,e.pendingProps),r=$i(s.type,r),h4(t,e,s,r,n);case 15:return ND(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:$i(s,r),r1(t,e),e.tag=1,yr(s)?(t=!0,D1(e)):t=!1,Fh(e,n),kD(e,s,r),kb(e,s,r,n),Nb(null,e,s,!0,t,n);case 19:return DD(t,e,n);case 22:return _D(t,e,n)}throw Error(xe(156,e.tag))};function XD(t,e){return CA(t,e)}function Dz(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function li(t,e,n,s){return new Dz(t,e,n,s)}function rI(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Pz(t){if(typeof t=="function")return rI(t)?1:0;if(t!=null){if(t=t.$$typeof,t===SS)return 11;if(t===IS)return 14}return 2}function pl(t,e){var n=t.alternate;return n===null?(n=li(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function a1(t,e,n,s,r,i){var o=2;if(s=t,typeof t=="function")rI(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ph:return Vc(n.children,r,i,e);case CS:o=8,r|=8;break;case Xw:return t=li(12,n,e,r|2),t.elementType=Xw,t.lanes=i,t;case Yw:return t=li(13,n,e,r),t.elementType=Yw,t.lanes=i,t;case Jw:return t=li(19,n,e,r),t.elementType=Jw,t.lanes=i,t;case iA:return ry(n,r,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case sA:o=10;break e;case rA:o=9;break e;case SS:o=11;break e;case IS:o=14;break e;case Wa:o=16,s=null;break e}throw Error(xe(130,t==null?t:typeof t,""))}return e=li(o,n,e,r),e.elementType=t,e.type=s,e.lanes=i,e}function Vc(t,e,n,s){return t=li(7,t,s,e),t.lanes=n,t}function ry(t,e,n,s){return t=li(22,t,s,e),t.elementType=iA,t.lanes=n,t.stateNode={isHidden:!1},t}function qx(t,e,n){return t=li(6,t,null,e),t.lanes=n,t}function Xx(t,e,n){return e=li(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Oz(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_x(0),this.expirationTimes=_x(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_x(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function iI(t,e,n,s,r,i,o,a,l){return t=new Oz(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=li(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},zS(i),t}function Fz(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fh,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function YD(t){if(!t)return El;t=t._reactInternals;e:{if(bu(t)!==t||t.tag!==1)throw Error(xe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(yr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(xe(171))}if(t.tag===1){var n=t.type;if(yr(n))return YA(t,n,e)}return e}function JD(t,e,n,s,r,i,o,a,l){return t=iI(n,s,!0,t,r,i,o,a,l),t.context=YD(null),n=t.current,s=Ys(),r=fl(n),i=aa(s,r),i.callback=e??null,hl(n,i,r),t.current.lanes=r,nm(t,r,s),vr(t,s),t}function iy(t,e,n,s){var r=e.current,i=Ys(),o=fl(r);return n=YD(n),e.context===null?e.context=n:e.pendingContext=n,e=aa(i,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=hl(r,e,o),t!==null&&(Li(t,r,o,i),t1(t,r,o)),o}function H1(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function S4(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function oI(t,e){S4(t,e),(t=t.alternate)&&S4(t,e)}function Lz(){return null}var ZD=typeof reportError=="function"?reportError:function(t){console.error(t)};function aI(t){this._internalRoot=t}oy.prototype.render=aI.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(xe(409));iy(t,e,null,null)};oy.prototype.unmount=aI.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;eu(function(){iy(null,t,null,null)}),e[da]=null}};function oy(t){this._internalRoot=t}oy.prototype.unstable_scheduleHydration=function(t){if(t){var e=_A();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ka.length&&e!==0&&e<Ka[n].priority;n++);Ka.splice(n,0,t),n===0&&RA(t)}};function lI(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ay(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function I4(){}function Mz(t,e,n,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var c=H1(o);i.call(c)}}var o=JD(e,s,t,0,null,!1,!1,"",I4);return t._reactRootContainer=o,t[da]=o.current,wp(t.nodeType===8?t.parentNode:t),eu(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var c=H1(l);a.call(c)}}var l=iI(t,0,!1,null,null,!1,!1,"",I4);return t._reactRootContainer=l,t[da]=l.current,wp(t.nodeType===8?t.parentNode:t),eu(function(){iy(e,l,n,s)}),l}function ly(t,e,n,s,r){var i=n._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var a=r;r=function(){var l=H1(o);a.call(l)}}iy(e,o,t,r)}else o=Mz(n,e,t,r,s);return H1(o)}EA=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Df(e.pendingLanes);n!==0&&(ES(e,n|1),vr(e,gn()),!(ft&6)&&(Qh=gn()+500,Bl()))}break;case 13:eu(function(){var s=fa(t,1);if(s!==null){var r=Ys();Li(s,t,1,r)}}),oI(t,1)}};NS=function(t){if(t.tag===13){var e=fa(t,134217728);if(e!==null){var n=Ys();Li(e,t,134217728,n)}oI(t,134217728)}};NA=function(t){if(t.tag===13){var e=fl(t),n=fa(t,e);if(n!==null){var s=Ys();Li(n,t,e,s)}oI(t,e)}};_A=function(){return Nt};$A=function(t,e){var n=Nt;try{return Nt=t,e()}finally{Nt=n}};ab=function(t,e,n){switch(e){case"input":if(eb(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=Z2(s);if(!r)throw Error(xe(90));aA(s),eb(s,r)}}}break;case"textarea":cA(t,n);break;case"select":e=n.value,e!=null&&Ah(t,!!n.multiple,e,!1)}};gA=tI;yA=eu;var Bz={usingClientEntryPoint:!1,Events:[rm,vh,Z2,pA,mA,tI]},bf={findFiberByHostInstance:Rc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Vz={bundleType:bf.bundleType,version:bf.version,rendererPackageName:bf.rendererPackageName,rendererConfig:bf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ba.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=wA(t),t===null?null:t.stateNode},findFiberByHostInstance:bf.findFiberByHostInstance||Lz,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var E0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!E0.isDisabled&&E0.supportsFiber)try{q2=E0.inject(Vz),mo=E0}catch{}}jr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Bz;jr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lI(e))throw Error(xe(200));return Fz(t,e,null,n)};jr.createRoot=function(t,e){if(!lI(t))throw Error(xe(299));var n=!1,s="",r=ZD;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=iI(t,1,!1,null,null,n,!1,s,r),t[da]=e.current,wp(t.nodeType===8?t.parentNode:t),new aI(e)};jr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(xe(188)):(t=Object.keys(t).join(","),Error(xe(268,t)));return t=wA(e),t=t===null?null:t.stateNode,t};jr.flushSync=function(t){return eu(t)};jr.hydrate=function(t,e,n){if(!ay(e))throw Error(xe(200));return ly(null,t,e,!0,n)};jr.hydrateRoot=function(t,e,n){if(!lI(t))throw Error(xe(405));var s=n!=null&&n.hydratedSources||null,r=!1,i="",o=ZD;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=JD(e,null,t,1,n??null,r,!1,i,o),t[da]=e.current,wp(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new oy(e)};jr.render=function(t,e,n){if(!ay(e))throw Error(xe(200));return ly(null,t,e,!1,n)};jr.unmountComponentAtNode=function(t){if(!ay(t))throw Error(xe(40));return t._reactRootContainer?(eu(function(){ly(null,null,t,!1,function(){t._reactRootContainer=null,t[da]=null})}),!0):!1};jr.unstable_batchedUpdates=tI;jr.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!ay(n))throw Error(xe(200));if(t==null||t._reactInternals===void 0)throw Error(xe(38));return ly(t,e,n,!1,s)};jr.version="18.3.1-next-f1338f8080-20240426";function QD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(QD)}catch(t){console.error(t)}}QD(),QR.exports=jr;var Uz=QR.exports,k4=Uz;Kw.createRoot=k4.createRoot,Kw.hydrateRoot=k4.hydrateRoot;/**
 * @remix-run/router v1.16.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _p(){return _p=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},_p.apply(this,arguments)}var nl;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(nl||(nl={}));const T4="popstate";function zz(t){t===void 0&&(t={});function e(s,r){let{pathname:i,search:o,hash:a}=s.location;return Vb("",{pathname:i,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:K1(r)}return jz(e,n,null,t)}function nn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function eP(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Wz(){return Math.random().toString(36).substr(2,8)}function E4(t,e){return{usr:t.state,key:t.key,idx:e}}function Vb(t,e,n,s){return n===void 0&&(n=null),_p({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?kd(e):e,{state:n,key:e&&e.key||s||Wz()})}function K1(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function kd(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function jz(t,e,n,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:i=!1}=s,o=r.history,a=nl.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(_p({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function h(){a=nl.Pop;let m=u(),y=m==null?null:m-c;c=m,l&&l({action:a,location:g.location,delta:y})}function d(m,y){a=nl.Push;let w=Vb(g.location,m,y);c=u()+1;let b=E4(w,c),C=g.createHref(w);try{o.pushState(b,"",C)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;r.location.assign(C)}i&&l&&l({action:a,location:g.location,delta:1})}function f(m,y){a=nl.Replace;let w=Vb(g.location,m,y);c=u();let b=E4(w,c),C=g.createHref(w);o.replaceState(b,"",C),i&&l&&l({action:a,location:g.location,delta:0})}function p(m){let y=r.location.origin!=="null"?r.location.origin:r.location.href,w=typeof m=="string"?m:K1(m);return w=w.replace(/ $/,"%20"),nn(y,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,y)}let g={get action(){return a},get location(){return t(r,o)},listen(m){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(T4,h),l=m,()=>{r.removeEventListener(T4,h),l=null}},createHref(m){return e(r,m)},createURL:p,encodeLocation(m){let y=p(m);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:d,replace:f,go(m){return o.go(m)}};return g}var N4;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(N4||(N4={}));function Gz(t,e,n){n===void 0&&(n="/");let s=typeof e=="string"?kd(e):e,r=ed(s.pathname||"/",n);if(r==null)return null;let i=tP(t);Hz(i);let o=null;for(let a=0;o==null&&a<i.length;++a){let l=sW(r);o=tW(i[a],l)}return o}function tP(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let r=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(nn(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let c=ml([s,l.relativePath]),u=n.concat(l);i.children&&i.children.length>0&&(nn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),tP(i.children,e,u,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:Qz(c,i.index),routesMeta:u})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))r(i,o);else for(let l of nP(i.path))r(i,o,l)}),e}function nP(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let o=nP(s.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),r&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function Hz(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:eW(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const Kz=/^:[\w-]+$/,qz=3,Xz=2,Yz=1,Jz=10,Zz=-2,_4=t=>t==="*";function Qz(t,e){let n=t.split("/"),s=n.length;return n.some(_4)&&(s+=Zz),e&&(s+=Xz),n.filter(r=>!_4(r)).reduce((r,i)=>r+(Kz.test(i)?qz:i===""?Yz:Jz),s)}function eW(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function tW(t,e){let{routesMeta:n}=t,s={},r="/",i=[];for(let o=0;o<n.length;++o){let a=n[o],l=o===n.length-1,c=r==="/"?e:e.slice(r.length)||"/",u=Ub({path:a.relativePath,caseSensitive:a.caseSensitive,end:l},c);if(!u)return null;Object.assign(s,u.params);let h=a.route;i.push({params:s,pathname:ml([r,u.pathname]),pathnameBase:aW(ml([r,u.pathnameBase])),route:h}),u.pathnameBase!=="/"&&(r=ml([r,u.pathnameBase]))}return i}function Ub(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=nW(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:s.reduce((c,u,h)=>{let{paramName:d,isOptional:f}=u;if(d==="*"){let g=a[h]||"";o=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const p=a[h];return f&&!p?c[d]=void 0:c[d]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:t}}function nW(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),eP(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function sW(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return eP(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function ed(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function rW(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?kd(t):t;return{pathname:n?n.startsWith("/")?n:iW(n,e):e,search:lW(s),hash:cW(r)}}function iW(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Yx(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function oW(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function cI(t,e){let n=oW(t);return e?n.map((s,r)=>r===t.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function uI(t,e,n,s){s===void 0&&(s=!1);let r;typeof t=="string"?r=kd(t):(r=_p({},t),nn(!r.pathname||!r.pathname.includes("?"),Yx("?","pathname","search",r)),nn(!r.pathname||!r.pathname.includes("#"),Yx("#","pathname","hash",r)),nn(!r.search||!r.search.includes("#"),Yx("#","search","hash",r)));let i=t===""||r.pathname==="",o=i?"/":r.pathname,a;if(o==null)a=n;else{let h=e.length-1;if(!s&&o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),h-=1;r.pathname=d.join("/")}a=h>=0?e[h]:"/"}let l=rW(r,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const ml=t=>t.join("/").replace(/\/\/+/g,"/"),aW=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),lW=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,cW=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function uW(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const sP=["post","put","patch","delete"];new Set(sP);const hW=["get",...sP];new Set(hW);/**
 * React Router v6.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $p(){return $p=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},$p.apply(this,arguments)}const cy=J.createContext(null),rP=J.createContext(null),Ca=J.createContext(null),uy=J.createContext(null),Vl=J.createContext({outlet:null,matches:[],isDataRoute:!1}),iP=J.createContext(null);function dW(t,e){let{relative:n}=e===void 0?{}:e;Td()||nn(!1);let{basename:s,navigator:r}=J.useContext(Ca),{hash:i,pathname:o,search:a}=hy(t,{relative:n}),l=o;return s!=="/"&&(l=o==="/"?s:ml([s,o])),r.createHref({pathname:l,search:a,hash:i})}function Td(){return J.useContext(uy)!=null}function Ul(){return Td()||nn(!1),J.useContext(uy).location}function oP(t){J.useContext(Ca).static||J.useLayoutEffect(t)}function om(){let{isDataRoute:t}=J.useContext(Vl);return t?kW():fW()}function fW(){Td()||nn(!1);let t=J.useContext(cy),{basename:e,future:n,navigator:s}=J.useContext(Ca),{matches:r}=J.useContext(Vl),{pathname:i}=Ul(),o=JSON.stringify(cI(r,n.v7_relativeSplatPath)),a=J.useRef(!1);return oP(()=>{a.current=!0}),J.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){s.go(c);return}let h=uI(c,JSON.parse(o),i,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:ml([e,h.pathname])),(u.replace?s.replace:s.push)(h,u.state,u)},[e,s,o,i,t])}function hy(t,e){let{relative:n}=e===void 0?{}:e,{future:s}=J.useContext(Ca),{matches:r}=J.useContext(Vl),{pathname:i}=Ul(),o=JSON.stringify(cI(r,s.v7_relativeSplatPath));return J.useMemo(()=>uI(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function pW(t,e){return mW(t,e)}function mW(t,e,n,s){Td()||nn(!1);let{navigator:r}=J.useContext(Ca),{matches:i}=J.useContext(Vl),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=Ul(),u;if(e){var h;let m=typeof e=="string"?kd(e):e;l==="/"||(h=m.pathname)!=null&&h.startsWith(l)||nn(!1),u=m}else u=c;let d=u.pathname||"/",f=d;if(l!=="/"){let m=l.replace(/^\//,"").split("/");f="/"+d.replace(/^\//,"").split("/").slice(m.length).join("/")}let p=Gz(t,{pathname:f}),g=wW(p&&p.map(m=>Object.assign({},m,{params:Object.assign({},a,m.params),pathname:ml([l,r.encodeLocation?r.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?l:ml([l,r.encodeLocation?r.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),i,n,s);return e&&g?J.createElement(uy.Provider,{value:{location:$p({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:nl.Pop}},g):g}function gW(){let t=IW(),e=uW(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return J.createElement(J.Fragment,null,J.createElement("h2",null,"Unexpected Application Error!"),J.createElement("h3",{style:{fontStyle:"italic"}},e),n?J.createElement("pre",{style:r},n):null,null)}const yW=J.createElement(gW,null);class vW extends J.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?J.createElement(Vl.Provider,{value:this.props.routeContext},J.createElement(iP.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function xW(t){let{routeContext:e,match:n,children:s}=t,r=J.useContext(cy);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),J.createElement(Vl.Provider,{value:e},s)}function wW(t,e,n,s){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var i;if((i=n)!=null&&i.errors)t=n.matches;else return null}let o=t,a=(r=n)==null?void 0:r.errors;if(a!=null){let u=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);u>=0||nn(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(n&&s&&s.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:d,errors:f}=n,p=h.route.loader&&d[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||p){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,h,d)=>{let f,p=!1,g=null,m=null;n&&(f=a&&h.route.id?a[h.route.id]:void 0,g=h.route.errorElement||yW,l&&(c<0&&d===0?(p=!0,m=null):c===d&&(p=!0,m=h.route.hydrateFallbackElement||null)));let y=e.concat(o.slice(0,d+1)),w=()=>{let b;return f?b=g:p?b=m:h.route.Component?b=J.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=u,J.createElement(xW,{match:h,routeContext:{outlet:u,matches:y,isDataRoute:n!=null},children:b})};return n&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?J.createElement(vW,{location:n.location,revalidation:n.revalidation,component:g,error:f,children:w(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):w()},null)}var aP=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(aP||{}),q1=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(q1||{});function bW(t){let e=J.useContext(cy);return e||nn(!1),e}function CW(t){let e=J.useContext(rP);return e||nn(!1),e}function SW(t){let e=J.useContext(Vl);return e||nn(!1),e}function lP(t){let e=SW(),n=e.matches[e.matches.length-1];return n.route.id||nn(!1),n.route.id}function IW(){var t;let e=J.useContext(iP),n=CW(q1.UseRouteError),s=lP(q1.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function kW(){let{router:t}=bW(aP.UseNavigateStable),e=lP(q1.UseNavigateStable),n=J.useRef(!1);return oP(()=>{n.current=!0}),J.useCallback(function(r,i){i===void 0&&(i={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,$p({fromRouteId:e},i)))},[t,e])}function cP(t){let{to:e,replace:n,state:s,relative:r}=t;Td()||nn(!1);let{future:i,static:o}=J.useContext(Ca),{matches:a}=J.useContext(Vl),{pathname:l}=Ul(),c=om(),u=uI(e,cI(a,i.v7_relativeSplatPath),l,r==="path"),h=JSON.stringify(u);return J.useEffect(()=>c(JSON.parse(h),{replace:n,state:s,relative:r}),[c,h,r,n,s]),null}function Ho(t){nn(!1)}function TW(t){let{basename:e="/",children:n=null,location:s,navigationType:r=nl.Pop,navigator:i,static:o=!1,future:a}=t;Td()&&nn(!1);let l=e.replace(/^\/*/,"/"),c=J.useMemo(()=>({basename:l,navigator:i,static:o,future:$p({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof s=="string"&&(s=kd(s));let{pathname:u="/",search:h="",hash:d="",state:f=null,key:p="default"}=s,g=J.useMemo(()=>{let m=ed(u,l);return m==null?null:{location:{pathname:m,search:h,hash:d,state:f,key:p},navigationType:r}},[l,u,h,d,f,p,r]);return g==null?null:J.createElement(Ca.Provider,{value:c},J.createElement(uy.Provider,{children:n,value:g}))}function EW(t){let{children:e,location:n}=t;return pW(zb(e),n)}new Promise(()=>{});function zb(t,e){e===void 0&&(e=[]);let n=[];return J.Children.forEach(t,(s,r)=>{if(!J.isValidElement(s))return;let i=[...e,r];if(s.type===J.Fragment){n.push.apply(n,zb(s.props.children,i));return}s.type!==Ho&&nn(!1),!s.props.index||!s.props.children||nn(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=zb(s.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function X1(){return X1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},X1.apply(this,arguments)}function uP(t,e){if(t==null)return{};var n={},s=Object.keys(t),r,i;for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function NW(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function _W(t,e){return t.button===0&&(!e||e==="_self")&&!NW(t)}const $W=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],RW=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"],AW="6";try{window.__reactRouterVersion=AW}catch{}const DW=J.createContext({isTransitioning:!1}),PW="startTransition",$4=$V[PW];function OW(t){let{basename:e,children:n,future:s,window:r}=t,i=J.useRef();i.current==null&&(i.current=zz({window:r,v5Compat:!0}));let o=i.current,[a,l]=J.useState({action:o.action,location:o.location}),{v7_startTransition:c}=s||{},u=J.useCallback(h=>{c&&$4?$4(()=>l(h)):l(h)},[l,c]);return J.useLayoutEffect(()=>o.listen(u),[o,u]),J.createElement(TW,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:s})}const FW=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",LW=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,MW=J.forwardRef(function(e,n){let{onClick:s,relative:r,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,unstable_viewTransition:h}=e,d=uP(e,$W),{basename:f}=J.useContext(Ca),p,g=!1;if(typeof c=="string"&&LW.test(c)&&(p=c,FW))try{let b=new URL(window.location.href),C=c.startsWith("//")?new URL(b.protocol+c):new URL(c),k=ed(C.pathname,f);C.origin===b.origin&&k!=null?c=k+C.search+C.hash:g=!0}catch{}let m=dW(c,{relative:r}),y=UW(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:r,unstable_viewTransition:h});function w(b){s&&s(b),b.defaultPrevented||y(b)}return J.createElement("a",X1({},d,{href:p||m,onClick:g||i?s:w,ref:n,target:l}))}),BW=J.forwardRef(function(e,n){let{"aria-current":s="page",caseSensitive:r=!1,className:i="",end:o=!1,style:a,to:l,unstable_viewTransition:c,children:u}=e,h=uP(e,RW),d=hy(l,{relative:h.relative}),f=Ul(),p=J.useContext(rP),{navigator:g,basename:m}=J.useContext(Ca),y=p!=null&&zW(d)&&c===!0,w=g.encodeLocation?g.encodeLocation(d).pathname:d.pathname,b=f.pathname,C=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;r||(b=b.toLowerCase(),C=C?C.toLowerCase():null,w=w.toLowerCase()),C&&m&&(C=ed(C,m)||C);const k=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let $=b===w||!o&&b.startsWith(w)&&b.charAt(k)==="/",I=C!=null&&(C===w||!o&&C.startsWith(w)&&C.charAt(w.length)==="/"),T={isActive:$,isPending:I,isTransitioning:y},R=$?s:void 0,E;typeof i=="function"?E=i(T):E=[i,$?"active":null,I?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let A=typeof a=="function"?a(T):a;return J.createElement(MW,X1({},h,{"aria-current":R,className:E,ref:n,style:A,to:l,unstable_viewTransition:c}),typeof u=="function"?u(T):u)});var Wb;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Wb||(Wb={}));var R4;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(R4||(R4={}));function VW(t){let e=J.useContext(cy);return e||nn(!1),e}function UW(t,e){let{target:n,replace:s,state:r,preventScrollReset:i,relative:o,unstable_viewTransition:a}=e===void 0?{}:e,l=om(),c=Ul(),u=hy(t,{relative:o});return J.useCallback(h=>{if(_W(h,n)){h.preventDefault();let d=s!==void 0?s:K1(c)===K1(u);l(t,{replace:d,state:r,preventScrollReset:i,relative:o,unstable_viewTransition:a})}},[c,l,u,s,r,n,t,i,o,a])}function zW(t,e){e===void 0&&(e={});let n=J.useContext(DW);n==null&&nn(!1);let{basename:s}=VW(Wb.useViewTransitionState),r=hy(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=ed(n.currentLocation.pathname,s)||n.currentLocation.pathname,o=ed(n.nextLocation.pathname,s)||n.nextLocation.pathname;return Ub(r.pathname,o)!=null||Ub(r.pathname,i)!=null}function Cf({children:t,...e}){const[n,s]=J.useState(!1),[r,i]=J.useState(!0),o=async a=>{try{(await fetch("https://europe-west1-proiect-licenta-fc2a8.cloudfunctions.net/api/verify-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:a})})).ok?s(!0):s(!1)}catch(l){console.error("Error verifying token: ",l),alert("Error: "+l),s(!1)}finally{i(!1)}};return J.useEffect(()=>{const a=localStorage.getItem("token");a?o(a):(s(!1),i(!1))},[]),r?U.jsx(U.Fragment,{}):n?Xc.cloneElement(t,{...e}):U.jsx(cP,{to:"/Login"})}var fr=function(){return fr=Object.assign||function(e){for(var n,s=1,r=arguments.length;s<r;s++){n=arguments[s];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},fr.apply(this,arguments)};function hI(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n}function Y1(t,e,n){if(n||arguments.length===2)for(var s=0,r=e.length,i;s<r;s++)(i||!(s in e))&&(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))}var Gt="-ms-",sp="-moz-",bt="-webkit-",hP="comm",dy="rule",dI="decl",WW="@import",dP="@keyframes",jW="@layer",fP=Math.abs,fI=String.fromCharCode,jb=Object.assign;function GW(t,e){return Xn(t,0)^45?(((e<<2^Xn(t,0))<<2^Xn(t,1))<<2^Xn(t,2))<<2^Xn(t,3):0}function pP(t){return t.trim()}function qo(t,e){return(t=e.exec(t))?t[0]:t}function Qe(t,e,n){return t.replace(e,n)}function l1(t,e,n){return t.indexOf(e,n)}function Xn(t,e){return t.charCodeAt(e)|0}function td(t,e,n){return t.slice(e,n)}function ao(t){return t.length}function mP(t){return t.length}function Of(t,e){return e.push(t),t}function HW(t,e){return t.map(e).join("")}function A4(t,e){return t.filter(function(n){return!qo(n,e)})}var fy=1,nd=1,gP=0,yi=0,In=0,Ed="";function py(t,e,n,s,r,i,o,a){return{value:t,root:e,parent:n,type:s,props:r,children:i,line:fy,column:nd,length:o,return:"",siblings:a}}function Ua(t,e){return jb(py("",null,null,"",null,null,0,t.siblings),t,{length:-t.length},e)}function Qu(t){for(;t.root;)t=Ua(t.root,{children:[t]});Of(t,t.siblings)}function KW(){return In}function qW(){return In=yi>0?Xn(Ed,--yi):0,nd--,In===10&&(nd=1,fy--),In}function Mi(){return In=yi<gP?Xn(Ed,yi++):0,nd++,In===10&&(nd=1,fy++),In}function Uc(){return Xn(Ed,yi)}function c1(){return yi}function my(t,e){return td(Ed,t,e)}function Gb(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function XW(t){return fy=nd=1,gP=ao(Ed=t),yi=0,[]}function YW(t){return Ed="",t}function Jx(t){return pP(my(yi-1,Hb(t===91?t+2:t===40?t+1:t)))}function JW(t){for(;(In=Uc())&&In<33;)Mi();return Gb(t)>2||Gb(In)>3?"":" "}function ZW(t,e){for(;--e&&Mi()&&!(In<48||In>102||In>57&&In<65||In>70&&In<97););return my(t,c1()+(e<6&&Uc()==32&&Mi()==32))}function Hb(t){for(;Mi();)switch(In){case t:return yi;case 34:case 39:t!==34&&t!==39&&Hb(In);break;case 40:t===41&&Hb(t);break;case 92:Mi();break}return yi}function QW(t,e){for(;Mi()&&t+In!==57;)if(t+In===84&&Uc()===47)break;return"/*"+my(e,yi-1)+"*"+fI(t===47?t:Mi())}function ej(t){for(;!Gb(Uc());)Mi();return my(t,yi)}function tj(t){return YW(u1("",null,null,null,[""],t=XW(t),0,[0],t))}function u1(t,e,n,s,r,i,o,a,l){for(var c=0,u=0,h=o,d=0,f=0,p=0,g=1,m=1,y=1,w=0,b="",C=r,k=i,$=s,I=b;m;)switch(p=w,w=Mi()){case 40:if(p!=108&&Xn(I,h-1)==58){l1(I+=Qe(Jx(w),"&","&\f"),"&\f",fP(c?a[c-1]:0))!=-1&&(y=-1);break}case 34:case 39:case 91:I+=Jx(w);break;case 9:case 10:case 13:case 32:I+=JW(p);break;case 92:I+=ZW(c1()-1,7);continue;case 47:switch(Uc()){case 42:case 47:Of(nj(QW(Mi(),c1()),e,n,l),l);break;default:I+="/"}break;case 123*g:a[c++]=ao(I)*y;case 125*g:case 59:case 0:switch(w){case 0:case 125:m=0;case 59+u:y==-1&&(I=Qe(I,/\f/g,"")),f>0&&ao(I)-h&&Of(f>32?P4(I+";",s,n,h-1,l):P4(Qe(I," ","")+";",s,n,h-2,l),l);break;case 59:I+=";";default:if(Of($=D4(I,e,n,c,u,r,a,b,C=[],k=[],h,i),i),w===123)if(u===0)u1(I,e,$,$,C,i,h,a,k);else switch(d===99&&Xn(I,3)===110?100:d){case 100:case 108:case 109:case 115:u1(t,$,$,s&&Of(D4(t,$,$,0,0,r,a,b,r,C=[],h,k),k),r,k,h,a,s?C:k);break;default:u1(I,$,$,$,[""],k,0,a,k)}}c=u=f=0,g=y=1,b=I="",h=o;break;case 58:h=1+ao(I),f=p;default:if(g<1){if(w==123)--g;else if(w==125&&g++==0&&qW()==125)continue}switch(I+=fI(w),w*g){case 38:y=u>0?1:(I+="\f",-1);break;case 44:a[c++]=(ao(I)-1)*y,y=1;break;case 64:Uc()===45&&(I+=Jx(Mi())),d=Uc(),u=h=ao(b=I+=ej(c1())),w++;break;case 45:p===45&&ao(I)==2&&(g=0)}}return i}function D4(t,e,n,s,r,i,o,a,l,c,u,h){for(var d=r-1,f=r===0?i:[""],p=mP(f),g=0,m=0,y=0;g<s;++g)for(var w=0,b=td(t,d+1,d=fP(m=o[g])),C=t;w<p;++w)(C=pP(m>0?f[w]+" "+b:Qe(b,/&\f/g,f[w])))&&(l[y++]=C);return py(t,e,n,r===0?dy:a,l,c,u,h)}function nj(t,e,n,s){return py(t,e,n,hP,fI(KW()),td(t,2,-2),0,s)}function P4(t,e,n,s,r){return py(t,e,n,dI,td(t,0,s),td(t,s+1,-1),s,r)}function yP(t,e,n){switch(GW(t,e)){case 5103:return bt+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return bt+t+t;case 4789:return sp+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return bt+t+sp+t+Gt+t+t;case 5936:switch(Xn(t,e+11)){case 114:return bt+t+Gt+Qe(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return bt+t+Gt+Qe(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return bt+t+Gt+Qe(t,/[svh]\w+-[tblr]{2}/,"lr")+t}case 6828:case 4268:case 2903:return bt+t+Gt+t+t;case 6165:return bt+t+Gt+"flex-"+t+t;case 5187:return bt+t+Qe(t,/(\w+).+(:[^]+)/,bt+"box-$1$2"+Gt+"flex-$1$2")+t;case 5443:return bt+t+Gt+"flex-item-"+Qe(t,/flex-|-self/g,"")+(qo(t,/flex-|baseline/)?"":Gt+"grid-row-"+Qe(t,/flex-|-self/g,""))+t;case 4675:return bt+t+Gt+"flex-line-pack"+Qe(t,/align-content|flex-|-self/g,"")+t;case 5548:return bt+t+Gt+Qe(t,"shrink","negative")+t;case 5292:return bt+t+Gt+Qe(t,"basis","preferred-size")+t;case 6060:return bt+"box-"+Qe(t,"-grow","")+bt+t+Gt+Qe(t,"grow","positive")+t;case 4554:return bt+Qe(t,/([^-])(transform)/g,"$1"+bt+"$2")+t;case 6187:return Qe(Qe(Qe(t,/(zoom-|grab)/,bt+"$1"),/(image-set)/,bt+"$1"),t,"")+t;case 5495:case 3959:return Qe(t,/(image-set\([^]*)/,bt+"$1$`$1");case 4968:return Qe(Qe(t,/(.+:)(flex-)?(.*)/,bt+"box-pack:$3"+Gt+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+bt+t+t;case 4200:if(!qo(t,/flex-|baseline/))return Gt+"grid-column-align"+td(t,e)+t;break;case 2592:case 3360:return Gt+Qe(t,"template-","")+t;case 4384:case 3616:return n&&n.some(function(s,r){return e=r,qo(s.props,/grid-\w+-end/)})?~l1(t+(n=n[e].value),"span",0)?t:Gt+Qe(t,"-start","")+t+Gt+"grid-row-span:"+(~l1(n,"span",0)?qo(n,/\d+/):+qo(n,/\d+/)-+qo(t,/\d+/))+";":Gt+Qe(t,"-start","")+t;case 4896:case 4128:return n&&n.some(function(s){return qo(s.props,/grid-\w+-start/)})?t:Gt+Qe(Qe(t,"-end","-span"),"span ","")+t;case 4095:case 3583:case 4068:case 2532:return Qe(t,/(.+)-inline(.+)/,bt+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ao(t)-1-e>6)switch(Xn(t,e+1)){case 109:if(Xn(t,e+4)!==45)break;case 102:return Qe(t,/(.+:)(.+)-([^]+)/,"$1"+bt+"$2-$3$1"+sp+(Xn(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~l1(t,"stretch",0)?yP(Qe(t,"stretch","fill-available"),e,n)+t:t}break;case 5152:case 5920:return Qe(t,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(s,r,i,o,a,l,c){return Gt+r+":"+i+c+(o?Gt+r+"-span:"+(a?l:+l-+i)+c:"")+t});case 4949:if(Xn(t,e+6)===121)return Qe(t,":",":"+bt)+t;break;case 6444:switch(Xn(t,Xn(t,14)===45?18:11)){case 120:return Qe(t,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+bt+(Xn(t,14)===45?"inline-":"")+"box$3$1"+bt+"$2$3$1"+Gt+"$2box$3")+t;case 100:return Qe(t,":",":"+Gt)+t}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Qe(t,"scroll-","scroll-snap-")+t}return t}function J1(t,e){for(var n="",s=0;s<t.length;s++)n+=e(t[s],s,t,e)||"";return n}function sj(t,e,n,s){switch(t.type){case jW:if(t.children.length)break;case WW:case dI:return t.return=t.return||t.value;case hP:return"";case dP:return t.return=t.value+"{"+J1(t.children,s)+"}";case dy:if(!ao(t.value=t.props.join(",")))return""}return ao(n=J1(t.children,s))?t.return=t.value+"{"+n+"}":""}function rj(t){var e=mP(t);return function(n,s,r,i){for(var o="",a=0;a<e;a++)o+=t[a](n,s,r,i)||"";return o}}function ij(t){return function(e){e.root||(e=e.return)&&t(e)}}function oj(t,e,n,s){if(t.length>-1&&!t.return)switch(t.type){case dI:t.return=yP(t.value,t.length,n);return;case dP:return J1([Ua(t,{value:Qe(t.value,"@","@"+bt)})],s);case dy:if(t.length)return HW(n=t.props,function(r){switch(qo(r,s=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":Qu(Ua(t,{props:[Qe(r,/:(read-\w+)/,":"+sp+"$1")]})),Qu(Ua(t,{props:[r]})),jb(t,{props:A4(n,s)});break;case"::placeholder":Qu(Ua(t,{props:[Qe(r,/:(plac\w+)/,":"+bt+"input-$1")]})),Qu(Ua(t,{props:[Qe(r,/:(plac\w+)/,":"+sp+"$1")]})),Qu(Ua(t,{props:[Qe(r,/:(plac\w+)/,Gt+"input-$1")]})),Qu(Ua(t,{props:[r]})),jb(t,{props:A4(n,s)});break}return""})}}var aj={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Dr={},sd=typeof process<"u"&&Dr!==void 0&&(Dr.REACT_APP_SC_ATTR||Dr.SC_ATTR)||"data-styled",vP="active",xP="data-styled-version",gy="6.1.11",pI=`/*!sc*/
`,mI=typeof window<"u"&&"HTMLElement"in window,lj=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&Dr!==void 0&&Dr.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&Dr.REACT_APP_SC_DISABLE_SPEEDY!==""?Dr.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&Dr.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&Dr!==void 0&&Dr.SC_DISABLE_SPEEDY!==void 0&&Dr.SC_DISABLE_SPEEDY!==""&&Dr.SC_DISABLE_SPEEDY!=="false"&&Dr.SC_DISABLE_SPEEDY),yy=Object.freeze([]),rd=Object.freeze({});function cj(t,e,n){return n===void 0&&(n=rd),t.theme!==n.theme&&t.theme||e||n.theme}var wP=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),uj=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,hj=/(^-|-$)/g;function O4(t){return t.replace(uj,"-").replace(hj,"")}var dj=/(a)(d)/gi,N0=52,F4=function(t){return String.fromCharCode(t+(t>25?39:97))};function Kb(t){var e,n="";for(e=Math.abs(t);e>N0;e=e/N0|0)n=F4(e%N0)+n;return(F4(e%N0)+n).replace(dj,"$1-$2")}var Zx,bP=5381,kh=function(t,e){for(var n=e.length;n;)t=33*t^e.charCodeAt(--n);return t},CP=function(t){return kh(bP,t)};function fj(t){return Kb(CP(t)>>>0)}function pj(t){return t.displayName||t.name||"Component"}function Qx(t){return typeof t=="string"&&!0}var SP=typeof Symbol=="function"&&Symbol.for,IP=SP?Symbol.for("react.memo"):60115,mj=SP?Symbol.for("react.forward_ref"):60112,gj={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},yj={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},kP={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},vj=((Zx={})[mj]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Zx[IP]=kP,Zx);function L4(t){return("type"in(e=t)&&e.type.$$typeof)===IP?kP:"$$typeof"in t?vj[t.$$typeof]:gj;var e}var xj=Object.defineProperty,wj=Object.getOwnPropertyNames,M4=Object.getOwnPropertySymbols,bj=Object.getOwnPropertyDescriptor,Cj=Object.getPrototypeOf,B4=Object.prototype;function TP(t,e,n){if(typeof e!="string"){if(B4){var s=Cj(e);s&&s!==B4&&TP(t,s,n)}var r=wj(e);M4&&(r=r.concat(M4(e)));for(var i=L4(t),o=L4(e),a=0;a<r.length;++a){var l=r[a];if(!(l in yj||n&&n[l]||o&&l in o||i&&l in i)){var c=bj(e,l);try{xj(t,l,c)}catch{}}}}return t}function id(t){return typeof t=="function"}function gI(t){return typeof t=="object"&&"styledComponentId"in t}function Pc(t,e){return t&&e?"".concat(t," ").concat(e):t||e||""}function V4(t,e){if(t.length===0)return"";for(var n=t[0],s=1;s<t.length;s++)n+=t[s];return n}function Rp(t){return t!==null&&typeof t=="object"&&t.constructor.name===Object.name&&!("props"in t&&t.$$typeof)}function qb(t,e,n){if(n===void 0&&(n=!1),!n&&!Rp(t)&&!Array.isArray(t))return e;if(Array.isArray(e))for(var s=0;s<e.length;s++)t[s]=qb(t[s],e[s]);else if(Rp(e))for(var s in e)t[s]=qb(t[s],e[s]);return t}function yI(t,e){Object.defineProperty(t,"toString",{value:e})}function am(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(t," for more information.").concat(e.length>0?" Args: ".concat(e.join(", ")):""))}var Sj=function(){function t(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}return t.prototype.indexOfGroup=function(e){for(var n=0,s=0;s<e;s++)n+=this.groupSizes[s];return n},t.prototype.insertRules=function(e,n){if(e>=this.groupSizes.length){for(var s=this.groupSizes,r=s.length,i=r;e>=i;)if((i<<=1)<0)throw am(16,"".concat(e));this.groupSizes=new Uint32Array(i),this.groupSizes.set(s),this.length=i;for(var o=r;o<i;o++)this.groupSizes[o]=0}for(var a=this.indexOfGroup(e+1),l=(o=0,n.length);o<l;o++)this.tag.insertRule(a,n[o])&&(this.groupSizes[e]++,a++)},t.prototype.clearGroup=function(e){if(e<this.length){var n=this.groupSizes[e],s=this.indexOfGroup(e),r=s+n;this.groupSizes[e]=0;for(var i=s;i<r;i++)this.tag.deleteRule(s)}},t.prototype.getGroup=function(e){var n="";if(e>=this.length||this.groupSizes[e]===0)return n;for(var s=this.groupSizes[e],r=this.indexOfGroup(e),i=r+s,o=r;o<i;o++)n+="".concat(this.tag.getRule(o)).concat(pI);return n},t}(),h1=new Map,Z1=new Map,d1=1,_0=function(t){if(h1.has(t))return h1.get(t);for(;Z1.has(d1);)d1++;var e=d1++;return h1.set(t,e),Z1.set(e,t),e},Ij=function(t,e){d1=e+1,h1.set(t,e),Z1.set(e,t)},kj="style[".concat(sd,"][").concat(xP,'="').concat(gy,'"]'),Tj=new RegExp("^".concat(sd,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),Ej=function(t,e,n){for(var s,r=n.split(","),i=0,o=r.length;i<o;i++)(s=r[i])&&t.registerName(e,s)},Nj=function(t,e){for(var n,s=((n=e.textContent)!==null&&n!==void 0?n:"").split(pI),r=[],i=0,o=s.length;i<o;i++){var a=s[i].trim();if(a){var l=a.match(Tj);if(l){var c=0|parseInt(l[1],10),u=l[2];c!==0&&(Ij(u,c),Ej(t,u,l[3]),t.getTag().insertRules(c,r)),r.length=0}else r.push(a)}}};function _j(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var EP=function(t){var e=document.head,n=t||e,s=document.createElement("style"),r=function(a){var l=Array.from(a.querySelectorAll("style[".concat(sd,"]")));return l[l.length-1]}(n),i=r!==void 0?r.nextSibling:null;s.setAttribute(sd,vP),s.setAttribute(xP,gy);var o=_j();return o&&s.setAttribute("nonce",o),n.insertBefore(s,i),s},$j=function(){function t(e){this.element=EP(e),this.element.appendChild(document.createTextNode("")),this.sheet=function(n){if(n.sheet)return n.sheet;for(var s=document.styleSheets,r=0,i=s.length;r<i;r++){var o=s[r];if(o.ownerNode===n)return o}throw am(17)}(this.element),this.length=0}return t.prototype.insertRule=function(e,n){try{return this.sheet.insertRule(n,e),this.length++,!0}catch{return!1}},t.prototype.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},t.prototype.getRule=function(e){var n=this.sheet.cssRules[e];return n&&n.cssText?n.cssText:""},t}(),Rj=function(){function t(e){this.element=EP(e),this.nodes=this.element.childNodes,this.length=0}return t.prototype.insertRule=function(e,n){if(e<=this.length&&e>=0){var s=document.createTextNode(n);return this.element.insertBefore(s,this.nodes[e]||null),this.length++,!0}return!1},t.prototype.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},t.prototype.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},t}(),Aj=function(){function t(e){this.rules=[],this.length=0}return t.prototype.insertRule=function(e,n){return e<=this.length&&(this.rules.splice(e,0,n),this.length++,!0)},t.prototype.deleteRule=function(e){this.rules.splice(e,1),this.length--},t.prototype.getRule=function(e){return e<this.length?this.rules[e]:""},t}(),U4=mI,Dj={isServer:!mI,useCSSOMInjection:!lj},NP=function(){function t(e,n,s){e===void 0&&(e=rd),n===void 0&&(n={});var r=this;this.options=fr(fr({},Dj),e),this.gs=n,this.names=new Map(s),this.server=!!e.isServer,!this.server&&mI&&U4&&(U4=!1,function(i){for(var o=document.querySelectorAll(kj),a=0,l=o.length;a<l;a++){var c=o[a];c&&c.getAttribute(sd)!==vP&&(Nj(i,c),c.parentNode&&c.parentNode.removeChild(c))}}(this)),yI(this,function(){return function(i){for(var o=i.getTag(),a=o.length,l="",c=function(h){var d=function(y){return Z1.get(y)}(h);if(d===void 0)return"continue";var f=i.names.get(d),p=o.getGroup(h);if(f===void 0||p.length===0)return"continue";var g="".concat(sd,".g").concat(h,'[id="').concat(d,'"]'),m="";f!==void 0&&f.forEach(function(y){y.length>0&&(m+="".concat(y,","))}),l+="".concat(p).concat(g,'{content:"').concat(m,'"}').concat(pI)},u=0;u<a;u++)c(u);return l}(r)})}return t.registerId=function(e){return _0(e)},t.prototype.reconstructWithOptions=function(e,n){return n===void 0&&(n=!0),new t(fr(fr({},this.options),e),this.gs,n&&this.names||void 0)},t.prototype.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},t.prototype.getTag=function(){return this.tag||(this.tag=(e=function(n){var s=n.useCSSOMInjection,r=n.target;return n.isServer?new Aj(r):s?new $j(r):new Rj(r)}(this.options),new Sj(e)));var e},t.prototype.hasNameForId=function(e,n){return this.names.has(e)&&this.names.get(e).has(n)},t.prototype.registerName=function(e,n){if(_0(e),this.names.has(e))this.names.get(e).add(n);else{var s=new Set;s.add(n),this.names.set(e,s)}},t.prototype.insertRules=function(e,n,s){this.registerName(e,n),this.getTag().insertRules(_0(e),s)},t.prototype.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},t.prototype.clearRules=function(e){this.getTag().clearGroup(_0(e)),this.clearNames(e)},t.prototype.clearTag=function(){this.tag=void 0},t}(),Pj=/&/g,Oj=/^\s*\/\/.*$/gm;function _P(t,e){return t.map(function(n){return n.type==="rule"&&(n.value="".concat(e," ").concat(n.value),n.value=n.value.replaceAll(",",",".concat(e," ")),n.props=n.props.map(function(s){return"".concat(e," ").concat(s)})),Array.isArray(n.children)&&n.type!=="@keyframes"&&(n.children=_P(n.children,e)),n})}function Fj(t){var e,n,s,r=rd,i=r.options,o=i===void 0?rd:i,a=r.plugins,l=a===void 0?yy:a,c=function(d,f,p){return p.startsWith(n)&&p.endsWith(n)&&p.replaceAll(n,"").length>0?".".concat(e):d},u=l.slice();u.push(function(d){d.type===dy&&d.value.includes("&")&&(d.props[0]=d.props[0].replace(Pj,n).replace(s,c))}),o.prefix&&u.push(oj),u.push(sj);var h=function(d,f,p,g){f===void 0&&(f=""),p===void 0&&(p=""),g===void 0&&(g="&"),e=g,n=f,s=new RegExp("\\".concat(n,"\\b"),"g");var m=d.replace(Oj,""),y=tj(p||f?"".concat(p," ").concat(f," { ").concat(m," }"):m);o.namespace&&(y=_P(y,o.namespace));var w=[];return J1(y,rj(u.concat(ij(function(b){return w.push(b)})))),w};return h.hash=l.length?l.reduce(function(d,f){return f.name||am(15),kh(d,f.name)},bP).toString():"",h}var Lj=new NP,Xb=Fj(),$P=Xc.createContext({shouldForwardProp:void 0,styleSheet:Lj,stylis:Xb});$P.Consumer;Xc.createContext(void 0);function z4(){return J.useContext($P)}var Mj=function(){function t(e,n){var s=this;this.inject=function(r,i){i===void 0&&(i=Xb);var o=s.name+i.hash;r.hasNameForId(s.id,o)||r.insertRules(s.id,o,i(s.rules,o,"@keyframes"))},this.name=e,this.id="sc-keyframes-".concat(e),this.rules=n,yI(this,function(){throw am(12,String(s.name))})}return t.prototype.getName=function(e){return e===void 0&&(e=Xb),this.name+e.hash},t}(),Bj=function(t){return t>="A"&&t<="Z"};function W4(t){for(var e="",n=0;n<t.length;n++){var s=t[n];if(n===1&&s==="-"&&t[0]==="-")return t;Bj(s)?e+="-"+s.toLowerCase():e+=s}return e.startsWith("ms-")?"-"+e:e}var RP=function(t){return t==null||t===!1||t===""},AP=function(t){var e,n,s=[];for(var r in t){var i=t[r];t.hasOwnProperty(r)&&!RP(i)&&(Array.isArray(i)&&i.isCss||id(i)?s.push("".concat(W4(r),":"),i,";"):Rp(i)?s.push.apply(s,Y1(Y1(["".concat(r," {")],AP(i),!1),["}"],!1)):s.push("".concat(W4(r),": ").concat((e=r,(n=i)==null||typeof n=="boolean"||n===""?"":typeof n!="number"||n===0||e in aj||e.startsWith("--")?String(n).trim():"".concat(n,"px")),";")))}return s};function zc(t,e,n,s){if(RP(t))return[];if(gI(t))return[".".concat(t.styledComponentId)];if(id(t)){if(!id(i=t)||i.prototype&&i.prototype.isReactComponent||!e)return[t];var r=t(e);return zc(r,e,n,s)}var i;return t instanceof Mj?n?(t.inject(n,s),[t.getName(s)]):[t]:Rp(t)?AP(t):Array.isArray(t)?Array.prototype.concat.apply(yy,t.map(function(o){return zc(o,e,n,s)})):[t.toString()]}function Vj(t){for(var e=0;e<t.length;e+=1){var n=t[e];if(id(n)&&!gI(n))return!1}return!0}var Uj=CP(gy),zj=function(){function t(e,n,s){this.rules=e,this.staticRulesId="",this.isStatic=(s===void 0||s.isStatic)&&Vj(e),this.componentId=n,this.baseHash=kh(Uj,n),this.baseStyle=s,NP.registerId(n)}return t.prototype.generateAndInjectStyles=function(e,n,s){var r=this.baseStyle?this.baseStyle.generateAndInjectStyles(e,n,s):"";if(this.isStatic&&!s.hash)if(this.staticRulesId&&n.hasNameForId(this.componentId,this.staticRulesId))r=Pc(r,this.staticRulesId);else{var i=V4(zc(this.rules,e,n,s)),o=Kb(kh(this.baseHash,i)>>>0);if(!n.hasNameForId(this.componentId,o)){var a=s(i,".".concat(o),void 0,this.componentId);n.insertRules(this.componentId,o,a)}r=Pc(r,o),this.staticRulesId=o}else{for(var l=kh(this.baseHash,s.hash),c="",u=0;u<this.rules.length;u++){var h=this.rules[u];if(typeof h=="string")c+=h;else if(h){var d=V4(zc(h,e,n,s));l=kh(l,d+u),c+=d}}if(c){var f=Kb(l>>>0);n.hasNameForId(this.componentId,f)||n.insertRules(this.componentId,f,s(c,".".concat(f),void 0,this.componentId)),r=Pc(r,f)}}return r},t}(),DP=Xc.createContext(void 0);DP.Consumer;var ew={};function Wj(t,e,n){var s=gI(t),r=t,i=!Qx(t),o=e.attrs,a=o===void 0?yy:o,l=e.componentId,c=l===void 0?function(C,k){var $=typeof C!="string"?"sc":O4(C);ew[$]=(ew[$]||0)+1;var I="".concat($,"-").concat(fj(gy+$+ew[$]));return k?"".concat(k,"-").concat(I):I}(e.displayName,e.parentComponentId):l,u=e.displayName,h=u===void 0?function(C){return Qx(C)?"styled.".concat(C):"Styled(".concat(pj(C),")")}(t):u,d=e.displayName&&e.componentId?"".concat(O4(e.displayName),"-").concat(e.componentId):e.componentId||c,f=s&&r.attrs?r.attrs.concat(a).filter(Boolean):a,p=e.shouldForwardProp;if(s&&r.shouldForwardProp){var g=r.shouldForwardProp;if(e.shouldForwardProp){var m=e.shouldForwardProp;p=function(C,k){return g(C,k)&&m(C,k)}}else p=g}var y=new zj(n,d,s?r.componentStyle:void 0);function w(C,k){return function($,I,T){var R=$.attrs,E=$.componentStyle,A=$.defaultProps,F=$.foldedComponentIds,P=$.styledComponentId,Z=$.target,H=Xc.useContext(DP),j=z4(),ee=$.shouldForwardProp||j.shouldForwardProp,z=cj(I,H,A)||rd,X=function(pe,we,ke){for(var De,_e=fr(fr({},we),{className:void 0,theme:ke}),Be=0;Be<pe.length;Be+=1){var Oe=id(De=pe[Be])?De(_e):De;for(var qe in Oe)_e[qe]=qe==="className"?Pc(_e[qe],Oe[qe]):qe==="style"?fr(fr({},_e[qe]),Oe[qe]):Oe[qe]}return we.className&&(_e.className=Pc(_e.className,we.className)),_e}(R,I,z),ie=X.as||Z,de={};for(var he in X)X[he]===void 0||he[0]==="$"||he==="as"||he==="theme"&&X.theme===z||(he==="forwardedAs"?de.as=X.forwardedAs:ee&&!ee(he,ie)||(de[he]=X[he]));var fe=function(pe,we){var ke=z4(),De=pe.generateAndInjectStyles(we,ke.styleSheet,ke.stylis);return De}(E,X),ge=Pc(F,P);return fe&&(ge+=" "+fe),X.className&&(ge+=" "+X.className),de[Qx(ie)&&!wP.has(ie)?"class":"className"]=ge,de.ref=T,J.createElement(ie,de)}(b,C,k)}w.displayName=h;var b=Xc.forwardRef(w);return b.attrs=f,b.componentStyle=y,b.displayName=h,b.shouldForwardProp=p,b.foldedComponentIds=s?Pc(r.foldedComponentIds,r.styledComponentId):"",b.styledComponentId=d,b.target=s?r.target:t,Object.defineProperty(b,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(C){this._foldedDefaultProps=s?function(k){for(var $=[],I=1;I<arguments.length;I++)$[I-1]=arguments[I];for(var T=0,R=$;T<R.length;T++)qb(k,R[T],!0);return k}({},r.defaultProps,C):C}}),yI(b,function(){return".".concat(b.styledComponentId)}),i&&TP(b,t,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),b}function j4(t,e){for(var n=[t[0]],s=0,r=e.length;s<r;s+=1)n.push(e[s],t[s+1]);return n}var G4=function(t){return Object.assign(t,{isCss:!0})};function jj(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(id(t)||Rp(t))return G4(zc(j4(yy,Y1([t],e,!0))));var s=t;return e.length===0&&s.length===1&&typeof s[0]=="string"?zc(s):G4(zc(j4(s,e)))}function Yb(t,e,n){if(n===void 0&&(n=rd),!e)throw am(1,e);var s=function(r){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];return t(e,n,jj.apply(void 0,Y1([r],i,!1)))};return s.attrs=function(r){return Yb(t,e,fr(fr({},n),{attrs:Array.prototype.concat(n.attrs,r).filter(Boolean)}))},s.withConfig=function(r){return Yb(t,e,fr(fr({},n),r))},s}var PP=function(t){return Yb(Wj,t)},Cr=PP;wP.forEach(function(t){Cr[t]=PP(t)});const vI=J.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),vy=J.createContext({}),xy=J.createContext(null),xI=typeof document<"u",wI=xI?J.useLayoutEffect:J.useEffect,OP=J.createContext({strict:!1}),bI=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Gj="framerAppearId",FP="data-"+bI(Gj),Hj={skipAnimations:!1,useManualTiming:!1};class H4{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const n=this.order.indexOf(e);n!==-1&&(this.order.splice(n,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function Kj(t){let e=new H4,n=new H4,s=0,r=!1,i=!1;const o=new WeakSet,a={schedule:(l,c=!1,u=!1)=>{const h=u&&r,d=h?e:n;return c&&o.add(l),d.add(l)&&h&&r&&(s=e.order.length),l},cancel:l=>{n.remove(l),o.delete(l)},process:l=>{if(r){i=!0;return}if(r=!0,[e,n]=[n,e],n.clear(),s=e.order.length,s)for(let c=0;c<s;c++){const u=e.order[c];o.has(u)&&(a.schedule(u),t()),u(l)}r=!1,i&&(i=!1,a.process(l))}};return a}const $0=["read","resolveKeyframes","update","preRender","render","postRender"],qj=40;function LP(t,e){let n=!1,s=!0;const r={delta:0,timestamp:0,isProcessing:!1},i=$0.reduce((h,d)=>(h[d]=Kj(()=>n=!0),h),{}),o=h=>{i[h].process(r)},a=()=>{const h=performance.now();n=!1,r.delta=s?1e3/60:Math.max(Math.min(h-r.timestamp,qj),1),r.timestamp=h,r.isProcessing=!0,$0.forEach(o),r.isProcessing=!1,n&&e&&(s=!1,t(a))},l=()=>{n=!0,s=!0,r.isProcessing||t(a)};return{schedule:$0.reduce((h,d)=>{const f=i[d];return h[d]=(p,g=!1,m=!1)=>(n||l(),f.schedule(p,g,m)),h},{}),cancel:h=>$0.forEach(d=>i[d].cancel(h)),state:r,steps:i}}const{schedule:CI,cancel:wNe}=LP(queueMicrotask,!1);function Xj(t,e,n,s){const{visualElement:r}=J.useContext(vy),i=J.useContext(OP),o=J.useContext(xy),a=J.useContext(vI).reducedMotion,l=J.useRef();s=s||i.renderer,!l.current&&s&&(l.current=s(t,{visualState:e,parent:r,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:a}));const c=l.current;J.useInsertionEffect(()=>{c&&c.update(n,o)});const u=J.useRef(!!(n[FP]&&!window.HandoffComplete));return wI(()=>{c&&(CI.render(c.render),u.current&&c.animationState&&c.animationState.animateChanges())}),J.useEffect(()=>{c&&(c.updateFeatures(),!u.current&&c.animationState&&c.animationState.animateChanges(),u.current&&(u.current=!1,window.HandoffComplete=!0))}),c}function Th(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Yj(t,e,n){return J.useCallback(s=>{s&&t.mount&&t.mount(s),e&&(s?e.mount(s):e.unmount()),n&&(typeof n=="function"?n(s):Th(n)&&(n.current=s))},[e])}function Ap(t){return typeof t=="string"||Array.isArray(t)}function wy(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const SI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],II=["initial",...SI];function by(t){return wy(t.animate)||II.some(e=>Ap(t[e]))}function MP(t){return!!(by(t)||t.variants)}function Jj(t,e){if(by(t)){const{initial:n,animate:s}=t;return{initial:n===!1||Ap(n)?n:void 0,animate:Ap(s)?s:void 0}}return t.inherit!==!1?e:{}}function Zj(t){const{initial:e,animate:n}=Jj(t,J.useContext(vy));return J.useMemo(()=>({initial:e,animate:n}),[K4(e),K4(n)])}function K4(t){return Array.isArray(t)?t.join(" "):t}const q4={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Dp={};for(const t in q4)Dp[t]={isEnabled:e=>q4[t].some(n=>!!e[n])};function Qj(t){for(const e in t)Dp[e]={...Dp[e],...t[e]}}const Pp=J.createContext({}),BP=J.createContext({}),eG=Symbol.for("motionComponentSymbol");function tG({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:s,Component:r}){t&&Qj(t);function i(a,l){let c;const u={...J.useContext(vI),...a,layoutId:nG(a)},{isStatic:h}=u,d=Zj(a),f=s(a,h);if(!h&&xI){d.visualElement=Xj(r,f,u,e);const p=J.useContext(BP),g=J.useContext(OP).strict;d.visualElement&&(c=d.visualElement.loadFeatures(u,g,t,p))}return U.jsxs(vy.Provider,{value:d,children:[c&&d.visualElement?U.jsx(c,{visualElement:d.visualElement,...u}):null,n(r,a,Yj(f,d.visualElement,l),f,h,d.visualElement)]})}const o=J.forwardRef(i);return o[eG]=r,o}function nG({layoutId:t}){const e=J.useContext(Pp).id;return e&&t!==void 0?e+"-"+t:t}function sG(t){function e(s,r={}){return tG(t(s,r))}if(typeof Proxy>"u")return e;const n=new Map;return new Proxy(e,{get:(s,r)=>(n.has(r)||n.set(r,e(r)),n.get(r))})}const rG=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function kI(t){return typeof t!="string"||t.includes("-")?!1:!!(rG.indexOf(t)>-1||/[A-Z]/u.test(t))}const Q1={};function iG(t){Object.assign(Q1,t)}const lm=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Cu=new Set(lm);function VP(t,{layout:e,layoutId:n}){return Cu.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!Q1[t]||t==="opacity")}const Rs=t=>!!(t&&t.getVelocity),oG={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},aG=lm.length;function lG(t,{enableHardwareAcceleration:e=!0,allowTransformNone:n=!0},s,r){let i="";for(let o=0;o<aG;o++){const a=lm[o];if(t[a]!==void 0){const l=oG[a]||a;i+=`${l}(${t[a]}) `}}return e&&!t.z&&(i+="translateZ(0)"),i=i.trim(),r?i=r(t,s?"":i):n&&s&&(i="none"),i}const UP=t=>e=>typeof e=="string"&&e.startsWith(t),zP=UP("--"),cG=UP("var(--"),TI=t=>cG(t)?uG.test(t.split("/*")[0].trim()):!1,uG=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,hG=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Nl=(t,e,n)=>n>e?e:n<t?t:n,Nd={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},rp={...Nd,transform:t=>Nl(0,1,t)},R0={...Nd,default:1},ip=t=>Math.round(t*1e5)/1e5,EI=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,dG=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,fG=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu;function cm(t){return typeof t=="string"}const um=t=>({test:e=>cm(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),za=um("deg"),yo=um("%"),We=um("px"),pG=um("vh"),mG=um("vw"),X4={...yo,parse:t=>yo.parse(t)/100,transform:t=>yo.transform(t*100)},Y4={...Nd,transform:Math.round},WP={borderWidth:We,borderTopWidth:We,borderRightWidth:We,borderBottomWidth:We,borderLeftWidth:We,borderRadius:We,radius:We,borderTopLeftRadius:We,borderTopRightRadius:We,borderBottomRightRadius:We,borderBottomLeftRadius:We,width:We,maxWidth:We,height:We,maxHeight:We,size:We,top:We,right:We,bottom:We,left:We,padding:We,paddingTop:We,paddingRight:We,paddingBottom:We,paddingLeft:We,margin:We,marginTop:We,marginRight:We,marginBottom:We,marginLeft:We,rotate:za,rotateX:za,rotateY:za,rotateZ:za,scale:R0,scaleX:R0,scaleY:R0,scaleZ:R0,skew:za,skewX:za,skewY:za,distance:We,translateX:We,translateY:We,translateZ:We,x:We,y:We,z:We,perspective:We,transformPerspective:We,opacity:rp,originX:X4,originY:X4,originZ:We,zIndex:Y4,backgroundPositionX:We,backgroundPositionY:We,fillOpacity:rp,strokeOpacity:rp,numOctaves:Y4};function NI(t,e,n,s){const{style:r,vars:i,transform:o,transformOrigin:a}=t;let l=!1,c=!1,u=!0;for(const h in e){const d=e[h];if(zP(h)){i[h]=d;continue}const f=WP[h],p=hG(d,f);if(Cu.has(h)){if(l=!0,o[h]=p,!u)continue;d!==(f.default||0)&&(u=!1)}else h.startsWith("origin")?(c=!0,a[h]=p):r[h]=p}if(e.transform||(l||s?r.transform=lG(t.transform,n,u,s):r.transform&&(r.transform="none")),c){const{originX:h="50%",originY:d="50%",originZ:f=0}=a;r.transformOrigin=`${h} ${d} ${f}`}}const _I=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function jP(t,e,n){for(const s in e)!Rs(e[s])&&!VP(s,n)&&(t[s]=e[s])}function gG({transformTemplate:t},e,n){return J.useMemo(()=>{const s=_I();return NI(s,e,{enableHardwareAcceleration:!n},t),Object.assign({},s.vars,s.style)},[e])}function yG(t,e,n){const s=t.style||{},r={};return jP(r,s,t),Object.assign(r,gG(t,e,n)),r}function vG(t,e,n){const s={},r=yG(t,e,n);return t.drag&&t.dragListener!==!1&&(s.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(s.tabIndex=0),s.style=r,s}const xG=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function e2(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||xG.has(t)}let GP=t=>!e2(t);function wG(t){t&&(GP=e=>e.startsWith("on")?!e2(e):t(e))}try{wG(require("@emotion/is-prop-valid").default)}catch{}function bG(t,e,n){const s={};for(const r in t)r==="values"&&typeof t.values=="object"||(GP(r)||n===!0&&e2(r)||!e&&!e2(r)||t.draggable&&r.startsWith("onDrag"))&&(s[r]=t[r]);return s}function J4(t,e,n){return typeof t=="string"?t:We.transform(e+n*t)}function CG(t,e,n){const s=J4(e,t.x,t.width),r=J4(n,t.y,t.height);return`${s} ${r}`}const SG={offset:"stroke-dashoffset",array:"stroke-dasharray"},IG={offset:"strokeDashoffset",array:"strokeDasharray"};function kG(t,e,n=1,s=0,r=!0){t.pathLength=1;const i=r?SG:IG;t[i.offset]=We.transform(-s);const o=We.transform(e),a=We.transform(n);t[i.array]=`${o} ${a}`}function $I(t,{attrX:e,attrY:n,attrScale:s,originX:r,originY:i,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},u,h,d){if(NI(t,c,u,d),h){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:f,style:p,dimensions:g}=t;f.transform&&(g&&(p.transform=f.transform),delete f.transform),g&&(r!==void 0||i!==void 0||p.transform)&&(p.transformOrigin=CG(g,r!==void 0?r:.5,i!==void 0?i:.5)),e!==void 0&&(f.x=e),n!==void 0&&(f.y=n),s!==void 0&&(f.scale=s),o!==void 0&&kG(f,o,a,l,!1)}const HP=()=>({..._I(),attrs:{}}),RI=t=>typeof t=="string"&&t.toLowerCase()==="svg";function TG(t,e,n,s){const r=J.useMemo(()=>{const i=HP();return $I(i,e,{enableHardwareAcceleration:!1},RI(s),t.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};jP(i,t.style,t),r.style={...i,...r.style}}return r}function EG(t=!1){return(n,s,r,{latestValues:i},o)=>{const l=(kI(n)?TG:vG)(s,i,o,n),c=bG(s,typeof n=="string",t),u=n!==J.Fragment?{...c,...l,ref:r}:{},{children:h}=s,d=J.useMemo(()=>Rs(h)?h.get():h,[h]);return J.createElement(n,{...u,children:d})}}function KP(t,{style:e,vars:n},s,r){Object.assign(t.style,e,r&&r.getProjectionStyles(s));for(const i in n)t.style.setProperty(i,n[i])}const qP=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function XP(t,e,n,s){KP(t,e,void 0,s);for(const r in e.attrs)t.setAttribute(qP.has(r)?r:bI(r),e.attrs[r])}function AI(t,e,n){var s;const{style:r}=t,i={};for(const o in r)(Rs(r[o])||e.style&&Rs(e.style[o])||VP(o,t)||((s=n==null?void 0:n.getValue(o))===null||s===void 0?void 0:s.liveStyle)!==void 0)&&(i[o]=r[o]);return i}function YP(t,e,n){const s=AI(t,e,n);for(const r in t)if(Rs(t[r])||Rs(e[r])){const i=lm.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;s[i]=t[r]}return s}function Z4(t){const e=[{},{}];return t==null||t.values.forEach((n,s)=>{e[0][s]=n.get(),e[1][s]=n.getVelocity()}),e}function DI(t,e,n,s){if(typeof e=="function"){const[r,i]=Z4(s);e=e(n!==void 0?n:t.custom,r,i)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[r,i]=Z4(s);e=e(n!==void 0?n:t.custom,r,i)}return e}function JP(t){const e=J.useRef(null);return e.current===null&&(e.current=t()),e.current}const Jb=t=>Array.isArray(t),NG=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),_G=t=>Jb(t)?t[t.length-1]||0:t;function f1(t){const e=Rs(t)?t.get():t;return NG(e)?e.toValue():e}function $G({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},s,r,i){const o={latestValues:RG(s,r,i,t),renderState:e()};return n&&(o.mount=a=>n(s,a,o)),o}const ZP=t=>(e,n)=>{const s=J.useContext(vy),r=J.useContext(xy),i=()=>$G(t,e,s,r);return n?i():JP(i)};function RG(t,e,n,s){const r={},i=s(t,{});for(const d in i)r[d]=f1(i[d]);let{initial:o,animate:a}=t;const l=by(t),c=MP(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let u=n?n.initial===!1:!1;u=u||o===!1;const h=u?a:o;return h&&typeof h!="boolean"&&!wy(h)&&(Array.isArray(h)?h:[h]).forEach(f=>{const p=DI(t,f);if(!p)return;const{transitionEnd:g,transition:m,...y}=p;for(const w in y){let b=y[w];if(Array.isArray(b)){const C=u?b.length-1:0;b=b[C]}b!==null&&(r[w]=b)}for(const w in g)r[w]=g[w]}),r}const As=t=>t,{schedule:Et,cancel:ma,state:cs,steps:tw}=LP(typeof requestAnimationFrame<"u"?requestAnimationFrame:As,!0),AG={useVisualState:ZP({scrapeMotionValuesFromProps:YP,createRenderState:HP,onMount:(t,e,{renderState:n,latestValues:s})=>{Et.read(()=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),Et.render(()=>{$I(n,s,{enableHardwareAcceleration:!1},RI(e.tagName),t.transformTemplate),XP(e,n)})}})},DG={useVisualState:ZP({scrapeMotionValuesFromProps:AI,createRenderState:_I})};function PG(t,{forwardMotionProps:e=!1},n,s){return{...kI(t)?AG:DG,preloadedFeatures:n,useRender:EG(e),createVisualElement:s,Component:t}}function ta(t,e,n,s={passive:!0}){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n)}const QP=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function Cy(t,e="page"){return{point:{x:t[`${e}X`],y:t[`${e}Y`]}}}const OG=t=>e=>QP(e)&&t(e,Cy(e));function la(t,e,n,s){return ta(t,e,OG(n),s)}const FG=(t,e)=>n=>e(t(n)),ca=(...t)=>t.reduce(FG);function eO(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const Q4=eO("dragHorizontal"),eN=eO("dragVertical");function tO(t){let e=!1;if(t==="y")e=eN();else if(t==="x")e=Q4();else{const n=Q4(),s=eN();n&&s?e=()=>{n(),s()}:(n&&n(),s&&s())}return e}function nO(){const t=tO(!0);return t?(t(),!1):!0}class zl{constructor(e){this.isMounted=!1,this.node=e}update(){}}function tN(t,e){const n=e?"pointerenter":"pointerleave",s=e?"onHoverStart":"onHoverEnd",r=(i,o)=>{if(i.pointerType==="touch"||nO())return;const a=t.getProps();t.animationState&&a.whileHover&&t.animationState.setActive("whileHover",e);const l=a[s];l&&Et.postRender(()=>l(i,o))};return la(t.current,n,r,{passive:!t.getProps()[s]})}class LG extends zl{mount(){this.unmount=ca(tN(this.node,!0),tN(this.node,!1))}unmount(){}}class MG extends zl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ca(ta(this.node.current,"focus",()=>this.onFocus()),ta(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const sO=(t,e)=>e?t===e?!0:sO(t,e.parentElement):!1;function nw(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,Cy(n))}class BG extends zl{constructor(){super(...arguments),this.removeStartListeners=As,this.removeEndListeners=As,this.removeAccessibleListeners=As,this.startPointerPress=(e,n)=>{if(this.isPressing)return;this.removeEndListeners();const s=this.node.getProps(),i=la(window,"pointerup",(a,l)=>{if(!this.checkPressEnd())return;const{onTap:c,onTapCancel:u,globalTapTarget:h}=this.node.getProps(),d=!h&&!sO(this.node.current,a.target)?u:c;d&&Et.update(()=>d(a,l))},{passive:!(s.onTap||s.onPointerUp)}),o=la(window,"pointercancel",(a,l)=>this.cancelPress(a,l),{passive:!(s.onTapCancel||s.onPointerCancel)});this.removeEndListeners=ca(i,o),this.startPress(e,n)},this.startAccessiblePress=()=>{const e=i=>{if(i.key!=="Enter"||this.isPressing)return;const o=a=>{a.key!=="Enter"||!this.checkPressEnd()||nw("up",(l,c)=>{const{onTap:u}=this.node.getProps();u&&Et.postRender(()=>u(l,c))})};this.removeEndListeners(),this.removeEndListeners=ta(this.node.current,"keyup",o),nw("down",(a,l)=>{this.startPress(a,l)})},n=ta(this.node.current,"keydown",e),s=()=>{this.isPressing&&nw("cancel",(i,o)=>this.cancelPress(i,o))},r=ta(this.node.current,"blur",s);this.removeAccessibleListeners=ca(n,r)}}startPress(e,n){this.isPressing=!0;const{onTapStart:s,whileTap:r}=this.node.getProps();r&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),s&&Et.postRender(()=>s(e,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!nO()}cancelPress(e,n){if(!this.checkPressEnd())return;const{onTapCancel:s}=this.node.getProps();s&&Et.postRender(()=>s(e,n))}mount(){const e=this.node.getProps(),n=la(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),s=ta(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=ca(n,s)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Zb=new WeakMap,sw=new WeakMap,VG=t=>{const e=Zb.get(t.target);e&&e(t)},UG=t=>{t.forEach(VG)};function zG({root:t,...e}){const n=t||document;sw.has(n)||sw.set(n,{});const s=sw.get(n),r=JSON.stringify(e);return s[r]||(s[r]=new IntersectionObserver(UG,{root:t,...e})),s[r]}function WG(t,e,n){const s=zG(e);return Zb.set(t,n),s.observe(t),()=>{Zb.delete(t),s.unobserve(t)}}const jG={some:0,all:1};class GG extends zl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:s,amount:r="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:s,threshold:typeof r=="number"?r:jG[r]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),d=c?u:h;d&&d(l)};return WG(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(HG(e,n))&&this.startObserver()}unmount(){}}function HG({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const KG={inView:{Feature:GG},tap:{Feature:BG},focus:{Feature:MG},hover:{Feature:LG}};function rO(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s])return!1;return!0}function Sy(t,e,n){const s=t.getProps();return DI(s,e,n!==void 0?n:s.custom,t)}const gl=t=>t*1e3,ua=t=>t/1e3,qG={type:"spring",stiffness:500,damping:25,restSpeed:10},XG=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),YG={type:"keyframes",duration:.8},JG={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},ZG=(t,{keyframes:e})=>e.length>2?YG:Cu.has(t)?t.startsWith("scale")?XG(e[1]):qG:JG;function QG({when:t,delay:e,delayChildren:n,staggerChildren:s,staggerDirection:r,repeat:i,repeatType:o,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function PI(t,e){return t[e]||t.default||t}const eH=t=>t!==null;function Iy(t,{repeat:e,repeatType:n="loop"},s){const r=t.filter(eH),i=e&&n!=="loop"&&e%2===1?0:r.length-1;return!i||s===void 0?r[i]:s}let p1;function tH(){p1=void 0}const yl={now:()=>(p1===void 0&&yl.set(cs.isProcessing||Hj.useManualTiming?cs.timestamp:performance.now()),p1),set:t=>{p1=t,queueMicrotask(tH)}},iO=t=>/^0[^.\s]+$/u.test(t);function nH(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||iO(t):!0}let Qb=As;const oO=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),sH=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function rH(t){const e=sH.exec(t);if(!e)return[,];const[,n,s,r]=e;return[`--${n??s}`,r]}function aO(t,e,n=1){const[s,r]=rH(t);if(!s)return;const i=window.getComputedStyle(e).getPropertyValue(s);if(i){const o=i.trim();return oO(o)?parseFloat(o):o}return TI(r)?aO(r,e,n+1):r}const iH=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),nN=t=>t===Nd||t===We,sN=(t,e)=>parseFloat(t.split(", ")[e]),rN=(t,e)=>(n,{transform:s})=>{if(s==="none"||!s)return 0;const r=s.match(/^matrix3d\((.+)\)$/u);if(r)return sN(r[1],e);{const i=s.match(/^matrix\((.+)\)$/u);return i?sN(i[1],t):0}},oH=new Set(["x","y","z"]),aH=lm.filter(t=>!oH.has(t));function lH(t){const e=[];return aH.forEach(n=>{const s=t.getValue(n);s!==void 0&&(e.push([n,s.get()]),s.set(n.startsWith("scale")?1:0))}),e}const od={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:rN(4,13),y:rN(5,14)};od.translateX=od.x;od.translateY=od.y;const lO=t=>e=>e.test(t),cH={test:t=>t==="auto",parse:t=>t},cO=[Nd,We,yo,za,mG,pG,cH],iN=t=>cO.find(lO(t)),Wc=new Set;let eC=!1,tC=!1;function uO(){if(tC){const t=Array.from(Wc).filter(s=>s.needsMeasurement),e=new Set(t.map(s=>s.element)),n=new Map;e.forEach(s=>{const r=lH(s);r.length&&(n.set(s,r),s.render())}),t.forEach(s=>s.measureInitialState()),e.forEach(s=>{s.render();const r=n.get(s);r&&r.forEach(([i,o])=>{var a;(a=s.getValue(i))===null||a===void 0||a.set(o)})}),t.forEach(s=>s.measureEndState()),t.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}tC=!1,eC=!1,Wc.forEach(t=>t.complete()),Wc.clear()}function hO(){Wc.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(tC=!0)})}function uH(){hO(),uO()}class OI{constructor(e,n,s,r,i,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=s,this.motionValue=r,this.element=i,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Wc.add(this),eC||(eC=!0,Et.read(hO),Et.resolveKeyframes(uO))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:s,motionValue:r}=this;for(let i=0;i<e.length;i++)if(e[i]===null)if(i===0){const o=r==null?void 0:r.get(),a=e[e.length-1];if(o!==void 0)e[0]=o;else if(s&&n){const l=s.readValue(n,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),r&&o===void 0&&r.set(e[0])}else e[i]=e[i-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Wc.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Wc.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const FI=(t,e)=>n=>!!(cm(n)&&fG.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),dO=(t,e,n)=>s=>{if(!cm(s))return s;const[r,i,o,a]=s.match(EI);return{[t]:parseFloat(r),[e]:parseFloat(i),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},hH=t=>Nl(0,255,t),rw={...Nd,transform:t=>Math.round(hH(t))},Oc={test:FI("rgb","red"),parse:dO("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:s=1})=>"rgba("+rw.transform(t)+", "+rw.transform(e)+", "+rw.transform(n)+", "+ip(rp.transform(s))+")"};function dH(t){let e="",n="",s="",r="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),s=t.substring(5,7),r=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),s=t.substring(3,4),r=t.substring(4,5),e+=e,n+=n,s+=s,r+=r),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(s,16),alpha:r?parseInt(r,16)/255:1}}const nC={test:FI("#"),parse:dH,transform:Oc.transform},Eh={test:FI("hsl","hue"),parse:dO("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:s=1})=>"hsla("+Math.round(t)+", "+yo.transform(ip(e))+", "+yo.transform(ip(n))+", "+ip(rp.transform(s))+")"},Ss={test:t=>Oc.test(t)||nC.test(t)||Eh.test(t),parse:t=>Oc.test(t)?Oc.parse(t):Eh.test(t)?Eh.parse(t):nC.parse(t),transform:t=>cm(t)?t:t.hasOwnProperty("red")?Oc.transform(t):Eh.transform(t)};function fH(t){var e,n;return isNaN(t)&&cm(t)&&(((e=t.match(EI))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(dG))===null||n===void 0?void 0:n.length)||0)>0}const fO="number",pO="color",pH="var",mH="var(",oN="${}",gH=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Op(t){const e=t.toString(),n=[],s={color:[],number:[],var:[]},r=[];let i=0;const a=e.replace(gH,l=>(Ss.test(l)?(s.color.push(i),r.push(pO),n.push(Ss.parse(l))):l.startsWith(mH)?(s.var.push(i),r.push(pH),n.push(l)):(s.number.push(i),r.push(fO),n.push(parseFloat(l))),++i,oN)).split(oN);return{values:n,split:a,indexes:s,types:r}}function mO(t){return Op(t).values}function gO(t){const{split:e,types:n}=Op(t),s=e.length;return r=>{let i="";for(let o=0;o<s;o++)if(i+=e[o],r[o]!==void 0){const a=n[o];a===fO?i+=ip(r[o]):a===pO?i+=Ss.transform(r[o]):i+=r[o]}return i}}const yH=t=>typeof t=="number"?0:t;function vH(t){const e=mO(t);return gO(t)(e.map(yH))}const _l={test:fH,parse:mO,createTransformer:gO,getAnimatableNone:vH},xH=new Set(["brightness","contrast","saturate","opacity"]);function wH(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[s]=n.match(EI)||[];if(!s)return t;const r=n.replace(s,"");let i=xH.has(e)?1:0;return s!==n&&(i*=100),e+"("+i+r+")"}const bH=/\b([a-z-]*)\(.*?\)/gu,sC={..._l,getAnimatableNone:t=>{const e=t.match(bH);return e?e.map(wH).join(" "):t}},CH={...WP,color:Ss,backgroundColor:Ss,outlineColor:Ss,fill:Ss,stroke:Ss,borderColor:Ss,borderTopColor:Ss,borderRightColor:Ss,borderBottomColor:Ss,borderLeftColor:Ss,filter:sC,WebkitFilter:sC},LI=t=>CH[t];function yO(t,e){let n=LI(t);return n!==sC&&(n=_l),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const SH=new Set(["auto","none","0"]);function IH(t,e,n){let s=0,r;for(;s<t.length&&!r;){const i=t[s];typeof i=="string"&&!SH.has(i)&&Op(i).values.length&&(r=t[s]),s++}if(r&&n)for(const i of e)t[i]=yO(n,r)}class vO extends OI{constructor(e,n,s,r){super(e,n,s,r,r==null?void 0:r.owner,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:s}=this;if(!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),TI(c))){const u=aO(c,n.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!iH.has(s)||e.length!==2)return;const[r,i]=e,o=iN(r),a=iN(i);if(o!==a)if(nN(o)&&nN(a))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,s=[];for(let r=0;r<e.length;r++)nH(e[r])&&s.push(r);s.length&&IH(e,s,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:s}=this;if(!e.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=od[s](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const r=n[n.length-1];r!==void 0&&e.getValue(s,r).jump(r,!1)}measureEndState(){var e;const{element:n,name:s,unresolvedKeyframes:r}=this;if(!n.current)return;const i=n.getValue(s);i&&i.jump(this.measuredOrigin,!1);const o=r.length-1,a=r[o];r[o]=od[s](n.measureViewportBox(),window.getComputedStyle(n.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{n.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function xO(t){let e;return()=>(e===void 0&&(e=t()),e)}const aN=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(_l.test(t)||t==="0")&&!t.startsWith("url("));function kH(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function TH(t,e,n,s){const r=t[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const i=t[t.length-1],o=aN(r,e),a=aN(i,e);return!o||!a?!1:kH(t)||n==="spring"&&s}class wO{constructor({autoplay:e=!0,delay:n=0,type:s="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.options={autoplay:e,delay:n,type:s,repeat:r,repeatDelay:i,repeatType:o,...a},this.updateFinishedPromise()}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&uH(),this._resolved}onKeyframesResolved(e,n){this.hasAttemptedResolve=!0;const{name:s,type:r,velocity:i,delay:o,onComplete:a,onUpdate:l,isGenerator:c}=this.options;if(!c&&!TH(e,s,r,i))if(o)this.options.duration=0;else{l==null||l(Iy(e,this.options,n)),a==null||a(),this.resolveFinishedPromise();return}const u=this.initPlayback(e,n);u!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...u},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}function bO(t,e){return e?t*(1e3/e):0}const EH=5;function CO(t,e,n){const s=Math.max(e-EH,0);return bO(n-t(s),e-s)}const iw=.001,NH=.01,_H=10,$H=.05,RH=1;function AH({duration:t=800,bounce:e=.25,velocity:n=0,mass:s=1}){let r,i,o=1-e;o=Nl($H,RH,o),t=Nl(NH,_H,ua(t)),o<1?(r=c=>{const u=c*o,h=u*t,d=u-n,f=rC(c,o),p=Math.exp(-h);return iw-d/f*p},i=c=>{const h=c*o*t,d=h*n+n,f=Math.pow(o,2)*Math.pow(c,2)*t,p=Math.exp(-h),g=rC(Math.pow(c,2),o);return(-r(c)+iw>0?-1:1)*((d-f)*p)/g}):(r=c=>{const u=Math.exp(-c*t),h=(c-n)*t+1;return-iw+u*h},i=c=>{const u=Math.exp(-c*t),h=(n-c)*(t*t);return u*h});const a=5/t,l=PH(r,i,a);if(t=gl(t),isNaN(l))return{stiffness:100,damping:10,duration:t};{const c=Math.pow(l,2)*s;return{stiffness:c,damping:o*2*Math.sqrt(s*c),duration:t}}}const DH=12;function PH(t,e,n){let s=n;for(let r=1;r<DH;r++)s=s-t(s)/e(s);return s}function rC(t,e){return t*Math.sqrt(1-e*e)}const OH=["duration","bounce"],FH=["stiffness","damping","mass"];function lN(t,e){return e.some(n=>t[n]!==void 0)}function LH(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!lN(t,FH)&&lN(t,OH)){const n=AH(t);e={...e,...n,mass:1},e.isResolvedFromDuration=!0}return e}function SO({keyframes:t,restDelta:e,restSpeed:n,...s}){const r=t[0],i=t[t.length-1],o={done:!1,value:r},{stiffness:a,damping:l,mass:c,duration:u,velocity:h,isResolvedFromDuration:d}=LH({...s,velocity:-ua(s.velocity||0)}),f=h||0,p=l/(2*Math.sqrt(a*c)),g=i-r,m=ua(Math.sqrt(a/c)),y=Math.abs(g)<5;n||(n=y?.01:2),e||(e=y?.005:.5);let w;if(p<1){const b=rC(m,p);w=C=>{const k=Math.exp(-p*m*C);return i-k*((f+p*m*g)/b*Math.sin(b*C)+g*Math.cos(b*C))}}else if(p===1)w=b=>i-Math.exp(-m*b)*(g+(f+m*g)*b);else{const b=m*Math.sqrt(p*p-1);w=C=>{const k=Math.exp(-p*m*C),$=Math.min(b*C,300);return i-k*((f+p*m*g)*Math.sinh($)+b*g*Math.cosh($))/b}}return{calculatedDuration:d&&u||null,next:b=>{const C=w(b);if(d)o.done=b>=u;else{let k=f;b!==0&&(p<1?k=CO(w,b,C):k=0);const $=Math.abs(k)<=n,I=Math.abs(i-C)<=e;o.done=$&&I}return o.value=o.done?i:C,o}}}function cN({keyframes:t,velocity:e=0,power:n=.8,timeConstant:s=325,bounceDamping:r=10,bounceStiffness:i=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:u}){const h=t[0],d={done:!1,value:h},f=T=>a!==void 0&&T<a||l!==void 0&&T>l,p=T=>a===void 0?l:l===void 0||Math.abs(a-T)<Math.abs(l-T)?a:l;let g=n*e;const m=h+g,y=o===void 0?m:o(m);y!==m&&(g=y-h);const w=T=>-g*Math.exp(-T/s),b=T=>y+w(T),C=T=>{const R=w(T),E=b(T);d.done=Math.abs(R)<=c,d.value=d.done?y:E};let k,$;const I=T=>{f(d.value)&&(k=T,$=SO({keyframes:[d.value,p(d.value)],velocity:CO(b,T,d.value),damping:r,stiffness:i,restDelta:c,restSpeed:u}))};return I(0),{calculatedDuration:null,next:T=>{let R=!1;return!$&&k===void 0&&(R=!0,C(T),I(T)),k!==void 0&&T>=k?$.next(T-k):(!R&&C(T),d)}}}const IO=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,MH=1e-7,BH=12;function VH(t,e,n,s,r){let i,o,a=0;do o=e+(n-e)/2,i=IO(o,s,r)-t,i>0?n=o:e=o;while(Math.abs(i)>MH&&++a<BH);return o}function hm(t,e,n,s){if(t===e&&n===s)return As;const r=i=>VH(i,0,1,t,n);return i=>i===0||i===1?i:IO(r(i),e,s)}const UH=hm(.42,0,1,1),zH=hm(0,0,.58,1),kO=hm(.42,0,.58,1),WH=t=>Array.isArray(t)&&typeof t[0]!="number",TO=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,EO=t=>e=>1-t(1-e),MI=t=>1-Math.sin(Math.acos(t)),NO=EO(MI),jH=TO(MI),_O=hm(.33,1.53,.69,.99),BI=EO(_O),GH=TO(BI),HH=t=>(t*=2)<1?.5*BI(t):.5*(2-Math.pow(2,-10*(t-1))),uN={linear:As,easeIn:UH,easeInOut:kO,easeOut:zH,circIn:MI,circInOut:jH,circOut:NO,backIn:BI,backInOut:GH,backOut:_O,anticipate:HH},hN=t=>{if(Array.isArray(t)){Qb(t.length===4);const[e,n,s,r]=t;return hm(e,n,s,r)}else if(typeof t=="string")return Qb(uN[t]!==void 0),uN[t];return t},Fp=(t,e,n)=>{const s=e-t;return s===0?1:(n-t)/s},en=(t,e,n)=>t+(e-t)*n;function ow(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function KH({hue:t,saturation:e,lightness:n,alpha:s}){t/=360,e/=100,n/=100;let r=0,i=0,o=0;if(!e)r=i=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;r=ow(l,a,t+1/3),i=ow(l,a,t),o=ow(l,a,t-1/3)}return{red:Math.round(r*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:s}}function t2(t,e){return n=>n>0?e:t}const aw=(t,e,n)=>{const s=t*t,r=n*(e*e-s)+s;return r<0?0:Math.sqrt(r)},qH=[nC,Oc,Eh],XH=t=>qH.find(e=>e.test(t));function dN(t){const e=XH(t);if(!e)return!1;let n=e.parse(t);return e===Eh&&(n=KH(n)),n}const fN=(t,e)=>{const n=dN(t),s=dN(e);if(!n||!s)return t2(t,e);const r={...n};return i=>(r.red=aw(n.red,s.red,i),r.green=aw(n.green,s.green,i),r.blue=aw(n.blue,s.blue,i),r.alpha=en(n.alpha,s.alpha,i),Oc.transform(r))},iC=new Set(["none","hidden"]);function YH(t,e){return iC.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function JH(t,e){return n=>en(t,e,n)}function VI(t){return typeof t=="number"?JH:typeof t=="string"?TI(t)?t2:Ss.test(t)?fN:eK:Array.isArray(t)?$O:typeof t=="object"?Ss.test(t)?fN:ZH:t2}function $O(t,e){const n=[...t],s=n.length,r=t.map((i,o)=>VI(i)(i,e[o]));return i=>{for(let o=0;o<s;o++)n[o]=r[o](i);return n}}function ZH(t,e){const n={...t,...e},s={};for(const r in n)t[r]!==void 0&&e[r]!==void 0&&(s[r]=VI(t[r])(t[r],e[r]));return r=>{for(const i in s)n[i]=s[i](r);return n}}function QH(t,e){var n;const s=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const o=e.types[i],a=t.indexes[o][r[o]],l=(n=t.values[a])!==null&&n!==void 0?n:0;s[i]=l,r[o]++}return s}const eK=(t,e)=>{const n=_l.createTransformer(e),s=Op(t),r=Op(e);return s.indexes.var.length===r.indexes.var.length&&s.indexes.color.length===r.indexes.color.length&&s.indexes.number.length>=r.indexes.number.length?iC.has(t)&&!r.values.length||iC.has(e)&&!s.values.length?YH(t,e):ca($O(QH(s,r),r.values),n):t2(t,e)};function RO(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?en(t,e,n):VI(t)(t,e)}function tK(t,e,n){const s=[],r=n||RO,i=t.length-1;for(let o=0;o<i;o++){let a=r(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||As:e;a=ca(l,a)}s.push(a)}return s}function nK(t,e,{clamp:n=!0,ease:s,mixer:r}={}){const i=t.length;if(Qb(i===e.length),i===1)return()=>e[0];if(i===2&&t[0]===t[1])return()=>e[1];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=tK(e,s,r),a=o.length,l=c=>{let u=0;if(a>1)for(;u<t.length-2&&!(c<t[u+1]);u++);const h=Fp(t[u],t[u+1],c);return o[u](h)};return n?c=>l(Nl(t[0],t[i-1],c)):l}function sK(t,e){const n=t[t.length-1];for(let s=1;s<=e;s++){const r=Fp(0,e,s);t.push(en(n,1,r))}}function rK(t){const e=[0];return sK(e,t.length-1),e}function iK(t,e){return t.map(n=>n*e)}function oK(t,e){return t.map(()=>e||kO).splice(0,t.length-1)}function n2({duration:t=300,keyframes:e,times:n,ease:s="easeInOut"}){const r=WH(s)?s.map(hN):hN(s),i={done:!1,value:e[0]},o=iK(n&&n.length===e.length?n:rK(e),t),a=nK(o,e,{ease:Array.isArray(r)?r:oK(e,r)});return{calculatedDuration:t,next:l=>(i.value=a(l),i.done=l>=t,i)}}const pN=2e4;function aK(t){let e=0;const n=50;let s=t.next(e);for(;!s.done&&e<pN;)e+=n,s=t.next(e);return e>=pN?1/0:e}const lK=t=>{const e=({timestamp:n})=>t(n);return{start:()=>Et.update(e,!0),stop:()=>ma(e),now:()=>cs.isProcessing?cs.timestamp:yl.now()}},cK={decay:cN,inertia:cN,tween:n2,keyframes:n2,spring:SO},uK=t=>t/100;class UI extends wO{constructor({KeyframeResolver:e=OI,...n}){super(n),this.holdTime=null,this.startTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:a}=this.options;a&&a()};const{name:s,motionValue:r,keyframes:i}=this.options,o=(a,l)=>this.onKeyframesResolved(a,l);s&&r&&r.owner?this.resolver=r.owner.resolveKeyframes(i,o,s,r):this.resolver=new e(i,o,s,r),this.resolver.scheduleResolve()}initPlayback(e){const{type:n="keyframes",repeat:s=0,repeatDelay:r=0,repeatType:i,velocity:o=0}=this.options,a=cK[n]||n2;let l,c;a!==n2&&typeof e[0]!="number"&&(l=ca(uK,RO(e[0],e[1])),e=[0,100]);const u=a({...this.options,keyframes:e});i==="mirror"&&(c=a({...this.options,keyframes:[...e].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=aK(u));const{calculatedDuration:h}=u,d=h+r,f=d*(s+1)-r;return{generator:u,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:h,resolvedDuration:d,totalDuration:f}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:s}=this;if(!s){const{keyframes:T}=this.options;return{done:!0,value:T[T.length-1]}}const{finalKeyframe:r,generator:i,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:c,totalDuration:u,resolvedDuration:h}=s;if(this.startTime===null)return i.next(0);const{delay:d,repeat:f,repeatType:p,repeatDelay:g,onUpdate:m}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-u/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const y=this.currentTime-d*(this.speed>=0?1:-1),w=this.speed>=0?y<0:y>u;this.currentTime=Math.max(y,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let b=this.currentTime,C=i;if(f){const T=Math.min(this.currentTime,u)/h;let R=Math.floor(T),E=T%1;!E&&T>=1&&(E=1),E===1&&R--,R=Math.min(R,f+1),!!(R%2)&&(p==="reverse"?(E=1-E,g&&(E-=g/h)):p==="mirror"&&(C=o)),b=Nl(0,1,E)*h}const k=w?{done:!1,value:l[0]}:C.next(b);a&&(k.value=a(k.value));let{done:$}=k;!w&&c!==null&&($=this.speed>=0?this.currentTime>=u:this.currentTime<=0);const I=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&$);return I&&r!==void 0&&(k.value=Iy(l,this.options,r)),m&&m(k.value),I&&this.finish(),k}get duration(){const{resolved:e}=this;return e?ua(e.calculatedDuration):0}get time(){return ua(this.currentTime)}set time(e){e=gl(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=ua(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=lK,onPlay:n}=this.options;this.driver||(this.driver=e(r=>this.tick(r))),n&&n();const s=this.driver.now();this.holdTime!==null?this.startTime=s-this.holdTime:(!this.startTime||this.state==="finished")&&(this.startTime=s),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const AO=t=>Array.isArray(t)&&typeof t[0]=="number";function DO(t){return!!(!t||typeof t=="string"&&t in zI||AO(t)||Array.isArray(t)&&t.every(DO))}const Ff=([t,e,n,s])=>`cubic-bezier(${t}, ${e}, ${n}, ${s})`,zI={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Ff([0,.65,.55,1]),circOut:Ff([.55,0,1,.45]),backIn:Ff([.31,.01,.66,-.59]),backOut:Ff([.33,1.53,.69,.99])};function hK(t){return PO(t)||zI.easeOut}function PO(t){if(t)return AO(t)?Ff(t):Array.isArray(t)?t.map(hK):zI[t]}function dK(t,e,n,{delay:s=0,duration:r=300,repeat:i=0,repeatType:o="loop",ease:a,times:l}={}){const c={[e]:n};l&&(c.offset=l);const u=PO(a);return Array.isArray(u)&&(c.easing=u),t.animate(c,{delay:s,duration:r,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}const fK=xO(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),pK=new Set(["opacity","clipPath","filter","transform"]),s2=10,mK=2e4;function gK(t){return t.type==="spring"||t.name==="backgroundColor"||!DO(t.ease)}function yK(t,e){const n=new UI({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let s={done:!1,value:t[0]};const r=[];let i=0;for(;!s.done&&i<mK;)s=n.sample(i),r.push(s.value),i+=s2;return{times:void 0,keyframes:r,duration:i-s2,ease:"linear"}}class mN extends wO{constructor(e){super(e);const{name:n,motionValue:s,keyframes:r}=this.options;this.resolver=new vO(r,(i,o)=>this.onKeyframesResolved(i,o),n,s),this.resolver.scheduleResolve()}initPlayback(e,n){var s;let{duration:r=300,times:i,ease:o,type:a,motionValue:l,name:c}=this.options;if(!(!((s=l.owner)===null||s===void 0)&&s.current))return!1;if(gK(this.options)){const{onComplete:h,onUpdate:d,motionValue:f,...p}=this.options,g=yK(e,p);e=g.keyframes,e.length===1&&(e[1]=e[0]),r=g.duration,i=g.times,o=g.ease,a="keyframes"}const u=dK(l.owner.current,c,e,{...this.options,duration:r,times:i,ease:o});return u.startTime=yl.now(),this.pendingTimeline?(u.timeline=this.pendingTimeline,this.pendingTimeline=void 0):u.onfinish=()=>{const{onComplete:h}=this.options;l.set(Iy(e,this.options,n)),h&&h(),this.cancel(),this.resolveFinishedPromise()},{animation:u,duration:r,times:i,type:a,ease:o,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return ua(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return ua(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.currentTime=gl(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return As;const{animation:s}=n;s.timeline=e,s.onfinish=null}return As}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:s,duration:r,type:i,ease:o,times:a}=e;if(!(n.playState==="idle"||n.playState==="finished")){if(this.time){const{motionValue:l,onUpdate:c,onComplete:u,...h}=this.options,d=new UI({...h,keyframes:s,duration:r,type:i,ease:o,times:a,isGenerator:!0}),f=gl(this.time);l.setWithVelocity(d.sample(f-s2).value,d.sample(f).value,s2)}this.cancel()}}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:s,repeatDelay:r,repeatType:i,damping:o,type:a}=e;return fK()&&s&&pK.has(s)&&n&&n.owner&&n.owner.current instanceof HTMLElement&&!n.owner.getProps().onUpdate&&!r&&i!=="mirror"&&o!==0&&a!=="inertia"}}function vK(t,e){let n;const s=()=>{const{currentTime:r}=e,o=(r===null?0:r.value)/100;n!==o&&t(o),n=o};return Et.update(s,!0),()=>ma(s)}const xK=xO(()=>window.ScrollTimeline!==void 0);class wK{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}then(e,n){return Promise.all(this.animations).then(e).catch(n)}getAll(e){return this.animations[0][e]}setAll(e,n){for(let s=0;s<this.animations.length;s++)this.animations[s][e]=n}attachTimeline(e){const n=this.animations.map(s=>{if(xK()&&s.attachTimeline)s.attachTimeline(e);else return s.pause(),vK(r=>{s.time=s.duration*r},e)});return()=>{n.forEach((s,r)=>{s&&s(),this.animations[r].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}const WI=(t,e,n,s={},r,i)=>o=>{const a=PI(s,t)||{},l=a.delay||s.delay||0;let{elapsed:c=0}=s;c=c-gl(l);let u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-c,onUpdate:d=>{e.set(d),a.onUpdate&&a.onUpdate(d)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:i?void 0:r};QG(a)||(u={...u,...ZG(t,u)}),u.duration&&(u.duration=gl(u.duration)),u.repeatDelay&&(u.repeatDelay=gl(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let h=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(h=!0)),h&&!i&&e.get()!==void 0){const d=Iy(u.keyframes,a);if(d!==void 0)return Et.update(()=>{u.onUpdate(d),u.onComplete()}),new wK([])}return!i&&mN.supports(u)?new mN(u):new UI(u)};function r2(t){return!!(Rs(t)&&t.add)}function jI(t,e){t.indexOf(e)===-1&&t.push(e)}function GI(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class HI{constructor(){this.subscriptions=[]}add(e){return jI(this.subscriptions,e),()=>GI(this.subscriptions,e)}notify(e,n,s){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,n,s);else for(let i=0;i<r;i++){const o=this.subscriptions[i];o&&o(e,n,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const gN=30,bK=t=>!isNaN(parseFloat(t));class CK{constructor(e,n={}){this.version="11.2.10",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(s,r=!0)=>{const i=yl.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=yl.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=bK(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new HI);const s=this.events[e].add(n);return e==="change"?()=>{s(),Et.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,s){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=yl.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>gN)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,gN);return bO(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Lp(t,e){return new CK(t,e)}function SK(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Lp(n))}function IK(t,e){const n=Sy(t,e);let{transitionEnd:s={},transition:r={},...i}=n||{};i={...i,...s};for(const o in i){const a=_G(i[o]);SK(t,o,a)}}function OO(t){return t.getProps()[FP]}function kK({protectedKeys:t,needsAnimating:e},n){const s=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,s}function FO(t,e,{delay:n=0,transitionOverride:s,type:r}={}){var i;let{transition:o=t.getDefaultTransition(),transitionEnd:a,...l}=e;const c=t.getValue("willChange");s&&(o=s);const u=[],h=r&&t.animationState&&t.animationState.getState()[r];for(const d in l){const f=t.getValue(d,(i=t.latestValues[d])!==null&&i!==void 0?i:null),p=l[d];if(p===void 0||h&&kK(h,d))continue;const g={delay:n,elapsed:0,...PI(o||{},d)};let m=!1;if(window.HandoffAppearAnimations){const w=OO(t);if(w){const b=window.HandoffAppearAnimations(w,d,f,Et);b!==null&&(g.elapsed=b,m=!0)}}f.start(WI(d,f,p,t.shouldReduceMotion&&Cu.has(d)?{type:!1}:g,t,m));const y=f.animation;y&&(r2(c)&&(c.add(d),y.then(()=>c.remove(d))),u.push(y))}return a&&Promise.all(u).then(()=>{Et.update(()=>{a&&IK(t,a)})}),u}function oC(t,e,n={}){var s;const r=Sy(t,e,n.type==="exit"?(s=t.presenceContext)===null||s===void 0?void 0:s.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(i=n.transitionOverride);const o=r?()=>Promise.all(FO(t,r,n)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:h,staggerDirection:d}=i;return TK(t,e,u+c,h,d,n)}:()=>Promise.resolve(),{when:l}=i;if(l){const[c,u]=l==="beforeChildren"?[o,a]:[a,o];return c().then(()=>u())}else return Promise.all([o(),a(n.delay)])}function TK(t,e,n=0,s=0,r=1,i){const o=[],a=(t.variantChildren.size-1)*s,l=r===1?(c=0)=>c*s:(c=0)=>a-c*s;return Array.from(t.variantChildren).sort(EK).forEach((c,u)=>{c.notify("AnimationStart",e),o.push(oC(c,e,{...i,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function EK(t,e){return t.sortNodePosition(e)}function NK(t,e,n={}){t.notify("AnimationStart",e);let s;if(Array.isArray(e)){const r=e.map(i=>oC(t,i,n));s=Promise.all(r)}else if(typeof e=="string")s=oC(t,e,n);else{const r=typeof e=="function"?Sy(t,e,n.custom):e;s=Promise.all(FO(t,r,n))}return s.then(()=>{Et.postRender(()=>{t.notify("AnimationComplete",e)})})}const _K=[...SI].reverse(),$K=SI.length;function RK(t){return e=>Promise.all(e.map(({animation:n,options:s})=>NK(t,n,s)))}function AK(t){let e=RK(t);const n=PK();let s=!0;const r=l=>(c,u)=>{var h;const d=Sy(t,u,l==="exit"?(h=t.presenceContext)===null||h===void 0?void 0:h.custom:void 0);if(d){const{transition:f,transitionEnd:p,...g}=d;c={...c,...g,...p}}return c};function i(l){e=l(t)}function o(l){const c=t.getProps(),u=t.getVariantContext(!0)||{},h=[],d=new Set;let f={},p=1/0;for(let m=0;m<$K;m++){const y=_K[m],w=n[y],b=c[y]!==void 0?c[y]:u[y],C=Ap(b),k=y===l?w.isActive:null;k===!1&&(p=m);let $=b===u[y]&&b!==c[y]&&C;if($&&s&&t.manuallyAnimateOnMount&&($=!1),w.protectedKeys={...f},!w.isActive&&k===null||!b&&!w.prevProp||wy(b)||typeof b=="boolean")continue;let T=DK(w.prevProp,b)||y===l&&w.isActive&&!$&&C||m>p&&C,R=!1;const E=Array.isArray(b)?b:[b];let A=E.reduce(r(y),{});k===!1&&(A={});const{prevResolvedValues:F={}}=w,P={...F,...A},Z=H=>{T=!0,d.has(H)&&(R=!0,d.delete(H)),w.needsAnimating[H]=!0;const j=t.getValue(H);j&&(j.liveStyle=!1)};for(const H in P){const j=A[H],ee=F[H];if(f.hasOwnProperty(H))continue;let z=!1;Jb(j)&&Jb(ee)?z=!rO(j,ee):z=j!==ee,z?j!=null?Z(H):d.add(H):j!==void 0&&d.has(H)?Z(H):w.protectedKeys[H]=!0}w.prevProp=b,w.prevResolvedValues=A,w.isActive&&(f={...f,...A}),s&&t.blockInitialAnimation&&(T=!1),T&&(!$||R)&&h.push(...E.map(H=>({animation:H,options:{type:y}})))}if(d.size){const m={};d.forEach(y=>{const w=t.getBaseTarget(y),b=t.getValue(y);b&&(b.liveStyle=!0),m[y]=w??null}),h.push({animation:m})}let g=!!h.length;return s&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(g=!1),s=!1,g?e(h):Promise.resolve()}function a(l,c){var u;if(n[l].isActive===c)return Promise.resolve();(u=t.variantChildren)===null||u===void 0||u.forEach(d=>{var f;return(f=d.animationState)===null||f===void 0?void 0:f.setActive(l,c)}),n[l].isActive=c;const h=o(l);for(const d in n)n[d].protectedKeys={};return h}return{animateChanges:o,setActive:a,setAnimateFunction:i,getState:()=>n}}function DK(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!rO(e,t):!1}function vc(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function PK(){return{animate:vc(!0),whileInView:vc(),whileHover:vc(),whileTap:vc(),whileDrag:vc(),whileFocus:vc(),exit:vc()}}class OK extends zl{constructor(e){super(e),e.animationState||(e.animationState=AK(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),wy(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let FK=0;class LK extends zl{constructor(){super(...arguments),this.id=FK++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const r=this.node.animationState.setActive("exit",!e);n&&!e&&r.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const MK={animation:{Feature:OK},exit:{Feature:LK}},yN=(t,e)=>Math.abs(t-e);function BK(t,e){const n=yN(t.x,e.x),s=yN(t.y,e.y);return Math.sqrt(n**2+s**2)}class LO{constructor(e,n,{transformPagePoint:s,contextWindow:r,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=cw(this.lastMoveEventInfo,this.history),d=this.startEvent!==null,f=BK(h.offset,{x:0,y:0})>=3;if(!d&&!f)return;const{point:p}=h,{timestamp:g}=cs;this.history.push({...p,timestamp:g});const{onStart:m,onMove:y}=this.handlers;d||(m&&m(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),y&&y(this.lastMoveEvent,h)},this.handlePointerMove=(h,d)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=lw(d,this.transformPagePoint),Et.update(this.updatePoint,!0)},this.handlePointerUp=(h,d)=>{this.end();const{onEnd:f,onSessionEnd:p,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=cw(h.type==="pointercancel"?this.lastMoveEventInfo:lw(d,this.transformPagePoint),this.history);this.startEvent&&f&&f(h,m),p&&p(h,m)},!QP(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=s,this.contextWindow=r||window;const o=Cy(e),a=lw(o,this.transformPagePoint),{point:l}=a,{timestamp:c}=cs;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(e,cw(a,this.history)),this.removeListeners=ca(la(this.contextWindow,"pointermove",this.handlePointerMove),la(this.contextWindow,"pointerup",this.handlePointerUp),la(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),ma(this.updatePoint)}}function lw(t,e){return e?{point:e(t.point)}:t}function vN(t,e){return{x:t.x-e.x,y:t.y-e.y}}function cw({point:t},e){return{point:t,delta:vN(t,MO(e)),offset:vN(t,VK(e)),velocity:UK(e,.1)}}function VK(t){return t[0]}function MO(t){return t[t.length-1]}function UK(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,s=null;const r=MO(t);for(;n>=0&&(s=t[n],!(r.timestamp-s.timestamp>gl(e)));)n--;if(!s)return{x:0,y:0};const i=ua(r.timestamp-s.timestamp);if(i===0)return{x:0,y:0};const o={x:(r.x-s.x)/i,y:(r.y-s.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function zr(t){return t.max-t.min}function aC(t,e=0,n=.01){return Math.abs(t-e)<=n}function xN(t,e,n,s=.5){t.origin=s,t.originPoint=en(e.min,e.max,t.origin),t.scale=zr(n)/zr(e),(aC(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=en(n.min,n.max,t.origin)-t.originPoint,(aC(t.translate)||isNaN(t.translate))&&(t.translate=0)}function op(t,e,n,s){xN(t.x,e.x,n.x,s?s.originX:void 0),xN(t.y,e.y,n.y,s?s.originY:void 0)}function wN(t,e,n){t.min=n.min+e.min,t.max=t.min+zr(e)}function zK(t,e,n){wN(t.x,e.x,n.x),wN(t.y,e.y,n.y)}function bN(t,e,n){t.min=e.min-n.min,t.max=t.min+zr(e)}function ap(t,e,n){bN(t.x,e.x,n.x),bN(t.y,e.y,n.y)}function WK(t,{min:e,max:n},s){return e!==void 0&&t<e?t=s?en(e,t,s.min):Math.max(t,e):n!==void 0&&t>n&&(t=s?en(n,t,s.max):Math.min(t,n)),t}function CN(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function jK(t,{top:e,left:n,bottom:s,right:r}){return{x:CN(t.x,n,r),y:CN(t.y,e,s)}}function SN(t,e){let n=e.min-t.min,s=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,s]=[s,n]),{min:n,max:s}}function GK(t,e){return{x:SN(t.x,e.x),y:SN(t.y,e.y)}}function HK(t,e){let n=.5;const s=zr(t),r=zr(e);return r>s?n=Fp(e.min,e.max-s,t.min):s>r&&(n=Fp(t.min,t.max-r,e.min)),Nl(0,1,n)}function KK(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const lC=.35;function qK(t=lC){return t===!1?t=0:t===!0&&(t=lC),{x:IN(t,"left","right"),y:IN(t,"top","bottom")}}function IN(t,e,n){return{min:kN(t,e),max:kN(t,n)}}function kN(t,e){return typeof t=="number"?t:t[e]||0}const TN=()=>({translate:0,scale:1,origin:0,originPoint:0}),Nh=()=>({x:TN(),y:TN()}),EN=()=>({min:0,max:0}),mn=()=>({x:EN(),y:EN()});function si(t){return[t("x"),t("y")]}function BO({top:t,left:e,right:n,bottom:s}){return{x:{min:e,max:n},y:{min:t,max:s}}}function XK({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function YK(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),s=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:s.y,right:s.x}}function uw(t){return t===void 0||t===1}function cC({scale:t,scaleX:e,scaleY:n}){return!uw(t)||!uw(e)||!uw(n)}function Sc(t){return cC(t)||VO(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function VO(t){return NN(t.x)||NN(t.y)}function NN(t){return t&&t!=="0%"}function i2(t,e,n){const s=t-n,r=e*s;return n+r}function _N(t,e,n,s,r){return r!==void 0&&(t=i2(t,r,s)),i2(t,n,s)+e}function uC(t,e=0,n=1,s,r){t.min=_N(t.min,e,n,s,r),t.max=_N(t.max,e,n,s,r)}function UO(t,{x:e,y:n}){uC(t.x,e.translate,e.scale,e.originPoint),uC(t.y,n.translate,n.scale,n.originPoint)}function JK(t,e,n,s=!1){const r=n.length;if(!r)return;e.x=e.y=1;let i,o;for(let a=0;a<r;a++){i=n[a],o=i.projectionDelta;const l=i.instance;l&&l.style&&l.style.display==="contents"||(s&&i.options.layoutScroll&&i.scroll&&i!==i.root&&_h(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,UO(t,o)),s&&Sc(i.latestValues)&&_h(t,i.latestValues))}e.x=$N(e.x),e.y=$N(e.y)}function $N(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function Ga(t,e){t.min=t.min+e,t.max=t.max+e}function RN(t,e,[n,s,r]){const i=e[r]!==void 0?e[r]:.5,o=en(t.min,t.max,i);uC(t,e[n],e[s],o,e.scale)}const ZK=["x","scaleX","originX"],QK=["y","scaleY","originY"];function _h(t,e){RN(t.x,e,ZK),RN(t.y,e,QK)}function zO(t,e){return BO(YK(t.getBoundingClientRect(),e))}function eq(t,e,n){const s=zO(t,n),{scroll:r}=e;return r&&(Ga(s.x,r.offset.x),Ga(s.y,r.offset.y)),s}const WO=({current:t})=>t?t.ownerDocument.defaultView:null,tq=new WeakMap;class nq{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=mn(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const r=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Cy(u,"page").point)},i=(u,h)=>{const{drag:d,dragPropagation:f,onDragStart:p}=this.getProps();if(d&&!f&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=tO(d),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),si(m=>{let y=this.getAxisMotionValue(m).get()||0;if(yo.test(y)){const{projection:w}=this.visualElement;if(w&&w.layout){const b=w.layout.layoutBox[m];b&&(y=zr(b)*(parseFloat(y)/100))}}this.originPoint[m]=y}),p&&Et.postRender(()=>p(u,h));const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},o=(u,h)=>{const{dragPropagation:d,dragDirectionLock:f,onDirectionLock:p,onDrag:g}=this.getProps();if(!d&&!this.openGlobalLock)return;const{offset:m}=h;if(f&&this.currentDirection===null){this.currentDirection=sq(m),this.currentDirection!==null&&p&&p(this.currentDirection);return}this.updateAxis("x",h.point,m),this.updateAxis("y",h.point,m),this.visualElement.render(),g&&g(u,h)},a=(u,h)=>this.stop(u,h),l=()=>si(u=>{var h;return this.getAnimationState(u)==="paused"&&((h=this.getAxisMotionValue(u).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new LO(e,{onSessionStart:r,onStart:i,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:WO(this.visualElement)})}stop(e,n){const s=this.isDragging;if(this.cancel(),!s)return;const{velocity:r}=n;this.startAnimation(r);const{onDragEnd:i}=this.getProps();i&&Et.postRender(()=>i(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,s){const{drag:r}=this.getProps();if(!s||!A0(e,r,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(o=WK(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:s}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;n&&Th(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&r?this.constraints=jK(r.layoutBox,n):this.constraints=!1,this.elastic=qK(s),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&si(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=KK(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Th(e))return!1;const s=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const i=eq(s,r.root,this.visualElement.getTransformPagePoint());let o=GK(r.layout.layoutBox,i);if(n){const a=n(XK(o));this.hasMutatedConstraints=!!a,a&&(o=BO(a))}return o}startAnimation(e){const{drag:n,dragMomentum:s,dragElastic:r,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=si(u=>{if(!A0(u,n,this.currentDirection))return;let h=l&&l[u]||{};o&&(h={min:0,max:0});const d=r?200:1e6,f=r?40:1e7,p={type:"inertia",velocity:s?e[u]:0,bounceStiffness:d,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(u,p)});return Promise.all(c).then(a)}startAxisValueAnimation(e,n){const s=this.getAxisMotionValue(e);return s.start(WI(e,s,0,n,this.visualElement))}stopAnimation(){si(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){si(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,s=this.visualElement.getProps(),r=s[n];return r||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){si(n=>{const{drag:s}=this.getProps();if(!A0(n,s,this.currentDirection))return;const{projection:r}=this.visualElement,i=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[n];i.set(e[n]-en(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:s}=this.visualElement;if(!Th(n)||!s||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};si(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();r[o]=HK({min:l,max:l},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),si(o=>{if(!A0(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(en(l,c,r[o]))})}addListeners(){if(!this.visualElement.current)return;tq.set(this.visualElement,this);const e=this.visualElement.current,n=la(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),s=()=>{const{dragConstraints:l}=this.getProps();Th(l)&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,i=r.addEventListener("measure",s);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),s();const o=ta(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(si(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=l[u].translate,h.set(h.get()+l[u].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:s=!1,dragPropagation:r=!1,dragConstraints:i=!1,dragElastic:o=lC,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:s,dragPropagation:r,dragConstraints:i,dragElastic:o,dragMomentum:a}}}function A0(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function sq(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class rq extends zl{constructor(e){super(e),this.removeGroupControls=As,this.removeListeners=As,this.controls=new nq(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||As}unmount(){this.removeGroupControls(),this.removeListeners()}}const AN=t=>(e,n)=>{t&&Et.postRender(()=>t(e,n))};class iq extends zl{constructor(){super(...arguments),this.removePointerDownListener=As}onPointerDown(e){this.session=new LO(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:WO(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:s,onPanEnd:r}=this.node.getProps();return{onSessionStart:AN(e),onStart:AN(n),onMove:s,onEnd:(i,o)=>{delete this.session,r&&Et.postRender(()=>r(i,o))}}}mount(){this.removePointerDownListener=la(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function oq(){const t=J.useContext(xy);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:n,register:s}=t,r=J.useId();return J.useEffect(()=>s(r),[]),!e&&n?[!1,()=>n&&n(r)]:[!0]}const m1={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function DN(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Sf={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(We.test(t))t=parseFloat(t);else return t;const n=DN(t,e.target.x),s=DN(t,e.target.y);return`${n}% ${s}%`}},aq={correct:(t,{treeScale:e,projectionDelta:n})=>{const s=t,r=_l.parse(t);if(r.length>5)return s;const i=_l.createTransformer(t),o=typeof r[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;r[0+o]/=a,r[1+o]/=l;const c=en(a,l,.5);return typeof r[2+o]=="number"&&(r[2+o]/=c),typeof r[3+o]=="number"&&(r[3+o]/=c),i(r)}};class lq extends J.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s,layoutId:r}=this.props,{projection:i}=e;iG(cq),i&&(n.group&&n.group.add(i),s&&s.register&&r&&s.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),m1.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:s,drag:r,isPresent:i}=this.props,o=s.projection;return o&&(o.isPresent=i,r||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||Et.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),CI.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),s&&s.deregister&&s.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function jO(t){const[e,n]=oq(),s=J.useContext(Pp);return U.jsx(lq,{...t,layoutGroup:s,switchLayoutGroup:J.useContext(BP),isPresent:e,safeToRemove:n})}const cq={borderRadius:{...Sf,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Sf,borderTopRightRadius:Sf,borderBottomLeftRadius:Sf,borderBottomRightRadius:Sf,boxShadow:aq},GO=["TopLeft","TopRight","BottomLeft","BottomRight"],uq=GO.length,PN=t=>typeof t=="string"?parseFloat(t):t,ON=t=>typeof t=="number"||We.test(t);function hq(t,e,n,s,r,i){r?(t.opacity=en(0,n.opacity!==void 0?n.opacity:1,dq(s)),t.opacityExit=en(e.opacity!==void 0?e.opacity:1,0,fq(s))):i&&(t.opacity=en(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,s));for(let o=0;o<uq;o++){const a=`border${GO[o]}Radius`;let l=FN(e,a),c=FN(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||ON(l)===ON(c)?(t[a]=Math.max(en(PN(l),PN(c),s),0),(yo.test(c)||yo.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||n.rotate)&&(t.rotate=en(e.rotate||0,n.rotate||0,s))}function FN(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const dq=HO(0,.5,NO),fq=HO(.5,.95,As);function HO(t,e,n){return s=>s<t?0:s>e?1:n(Fp(t,e,s))}function LN(t,e){t.min=e.min,t.max=e.max}function Qr(t,e){LN(t.x,e.x),LN(t.y,e.y)}function MN(t,e,n,s,r){return t-=e,t=i2(t,1/n,s),r!==void 0&&(t=i2(t,1/r,s)),t}function pq(t,e=0,n=1,s=.5,r,i=t,o=t){if(yo.test(e)&&(e=parseFloat(e),e=en(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=en(i.min,i.max,s);t===i&&(a-=e),t.min=MN(t.min,e,n,a,r),t.max=MN(t.max,e,n,a,r)}function BN(t,e,[n,s,r],i,o){pq(t,e[n],e[s],e[r],e.scale,i,o)}const mq=["x","scaleX","originX"],gq=["y","scaleY","originY"];function VN(t,e,n,s){BN(t.x,e,mq,n?n.x:void 0,s?s.x:void 0),BN(t.y,e,gq,n?n.y:void 0,s?s.y:void 0)}function UN(t){return t.translate===0&&t.scale===1}function KO(t){return UN(t.x)&&UN(t.y)}function yq(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function qO(t,e){return Math.round(t.x.min)===Math.round(e.x.min)&&Math.round(t.x.max)===Math.round(e.x.max)&&Math.round(t.y.min)===Math.round(e.y.min)&&Math.round(t.y.max)===Math.round(e.y.max)}function zN(t){return zr(t.x)/zr(t.y)}class vq{constructor(){this.members=[]}add(e){jI(this.members,e),e.scheduleRender()}remove(e){if(GI(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(r=>e===r);if(n===0)return!1;let s;for(let r=n;r>=0;r--){const i=this.members[r];if(i.isPresent!==!1){s=i;break}}return s?(this.promote(s),!0):!1}promote(e,n){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,n&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:s}=e;n.onExitComplete&&n.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function WN(t,e,n){let s="";const r=t.x.translate/e.x,i=t.y.translate/e.y,o=(n==null?void 0:n.z)||0;if((r||i||o)&&(s=`translate3d(${r}px, ${i}px, ${o}px) `),(e.x!==1||e.y!==1)&&(s+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:h,rotateY:d,skewX:f,skewY:p}=n;c&&(s=`perspective(${c}px) ${s}`),u&&(s+=`rotate(${u}deg) `),h&&(s+=`rotateX(${h}deg) `),d&&(s+=`rotateY(${d}deg) `),f&&(s+=`skewX(${f}deg) `),p&&(s+=`skewY(${p}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(s+=`scale(${a}, ${l})`),s||"none"}const xq=(t,e)=>t.depth-e.depth;class wq{constructor(){this.children=[],this.isDirty=!1}add(e){jI(this.children,e),this.isDirty=!0}remove(e){GI(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(xq),this.isDirty=!1,this.children.forEach(e)}}function bq(t,e){const n=yl.now(),s=({timestamp:r})=>{const i=r-n;i>=e&&(ma(s),t(i-e))};return Et.read(s,!0),()=>ma(s)}function Cq(t){window.MotionDebug&&window.MotionDebug.record(t)}function Sq(t){return t instanceof SVGElement&&t.tagName!=="svg"}function Iq(t,e,n){const s=Rs(t)?t:Lp(t);return s.start(WI("",s,e,n)),s.animation}const hw=["","X","Y","Z"],kq={visibility:"hidden"},jN=1e3;let Tq=0;const Ic={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function dw(t,e,n,s){const{latestValues:r}=e;r[t]&&(n[t]=r[t],e.setStaticValue(t,0),s&&(s[t]=0))}function XO(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return!1;const{visualElement:e}=t.options;return e?OO(e)?!0:t.parent&&!t.parent.hasCheckedOptimisedAppear?XO(t.parent):!1:!1}function YO({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:s,resetTransform:r}){return class{constructor(o={},a=e==null?void 0:e()){this.id=Tq++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Ic.totalNodes=Ic.resolvedTargetDeltas=Ic.recalculatedProjection=0,this.nodes.forEach(_q),this.nodes.forEach(Pq),this.nodes.forEach(Oq),this.nodes.forEach($q),Cq(Ic)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new wq)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new HI),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Sq(o),this.instance=o;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(c||l)&&(this.isLayoutDirty=!0),t){let h;const d=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=bq(d,250),m1.hasAnimatedSinceResize&&(m1.hasAnimatedSinceResize=!1,this.nodes.forEach(HN))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:d,hasRelativeTargetChanged:f,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||u.getDefaultTransition()||Vq,{onLayoutAnimationStart:m,onLayoutAnimationComplete:y}=u.getProps(),w=!this.targetLayout||!qO(this.targetLayout,p)||f,b=!d&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||b||d&&(w||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,b);const C={...PI(g,"layout"),onPlay:m,onComplete:y};(u.shouldReduceMotion||this.options.layoutRoot)&&(C.delay=0,C.type=!1),this.startAnimation(C)}else d||HN(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,ma(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Fq),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.HandoffCancelAllAnimations&&XO(this)&&window.HandoffCancelAllAnimations(),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(GN);return}this.isUpdating||this.nodes.forEach(Aq),this.isUpdating=!1,this.nodes.forEach(Dq),this.nodes.forEach(Eq),this.nodes.forEach(Nq),this.clearAllSnapshots();const a=yl.now();cs.delta=Nl(0,1e3/60,a-cs.timestamp),cs.timestamp=a,cs.isProcessing=!0,tw.update.process(cs),tw.preRender.process(cs),tw.render.process(cs),cs.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,CI.read(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(Rq),this.sharedNodes.forEach(Lq)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Et.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Et.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=mn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:s(this.instance),offset:n(this.instance)})}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform,a=this.projectionDelta&&!KO(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;o&&(a||Sc(this.latestValues)||u)&&(r(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),Uq(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return mn();const a=o.measureViewportBox(),{scroll:l}=this.root;return l&&(Ga(a.x,l.offset.x),Ga(a.y,l.offset.y)),a}removeElementScroll(o){const a=mn();Qr(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:u,options:h}=c;if(c!==this.root&&u&&h.layoutScroll){if(u.isRoot){Qr(a,o);const{scroll:d}=this.root;d&&(Ga(a.x,-d.offset.x),Ga(a.y,-d.offset.y))}Ga(a.x,u.offset.x),Ga(a.y,u.offset.y)}}return a}applyTransform(o,a=!1){const l=mn();Qr(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&_h(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Sc(u.latestValues)&&_h(l,u.latestValues)}return Sc(this.latestValues)&&_h(l,this.latestValues),l}removeTransform(o){const a=mn();Qr(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Sc(c.latestValues))continue;cC(c.latestValues)&&c.updateSnapshot();const u=mn(),h=c.measurePageBox();Qr(u,h),VN(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Sc(this.latestValues)&&VN(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==cs.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:d}=this.options;if(!(!this.layout||!(h||d))){if(this.resolvedRelativeTargetAt=cs.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=mn(),this.relativeTargetOrigin=mn(),ap(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),Qr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=mn(),this.targetWithTransforms=mn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),zK(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Qr(this.target,this.layout.layoutBox),UO(this.target,this.targetDelta)):Qr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=mn(),this.relativeTargetOrigin=mn(),ap(this.relativeTargetOrigin,this.target,f.target),Qr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Ic.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||cC(this.parent.latestValues)||VO(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===cs.timestamp&&(c=!1),c)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;Qr(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,f=this.treeScale.y;JK(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=mn());const{target:p}=a;if(!p){this.projectionTransform&&(this.projectionDelta=Nh(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Nh(),this.projectionDeltaWithTransform=Nh());const g=this.projectionTransform;op(this.projectionDelta,this.layoutCorrected,p,this.latestValues),this.projectionTransform=WN(this.projectionDelta,this.treeScale),(this.projectionTransform!==g||this.treeScale.x!==d||this.treeScale.y!==f)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p)),Ic.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},h=Nh();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const d=mn(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,g=f!==p,m=this.getStack(),y=!m||m.members.length<=1,w=!!(g&&!y&&this.options.crossfade===!0&&!this.path.some(Bq));this.animationProgress=0;let b;this.mixTargetDelta=C=>{const k=C/1e3;KN(h.x,o.x,k),KN(h.y,o.y,k),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(ap(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Mq(this.relativeTarget,this.relativeTargetOrigin,d,k),b&&yq(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=mn()),Qr(b,this.relativeTarget)),g&&(this.animationValues=u,hq(u,c,this.latestValues,k,w,y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=k},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ma(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Et.update(()=>{m1.hasAnimatedSinceResize=!0,this.currentAnimation=Iq(0,jN,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(jN),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&JO(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||mn();const h=zr(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+h;const d=zr(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+d}Qr(a,l),_h(a,u),op(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new vq),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&dw("z",o,c,this.animationValues);for(let u=0;u<hw.length;u++)dw(`rotate${hw[u]}`,o,c,this.animationValues),dw(`skew${hw[u]}`,o,c,this.animationValues);o.render();for(const u in c)o.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return kq;const c={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=f1(o==null?void 0:o.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=f1(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Sc(this.latestValues)&&(g.transform=u?u({},""):"none",this.hasProjected=!1),g}const d=h.animationValues||h.latestValues;this.applyTransformsToTarget(),c.transform=WN(this.projectionDeltaWithTransform,this.treeScale,d),u&&(c.transform=u(d,c.transform));const{x:f,y:p}=this.projectionDelta;c.transformOrigin=`${f.origin*100}% ${p.origin*100}% 0`,h.animationValues?c.opacity=h===this?(l=(a=d.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:c.opacity=h===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const g in Q1){if(d[g]===void 0)continue;const{correct:m,applyTo:y}=Q1[g],w=c.transform==="none"?d[g]:m(d[g],h);if(y){const b=y.length;for(let C=0;C<b;C++)c[y[C]]=w}else c[g]=w}return this.options.layoutId&&(c.pointerEvents=h===this?f1(o==null?void 0:o.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(GN),this.root.sharedNodes.clear()}}}function Eq(t){t.updateLayout()}function Nq(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:r}=t.layout,{animationType:i}=t.options,o=n.source!==t.layout.source;i==="size"?si(h=>{const d=o?n.measuredBox[h]:n.layoutBox[h],f=zr(d);d.min=s[h].min,d.max=d.min+f}):JO(i,n.layoutBox,s)&&si(h=>{const d=o?n.measuredBox[h]:n.layoutBox[h],f=zr(s[h]);d.max=d.min+f,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+f)});const a=Nh();op(a,s,n.layoutBox);const l=Nh();o?op(l,t.applyTransform(r,!0),n.measuredBox):op(l,s,n.layoutBox);const c=!KO(a);let u=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:d,layout:f}=h;if(d&&f){const p=mn();ap(p,n.layoutBox,d.layoutBox);const g=mn();ap(g,s,f.layoutBox),qO(p,g)||(u=!0),h.options.layoutRoot&&(t.relativeTarget=g,t.relativeTargetOrigin=p,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:s,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(t.isLead()){const{onExitComplete:s}=t.options;s&&s()}t.options.transition=void 0}function _q(t){Ic.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function $q(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Rq(t){t.clearSnapshot()}function GN(t){t.clearMeasurements()}function Aq(t){t.isLayoutDirty=!1}function Dq(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function HN(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Pq(t){t.resolveTargetDelta()}function Oq(t){t.calcProjection()}function Fq(t){t.resetSkewAndRotation()}function Lq(t){t.removeLeadSnapshot()}function KN(t,e,n){t.translate=en(e.translate,0,n),t.scale=en(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function qN(t,e,n,s){t.min=en(e.min,n.min,s),t.max=en(e.max,n.max,s)}function Mq(t,e,n,s){qN(t.x,e.x,n.x,s),qN(t.y,e.y,n.y,s)}function Bq(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Vq={duration:.45,ease:[.4,0,.1,1]},XN=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),YN=XN("applewebkit/")&&!XN("chrome/")?Math.round:As;function JN(t){t.min=YN(t.min),t.max=YN(t.max)}function Uq(t){JN(t.x),JN(t.y)}function JO(t,e,n){return t==="position"||t==="preserve-aspect"&&!aC(zN(e),zN(n),.2)}const zq=YO({attachResizeListener:(t,e)=>ta(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),fw={current:void 0},ZO=YO({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!fw.current){const t=new zq({});t.mount(window),t.setOptions({layoutScroll:!0}),fw.current=t}return fw.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Wq={pan:{Feature:iq},drag:{Feature:rq,ProjectionNode:ZO,MeasureLayout:jO}},hC={current:null},QO={current:!1};function jq(){if(QO.current=!0,!!xI)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>hC.current=t.matches;t.addListener(e),e()}else hC.current=!1}function Gq(t,e,n){const{willChange:s}=e;for(const r in e){const i=e[r],o=n[r];if(Rs(i))t.addValue(r,i),r2(s)&&s.add(r);else if(Rs(o))t.addValue(r,Lp(i,{owner:t})),r2(s)&&s.remove(r);else if(o!==i)if(t.hasValue(r)){const a=t.getValue(r);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=t.getStaticValue(r);t.addValue(r,Lp(a!==void 0?a:i,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const ZN=new WeakMap,Hq=[...cO,Ss,_l],Kq=t=>Hq.find(lO(t)),eF=Object.keys(Dp),qq=eF.length,QN=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Xq=II.length;function tF(t){if(t)return t.options.allowProjection!==!1?t.projection:tF(t.parent)}class Yq{scrapeMotionValuesFromProps(e,n,s){return{}}constructor({parent:e,props:n,presenceContext:s,reducedMotionConfig:r,blockInitialAnimation:i,visualState:o},a={}){this.resolveKeyframes=(d,f,p,g)=>new this.KeyframeResolver(d,f,p,g,this),this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=OI,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Et.render(this.render,!1,!0);const{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!i,this.isControllingVariants=by(n),this.isVariantNode=MP(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...h}=this.scrapeMotionValuesFromProps(n,{},this);for(const d in h){const f=h[d];l[d]!==void 0&&Rs(f)&&(f.set(l[d],!1),r2(u)&&u.add(d))}}mount(e){this.current=e,ZN.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),QO.current||jq(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:hC.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){var e;ZN.delete(this.current),this.projection&&this.projection.unmount(),ma(this.notifyUpdate),ma(this.render),this.valueSubscriptions.forEach(n=>n()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const n in this.events)this.events[n].clear();for(const n in this.features)(e=this.features[n])===null||e===void 0||e.unmount();this.current=null}bindToMotionValue(e,n){const s=Cu.has(e),r=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&Et.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{r(),i(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...n},s,r,i){let o,a;for(let l=0;l<qq;l++){const c=eF[l],{isEnabled:u,Feature:h,ProjectionNode:d,MeasureLayout:f}=Dp[c];d&&(o=d),u(n)&&(!this.features[c]&&h&&(this.features[c]=new h(this)),f&&(a=f))}if((this.type==="html"||this.type==="svg")&&!this.projection&&o){const{layoutId:l,layout:c,drag:u,dragConstraints:h,layoutScroll:d,layoutRoot:f}=n;this.projection=new o(this.latestValues,n["data-framer-portal-id"]?void 0:tF(this.parent)),this.projection.setOptions({layoutId:l,layout:c,alwaysMeasureLayout:!!u||h&&Th(h),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof c=="string"?c:"both",initialPromotionConfig:i,layoutScroll:d,layoutRoot:f})}return a}updateFeatures(){for(const e in this.features){const n=this.features[e];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):mn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let s=0;s<QN.length;s++){const r=QN[s];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const i="on"+r,o=e[i];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=Gq(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const s=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(s.initial=this.props.initial),s}const n={};for(let s=0;s<Xq;s++){const r=II[s],i=this.props[r];(Ap(i)||i===!1)&&(n[r]=i)}return n}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const s=this.values.get(e);n!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&n!==void 0&&(s=Lp(n===null?void 0:n,{owner:this}),this.addValue(e,s)),s}readValue(e,n){var s;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(s=this.getBaseTargetFromProps(this.props,e))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(oO(r)||iO(r))?r=parseFloat(r):!Kq(r)&&_l.test(n)&&(r=yO(e,n)),this.setBaseTarget(e,Rs(r)?r.get():r)),Rs(r)?r.get():r}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:s}=this.props;let r;if(typeof s=="string"||typeof s=="object"){const o=DI(this.props,s,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);o&&(r=o[e])}if(s&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Rs(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new HI),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class nF extends Yq{constructor(){super(...arguments),this.KeyframeResolver=vO}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:s}){delete n[e],delete s[e]}}function Jq(t){return window.getComputedStyle(t)}class Zq extends nF{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,n){if(Cu.has(n)){const s=LI(n);return s&&s.default||0}else{const s=Jq(e),r=(zP(n)?s.getPropertyValue(n):s[n])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:n}){return zO(e,n)}build(e,n,s,r){NI(e,n,s,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,s){return AI(e,n,s)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Rs(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(e,n,s,r){KP(e,n,s,r)}}class Qq extends nF{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Cu.has(n)){const s=LI(n);return s&&s.default||0}return n=qP.has(n)?n:bI(n),e.getAttribute(n)}measureInstanceViewportBox(){return mn()}scrapeMotionValuesFromProps(e,n,s){return YP(e,n,s)}build(e,n,s,r){$I(e,n,s,this.isSVGTag,r.transformTemplate)}renderInstance(e,n,s,r){XP(e,n,s,r)}mount(e){this.isSVGTag=RI(e.tagName),super.mount(e)}}const eX=(t,e)=>kI(t)?new Qq(e,{enableHardwareAcceleration:!1}):new Zq(e,{allowProjection:t!==J.Fragment,enableHardwareAcceleration:!0}),tX={layout:{ProjectionNode:ZO,MeasureLayout:jO}},nX={...MK,...KG,...Wq,...tX},Le=sG((t,e)=>PG(t,e,nX,eX));function sF(){const t=J.useRef(!1);return wI(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function rF(){const t=sF(),[e,n]=J.useState(0),s=J.useCallback(()=>{t.current&&n(e+1)},[e]);return[J.useCallback(()=>Et.postRender(s),[s]),e]}class sX extends J.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const s=this.props.sizeRef.current;s.height=n.offsetHeight||0,s.width=n.offsetWidth||0,s.top=n.offsetTop,s.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function rX({children:t,isPresent:e}){const n=J.useId(),s=J.useRef(null),r=J.useRef({width:0,height:0,top:0,left:0}),{nonce:i}=J.useContext(vI);return J.useInsertionEffect(()=>{const{width:o,height:a,top:l,left:c}=r.current;if(e||!s.current||!o||!a)return;s.current.dataset.motionPopId=n;const u=document.createElement("style");return i&&(u.nonce=i),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${a}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),U.jsx(sX,{isPresent:e,childRef:s,sizeRef:r,children:J.cloneElement(t,{ref:s})})}const pw=({children:t,initial:e,isPresent:n,onExitComplete:s,custom:r,presenceAffectsLayout:i,mode:o})=>{const a=JP(iX),l=J.useId(),c=J.useMemo(()=>({id:l,initial:e,isPresent:n,custom:r,onExitComplete:u=>{a.set(u,!0);for(const h of a.values())if(!h)return;s&&s()},register:u=>(a.set(u,!1),()=>a.delete(u))}),i?[Math.random()]:[n]);return J.useMemo(()=>{a.forEach((u,h)=>a.set(h,!1))},[n]),J.useEffect(()=>{!n&&!a.size&&s&&s()},[n]),o==="popLayout"&&(t=U.jsx(rX,{isPresent:n,children:t})),U.jsx(xy.Provider,{value:c,children:t})};function iX(){return new Map}function oX(t){return J.useEffect(()=>()=>t(),[])}const kc=t=>t.key||"";function aX(t,e){t.forEach(n=>{const s=kc(n);e.set(s,n)})}function lX(t){const e=[];return J.Children.forEach(t,n=>{J.isValidElement(n)&&e.push(n)}),e}const vl=({children:t,custom:e,initial:n=!0,onExitComplete:s,exitBeforeEnter:r,presenceAffectsLayout:i=!0,mode:o="sync"})=>{const a=J.useContext(Pp).forceRender||rF()[0],l=sF(),c=lX(t);let u=c;const h=J.useRef(new Map).current,d=J.useRef(u),f=J.useRef(new Map).current,p=J.useRef(!0);if(wI(()=>{p.current=!1,aX(c,f),d.current=u}),oX(()=>{p.current=!0,f.clear(),h.clear()}),p.current)return U.jsx(U.Fragment,{children:u.map(w=>U.jsx(pw,{isPresent:!0,initial:n?void 0:!1,presenceAffectsLayout:i,mode:o,children:w},kc(w)))});u=[...u];const g=d.current.map(kc),m=c.map(kc),y=g.length;for(let w=0;w<y;w++){const b=g[w];m.indexOf(b)===-1&&!h.has(b)&&h.set(b,void 0)}return o==="wait"&&h.size&&(u=[]),h.forEach((w,b)=>{if(m.indexOf(b)!==-1)return;const C=f.get(b);if(!C)return;const k=g.indexOf(b);let $=w;if(!$){const I=()=>{h.delete(b);const T=Array.from(f.keys()).filter(R=>!m.includes(R));if(T.forEach(R=>f.delete(R)),d.current=c.filter(R=>{const E=kc(R);return E===b||T.includes(E)}),!h.size){if(l.current===!1)return;a(),s&&s()}};$=U.jsx(pw,{isPresent:!1,onExitComplete:I,custom:e,presenceAffectsLayout:i,mode:o,children:C},kc(C)),h.set(b,$)}u.splice(k,0,$)}),u=u.map(w=>{const b=w.key;return h.has(b)?w:U.jsx(pw,{isPresent:!0,presenceAffectsLayout:i,mode:o,children:w},kc(w))}),U.jsx(U.Fragment,{children:h.size?u:u.map(w=>J.cloneElement(w))})},cX=J.createContext(null),uX=t=>!t.isLayoutDirty&&t.willUpdate(!1);function e_(){const t=new Set,e=new WeakMap,n=()=>t.forEach(uX);return{add:s=>{t.add(s),e.set(s,s.addEventListener("willUpdate",n))},remove:s=>{t.delete(s);const r=e.get(s);r&&(r(),e.delete(s)),n()},dirty:n}}const iF=t=>t===!0,hX=t=>iF(t===!0)||t==="id",dX=({children:t,id:e,inherit:n=!0})=>{const s=J.useContext(Pp),r=J.useContext(cX),[i,o]=rF(),a=J.useRef(null),l=s.id||r;a.current===null&&(hX(n)&&l&&(e=e?l+"-"+e:l),a.current={id:e,group:iF(n)&&s.group||e_()});const c=J.useMemo(()=>({...a.current,forceRender:i}),[o]);return U.jsx(Pp.Provider,{value:c,children:t})},fX="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M18.5%203H16C15.7239%203%2015.5%203.22386%2015.5%203.5V3.55891L19%206.35891V3.5C19%203.22386%2018.7762%203%2018.5%203Z'%20fill='%231C274C'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10.75%209.5C10.75%208.80964%2011.3097%208.25%2012%208.25C12.6904%208.25%2013.25%208.80964%2013.25%209.5C13.25%2010.1904%2012.6904%2010.75%2012%2010.75C11.3097%2010.75%2010.75%2010.1904%2010.75%209.5Z'%20fill='%231C274C'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M20.75%2010.9605L21.5315%2011.5857C21.855%2011.8444%2022.3269%2011.792%2022.5857%2011.4685C22.8444%2011.1451%2022.792%2010.6731%2022.4685%2010.4143L14.3426%203.91362C12.9731%202.81796%2011.027%202.81796%209.65742%203.91362L1.53151%2010.4143C1.20806%2010.6731%201.15562%2011.1451%201.41438%2011.4685C1.67313%2011.792%202.1451%2011.8444%202.46855%2011.5857L3.25003%2010.9605V21.25H2.00003C1.58581%2021.25%201.25003%2021.5858%201.25003%2022C1.25003%2022.4142%201.58581%2022.75%202.00003%2022.75H22C22.4142%2022.75%2022.75%2022.4142%2022.75%2022C22.75%2021.5858%2022.4142%2021.25%2022%2021.25H20.75V10.9605ZM9.25003%209.5C9.25003%207.98122%2010.4812%206.75%2012%206.75C13.5188%206.75%2014.75%207.98122%2014.75%209.5C14.75%2011.0188%2013.5188%2012.25%2012%2012.25C10.4812%2012.25%209.25003%2011.0188%209.25003%209.5ZM12.0494%2013.25C12.7143%2013.25%2013.2871%2013.2499%2013.7459%2013.3116C14.2375%2013.3777%2014.7088%2013.5268%2015.091%2013.909C15.4733%2014.2913%2015.6223%2014.7625%2015.6884%2015.2542C15.7462%2015.6842%2015.7498%2016.2146%2015.75%2016.827C15.75%2016.8679%2015.75%2016.9091%2015.75%2016.9506L15.75%2021.25H14.25V17C14.25%2016.2717%2014.2484%2015.8009%2014.2018%2015.454C14.1581%2015.1287%2014.0875%2015.0268%2014.0304%2014.9697C13.9733%2014.9126%2013.8713%2014.842%2013.546%2014.7982C13.1991%2014.7516%2012.7283%2014.75%2012%2014.75C11.2717%2014.75%2010.8009%2014.7516%2010.4541%2014.7982C10.1288%2014.842%2010.0268%2014.9126%209.9697%2014.9697C9.9126%2015.0268%209.84199%2015.1287%209.79826%2015.454C9.75162%2015.8009%209.75003%2016.2717%209.75003%2017V21.25H8.25003L8.25003%2016.9506C8.24999%2016.2858%208.24996%2015.7129%208.31163%2015.2542C8.37773%2014.7625%208.52679%2014.2913%208.90904%2013.909C9.29128%2013.5268%209.76255%2013.3777%2010.2542%2013.3116C10.7129%2013.2499%2011.2858%2013.25%2011.9507%2013.25H12.0494Z'%20fill='%231C274C'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10.75%209.5C10.75%208.80964%2011.3097%208.25%2012%208.25C12.6904%208.25%2013.25%208.80964%2013.25%209.5C13.25%2010.1904%2012.6904%2010.75%2012%2010.75C11.3097%2010.75%2010.75%2010.1904%2010.75%209.5Z'%20fill='%231C274C'/%3e%3c/svg%3e",pX="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M12%2022C7.28595%2022%204.92893%2022%203.46447%2020.5355C2%2019.0711%202%2016.714%202%2012C2%207.28595%202%204.92893%203.46447%203.46447C4.92893%202%207.28595%202%2012%202C16.714%202%2019.0711%202%2020.5355%203.46447C22%204.92893%2022%207.28595%2022%2012C22%2016.714%2022%2019.0711%2020.5355%2020.5355C19.0711%2022%2016.714%2022%2012%2022ZM12%2017.75C12.4142%2017.75%2012.75%2017.4142%2012.75%2017V11C12.75%2010.5858%2012.4142%2010.25%2012%2010.25C11.5858%2010.25%2011.25%2010.5858%2011.25%2011V17C11.25%2017.4142%2011.5858%2017.75%2012%2017.75ZM12%207C12.5523%207%2013%207.44772%2013%208C13%208.55228%2012.5523%209%2012%209C11.4477%209%2011%208.55228%2011%208C11%207.44772%2011.4477%207%2012%207Z'%20fill='%231C274C'/%3e%3c/svg%3e",mX="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M12%202V6'%20stroke='%231C274C'%20stroke-width='1.5'%20stroke-linecap='round'/%3e%3cpath%20d='M12.75%202.75C12.75%202.33579%2012.4142%202%2012%202C11.5858%202%2011.25%202.33579%2011.25%202.75V6.75C11.25%207.16421%2011.5858%207.5%2012%207.5C12.4142%207.5%2012.75%207.16421%2012.75%206.75V2.75Z'%20fill='%231C274C'/%3e%3cpath%20d='M8.7919%205.14692C9.17345%204.98571%209.35208%204.54571%209.19087%204.16416C9.02966%203.7826%208.58966%203.60398%208.2081%203.76519C4.70832%205.24386%202.25%208.70905%202.25%2012.7501C2.25%2018.1349%206.61522%2022.5001%2012%2022.5001C17.3848%2022.5001%2021.75%2018.1349%2021.75%2012.7501C21.75%208.70905%2019.2917%205.24386%2015.7919%203.76519C15.4103%203.60398%2014.9703%203.7826%2014.8091%204.16416C14.6479%204.54571%2014.8265%204.98571%2015.2081%205.14692C18.1722%206.39927%2020.25%209.33293%2020.25%2012.7501C20.25%2017.3065%2016.5563%2021.0001%2012%2021.0001C7.44365%2021.0001%203.75%2017.3065%203.75%2012.7501C3.75%209.33293%205.82779%206.39927%208.7919%205.14692Z'%20fill='%231C274C'/%3e%3c/svg%3e",gX="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M4.72718%202.71244C5.03258%202.41324%205.46135%202.21816%206.27103%202.11151C7.10452%202.00172%208.2092%202%209.7931%202H14.2069C15.7908%202%2016.8955%202.00172%2017.729%202.11151C18.5387%202.21816%2018.9674%202.41324%2019.2728%202.71244C19.5782%203.01165%2019.7773%203.43172%2019.8862%204.22499C19.9982%205.04159%2020%206.12387%2020%207.67568V15.5135L7.34563%2015.5135C6.44305%2015.5132%205.82716%2015.513%205.29899%2015.6517C4.82674%2015.7756%204.38867%2015.9781%204%2016.2442V7.67568C4%206.12387%204.00176%205.04159%204.11382%204.225C4.22268%203.43172%204.42179%203.01165%204.72718%202.71244ZM7.58621%205.78378C7.12914%205.78378%206.75862%206.1468%206.75862%206.59459C6.75862%207.04239%207.12914%207.40541%207.58621%207.40541H16.4138C16.8709%207.40541%2017.2414%207.04239%2017.2414%206.59459C17.2414%206.1468%2016.8709%205.78378%2016.4138%205.78378H7.58621ZM6.75862%2010.3784C6.75862%209.93058%207.12914%209.56757%207.58621%209.56757H13.1034C13.5605%209.56757%2013.931%209.93058%2013.931%2010.3784C13.931%2010.8262%2013.5605%2011.1892%2013.1034%2011.1892H7.58621C7.12914%2011.1892%206.75862%2010.8262%206.75862%2010.3784Z'%20fill='%231C274D'/%3e%3cpath%20d='M7.47341%2017.1351C6.39395%2017.1351%206.01657%2017.1421%205.72738%2017.218C4.93365%2017.4264%204.30088%2018.0044%204.02952%2018.7558C4.0463%2019.1382%204.07259%2019.4746%204.11382%2019.775C4.22268%2020.5683%204.42179%2020.9884%204.72718%2021.2876C5.03258%2021.5868%205.46135%2021.7818%206.27103%2021.8885C7.10452%2021.9983%208.2092%2022%209.7931%2022H14.2069C15.7908%2022%2016.8955%2021.9983%2017.729%2021.8885C18.5387%2021.7818%2018.9674%2021.5868%2019.2728%2021.2876C19.4894%2021.0753%2019.6526%2020.8023%2019.768%2020.3784H7.58621C7.12914%2020.3784%206.75862%2020.0154%206.75862%2019.5676C6.75862%2019.1198%207.12914%2018.7568%207.58621%2018.7568H19.9704C19.9909%2018.2908%2019.9972%2017.7564%2019.9991%2017.1351H7.47341Z'%20fill='%231C274D'/%3e%3c/svg%3e",yX="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M2%2016.1436V4.9978C2%203.89963%202.8863%203.00752%203.9824%203.07489C4.95877%203.1349%206.11349%203.25351%207%203.48744C8.04921%203.76431%209.29611%204.35401%2010.2823%204.87546C10.5894%205.03785%2010.9159%205.15048%2011.2502%205.21397V20.3926C10.9472%2020.3258%2010.6516%2020.218%2010.3724%2020.0692C9.37293%2019.5365%208.08145%2018.9187%207%2018.6334C6.12329%2018.402%204.98428%2018.2835%204.01486%2018.2228C2.90605%2018.1535%202%2017.2546%202%2016.1436ZM5.18208%208.27239C4.78023%208.17193%204.37303%208.41625%204.27257%208.8181C4.17211%209.21994%204.41643%209.62715%204.81828%209.72761L8.81828%2010.7276C9.22012%2010.8281%209.62732%2010.5837%209.72778%2010.1819C9.82825%209.78006%209.58393%209.37285%209.18208%209.27239L5.18208%208.27239ZM5.18208%2012.2724C4.78023%2012.1719%204.37303%2012.4163%204.27257%2012.8181C4.17211%2013.2199%204.41643%2013.6271%204.81828%2013.7276L8.81828%2014.7276C9.22012%2014.8281%209.62732%2014.5837%209.72778%2014.1819C9.82825%2013.7801%209.58393%2013.3729%209.18208%2013.2724L5.18208%2012.2724Z'%20fill='%231C274D'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M12.7502%2020.3925C13.0531%2020.3257%2013.3485%2020.218%2013.6276%2020.0692C14.6271%2019.5365%2015.9185%2018.9187%2017%2018.6334C17.8767%2018.402%2019.0157%2018.2835%2019.9851%2018.2228C21.094%2018.1535%2022%2017.2546%2022%2016.1436V4.93319C22%203.86075%2021.1538%202.98041%2020.082%203.01775C18.9534%203.05706%2017.5469%203.17403%2016.5%203.48744C15.5924%203.75916%2014.5353%204.30418%2013.6738%204.80275C13.3824%204.97142%2013.0709%205.0953%2012.7502%205.17387V20.3925ZM19.1821%209.72761C19.5839%209.62715%2019.8282%209.21994%2019.7278%208.8181C19.6273%208.41625%2019.2201%208.17193%2018.8183%208.27239L14.8183%209.27239C14.4164%209.37285%2014.1721%209.78006%2014.2726%2010.1819C14.373%2010.5837%2014.7802%2010.8281%2015.1821%2010.7276L19.1821%209.72761ZM19.1821%2013.7276C19.5839%2013.6271%2019.8282%2013.2199%2019.7278%2012.8181C19.6273%2012.4163%2019.2201%2012.1719%2018.8183%2012.2724L14.8183%2013.2724C14.4164%2013.3729%2014.1721%2013.7801%2014.2726%2014.1819C14.373%2014.5837%2014.7802%2014.8281%2015.1821%2014.7276L19.1821%2013.7276Z'%20fill='%231C274D'/%3e%3c/svg%3e",vX="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10%204H14C17.7712%204%2019.6569%204%2020.8284%205.17157C22%206.34315%2022%208.22876%2022%2012C22%2015.7712%2022%2017.6569%2020.8284%2018.8284C19.6569%2020%2017.7712%2020%2014%2020H10C6.22876%2020%204.34315%2020%203.17157%2018.8284C2%2017.6569%202%2015.7712%202%2012C2%208.22876%202%206.34315%203.17157%205.17157C4.34315%204%206.22876%204%2010%204ZM13.25%209C13.25%208.58579%2013.5858%208.25%2014%208.25H19C19.4142%208.25%2019.75%208.58579%2019.75%209C19.75%209.41421%2019.4142%209.75%2019%209.75H14C13.5858%209.75%2013.25%209.41421%2013.25%209ZM14.25%2012C14.25%2011.5858%2014.5858%2011.25%2015%2011.25H19C19.4142%2011.25%2019.75%2011.5858%2019.75%2012C19.75%2012.4142%2019.4142%2012.75%2019%2012.75H15C14.5858%2012.75%2014.25%2012.4142%2014.25%2012ZM15.25%2015C15.25%2014.5858%2015.5858%2014.25%2016%2014.25H19C19.4142%2014.25%2019.75%2014.5858%2019.75%2015C19.75%2015.4142%2019.4142%2015.75%2019%2015.75H16C15.5858%2015.75%2015.25%2015.4142%2015.25%2015ZM11%209C11%2010.1046%2010.1046%2011%209%2011C7.89543%2011%207%2010.1046%207%209C7%207.89543%207.89543%207%209%207C10.1046%207%2011%207.89543%2011%209ZM9%2017C13%2017%2013%2016.1046%2013%2015C13%2013.8954%2011.2091%2013%209%2013C6.79086%2013%205%2013.8954%205%2015C5%2016.1046%205%2017%209%2017Z'%20fill='%231C274C'/%3e%3c/svg%3e",dC="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='12'%20cy='6'%20r='4'%20fill='%231C274C'/%3e%3cpath%20d='M20%2017.5C20%2019.9853%2020%2022%2012%2022C4%2022%204%2019.9853%204%2017.5C4%2015.0147%207.58172%2013%2012%2013C16.4183%2013%2020%2015.0147%2020%2017.5Z'%20fill='%231C274C'/%3e%3c/svg%3e",xX="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M22%2012C22%2017.5228%2017.5228%2022%2012%2022C6.47715%2022%202%2017.5228%202%2012C2%206.47715%206.47715%202%2012%202C17.5228%202%2022%206.47715%2022%2012ZM15%209C15%2010.6569%2013.6569%2012%2012%2012C10.3431%2012%209%2010.6569%209%209C9%207.34315%2010.3431%206%2012%206C13.6569%206%2015%207.34315%2015%209ZM12%2020.5C13.784%2020.5%2015.4397%2019.9504%2016.8069%2019.0112C17.4108%2018.5964%2017.6688%2017.8062%2017.3178%2017.1632C16.59%2015.8303%2015.0902%2015%2011.9999%2015C8.90969%2015%207.40997%2015.8302%206.68214%2017.1632C6.33105%2017.8062%206.5891%2018.5963%207.19296%2019.0111C8.56018%2019.9503%2010.2159%2020.5%2012%2020.5Z'%20fill='%231C274C'/%3e%3c/svg%3e",wX="/assets/logo-Dab2cwtx.png";var t_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},bX=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],a=t[n++],l=((r&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(l>>10)),e[s++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},aF={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,a=o?t[r+1]:0,l=r+2<t.length,c=l?t[r+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let d=(a&15)<<2|c>>6,f=c&63;l||(f=64,o||(d=64)),s.push(n[u],n[h],n[d],n[f])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(oF(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):bX(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;const c=r<t.length?n[t.charAt(r)]:64;++r;const h=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||a==null||c==null||h==null)throw new CX;const d=i<<2|a>>4;if(s.push(d),c!==64){const f=a<<4&240|c>>2;if(s.push(f),h!==64){const p=c<<6&192|h;s.push(p)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class CX extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const SX=function(t){const e=oF(t);return aF.encodeByteArray(e,!0)},o2=function(t){return SX(t).replace(/\./g,"")},lF=function(t){try{return aF.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IX(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kX=()=>IX().__FIREBASE_DEFAULTS__,TX=()=>{if(typeof process>"u"||typeof t_>"u")return;const t=t_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},EX=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&lF(t[1]);return e&&JSON.parse(e)},KI=()=>{try{return kX()||TX()||EX()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},cF=t=>{var e,n;return(n=(e=KI())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},uF=t=>{const e=cF(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},hF=()=>{var t;return(t=KI())===null||t===void 0?void 0:t.config},dF=t=>{var e;return(e=KI())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NX{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fF(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[o2(JSON.stringify(n)),o2(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Os(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function _X(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Os())}function $X(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function RX(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function AX(){const t=Os();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function DX(){try{return typeof indexedDB=="object"}catch{return!1}}function PX(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var i;e(((i=r.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OX="FirebaseError";class Do extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=OX,Object.setPrototypeOf(this,Do.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,dm.prototype.create)}}class dm{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?FX(i,s):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Do(r,a,s)}}function FX(t,e){return t.replace(LX,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const LX=/\{\$([^}]+)}/g;function MX(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function a2(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],o=e[r];if(n_(i)&&n_(o)){if(!a2(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function n_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fm(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Lf(t){const e={};return t.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[r,i]=s.split("=");e[decodeURIComponent(r)]=decodeURIComponent(i)}}),e}function Mf(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function BX(t,e){const n=new VX(t,e);return n.subscribe.bind(n)}class VX{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let r;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");UX(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:s},r.next===void 0&&(r.next=mw),r.error===void 0&&(r.error=mw),r.complete===void 0&&(r.complete=mw);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function UX(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function mw(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ls(t){return t&&t._delegate?t._delegate:t}class $l{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tc="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zX{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new NX;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(jX(e))try{this.getOrInitializeService({instanceIdentifier:Tc})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=Tc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Tc){return this.instances.has(e)}getOptions(e=Tc){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);s===a&&o.resolve(r)}return r}onInit(e,n){var s;const r=this.normalizeInstanceIdentifier(n),i=(s=this.onInitCallbacks.get(r))!==null&&s!==void 0?s:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:WX(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Tc){return this.component?this.component.multipleInstances?e:Tc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function WX(t){return t===Tc?void 0:t}function jX(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GX{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new zX(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var St;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(St||(St={}));const HX={debug:St.DEBUG,verbose:St.VERBOSE,info:St.INFO,warn:St.WARN,error:St.ERROR,silent:St.SILENT},KX=St.INFO,qX={[St.DEBUG]:"log",[St.VERBOSE]:"log",[St.INFO]:"info",[St.WARN]:"warn",[St.ERROR]:"error"},XX=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=qX[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let qI=class{constructor(e){this.name=e,this._logLevel=KX,this._logHandler=XX,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in St))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?HX[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,St.DEBUG,...e),this._logHandler(this,St.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,St.VERBOSE,...e),this._logHandler(this,St.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,St.INFO,...e),this._logHandler(this,St.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,St.WARN,...e),this._logHandler(this,St.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,St.ERROR,...e),this._logHandler(this,St.ERROR,...e)}};const YX=(t,e)=>e.some(n=>t instanceof n);let s_,r_;function JX(){return s_||(s_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ZX(){return r_||(r_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const pF=new WeakMap,fC=new WeakMap,mF=new WeakMap,gw=new WeakMap,XI=new WeakMap;function QX(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(xl(t.result)),r()},o=()=>{s(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&pF.set(n,t)}).catch(()=>{}),XI.set(e,t),e}function eY(t){if(fC.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),r()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});fC.set(t,e)}let pC={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return fC.get(t);if(e==="objectStoreNames")return t.objectStoreNames||mF.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return xl(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function tY(t){pC=t(pC)}function nY(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(yw(this),e,...n);return mF.set(s,e.sort?e.sort():[e]),xl(s)}:ZX().includes(t)?function(...e){return t.apply(yw(this),e),xl(pF.get(this))}:function(...e){return xl(t.apply(yw(this),e))}}function sY(t){return typeof t=="function"?nY(t):(t instanceof IDBTransaction&&eY(t),YX(t,JX())?new Proxy(t,pC):t)}function xl(t){if(t instanceof IDBRequest)return QX(t);if(gw.has(t))return gw.get(t);const e=sY(t);return e!==t&&(gw.set(t,e),XI.set(e,t)),e}const yw=t=>XI.get(t);function rY(t,e,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(t,e),a=xl(o);return s&&o.addEventListener("upgradeneeded",l=>{s(xl(o.result),l.oldVersion,l.newVersion,xl(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const iY=["get","getKey","getAll","getAllKeys","count"],oY=["put","add","delete","clear"],vw=new Map;function i_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(vw.get(e))return vw.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=oY.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||iY.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let c=l.store;return s&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),r&&l.done]))[0]};return vw.set(e,i),i}tY(t=>({...t,get:(e,n,s)=>i_(e,n)||t.get(e,n,s),has:(e,n)=>!!i_(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aY{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(lY(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function lY(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const mC="@firebase/app",o_="0.10.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tu=new qI("@firebase/app"),cY="@firebase/app-compat",uY="@firebase/analytics-compat",hY="@firebase/analytics",dY="@firebase/app-check-compat",fY="@firebase/app-check",pY="@firebase/auth",mY="@firebase/auth-compat",gY="@firebase/database",yY="@firebase/database-compat",vY="@firebase/functions",xY="@firebase/functions-compat",wY="@firebase/installations",bY="@firebase/installations-compat",CY="@firebase/messaging",SY="@firebase/messaging-compat",IY="@firebase/performance",kY="@firebase/performance-compat",TY="@firebase/remote-config",EY="@firebase/remote-config-compat",NY="@firebase/storage",_Y="@firebase/storage-compat",$Y="@firebase/firestore",RY="@firebase/vertexai-preview",AY="@firebase/firestore-compat",DY="firebase",PY="10.12.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gC="[DEFAULT]",OY={[mC]:"fire-core",[cY]:"fire-core-compat",[hY]:"fire-analytics",[uY]:"fire-analytics-compat",[fY]:"fire-app-check",[dY]:"fire-app-check-compat",[pY]:"fire-auth",[mY]:"fire-auth-compat",[gY]:"fire-rtdb",[yY]:"fire-rtdb-compat",[vY]:"fire-fn",[xY]:"fire-fn-compat",[wY]:"fire-iid",[bY]:"fire-iid-compat",[CY]:"fire-fcm",[SY]:"fire-fcm-compat",[IY]:"fire-perf",[kY]:"fire-perf-compat",[TY]:"fire-rc",[EY]:"fire-rc-compat",[NY]:"fire-gcs",[_Y]:"fire-gcs-compat",[$Y]:"fire-fst",[AY]:"fire-fst-compat",[RY]:"fire-vertex","fire-js":"fire-js",[DY]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2=new Map,FY=new Map,yC=new Map;function a_(t,e){try{t.container.addComponent(e)}catch(n){tu.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function nu(t){const e=t.name;if(yC.has(e))return tu.debug(`There were multiple attempts to register component ${e}.`),!1;yC.set(e,t);for(const n of l2.values())a_(n,t);for(const n of FY.values())a_(n,t);return!0}function ky(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function na(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LY={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},wl=new dm("app","Firebase",LY);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MY{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new $l("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw wl.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Su=PY;function gF(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s=Object.assign({name:gC,automaticDataCollectionEnabled:!1},e),r=s.name;if(typeof r!="string"||!r)throw wl.create("bad-app-name",{appName:String(r)});if(n||(n=hF()),!n)throw wl.create("no-options");const i=l2.get(r);if(i){if(a2(n,i.options)&&a2(s,i.config))return i;throw wl.create("duplicate-app",{appName:r})}const o=new GX(r);for(const l of yC.values())o.addComponent(l);const a=new MY(n,s,o);return l2.set(r,a),a}function YI(t=gC){const e=l2.get(t);if(!e&&t===gC&&hF())return gF();if(!e)throw wl.create("no-app",{appName:t});return e}function vo(t,e,n){var s;let r=(s=OY[t])!==null&&s!==void 0?s:t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),tu.warn(a.join(" "));return}nu(new $l(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BY="firebase-heartbeat-database",VY=1,Mp="firebase-heartbeat-store";let xw=null;function yF(){return xw||(xw=rY(BY,VY,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Mp)}catch(n){console.warn(n)}}}}).catch(t=>{throw wl.create("idb-open",{originalErrorMessage:t.message})})),xw}async function UY(t){try{const n=(await yF()).transaction(Mp),s=await n.objectStore(Mp).get(vF(t));return await n.done,s}catch(e){if(e instanceof Do)tu.warn(e.message);else{const n=wl.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});tu.warn(n.message)}}}async function l_(t,e){try{const s=(await yF()).transaction(Mp,"readwrite");await s.objectStore(Mp).put(e,vF(t)),await s.done}catch(n){if(n instanceof Do)tu.warn(n.message);else{const s=wl.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});tu.warn(s.message)}}}function vF(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zY=1024,WY=30*24*60*60*1e3;class jY{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new HY(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=c_();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=WY}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=c_(),{heartbeatsToSend:s,unsentEntries:r}=GY(this._heartbeatsCache.heartbeats),i=o2(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function c_(){return new Date().toISOString().substring(0,10)}function GY(t,e=zY){const n=[];let s=t.slice();for(const r of t){const i=n.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),u_(n)>e){i.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),u_(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class HY{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return DX()?PX().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await UY(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return l_(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return l_(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function u_(t){return o2(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KY(t){nu(new $l("platform-logger",e=>new aY(e),"PRIVATE")),nu(new $l("heartbeat",e=>new jY(e),"PRIVATE")),vo(mC,o_,t),vo(mC,o_,"esm2017"),vo("fire-js","")}KY("");function xF(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const qY=xF,wF=new dm("auth","Firebase",xF());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c2=new qI("@firebase/auth");function XY(t,...e){c2.logLevel<=St.WARN&&c2.warn(`Auth (${Su}): ${t}`,...e)}function g1(t,...e){c2.logLevel<=St.ERROR&&c2.error(`Auth (${Su}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wi(t,...e){throw JI(t,...e)}function xo(t,...e){return JI(t,...e)}function bF(t,e,n){const s=Object.assign(Object.assign({},qY()),{[e]:n});return new dm("auth","Firebase",s).create(e,{appName:t.name})}function bl(t){return bF(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function JI(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return wF.create(t,...e)}function Ke(t,e,...n){if(!t)throw JI(e,...n)}function sa(t){const e="INTERNAL ASSERTION FAILED: "+t;throw g1(e),new Error(e)}function ga(t,e){t||sa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vC(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function YY(){return h_()==="http:"||h_()==="https:"}function h_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JY(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(YY()||$X()||"connection"in navigator)?navigator.onLine:!0}function ZY(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm{constructor(e,n){this.shortDelay=e,this.longDelay=n,ga(n>e,"Short delay should be less than long delay!"),this.isMobile=_X()||RX()}get(){return JY()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZI(t,e){ga(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CF{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;sa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;sa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;sa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QY={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eJ=new pm(3e4,6e4);function Wl(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Sa(t,e,n,s,r={}){return SF(t,r,async()=>{let i={},o={};s&&(e==="GET"?o=s:i={body:JSON.stringify(s)});const a=fm(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode),CF.fetch()(IF(t,t.config.apiHost,n,a),Object.assign({method:e,headers:l,referrerPolicy:"no-referrer"},i))})}async function SF(t,e,n){t._canInitEmulator=!1;const s=Object.assign(Object.assign({},QY),e);try{const r=new nJ(t),i=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw D0(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw D0(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw D0(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw D0(t,"user-disabled",o);const u=s[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw bF(t,u,c);Wi(t,u)}}catch(r){if(r instanceof Do)throw r;Wi(t,"network-request-failed",{message:String(r)})}}async function Ty(t,e,n,s,r={}){const i=await Sa(t,e,n,s,r);return"mfaPendingCredential"in i&&Wi(t,"multi-factor-auth-required",{_serverResponse:i}),i}function IF(t,e,n,s){const r=`${e}${n}?${s}`;return t.config.emulator?ZI(t.config,r):`${t.config.apiScheme}://${r}`}function tJ(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class nJ{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(xo(this.auth,"network-request-failed")),eJ.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function D0(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const r=xo(t,e,s);return r.customData._tokenResponse=n,r}function d_(t){return t!==void 0&&t.enterprise!==void 0}class sJ{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return tJ(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function rJ(t,e){return Sa(t,"GET","/v2/recaptchaConfig",Wl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iJ(t,e){return Sa(t,"POST","/v1/accounts:delete",e)}async function kF(t,e){return Sa(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lp(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function oJ(t,e=!1){const n=Ls(t),s=await n.getIdToken(e),r=QI(s);Ke(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:r,token:s,authTime:lp(ww(r.auth_time)),issuedAtTime:lp(ww(r.iat)),expirationTime:lp(ww(r.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function ww(t){return Number(t)*1e3}function QI(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return g1("JWT malformed, contained fewer than 3 sections"),null;try{const r=lF(n);return r?JSON.parse(r):(g1("Failed to decode base64 JWT payload"),null)}catch(r){return g1("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function f_(t){const e=QI(t);return Ke(e,"internal-error"),Ke(typeof e.exp<"u","internal-error"),Ke(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bp(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof Do&&aJ(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function aJ({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lJ{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const r=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=lp(this.lastLoginAt),this.creationTime=lp(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u2(t){var e;const n=t.auth,s=await t.getIdToken(),r=await Bp(t,kF(n,{idToken:s}));Ke(r==null?void 0:r.users.length,n,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?TF(i.providerUserInfo):[],a=uJ(t.providerData,o),l=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),u=l?c:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new xC(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function cJ(t){const e=Ls(t);await u2(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function uJ(t,e){return[...t.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function TF(t){return t.map(e=>{var{providerId:n}=e,s=hI(e,["providerId"]);return{providerId:n,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hJ(t,e){const n=await SF(t,{},async()=>{const s=fm({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=t.config,o=IF(t,r,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",CF.fetch()(o,{method:"POST",headers:a,body:s})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function dJ(t,e){return Sa(t,"POST","/v2/accounts:revokeToken",Wl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ke(e.idToken,"internal-error"),Ke(typeof e.idToken<"u","internal-error"),Ke(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):f_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ke(e.length!==0,"internal-error");const n=f_(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ke(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:r,expiresIn:i}=await hJ(e,n);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:r,expirationTime:i}=n,o=new Mh;return s&&(Ke(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),r&&(Ke(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),i&&(Ke(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Mh,this.toJSON())}_performRefresh(){return sa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Va(t,e){Ke(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ra{constructor(e){var{uid:n,auth:s,stsTokenManager:r}=e,i=hI(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new lJ(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=s,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new xC(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Bp(this,this.stsTokenManager.getToken(this.auth,e));return Ke(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return oJ(this,e)}reload(){return cJ(this)}_assign(e){this!==e&&(Ke(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ra(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Ke(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await u2(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(na(this.auth.app))return Promise.reject(bl(this.auth));const e=await this.getIdToken();return await Bp(this,iJ(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var s,r,i,o,a,l,c,u;const h=(s=n.displayName)!==null&&s!==void 0?s:void 0,d=(r=n.email)!==null&&r!==void 0?r:void 0,f=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,p=(o=n.photoURL)!==null&&o!==void 0?o:void 0,g=(a=n.tenantId)!==null&&a!==void 0?a:void 0,m=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,y=(c=n.createdAt)!==null&&c!==void 0?c:void 0,w=(u=n.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:b,emailVerified:C,isAnonymous:k,providerData:$,stsTokenManager:I}=n;Ke(b&&I,e,"internal-error");const T=Mh.fromJSON(this.name,I);Ke(typeof b=="string",e,"internal-error"),Va(h,e.name),Va(d,e.name),Ke(typeof C=="boolean",e,"internal-error"),Ke(typeof k=="boolean",e,"internal-error"),Va(f,e.name),Va(p,e.name),Va(g,e.name),Va(m,e.name),Va(y,e.name),Va(w,e.name);const R=new ra({uid:b,auth:e,email:d,emailVerified:C,displayName:h,isAnonymous:k,photoURL:p,phoneNumber:f,tenantId:g,stsTokenManager:T,createdAt:y,lastLoginAt:w});return $&&Array.isArray($)&&(R.providerData=$.map(E=>Object.assign({},E))),m&&(R._redirectEventId=m),R}static async _fromIdTokenResponse(e,n,s=!1){const r=new Mh;r.updateFromServerResponse(n);const i=new ra({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await u2(i),i}static async _fromGetAccountInfoResponse(e,n,s){const r=n.users[0];Ke(r.localId!==void 0,"internal-error");const i=r.providerUserInfo!==void 0?TF(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(i!=null&&i.length),a=new Mh;a.updateFromIdToken(s);const l=new ra({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new xC(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p_=new Map;function ia(t){ga(t instanceof Function,"Expected a class definition");let e=p_.get(t);return e?(ga(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,p_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EF{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}EF.type="NONE";const m_=EF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y1(t,e,n){return`firebase:${t}:${e}:${n}`}class Bh{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=y1(this.userKey,r.apiKey,i),this.fullPersistenceKey=y1("persistence",r.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ra._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new Bh(ia(m_),e,s);const r=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=r[0]||ia(m_);const o=y1(s,e.config.apiKey,e.name);let a=null;for(const c of n)try{const u=await c._get(o);if(u){const h=ra._fromJSON(e,u);c!==i&&(a=h),i=c;break}}catch{}const l=r.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Bh(i,e,s):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new Bh(i,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if($F(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(NF(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(AF(e))return"Blackberry";if(DF(e))return"Webos";if(ek(e))return"Safari";if((e.includes("chrome/")||_F(e))&&!e.includes("edge/"))return"Chrome";if(RF(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function NF(t=Os()){return/firefox\//i.test(t)}function ek(t=Os()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function _F(t=Os()){return/crios\//i.test(t)}function $F(t=Os()){return/iemobile/i.test(t)}function RF(t=Os()){return/android/i.test(t)}function AF(t=Os()){return/blackberry/i.test(t)}function DF(t=Os()){return/webos/i.test(t)}function Ey(t=Os()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function fJ(t=Os()){var e;return Ey(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function pJ(){return AX()&&document.documentMode===10}function PF(t=Os()){return Ey(t)||RF(t)||DF(t)||AF(t)||/windows phone/i.test(t)||$F(t)}function mJ(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OF(t,e=[]){let n;switch(t){case"Browser":n=g_(Os());break;case"Worker":n=`${g_(Os())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Su}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gJ{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});s.onAbort=n,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yJ(t,e={}){return Sa(t,"GET","/v2/passwordPolicy",Wl(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vJ=6;class xJ{constructor(e){var n,s,r,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:vJ,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,s,r,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(r=l.containsLowercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),r&&(n.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wJ{constructor(e,n,s,r){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new y_(this),this.idTokenSubscription=new y_(this),this.beforeStateQueue=new gJ(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=wF,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ia(n)),this._initializationPromise=this.queue(async()=>{var s,r;if(!this._deleted&&(this.persistenceManager=await Bh.create(this,e),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await kF(this,{idToken:e}),s=await ra._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(na(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let r=s,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ke(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await u2(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ZY()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(na(this.app))return Promise.reject(bl(this));const n=e?Ls(e):null;return n&&Ke(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ke(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return na(this.app)?Promise.reject(bl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return na(this.app)?Promise.reject(bl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ia(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await yJ(this),n=new xJ(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new dm("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await dJ(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ia(e)||this._popupRedirectResolver;Ke(n,this,"argument-error"),this.redirectPersistenceManager=await Bh.create(this,[ia(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,s;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,r){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ke(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,s,r);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ke(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=OF(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(n["X-Firebase-Client"]=s);const r=await this._getAppCheckToken();return r&&(n["X-Firebase-AppCheck"]=r),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&XY(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Iu(t){return Ls(t)}class y_{constructor(e){this.auth=e,this.observer=null,this.addObserver=BX(n=>this.observer=n)}get next(){return Ke(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ny={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function bJ(t){Ny=t}function FF(t){return Ny.loadJS(t)}function CJ(){return Ny.recaptchaEnterpriseScript}function SJ(){return Ny.gapiScript}function IJ(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const kJ="recaptcha-enterprise",TJ="NO_RECAPTCHA";class EJ{constructor(e){this.type=kJ,this.auth=Iu(e)}async verify(e="verify",n=!1){async function s(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{rJ(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new sJ(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function r(i,o,a){const l=window.grecaptcha;d_(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(TJ)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{s(this.auth).then(a=>{if(!n&&d_(window.grecaptcha))r(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=CJ();l.length!==0&&(l+=a),FF(l).then(()=>{r(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function v_(t,e,n,s=!1){const r=new EJ(t);let i;try{i=await r.verify(n)}catch{i=await r.verify(n,!0)}const o=Object.assign({},e);return s?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function wC(t,e,n,s){var r;if(!((r=t._getRecaptchaConfig())===null||r===void 0)&&r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await v_(t,e,n,n==="getOobCode");return s(t,i)}else return s(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await v_(t,e,n,n==="getOobCode");return s(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NJ(t,e){const n=ky(t,"auth");if(n.isInitialized()){const r=n.getImmediate(),i=n.getOptions();if(a2(i,e??{}))return r;Wi(r,"already-initialized")}return n.initialize({options:e})}function _J(t,e){const n=(e==null?void 0:e.persistence)||[],s=(Array.isArray(n)?n:[n]).map(ia);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function $J(t,e,n){const s=Iu(t);Ke(s._canInitEmulator,s,"emulator-config-failed"),Ke(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!1,i=LF(e),{host:o,port:a}=RJ(e),l=a===null?"":`:${a}`;s.config.emulator={url:`${i}//${o}${l}/`},s.settings.appVerificationDisabledForTesting=!0,s.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})}),AJ()}function LF(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function RJ(t){const e=LF(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:x_(s.substr(i.length+1))}}else{const[i,o]=s.split(":");return{host:i,port:x_(o)}}}function x_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function AJ(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return sa("not implemented")}_getIdTokenResponse(e){return sa("not implemented")}_linkToIdToken(e,n){return sa("not implemented")}_getReauthenticationResolver(e){return sa("not implemented")}}async function DJ(t,e){return Sa(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PJ(t,e){return Ty(t,"POST","/v1/accounts:signInWithPassword",Wl(t,e))}async function MF(t,e){return Sa(t,"POST","/v1/accounts:sendOobCode",Wl(t,e))}async function OJ(t,e){return MF(t,e)}async function FJ(t,e){return MF(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LJ(t,e){return Ty(t,"POST","/v1/accounts:signInWithEmailLink",Wl(t,e))}async function MJ(t,e){return Ty(t,"POST","/v1/accounts:signInWithEmailLink",Wl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vp extends tk{constructor(e,n,s,r=null){super("password",s),this._email=e,this._password=n,this._tenantId=r}static _fromEmailAndPassword(e,n){return new Vp(e,n,"password")}static _fromEmailAndCode(e,n,s=null){return new Vp(e,n,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return wC(e,n,"signInWithPassword",PJ);case"emailLink":return LJ(e,{email:this._email,oobCode:this._password});default:Wi(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const s={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return wC(e,s,"signUpPassword",DJ);case"emailLink":return MJ(e,{idToken:n,email:this._email,oobCode:this._password});default:Wi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vh(t,e){return Ty(t,"POST","/v1/accounts:signInWithIdp",Wl(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BJ="http://localhost";class su extends tk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new su(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Wi("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r}=n,i=hI(n,["providerId","signInMethod"]);if(!s||!r)return null;const o=new su(s,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Vh(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,Vh(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Vh(e,n)}buildRequest(){const e={requestUri:BJ,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=fm(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VJ(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function UJ(t){const e=Lf(Mf(t)).link,n=e?Lf(Mf(e)).deep_link_id:null,s=Lf(Mf(t)).deep_link_id;return(s?Lf(Mf(s)).link:null)||s||n||e||t}class nk{constructor(e){var n,s,r,i,o,a;const l=Lf(Mf(e)),c=(n=l.apiKey)!==null&&n!==void 0?n:null,u=(s=l.oobCode)!==null&&s!==void 0?s:null,h=VJ((r=l.mode)!==null&&r!==void 0?r:null);Ke(c&&u&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=u,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=UJ(e);try{return new nk(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(){this.providerId=_d.PROVIDER_ID}static credential(e,n){return Vp._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const s=nk.parseLink(n);return Ke(s,"argument-error"),Vp._fromEmailAndCode(e,s.code,s.tenantId)}}_d.PROVIDER_ID="password";_d.EMAIL_PASSWORD_SIGN_IN_METHOD="password";_d.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BF{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mm extends BF{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa extends mm{constructor(){super("facebook.com")}static credential(e){return su._fromParams({providerId:Xa.PROVIDER_ID,signInMethod:Xa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xa.credentialFromTaggedObject(e)}static credentialFromError(e){return Xa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xa.credential(e.oauthAccessToken)}catch{return null}}}Xa.FACEBOOK_SIGN_IN_METHOD="facebook.com";Xa.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya extends mm{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return su._fromParams({providerId:Ya.PROVIDER_ID,signInMethod:Ya.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ya.credentialFromTaggedObject(e)}static credentialFromError(e){return Ya.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return Ya.credential(n,s)}catch{return null}}}Ya.GOOGLE_SIGN_IN_METHOD="google.com";Ya.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja extends mm{constructor(){super("github.com")}static credential(e){return su._fromParams({providerId:Ja.PROVIDER_ID,signInMethod:Ja.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ja.credentialFromTaggedObject(e)}static credentialFromError(e){return Ja.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ja.credential(e.oauthAccessToken)}catch{return null}}}Ja.GITHUB_SIGN_IN_METHOD="github.com";Ja.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za extends mm{constructor(){super("twitter.com")}static credential(e,n){return su._fromParams({providerId:Za.PROVIDER_ID,signInMethod:Za.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Za.credentialFromTaggedObject(e)}static credentialFromError(e){return Za.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return Za.credential(n,s)}catch{return null}}}Za.TWITTER_SIGN_IN_METHOD="twitter.com";Za.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,r=!1){const i=await ra._fromIdTokenResponse(e,s,r),o=w_(s);return new ad({user:i,providerId:o,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const r=w_(s);return new ad({user:e,providerId:r,_tokenResponse:s,operationType:n})}}function w_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2 extends Do{constructor(e,n,s,r){var i;super(n.code,n.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,h2.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,r){return new h2(e,n,s,r)}}function VF(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?h2._fromErrorAndOperation(t,i,e,s):i})}async function zJ(t,e,n=!1){const s=await Bp(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ad._forOperation(t,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WJ(t,e,n=!1){const{auth:s}=t;if(na(s.app))return Promise.reject(bl(s));const r="reauthenticate";try{const i=await Bp(t,VF(s,r,e,t),n);Ke(i.idToken,s,"internal-error");const o=QI(i.idToken);Ke(o,s,"internal-error");const{sub:a}=o;return Ke(t.uid===a,s,"user-mismatch"),ad._forOperation(t,r,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Wi(s,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UF(t,e,n=!1){if(na(t.app))return Promise.reject(bl(t));const s="signIn",r=await VF(t,s,e),i=await ad._fromIdTokenResponse(t,s,r);return n||await t._updateCurrentUser(i.user),i}async function jJ(t,e){return UF(Iu(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GJ(t){const e=Iu(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function HJ(t,e,n){const s=Iu(t);await wC(s,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",FJ)}function b_(t,e,n){return na(t.app)?Promise.reject(bl(t)):jJ(Ls(t),_d.credential(e,n)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&GJ(t),s})}async function KJ(t,e){const n=Ls(t),r={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:i}=await OJ(n.auth,r);i!==t.email&&await t.reload()}function qJ(t,e,n,s){return Ls(t).onIdTokenChanged(e,n,s)}function XJ(t,e,n){return Ls(t).beforeAuthStateChanged(e,n)}function zF(t){return Ls(t).signOut()}const d2="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WF{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(d2,"1"),this.storage.removeItem(d2),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YJ(){const t=Os();return ek(t)||Ey(t)}const JJ=1e3,ZJ=10;class jF extends WF{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=YJ()&&mJ(),this.fallbackToPolling=PF(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),r=this.localCache[n];s!==r&&e(n,r,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const s=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(s);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(s,e.newValue):this.storage.removeItem(s);else if(this.localCache[s]===e.newValue&&!n)return}const r=()=>{const o=this.storage.getItem(s);!n&&this.localCache[s]===o||this.notifyListeners(s,o)},i=this.storage.getItem(s);pJ()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,ZJ):r()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},JJ)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}jF.type="LOCAL";const QJ=jF;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GF extends WF{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}GF.type="SESSION";const HF=GF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eZ(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;const s=new _y(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:r,data:i}=n.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const a=Array.from(o).map(async c=>c(n.origin,i)),l=await eZ(a);n.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}_y.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sk(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tZ{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=sk("",20);r.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},s);o={messageChannel:r,onMessage(h){const d=h;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(d.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wo(){return window}function nZ(t){wo().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KF(){return typeof wo().WorkerGlobalScope<"u"&&typeof wo().importScripts=="function"}async function sZ(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function rZ(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function iZ(){return KF()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qF="firebaseLocalStorageDb",oZ=1,f2="firebaseLocalStorage",XF="fbase_key";class gm{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function $y(t,e){return t.transaction([f2],e?"readwrite":"readonly").objectStore(f2)}function aZ(){const t=indexedDB.deleteDatabase(qF);return new gm(t).toPromise()}function bC(){const t=indexedDB.open(qF,oZ);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(f2,{keyPath:XF})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(f2)?e(s):(s.close(),await aZ(),e(await bC()))})})}async function C_(t,e,n){const s=$y(t,!0).put({[XF]:e,value:n});return new gm(s).toPromise()}async function lZ(t,e){const n=$y(t,!1).get(e),s=await new gm(n).toPromise();return s===void 0?null:s.value}function S_(t,e){const n=$y(t,!0).delete(e);return new gm(n).toPromise()}const cZ=800,uZ=3;class YF{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await bC(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>uZ)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return KF()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=_y._getInstance(iZ()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await sZ(),!this.activeServiceWorker)return;this.sender=new tZ(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((n=s[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||rZ()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await bC();return await C_(e,d2,"1"),await S_(e,d2),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>C_(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>lZ(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>S_(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=$y(r,!1).getAll();return new gm(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),cZ)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}YF.type="LOCAL";const hZ=YF;new pm(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dZ(t,e){return e?ia(e):(Ke(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk extends tk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Vh(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Vh(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Vh(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function fZ(t){return UF(t.auth,new rk(t),t.bypassAuthState)}function pZ(t){const{auth:e,user:n}=t;return Ke(n,e,"internal-error"),WJ(n,new rk(t),t.bypassAuthState)}async function mZ(t){const{auth:e,user:n}=t;return Ke(n,e,"internal-error"),zJ(n,new rk(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JF{constructor(e,n,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:r,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return fZ;case"linkViaPopup":case"linkViaRedirect":return mZ;case"reauthViaPopup":case"reauthViaRedirect":return pZ;default:Wi(this.auth,"internal-error")}}resolve(e){ga(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ga(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gZ=new pm(2e3,1e4);class $h extends JF{constructor(e,n,s,r,i){super(e,n,r,i),this.provider=s,this.authWindow=null,this.pollId=null,$h.currentPopupAction&&$h.currentPopupAction.cancel(),$h.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ke(e,this.auth,"internal-error"),e}async onExecution(){ga(this.filter.length===1,"Popup operations only handle one event");const e=sk();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(xo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(xo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$h.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,s;if(!((s=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(xo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,gZ.get())};e()}}$h.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yZ="pendingRedirect",v1=new Map;class vZ extends JF{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=v1.get(this.auth._key());if(!e){try{const s=await xZ(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}v1.set(this.auth._key(),e)}return this.bypassAuthState||v1.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function xZ(t,e){const n=CZ(e),s=bZ(t);if(!await s._isAvailable())return!1;const r=await s._get(n)==="true";return await s._remove(n),r}function wZ(t,e){v1.set(t._key(),e)}function bZ(t){return ia(t._redirectPersistence)}function CZ(t){return y1(yZ,t.config.apiKey,t.name)}async function SZ(t,e,n=!1){if(na(t.app))return Promise.reject(bl(t));const s=Iu(t),r=dZ(s,e),o=await new vZ(s,r,n).execute();return o&&!n&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IZ=10*60*1e3;class kZ{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!TZ(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var s;if(e.error&&!ZF(e)){const r=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";n.onError(xo(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=IZ&&this.cachedEventUids.clear(),this.cachedEventUids.has(I_(e))}saveEventToCache(e){this.cachedEventUids.add(I_(e)),this.lastProcessedEventTime=Date.now()}}function I_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function ZF({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function TZ(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ZF(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EZ(t,e={}){return Sa(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NZ=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_Z=/^https?/;async function $Z(t){if(t.config.emulator)return;const{authorizedDomains:e}=await EZ(t);for(const n of e)try{if(RZ(n))return}catch{}Wi(t,"unauthorized-domain")}function RZ(t){const e=vC(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===s}if(!_Z.test(n))return!1;if(NZ.test(t))return s===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AZ=new pm(3e4,6e4);function k_(){const t=wo().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function DZ(t){return new Promise((e,n)=>{var s,r,i;function o(){k_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{k_(),n(xo(t,"network-request-failed"))},timeout:AZ.get()})}if(!((r=(s=wo().gapi)===null||s===void 0?void 0:s.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((i=wo().gapi)===null||i===void 0)&&i.load)o();else{const a=IJ("iframefcb");return wo()[a]=()=>{gapi.load?o():n(xo(t,"network-request-failed"))},FF(`${SJ()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw x1=null,e})}let x1=null;function PZ(t){return x1=x1||DZ(t),x1}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OZ=new pm(5e3,15e3),FZ="__/auth/iframe",LZ="emulator/auth/iframe",MZ={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},BZ=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function VZ(t){const e=t.config;Ke(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?ZI(e,LZ):`https://${t.config.authDomain}/${FZ}`,s={apiKey:e.apiKey,appName:t.name,v:Su},r=BZ.get(t.config.apiHost);r&&(s.eid=r);const i=t._getFrameworks();return i.length&&(s.fw=i.join(",")),`${n}?${fm(s).slice(1)}`}async function UZ(t){const e=await PZ(t),n=wo().gapi;return Ke(n,t,"internal-error"),e.open({where:document.body,url:VZ(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:MZ,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const o=xo(t,"network-request-failed"),a=wo().setTimeout(()=>{i(o)},OZ.get());function l(){wo().clearTimeout(a),r(s)}s.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zZ={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},WZ=500,jZ=600,GZ="_blank",HZ="http://localhost";class T_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function KZ(t,e,n,s=WZ,r=jZ){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const l=Object.assign(Object.assign({},zZ),{width:s.toString(),height:r.toString(),top:i,left:o}),c=Os().toLowerCase();n&&(a=_F(c)?GZ:n),NF(c)&&(e=e||HZ,l.scrollbars="yes");const u=Object.entries(l).reduce((d,[f,p])=>`${d}${f}=${p},`,"");if(fJ(c)&&a!=="_self")return qZ(e||"",a),new T_(null);const h=window.open(e||"",a,u);Ke(h,t,"popup-blocked");try{h.focus()}catch{}return new T_(h)}function qZ(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XZ="__/auth/handler",YZ="emulator/auth/handler",JZ=encodeURIComponent("fac");async function E_(t,e,n,s,r,i){Ke(t.config.authDomain,t,"auth-domain-config-required"),Ke(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:Su,eventId:r};if(e instanceof BF){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",MX(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))o[u]=h}if(e instanceof mm){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await t._getAppCheckToken(),c=l?`#${JZ}=${encodeURIComponent(l)}`:"";return`${ZZ(t)}?${fm(a).slice(1)}${c}`}function ZZ({config:t}){return t.emulator?ZI(t,YZ):`https://${t.authDomain}/${XZ}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bw="webStorageSupport";class QZ{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=HF,this._completeRedirectFn=SZ,this._overrideRedirectResult=wZ}async _openPopup(e,n,s,r){var i;ga((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await E_(e,n,s,vC(),r);return KZ(e,o,sk())}async _openRedirect(e,n,s,r){await this._originValidation(e);const i=await E_(e,n,s,vC(),r);return nZ(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:r,promise:i}=this.eventManagers[n];return r?Promise.resolve(r):(ga(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await UZ(e),s=new kZ(e);return n.register("authEvent",r=>(Ke(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(bw,{type:bw},r=>{var i;const o=(i=r==null?void 0:r[0])===null||i===void 0?void 0:i[bw];o!==void 0&&n(!!o),Wi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=$Z(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return PF()||ek()||Ey()}}const eQ=QZ;var N_="@firebase/auth",__="1.7.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tQ{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ke(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nQ(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function sQ(t){nu(new $l("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=s.options;Ke(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:OF(t)},c=new wJ(s,r,i,l);return _J(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),nu(new $l("auth-internal",e=>{const n=Iu(e.getProvider("auth").getImmediate());return(s=>new tQ(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),vo(N_,__,nQ(t)),vo(N_,__,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rQ=5*60,iQ=dF("authIdTokenMaxAge")||rQ;let $_=null;const oQ=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>iQ)return;const r=n==null?void 0:n.token;$_!==r&&($_=r,await fetch(t,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function aQ(t=YI()){const e=ky(t,"auth");if(e.isInitialized())return e.getImmediate();const n=NJ(t,{popupRedirectResolver:eQ,persistence:[hZ,QJ,HF]}),s=dF("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(s,location.origin);if(location.origin===i.origin){const o=oQ(i.toString());XJ(n,o,()=>o(n.currentUser)),qJ(n,a=>o(a))}}const r=cF("auth");return r&&$J(n,`http://${r}`),n}function lQ(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}bJ({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=r=>{const i=xo("internal-error");i.customData=r,n(i)},s.type="text/javascript",s.charset="UTF-8",lQ().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});sQ("Browser");var cQ="firebase",uQ="10.12.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vo(cQ,uQ,"app");var R_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var QF;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,T){function R(){}R.prototype=T.prototype,I.D=T.prototype,I.prototype=new R,I.prototype.constructor=I,I.C=function(E,A,F){for(var P=Array(arguments.length-2),Z=2;Z<arguments.length;Z++)P[Z-2]=arguments[Z];return T.prototype[A].apply(E,P)}}function n(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,n),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(I,T,R){R||(R=0);var E=Array(16);if(typeof T=="string")for(var A=0;16>A;++A)E[A]=T.charCodeAt(R++)|T.charCodeAt(R++)<<8|T.charCodeAt(R++)<<16|T.charCodeAt(R++)<<24;else for(A=0;16>A;++A)E[A]=T[R++]|T[R++]<<8|T[R++]<<16|T[R++]<<24;T=I.g[0],R=I.g[1],A=I.g[2];var F=I.g[3],P=T+(F^R&(A^F))+E[0]+3614090360&4294967295;T=R+(P<<7&4294967295|P>>>25),P=F+(A^T&(R^A))+E[1]+3905402710&4294967295,F=T+(P<<12&4294967295|P>>>20),P=A+(R^F&(T^R))+E[2]+606105819&4294967295,A=F+(P<<17&4294967295|P>>>15),P=R+(T^A&(F^T))+E[3]+3250441966&4294967295,R=A+(P<<22&4294967295|P>>>10),P=T+(F^R&(A^F))+E[4]+4118548399&4294967295,T=R+(P<<7&4294967295|P>>>25),P=F+(A^T&(R^A))+E[5]+1200080426&4294967295,F=T+(P<<12&4294967295|P>>>20),P=A+(R^F&(T^R))+E[6]+2821735955&4294967295,A=F+(P<<17&4294967295|P>>>15),P=R+(T^A&(F^T))+E[7]+4249261313&4294967295,R=A+(P<<22&4294967295|P>>>10),P=T+(F^R&(A^F))+E[8]+1770035416&4294967295,T=R+(P<<7&4294967295|P>>>25),P=F+(A^T&(R^A))+E[9]+2336552879&4294967295,F=T+(P<<12&4294967295|P>>>20),P=A+(R^F&(T^R))+E[10]+4294925233&4294967295,A=F+(P<<17&4294967295|P>>>15),P=R+(T^A&(F^T))+E[11]+2304563134&4294967295,R=A+(P<<22&4294967295|P>>>10),P=T+(F^R&(A^F))+E[12]+1804603682&4294967295,T=R+(P<<7&4294967295|P>>>25),P=F+(A^T&(R^A))+E[13]+4254626195&4294967295,F=T+(P<<12&4294967295|P>>>20),P=A+(R^F&(T^R))+E[14]+2792965006&4294967295,A=F+(P<<17&4294967295|P>>>15),P=R+(T^A&(F^T))+E[15]+1236535329&4294967295,R=A+(P<<22&4294967295|P>>>10),P=T+(A^F&(R^A))+E[1]+4129170786&4294967295,T=R+(P<<5&4294967295|P>>>27),P=F+(R^A&(T^R))+E[6]+3225465664&4294967295,F=T+(P<<9&4294967295|P>>>23),P=A+(T^R&(F^T))+E[11]+643717713&4294967295,A=F+(P<<14&4294967295|P>>>18),P=R+(F^T&(A^F))+E[0]+3921069994&4294967295,R=A+(P<<20&4294967295|P>>>12),P=T+(A^F&(R^A))+E[5]+3593408605&4294967295,T=R+(P<<5&4294967295|P>>>27),P=F+(R^A&(T^R))+E[10]+38016083&4294967295,F=T+(P<<9&4294967295|P>>>23),P=A+(T^R&(F^T))+E[15]+3634488961&4294967295,A=F+(P<<14&4294967295|P>>>18),P=R+(F^T&(A^F))+E[4]+3889429448&4294967295,R=A+(P<<20&4294967295|P>>>12),P=T+(A^F&(R^A))+E[9]+568446438&4294967295,T=R+(P<<5&4294967295|P>>>27),P=F+(R^A&(T^R))+E[14]+3275163606&4294967295,F=T+(P<<9&4294967295|P>>>23),P=A+(T^R&(F^T))+E[3]+4107603335&4294967295,A=F+(P<<14&4294967295|P>>>18),P=R+(F^T&(A^F))+E[8]+1163531501&4294967295,R=A+(P<<20&4294967295|P>>>12),P=T+(A^F&(R^A))+E[13]+2850285829&4294967295,T=R+(P<<5&4294967295|P>>>27),P=F+(R^A&(T^R))+E[2]+4243563512&4294967295,F=T+(P<<9&4294967295|P>>>23),P=A+(T^R&(F^T))+E[7]+1735328473&4294967295,A=F+(P<<14&4294967295|P>>>18),P=R+(F^T&(A^F))+E[12]+2368359562&4294967295,R=A+(P<<20&4294967295|P>>>12),P=T+(R^A^F)+E[5]+4294588738&4294967295,T=R+(P<<4&4294967295|P>>>28),P=F+(T^R^A)+E[8]+2272392833&4294967295,F=T+(P<<11&4294967295|P>>>21),P=A+(F^T^R)+E[11]+1839030562&4294967295,A=F+(P<<16&4294967295|P>>>16),P=R+(A^F^T)+E[14]+4259657740&4294967295,R=A+(P<<23&4294967295|P>>>9),P=T+(R^A^F)+E[1]+2763975236&4294967295,T=R+(P<<4&4294967295|P>>>28),P=F+(T^R^A)+E[4]+1272893353&4294967295,F=T+(P<<11&4294967295|P>>>21),P=A+(F^T^R)+E[7]+4139469664&4294967295,A=F+(P<<16&4294967295|P>>>16),P=R+(A^F^T)+E[10]+3200236656&4294967295,R=A+(P<<23&4294967295|P>>>9),P=T+(R^A^F)+E[13]+681279174&4294967295,T=R+(P<<4&4294967295|P>>>28),P=F+(T^R^A)+E[0]+3936430074&4294967295,F=T+(P<<11&4294967295|P>>>21),P=A+(F^T^R)+E[3]+3572445317&4294967295,A=F+(P<<16&4294967295|P>>>16),P=R+(A^F^T)+E[6]+76029189&4294967295,R=A+(P<<23&4294967295|P>>>9),P=T+(R^A^F)+E[9]+3654602809&4294967295,T=R+(P<<4&4294967295|P>>>28),P=F+(T^R^A)+E[12]+3873151461&4294967295,F=T+(P<<11&4294967295|P>>>21),P=A+(F^T^R)+E[15]+530742520&4294967295,A=F+(P<<16&4294967295|P>>>16),P=R+(A^F^T)+E[2]+3299628645&4294967295,R=A+(P<<23&4294967295|P>>>9),P=T+(A^(R|~F))+E[0]+4096336452&4294967295,T=R+(P<<6&4294967295|P>>>26),P=F+(R^(T|~A))+E[7]+1126891415&4294967295,F=T+(P<<10&4294967295|P>>>22),P=A+(T^(F|~R))+E[14]+2878612391&4294967295,A=F+(P<<15&4294967295|P>>>17),P=R+(F^(A|~T))+E[5]+4237533241&4294967295,R=A+(P<<21&4294967295|P>>>11),P=T+(A^(R|~F))+E[12]+1700485571&4294967295,T=R+(P<<6&4294967295|P>>>26),P=F+(R^(T|~A))+E[3]+2399980690&4294967295,F=T+(P<<10&4294967295|P>>>22),P=A+(T^(F|~R))+E[10]+4293915773&4294967295,A=F+(P<<15&4294967295|P>>>17),P=R+(F^(A|~T))+E[1]+2240044497&4294967295,R=A+(P<<21&4294967295|P>>>11),P=T+(A^(R|~F))+E[8]+1873313359&4294967295,T=R+(P<<6&4294967295|P>>>26),P=F+(R^(T|~A))+E[15]+4264355552&4294967295,F=T+(P<<10&4294967295|P>>>22),P=A+(T^(F|~R))+E[6]+2734768916&4294967295,A=F+(P<<15&4294967295|P>>>17),P=R+(F^(A|~T))+E[13]+1309151649&4294967295,R=A+(P<<21&4294967295|P>>>11),P=T+(A^(R|~F))+E[4]+4149444226&4294967295,T=R+(P<<6&4294967295|P>>>26),P=F+(R^(T|~A))+E[11]+3174756917&4294967295,F=T+(P<<10&4294967295|P>>>22),P=A+(T^(F|~R))+E[2]+718787259&4294967295,A=F+(P<<15&4294967295|P>>>17),P=R+(F^(A|~T))+E[9]+3951481745&4294967295,I.g[0]=I.g[0]+T&4294967295,I.g[1]=I.g[1]+(A+(P<<21&4294967295|P>>>11))&4294967295,I.g[2]=I.g[2]+A&4294967295,I.g[3]=I.g[3]+F&4294967295}s.prototype.u=function(I,T){T===void 0&&(T=I.length);for(var R=T-this.blockSize,E=this.B,A=this.h,F=0;F<T;){if(A==0)for(;F<=R;)r(this,I,F),F+=this.blockSize;if(typeof I=="string"){for(;F<T;)if(E[A++]=I.charCodeAt(F++),A==this.blockSize){r(this,E),A=0;break}}else for(;F<T;)if(E[A++]=I[F++],A==this.blockSize){r(this,E),A=0;break}}this.h=A,this.o+=T},s.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var T=1;T<I.length-8;++T)I[T]=0;var R=8*this.o;for(T=I.length-8;T<I.length;++T)I[T]=R&255,R/=256;for(this.u(I),I=Array(16),T=R=0;4>T;++T)for(var E=0;32>E;E+=8)I[R++]=this.g[T]>>>E&255;return I};function i(I,T){var R=a;return Object.prototype.hasOwnProperty.call(R,I)?R[I]:R[I]=T(I)}function o(I,T){this.h=T;for(var R=[],E=!0,A=I.length-1;0<=A;A--){var F=I[A]|0;E&&F==T||(R[A]=F,E=!1)}this.g=R}var a={};function l(I){return-128<=I&&128>I?i(I,function(T){return new o([T|0],0>T?-1:0)}):new o([I|0],0>I?-1:0)}function c(I){if(isNaN(I)||!isFinite(I))return h;if(0>I)return m(c(-I));for(var T=[],R=1,E=0;I>=R;E++)T[E]=I/R|0,R*=4294967296;return new o(T,0)}function u(I,T){if(I.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(I.charAt(0)=="-")return m(u(I.substring(1),T));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=c(Math.pow(T,8)),E=h,A=0;A<I.length;A+=8){var F=Math.min(8,I.length-A),P=parseInt(I.substring(A,A+F),T);8>F?(F=c(Math.pow(T,F)),E=E.j(F).add(c(P))):(E=E.j(R),E=E.add(c(P)))}return E}var h=l(0),d=l(1),f=l(16777216);t=o.prototype,t.m=function(){if(g(this))return-m(this).m();for(var I=0,T=1,R=0;R<this.g.length;R++){var E=this.i(R);I+=(0<=E?E:4294967296+E)*T,T*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(p(this))return"0";if(g(this))return"-"+m(this).toString(I);for(var T=c(Math.pow(I,6)),R=this,E="";;){var A=C(R,T).g;R=y(R,A.j(T));var F=((0<R.g.length?R.g[0]:R.h)>>>0).toString(I);if(R=A,p(R))return F+E;for(;6>F.length;)F="0"+F;E=F+E}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function p(I){if(I.h!=0)return!1;for(var T=0;T<I.g.length;T++)if(I.g[T]!=0)return!1;return!0}function g(I){return I.h==-1}t.l=function(I){return I=y(this,I),g(I)?-1:p(I)?0:1};function m(I){for(var T=I.g.length,R=[],E=0;E<T;E++)R[E]=~I.g[E];return new o(R,~I.h).add(d)}t.abs=function(){return g(this)?m(this):this},t.add=function(I){for(var T=Math.max(this.g.length,I.g.length),R=[],E=0,A=0;A<=T;A++){var F=E+(this.i(A)&65535)+(I.i(A)&65535),P=(F>>>16)+(this.i(A)>>>16)+(I.i(A)>>>16);E=P>>>16,F&=65535,P&=65535,R[A]=P<<16|F}return new o(R,R[R.length-1]&-2147483648?-1:0)};function y(I,T){return I.add(m(T))}t.j=function(I){if(p(this)||p(I))return h;if(g(this))return g(I)?m(this).j(m(I)):m(m(this).j(I));if(g(I))return m(this.j(m(I)));if(0>this.l(f)&&0>I.l(f))return c(this.m()*I.m());for(var T=this.g.length+I.g.length,R=[],E=0;E<2*T;E++)R[E]=0;for(E=0;E<this.g.length;E++)for(var A=0;A<I.g.length;A++){var F=this.i(E)>>>16,P=this.i(E)&65535,Z=I.i(A)>>>16,H=I.i(A)&65535;R[2*E+2*A]+=P*H,w(R,2*E+2*A),R[2*E+2*A+1]+=F*H,w(R,2*E+2*A+1),R[2*E+2*A+1]+=P*Z,w(R,2*E+2*A+1),R[2*E+2*A+2]+=F*Z,w(R,2*E+2*A+2)}for(E=0;E<T;E++)R[E]=R[2*E+1]<<16|R[2*E];for(E=T;E<2*T;E++)R[E]=0;return new o(R,0)};function w(I,T){for(;(I[T]&65535)!=I[T];)I[T+1]+=I[T]>>>16,I[T]&=65535,T++}function b(I,T){this.g=I,this.h=T}function C(I,T){if(p(T))throw Error("division by zero");if(p(I))return new b(h,h);if(g(I))return T=C(m(I),T),new b(m(T.g),m(T.h));if(g(T))return T=C(I,m(T)),new b(m(T.g),T.h);if(30<I.g.length){if(g(I)||g(T))throw Error("slowDivide_ only works with positive integers.");for(var R=d,E=T;0>=E.l(I);)R=k(R),E=k(E);var A=$(R,1),F=$(E,1);for(E=$(E,2),R=$(R,2);!p(E);){var P=F.add(E);0>=P.l(I)&&(A=A.add(R),F=P),E=$(E,1),R=$(R,1)}return T=y(I,A.j(T)),new b(A,T)}for(A=h;0<=I.l(T);){for(R=Math.max(1,Math.floor(I.m()/T.m())),E=Math.ceil(Math.log(R)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),F=c(R),P=F.j(T);g(P)||0<P.l(I);)R-=E,F=c(R),P=F.j(T);p(F)&&(F=d),A=A.add(F),I=y(I,P)}return new b(A,I)}t.A=function(I){return C(this,I).h},t.and=function(I){for(var T=Math.max(this.g.length,I.g.length),R=[],E=0;E<T;E++)R[E]=this.i(E)&I.i(E);return new o(R,this.h&I.h)},t.or=function(I){for(var T=Math.max(this.g.length,I.g.length),R=[],E=0;E<T;E++)R[E]=this.i(E)|I.i(E);return new o(R,this.h|I.h)},t.xor=function(I){for(var T=Math.max(this.g.length,I.g.length),R=[],E=0;E<T;E++)R[E]=this.i(E)^I.i(E);return new o(R,this.h^I.h)};function k(I){for(var T=I.g.length+1,R=[],E=0;E<T;E++)R[E]=I.i(E)<<1|I.i(E-1)>>>31;return new o(R,I.h)}function $(I,T){var R=T>>5;T%=32;for(var E=I.g.length-R,A=[],F=0;F<E;F++)A[F]=0<T?I.i(F+R)>>>T|I.i(F+R+1)<<32-T:I.i(F+R);return new o(A,I.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,QF=o}).apply(typeof R_<"u"?R_:typeof self<"u"?self:typeof window<"u"?window:{});var P0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(x,N,D){return x==Array.prototype||x==Object.prototype||(x[N]=D.value),x};function n(x){x=[typeof globalThis=="object"&&globalThis,x,typeof window=="object"&&window,typeof self=="object"&&self,typeof P0=="object"&&P0];for(var N=0;N<x.length;++N){var D=x[N];if(D&&D.Math==Math)return D}throw Error("Cannot find global object")}var s=n(this);function r(x,N){if(N)e:{var D=s;x=x.split(".");for(var M=0;M<x.length-1;M++){var se=x[M];if(!(se in D))break e;D=D[se]}x=x[x.length-1],M=D[x],N=N(M),N!=M&&N!=null&&e(D,x,{configurable:!0,writable:!0,value:N})}}function i(x,N){x instanceof String&&(x+="");var D=0,M=!1,se={next:function(){if(!M&&D<x.length){var le=D++;return{value:N(le,x[le]),done:!1}}return M=!0,{done:!0,value:void 0}}};return se[Symbol.iterator]=function(){return se},se}r("Array.prototype.values",function(x){return x||function(){return i(this,function(N,D){return D})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(x){var N=typeof x;return N=N!="object"?N:x?Array.isArray(x)?"array":N:"null",N=="array"||N=="object"&&typeof x.length=="number"}function c(x){var N=typeof x;return N=="object"&&x!=null||N=="function"}function u(x,N,D){return x.call.apply(x.bind,arguments)}function h(x,N,D){if(!x)throw Error();if(2<arguments.length){var M=Array.prototype.slice.call(arguments,2);return function(){var se=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(se,M),x.apply(N,se)}}return function(){return x.apply(N,arguments)}}function d(x,N,D){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,d.apply(null,arguments)}function f(x,N){var D=Array.prototype.slice.call(arguments,1);return function(){var M=D.slice();return M.push.apply(M,arguments),x.apply(this,M)}}function p(x,N){function D(){}D.prototype=N.prototype,x.aa=N.prototype,x.prototype=new D,x.prototype.constructor=x,x.Qb=function(M,se,le){for(var be=Array(arguments.length-2),wt=2;wt<arguments.length;wt++)be[wt-2]=arguments[wt];return N.prototype[se].apply(M,be)}}function g(x){const N=x.length;if(0<N){const D=Array(N);for(let M=0;M<N;M++)D[M]=x[M];return D}return[]}function m(x,N){for(let D=1;D<arguments.length;D++){const M=arguments[D];if(l(M)){const se=x.length||0,le=M.length||0;x.length=se+le;for(let be=0;be<le;be++)x[se+be]=M[be]}else x.push(M)}}class y{constructor(N,D){this.i=N,this.j=D,this.h=0,this.g=null}get(){let N;return 0<this.h?(this.h--,N=this.g,this.g=N.next,N.next=null):N=this.i(),N}}function w(x){return/^[\s\xa0]*$/.test(x)}function b(){var x=a.navigator;return x&&(x=x.userAgent)?x:""}function C(x){return C[" "](x),x}C[" "]=function(){};var k=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function $(x,N,D){for(const M in x)N.call(D,x[M],M,x)}function I(x,N){for(const D in x)N.call(void 0,x[D],D,x)}function T(x){const N={};for(const D in x)N[D]=x[D];return N}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(x,N){let D,M;for(let se=1;se<arguments.length;se++){M=arguments[se];for(D in M)x[D]=M[D];for(let le=0;le<R.length;le++)D=R[le],Object.prototype.hasOwnProperty.call(M,D)&&(x[D]=M[D])}}function A(x){var N=1;x=x.split(":");const D=[];for(;0<N&&x.length;)D.push(x.shift()),N--;return x.length&&D.push(x.join(":")),D}function F(x){a.setTimeout(()=>{throw x},0)}function P(){var x=X;let N=null;return x.g&&(N=x.g,x.g=x.g.next,x.g||(x.h=null),N.next=null),N}class Z{constructor(){this.h=this.g=null}add(N,D){const M=H.get();M.set(N,D),this.h?this.h.next=M:this.g=M,this.h=M}}var H=new y(()=>new j,x=>x.reset());class j{constructor(){this.next=this.g=this.h=null}set(N,D){this.h=N,this.g=D,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,z=!1,X=new Z,ie=()=>{const x=a.Promise.resolve(void 0);ee=()=>{x.then(de)}};var de=()=>{for(var x;x=P();){try{x.h.call(x.g)}catch(D){F(D)}var N=H;N.j(x),100>N.h&&(N.h++,x.next=N.g,N.g=x)}z=!1};function he(){this.s=this.s,this.C=this.C}he.prototype.s=!1,he.prototype.ma=function(){this.s||(this.s=!0,this.N())},he.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function fe(x,N){this.type=x,this.g=this.target=N,this.defaultPrevented=!1}fe.prototype.h=function(){this.defaultPrevented=!0};var ge=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var x=!1,N=Object.defineProperty({},"passive",{get:function(){x=!0}});try{const D=()=>{};a.addEventListener("test",D,N),a.removeEventListener("test",D,N)}catch{}return x}();function pe(x,N){if(fe.call(this,x?x.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,x){var D=this.type=x.type,M=x.changedTouches&&x.changedTouches.length?x.changedTouches[0]:null;if(this.target=x.target||x.srcElement,this.g=N,N=x.relatedTarget){if(k){e:{try{C(N.nodeName);var se=!0;break e}catch{}se=!1}se||(N=null)}}else D=="mouseover"?N=x.fromElement:D=="mouseout"&&(N=x.toElement);this.relatedTarget=N,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0),this.button=x.button,this.key=x.key||"",this.ctrlKey=x.ctrlKey,this.altKey=x.altKey,this.shiftKey=x.shiftKey,this.metaKey=x.metaKey,this.pointerId=x.pointerId||0,this.pointerType=typeof x.pointerType=="string"?x.pointerType:we[x.pointerType]||"",this.state=x.state,this.i=x,x.defaultPrevented&&pe.aa.h.call(this)}}p(pe,fe);var we={2:"touch",3:"pen",4:"mouse"};pe.prototype.h=function(){pe.aa.h.call(this);var x=this.i;x.preventDefault?x.preventDefault():x.returnValue=!1};var ke="closure_listenable_"+(1e6*Math.random()|0),De=0;function _e(x,N,D,M,se){this.listener=x,this.proxy=null,this.src=N,this.type=D,this.capture=!!M,this.ha=se,this.key=++De,this.da=this.fa=!1}function Be(x){x.da=!0,x.listener=null,x.proxy=null,x.src=null,x.ha=null}function Oe(x){this.src=x,this.g={},this.h=0}Oe.prototype.add=function(x,N,D,M,se){var le=x.toString();x=this.g[le],x||(x=this.g[le]=[],this.h++);var be=Ue(x,N,M,se);return-1<be?(N=x[be],D||(N.fa=!1)):(N=new _e(N,this.src,le,!!M,se),N.fa=D,x.push(N)),N};function qe(x,N){var D=N.type;if(D in x.g){var M=x.g[D],se=Array.prototype.indexOf.call(M,N,void 0),le;(le=0<=se)&&Array.prototype.splice.call(M,se,1),le&&(Be(N),x.g[D].length==0&&(delete x.g[D],x.h--))}}function Ue(x,N,D,M){for(var se=0;se<x.length;++se){var le=x[se];if(!le.da&&le.listener==N&&le.capture==!!D&&le.ha==M)return se}return-1}var Ye="closure_lm_"+(1e6*Math.random()|0),ut={};function it(x,N,D,M,se){if(Array.isArray(N)){for(var le=0;le<N.length;le++)it(x,N[le],D,M,se);return null}return D=xn(D),x&&x[ke]?x.K(N,D,c(M)?!!M.capture:!!M,se):$t(x,N,D,!1,M,se)}function $t(x,N,D,M,se,le){if(!N)throw Error("Invalid event type");var be=c(se)?!!se.capture:!!se,wt=Vs(x);if(wt||(x[Ye]=wt=new Oe(x)),D=wt.add(N,D,M,be,le),D.proxy)return D;if(M=vt(),D.proxy=M,M.src=x,M.listener=D,x.addEventListener)ge||(se=be),se===void 0&&(se=!1),x.addEventListener(N.toString(),M,se);else if(x.attachEvent)x.attachEvent(sr(N.toString()),M);else if(x.addListener&&x.removeListener)x.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return D}function vt(){function x(D){return N.call(x.src,x.listener,D)}const N=jn;return x}function Bs(x,N,D,M,se){if(Array.isArray(N))for(var le=0;le<N.length;le++)Bs(x,N[le],D,M,se);else M=c(M)?!!M.capture:!!M,D=xn(D),x&&x[ke]?(x=x.i,N=String(N).toString(),N in x.g&&(le=x.g[N],D=Ue(le,D,M,se),-1<D&&(Be(le[D]),Array.prototype.splice.call(le,D,1),le.length==0&&(delete x.g[N],x.h--)))):x&&(x=Vs(x))&&(N=x.g[N.toString()],x=-1,N&&(x=Ue(N,D,M,se)),(D=-1<x?N[x]:null)&&Ut(D))}function Ut(x){if(typeof x!="number"&&x&&!x.da){var N=x.src;if(N&&N[ke])qe(N.i,x);else{var D=x.type,M=x.proxy;N.removeEventListener?N.removeEventListener(D,M,x.capture):N.detachEvent?N.detachEvent(sr(D),M):N.addListener&&N.removeListener&&N.removeListener(M),(D=Vs(N))?(qe(D,x),D.h==0&&(D.src=null,N[Ye]=null)):Be(x)}}}function sr(x){return x in ut?ut[x]:ut[x]="on"+x}function jn(x,N){if(x.da)x=!0;else{N=new pe(N,this);var D=x.listener,M=x.ha||x.src;x.fa&&Ut(x),x=D.call(M,N)}return x}function Vs(x){return x=x[Ye],x instanceof Oe?x:null}var Gn="__closure_events_fn_"+(1e9*Math.random()>>>0);function xn(x){return typeof x=="function"?x:(x[Gn]||(x[Gn]=function(N){return x.handleEvent(N)}),x[Gn])}function Rt(){he.call(this),this.i=new Oe(this),this.M=this,this.F=null}p(Rt,he),Rt.prototype[ke]=!0,Rt.prototype.removeEventListener=function(x,N,D,M){Bs(this,x,N,D,M)};function kt(x,N){var D,M=x.F;if(M)for(D=[];M;M=M.F)D.push(M);if(x=x.M,M=N.type||N,typeof N=="string")N=new fe(N,x);else if(N instanceof fe)N.target=N.target||x;else{var se=N;N=new fe(M,x),E(N,se)}if(se=!0,D)for(var le=D.length-1;0<=le;le--){var be=N.g=D[le];se=ns(be,M,!0,N)&&se}if(be=N.g=x,se=ns(be,M,!0,N)&&se,se=ns(be,M,!1,N)&&se,D)for(le=0;le<D.length;le++)be=N.g=D[le],se=ns(be,M,!1,N)&&se}Rt.prototype.N=function(){if(Rt.aa.N.call(this),this.i){var x=this.i,N;for(N in x.g){for(var D=x.g[N],M=0;M<D.length;M++)Be(D[M]);delete x.g[N],x.h--}}this.F=null},Rt.prototype.K=function(x,N,D,M){return this.i.add(String(x),N,!1,D,M)},Rt.prototype.L=function(x,N,D,M){return this.i.add(String(x),N,!0,D,M)};function ns(x,N,D,M){if(N=x.i.g[String(N)],!N)return!0;N=N.concat();for(var se=!0,le=0;le<N.length;++le){var be=N[le];if(be&&!be.da&&be.capture==D){var wt=be.listener,Sn=be.ha||be.src;be.fa&&qe(x.i,be),se=wt.call(Sn,M)!==!1&&se}}return se&&!M.defaultPrevented}function Xi(x,N,D){if(typeof x=="function")D&&(x=d(x,D));else if(x&&typeof x.handleEvent=="function")x=d(x.handleEvent,x);else throw Error("Invalid listener argument");return 2147483647<Number(N)?-1:a.setTimeout(x,N||0)}function Oo(x){x.g=Xi(()=>{x.g=null,x.i&&(x.i=!1,Oo(x))},x.l);const N=x.h;x.h=null,x.m.apply(null,N)}class nc extends he{constructor(N,D){super(),this.m=N,this.l=D,this.h=null,this.i=!1,this.g=null}j(N){this.h=arguments,this.g?this.i=!0:Oo(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Yi(x){he.call(this),this.h=x,this.g={}}p(Yi,he);var Ji=[];function Zi(x){$(x.g,function(N,D){this.g.hasOwnProperty(D)&&Ut(N)},x),x.g={}}Yi.prototype.N=function(){Yi.aa.N.call(this),Zi(this)},Yi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Fo=a.JSON.stringify,Bg=a.JSON.parse,mx=class{stringify(x){return a.JSON.stringify(x,void 0)}parse(x){return a.JSON.parse(x,void 0)}};function Qi(){}Qi.prototype.h=null;function Mu(x){return x.h||(x.h=x.i())}function Lo(){}var Mo={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Bu(){fe.call(this,"d")}p(Bu,fe);function Vu(){fe.call(this,"c")}p(Vu,fe);var eo={},qd=null;function Bo(){return qd=qd||new Rt}eo.La="serverreachability";function Xd(x){fe.call(this,eo.La,x)}p(Xd,fe);function Vo(x){const N=Bo();kt(N,new Xd(N))}eo.STAT_EVENT="statevent";function Uu(x,N){fe.call(this,eo.STAT_EVENT,x),this.stat=N}p(Uu,fe);function Hn(x){const N=Bo();kt(N,new Uu(N,x))}eo.Ma="timingevent";function sc(x,N){fe.call(this,eo.Ma,x),this.size=N}p(sc,fe);function Na(x,N){if(typeof x!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){x()},N)}function _a(){this.g=!0}_a.prototype.xa=function(){this.g=!1};function zu(x,N,D,M,se,le){x.info(function(){if(x.g)if(le)for(var be="",wt=le.split("&"),Sn=0;Sn<wt.length;Sn++){var ot=wt[Sn].split("=");if(1<ot.length){var Dn=ot[0];ot=ot[1];var Pn=Dn.split("_");be=2<=Pn.length&&Pn[1]=="type"?be+(Dn+"="+ot+"&"):be+(Dn+"=redacted&")}}else be=null;else be=le;return"XMLHTTP REQ ("+M+") [attempt "+se+"]: "+N+`
`+D+`
`+be})}function gx(x,N,D,M,se,le,be){x.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+se+"]: "+N+`
`+D+`
`+le+" "+be})}function Ir(x,N,D,M){x.info(function(){return"XMLHTTP TEXT ("+N+"): "+Ug(x,D)+(M?" "+M:"")})}function Vg(x,N){x.info(function(){return"TIMEOUT: "+N})}_a.prototype.info=function(){};function Ug(x,N){if(!x.g)return N;if(!N)return null;try{var D=JSON.parse(N);if(D){for(x=0;x<D.length;x++)if(Array.isArray(D[x])){var M=D[x];if(!(2>M.length)){var se=M[1];if(Array.isArray(se)&&!(1>se.length)){var le=se[0];if(le!="noop"&&le!="stop"&&le!="close")for(var be=1;be<se.length;be++)se[be]=""}}}}return Fo(D)}catch{return N}}var Yd={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Si={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},kr;function vs(){}p(vs,Qi),vs.prototype.g=function(){return new XMLHttpRequest},vs.prototype.i=function(){return{}},kr=new vs;function Ii(x,N,D,M){this.j=x,this.i=N,this.l=D,this.R=M||1,this.U=new Yi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Jd}function Jd(){this.i=null,this.g="",this.h=!1}var wn={},rr={};function $a(x,N,D){x.L=1,x.v=Hu(Xr(N)),x.m=D,x.P=!0,Tr(x,null)}function Tr(x,N){x.F=Date.now(),Uo(x),x.A=Xr(x.v);var D=x.A,M=x.R;Array.isArray(M)||(M=[String(M)]),ac(D.i,"t",M),x.C=0,D=x.j.J,x.h=new Jd,x.g=o0(x.j,D?N:null,!x.m),0<x.O&&(x.M=new nc(d(x.Y,x,x.g),x.O)),N=x.U,D=x.g,M=x.ca;var se="readystatechange";Array.isArray(se)||(se&&(Ji[0]=se.toString()),se=Ji);for(var le=0;le<se.length;le++){var be=it(D,se[le],M||N.handleEvent,!1,N.h||N);if(!be)break;N.g[be.key]=be}N=x.H?T(x.H):{},x.m?(x.u||(x.u="POST"),N["Content-Type"]="application/x-www-form-urlencoded",x.g.ea(x.A,x.u,x.m,N)):(x.u="GET",x.g.ea(x.A,x.u,null,N)),Vo(),zu(x.i,x.u,x.A,x.l,x.R,x.m)}Ii.prototype.ca=function(x){x=x.target;const N=this.M;N&&Jr(x)==3?N.j():this.Y(x)},Ii.prototype.Y=function(x){try{if(x==this.g)e:{const Pn=Jr(this.g);var N=this.g.Ba();const Go=this.g.Z();if(!(3>Pn)&&(Pn!=3||this.g&&(this.h.h||this.g.oa()||_r(this.g)))){this.J||Pn!=4||N==7||(N==8||0>=Go?Vo(3):Vo(2)),to(this);var D=this.g.Z();this.X=D;t:if(zg(this)){var M=_r(this.g);x="";var se=M.length,le=Jr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){qr(this),Ra(this);var be="";break t}this.h.i=new a.TextDecoder}for(N=0;N<se;N++)this.h.h=!0,x+=this.h.i.decode(M[N],{stream:!(le&&N==se-1)});M.length=0,this.h.g+=x,this.C=0,be=this.h.g}else be=this.g.oa();if(this.o=D==200,gx(this.i,this.u,this.A,this.l,this.R,Pn,D),this.o){if(this.T&&!this.K){t:{if(this.g){var wt,Sn=this.g;if((wt=Sn.g?Sn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(wt)){var ot=wt;break t}}ot=null}if(D=ot)Ir(this.i,this.l,D,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ic(this,D);else{this.o=!1,this.s=3,Hn(12),qr(this),Ra(this);break e}}if(this.P){D=!0;let Rr;for(;!this.J&&this.C<be.length;)if(Rr=Wu(this,be),Rr==rr){Pn==4&&(this.s=4,Hn(14),D=!1),Ir(this.i,this.l,null,"[Incomplete Response]");break}else if(Rr==wn){this.s=4,Hn(15),Ir(this.i,this.l,be,"[Invalid Chunk]"),D=!1;break}else Ir(this.i,this.l,Rr,null),ic(this,Rr);if(zg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pn!=4||be.length!=0||this.h.h||(this.s=1,Hn(16),D=!1),this.o=this.o&&D,!D)Ir(this.i,this.l,be,"[Invalid Chunked Response]"),qr(this),Ra(this);else if(0<be.length&&!this.W){this.W=!0;var Dn=this.j;Dn.g==this&&Dn.ba&&!Dn.M&&(Dn.j.info("Great, no buffering proxy detected. Bytes received: "+be.length),no(Dn),Dn.M=!0,Hn(11))}}else Ir(this.i,this.l,be,null),ic(this,be);Pn==4&&qr(this),this.o&&!this.J&&(Pn==4?r0(this.j,this):(this.o=!1,Uo(this)))}else t0(this.g),D==400&&0<be.indexOf("Unknown SID")?(this.s=3,Hn(12)):(this.s=0,Hn(13)),qr(this),Ra(this)}}}catch{}finally{}};function zg(x){return x.g?x.u=="GET"&&x.L!=2&&x.j.Ca:!1}function Wu(x,N){var D=x.C,M=N.indexOf(`
`,D);return M==-1?rr:(D=Number(N.substring(D,M)),isNaN(D)?wn:(M+=1,M+D>N.length?rr:(N=N.slice(M,M+D),x.C=M+D,N)))}Ii.prototype.cancel=function(){this.J=!0,qr(this)};function Uo(x){x.S=Date.now()+x.I,rc(x,x.I)}function rc(x,N){if(x.B!=null)throw Error("WatchDog timer not null");x.B=Na(d(x.ba,x),N)}function to(x){x.B&&(a.clearTimeout(x.B),x.B=null)}Ii.prototype.ba=function(){this.B=null;const x=Date.now();0<=x-this.S?(Vg(this.i,this.A),this.L!=2&&(Vo(),Hn(17)),qr(this),this.s=2,Ra(this)):rc(this,this.S-x)};function Ra(x){x.j.G==0||x.J||r0(x.j,x)}function qr(x){to(x);var N=x.M;N&&typeof N.ma=="function"&&N.ma(),x.M=null,Zi(x.U),x.g&&(N=x.g,x.g=null,N.abort(),N.ma())}function ic(x,N){try{var D=x.j;if(D.G!=0&&(D.g==x||xs(D.h,x))){if(!x.K&&xs(D.h,x)&&D.G==3){try{var M=D.Da.g.parse(N)}catch{M=null}if(Array.isArray(M)&&M.length==3){var se=M;if(se[0]==0){e:if(!D.u){if(D.g)if(D.g.F+3e3<x.F)La(D),qu(D);else break e;gc(D),Hn(18)}}else D.za=se[1],0<D.za-D.T&&37500>se[2]&&D.F&&D.v==0&&!D.C&&(D.C=Na(d(D.Za,D),6e3));if(1>=bn(D.h)&&D.ca){try{D.ca()}catch{}D.ca=void 0}}else $r(D,11)}else if((x.K||D.g==x)&&La(D),!w(N))for(se=D.Da.g.parse(N),N=0;N<se.length;N++){let ot=se[N];if(D.T=ot[0],ot=ot[1],D.G==2)if(ot[0]=="c"){D.K=ot[1],D.ia=ot[2];const Dn=ot[3];Dn!=null&&(D.la=Dn,D.j.info("VER="+D.la));const Pn=ot[4];Pn!=null&&(D.Aa=Pn,D.j.info("SVER="+D.Aa));const Go=ot[5];Go!=null&&typeof Go=="number"&&0<Go&&(M=1.5*Go,D.L=M,D.j.info("backChannelRequestTimeoutMs_="+M)),M=D;const Rr=x.g;if(Rr){const yc=Rr.g?Rr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(yc){var le=M.h;le.g||yc.indexOf("spdy")==-1&&yc.indexOf("quic")==-1&&yc.indexOf("h2")==-1||(le.j=le.l,le.g=new Set,le.h&&(Er(le,le.h),le.h=null))}if(M.D){const ff=Rr.g?Rr.g.getResponseHeader("X-HTTP-Session-Id"):null;ff&&(M.ya=ff,xt(M.I,M.D,ff))}}D.G=3,D.l&&D.l.ua(),D.ba&&(D.R=Date.now()-x.F,D.j.info("Handshake RTT: "+D.R+"ms")),M=D;var be=x;if(M.qa=df(M,M.J?M.ia:null,M.W),be.K){Aa(M.h,be);var wt=be,Sn=M.L;Sn&&(wt.I=Sn),wt.B&&(to(wt),Uo(wt)),M.g=be}else mc(M);0<D.i.length&&fc(D)}else ot[0]!="stop"&&ot[0]!="close"||$r(D,7);else D.G==3&&(ot[0]=="stop"||ot[0]=="close"?ot[0]=="stop"?$r(D,7):lf(D):ot[0]!="noop"&&D.l&&D.l.ta(ot),D.v=0)}}Vo(4)}catch{}}var Wg=class{constructor(x,N){this.g=x,this.map=N}};function Zd(x){this.l=x||10,a.PerformanceNavigationTiming?(x=a.performance.getEntriesByType("navigation"),x=0<x.length&&(x[0].nextHopProtocol=="hq"||x[0].nextHopProtocol=="h2")):x=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=x?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Qd(x){return x.h?!0:x.g?x.g.size>=x.j:!1}function bn(x){return x.h?1:x.g?x.g.size:0}function xs(x,N){return x.h?x.h==N:x.g?x.g.has(N):!1}function Er(x,N){x.g?x.g.add(N):x.h=N}function Aa(x,N){x.h&&x.h==N?x.h=null:x.g&&x.g.has(N)&&x.g.delete(N)}Zd.prototype.cancel=function(){if(this.i=oc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const x of this.g.values())x.cancel();this.g.clear()}};function oc(x){if(x.h!=null)return x.i.concat(x.h.D);if(x.g!=null&&x.g.size!==0){let N=x.i;for(const D of x.g.values())N=N.concat(D.D);return N}return g(x.i)}function ef(x){if(x.V&&typeof x.V=="function")return x.V();if(typeof Map<"u"&&x instanceof Map||typeof Set<"u"&&x instanceof Set)return Array.from(x.values());if(typeof x=="string")return x.split("");if(l(x)){for(var N=[],D=x.length,M=0;M<D;M++)N.push(x[M]);return N}N=[],D=0;for(M in x)N[D++]=x[M];return N}function ju(x){if(x.na&&typeof x.na=="function")return x.na();if(!x.V||typeof x.V!="function"){if(typeof Map<"u"&&x instanceof Map)return Array.from(x.keys());if(!(typeof Set<"u"&&x instanceof Set)){if(l(x)||typeof x=="string"){var N=[];x=x.length;for(var D=0;D<x;D++)N.push(D);return N}N=[],D=0;for(const M in x)N[D++]=M;return N}}}function Gu(x,N){if(x.forEach&&typeof x.forEach=="function")x.forEach(N,void 0);else if(l(x)||typeof x=="string")Array.prototype.forEach.call(x,N,void 0);else for(var D=ju(x),M=ef(x),se=M.length,le=0;le<se;le++)N.call(void 0,M[le],D&&D[le],x)}var tf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function nf(x,N){if(x){x=x.split("&");for(var D=0;D<x.length;D++){var M=x[D].indexOf("="),se=null;if(0<=M){var le=x[D].substring(0,M);se=x[D].substring(M+1)}else le=x[D];N(le,se?decodeURIComponent(se.replace(/\+/g," ")):"")}}}function Kn(x){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,x instanceof Kn){this.h=x.h,Da(this,x.j),this.o=x.o,this.g=x.g,Yr(this,x.s),this.l=x.l;var N=x.i,D=new Wo;D.i=N.i,N.g&&(D.g=new Map(N.g),D.h=N.h),Nr(this,D),this.m=x.m}else x&&(N=String(x).match(tf))?(this.h=!1,Da(this,N[1]||"",!0),this.o=Pa(N[2]||""),this.g=Pa(N[3]||"",!0),Yr(this,N[4]),this.l=Pa(N[5]||"",!0),Nr(this,N[6]||"",!0),this.m=Pa(N[7]||"")):(this.h=!1,this.i=new Wo(null,this.h))}Kn.prototype.toString=function(){var x=[],N=this.j;N&&x.push(zo(N,jg,!0),":");var D=this.g;return(D||N=="file")&&(x.push("//"),(N=this.o)&&x.push(zo(N,jg,!0),"@"),x.push(encodeURIComponent(String(D)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),D=this.s,D!=null&&x.push(":",String(D))),(D=this.l)&&(this.g&&D.charAt(0)!="/"&&x.push("/"),x.push(zo(D,D.charAt(0)=="/"?Hg:Gg,!0))),(D=this.i.toString())&&x.push("?",D),(D=this.m)&&x.push("#",zo(D,qg)),x.join("")};function Xr(x){return new Kn(x)}function Da(x,N,D){x.j=D?Pa(N,!0):N,x.j&&(x.j=x.j.replace(/:$/,""))}function Yr(x,N){if(N){if(N=Number(N),isNaN(N)||0>N)throw Error("Bad port number "+N);x.s=N}else x.s=null}function Nr(x,N,D){N instanceof Wo?(x.i=N,Xg(x.i,x.h)):(D||(N=zo(N,Kg)),x.i=new Wo(N,x.h))}function xt(x,N,D){x.i.set(N,D)}function Hu(x){return xt(x,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),x}function Pa(x,N){return x?N?decodeURI(x.replace(/%25/g,"%2525")):decodeURIComponent(x):""}function zo(x,N,D){return typeof x=="string"?(x=encodeURI(x).replace(N,yx),D&&(x=x.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x):null}function yx(x){return x=x.charCodeAt(0),"%"+(x>>4&15).toString(16)+(x&15).toString(16)}var jg=/[#\/\?@]/g,Gg=/[#\?:]/g,Hg=/[#\?]/g,Kg=/[#\?@]/g,qg=/#/g;function Wo(x,N){this.h=this.g=null,this.i=x||null,this.j=!!N}function Tt(x){x.g||(x.g=new Map,x.h=0,x.i&&nf(x.i,function(N,D){x.add(decodeURIComponent(N.replace(/\+/g," ")),D)}))}t=Wo.prototype,t.add=function(x,N){Tt(this),this.i=null,x=jo(this,x);var D=this.g.get(x);return D||this.g.set(x,D=[]),D.push(N),this.h+=1,this};function sf(x,N){Tt(x),N=jo(x,N),x.g.has(N)&&(x.i=null,x.h-=x.g.get(N).length,x.g.delete(N))}function rf(x,N){return Tt(x),N=jo(x,N),x.g.has(N)}t.forEach=function(x,N){Tt(this),this.g.forEach(function(D,M){D.forEach(function(se){x.call(N,se,M,this)},this)},this)},t.na=function(){Tt(this);const x=Array.from(this.g.values()),N=Array.from(this.g.keys()),D=[];for(let M=0;M<N.length;M++){const se=x[M];for(let le=0;le<se.length;le++)D.push(N[M])}return D},t.V=function(x){Tt(this);let N=[];if(typeof x=="string")rf(this,x)&&(N=N.concat(this.g.get(jo(this,x))));else{x=Array.from(this.g.values());for(let D=0;D<x.length;D++)N=N.concat(x[D])}return N},t.set=function(x,N){return Tt(this),this.i=null,x=jo(this,x),rf(this,x)&&(this.h-=this.g.get(x).length),this.g.set(x,[N]),this.h+=1,this},t.get=function(x,N){return x?(x=this.V(x),0<x.length?String(x[0]):N):N};function ac(x,N,D){sf(x,N),0<D.length&&(x.i=null,x.g.set(jo(x,N),g(D)),x.h+=D.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const x=[],N=Array.from(this.g.keys());for(var D=0;D<N.length;D++){var M=N[D];const le=encodeURIComponent(String(M)),be=this.V(M);for(M=0;M<be.length;M++){var se=le;be[M]!==""&&(se+="="+encodeURIComponent(String(be[M]))),x.push(se)}}return this.i=x.join("&")};function jo(x,N){return N=String(N),x.j&&(N=N.toLowerCase()),N}function Xg(x,N){N&&!x.j&&(Tt(x),x.i=null,x.g.forEach(function(D,M){var se=M.toLowerCase();M!=se&&(sf(this,M),ac(this,se,D))},x)),x.j=N}function vx(x,N){const D=new _a;if(a.Image){const M=new Image;M.onload=f(ki,D,"TestLoadImage: loaded",!0,N,M),M.onerror=f(ki,D,"TestLoadImage: error",!1,N,M),M.onabort=f(ki,D,"TestLoadImage: abort",!1,N,M),M.ontimeout=f(ki,D,"TestLoadImage: timeout",!1,N,M),a.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=x}else N(!1)}function xx(x,N){const D=new _a,M=new AbortController,se=setTimeout(()=>{M.abort(),ki(D,"TestPingServer: timeout",!1,N)},1e4);fetch(x,{signal:M.signal}).then(le=>{clearTimeout(se),le.ok?ki(D,"TestPingServer: ok",!0,N):ki(D,"TestPingServer: server error",!1,N)}).catch(()=>{clearTimeout(se),ki(D,"TestPingServer: error",!1,N)})}function ki(x,N,D,M,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),M(D)}catch{}}function Yg(){this.g=new mx}function Ku(x,N,D){const M=D||"";try{Gu(x,function(se,le){let be=se;c(se)&&(be=Fo(se)),N.push(M+le+"="+encodeURIComponent(be))})}catch(se){throw N.push(M+"type="+encodeURIComponent("_badmap")),se}}function lc(x){this.l=x.Ub||null,this.j=x.eb||!1}p(lc,Qi),lc.prototype.g=function(){return new cc(this.l,this.j)},lc.prototype.i=function(x){return function(){return x}}({});function cc(x,N){Rt.call(this),this.D=x,this.o=N,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}p(cc,Rt),t=cc.prototype,t.open=function(x,N){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=x,this.A=N,this.readyState=1,hc(this)},t.send=function(x){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const N={headers:this.u,method:this.B,credentials:this.m,cache:void 0};x&&(N.body=x),(this.D||a).fetch(new Request(this.A,N)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,uc(this)),this.readyState=0},t.Sa=function(x){if(this.g&&(this.l=x,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=x.headers,this.readyState=2,hc(this)),this.g&&(this.readyState=3,hc(this),this.g)))if(this.responseType==="arraybuffer")x.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in x){if(this.j=x.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Oa(this)}else x.text().then(this.Ra.bind(this),this.ga.bind(this))};function Oa(x){x.j.read().then(x.Pa.bind(x)).catch(x.ga.bind(x))}t.Pa=function(x){if(this.g){if(this.o&&x.value)this.response.push(x.value);else if(!this.o){var N=x.value?x.value:new Uint8Array(0);(N=this.v.decode(N,{stream:!x.done}))&&(this.response=this.responseText+=N)}x.done?uc(this):hc(this),this.readyState==3&&Oa(this)}},t.Ra=function(x){this.g&&(this.response=this.responseText=x,uc(this))},t.Qa=function(x){this.g&&(this.response=x,uc(this))},t.ga=function(){this.g&&uc(this)};function uc(x){x.readyState=4,x.l=null,x.j=null,x.v=null,hc(x)}t.setRequestHeader=function(x,N){this.u.append(x,N)},t.getResponseHeader=function(x){return this.h&&this.h.get(x.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const x=[],N=this.h.entries();for(var D=N.next();!D.done;)D=D.value,x.push(D[0]+": "+D[1]),D=N.next();return x.join(`\r
`)};function hc(x){x.onreadystatechange&&x.onreadystatechange.call(x)}Object.defineProperty(cc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(x){this.m=x?"include":"same-origin"}});function Jg(x){let N="";return $(x,function(D,M){N+=M,N+=":",N+=D,N+=`\r
`}),N}function of(x,N,D){e:{for(M in D){var M=!1;break e}M=!0}M||(D=Jg(D),typeof x=="string"?D!=null&&encodeURIComponent(String(D)):xt(x,N,D))}function zt(x){Rt.call(this),this.headers=new Map,this.o=x||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}p(zt,Rt);var dc=/^https?$/i,wx=["POST","PUT"];t=zt.prototype,t.Ha=function(x){this.J=x},t.ea=function(x,N,D,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+x);N=N?N.toUpperCase():"GET",this.D=x,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():kr.g(),this.v=this.o?Mu(this.o):Mu(kr),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(N,String(x),!0),this.B=!1}catch(le){Zg(this,le);return}if(x=D||"",D=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var se in M)D.set(se,M[se]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const le of M.keys())D.set(le,M.get(le));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(D.keys()).find(le=>le.toLowerCase()=="content-type"),se=a.FormData&&x instanceof a.FormData,!(0<=Array.prototype.indexOf.call(wx,N,void 0))||M||se||D.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[le,be]of D)this.g.setRequestHeader(le,be);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{af(this),this.u=!0,this.g.send(x),this.u=!1}catch(le){Zg(this,le)}};function Zg(x,N){x.h=!1,x.g&&(x.j=!0,x.g.abort(),x.j=!1),x.l=N,x.m=5,Qg(x),Fa(x)}function Qg(x){x.A||(x.A=!0,kt(x,"complete"),kt(x,"error"))}t.abort=function(x){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=x||7,kt(this,"complete"),kt(this,"abort"),Fa(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Fa(this,!0)),zt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?e0(this):this.bb())},t.bb=function(){e0(this)};function e0(x){if(x.h&&typeof o<"u"&&(!x.v[1]||Jr(x)!=4||x.Z()!=2)){if(x.u&&Jr(x)==4)Xi(x.Ea,0,x);else if(kt(x,"readystatechange"),Jr(x)==4){x.h=!1;try{const be=x.Z();e:switch(be){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var N=!0;break e;default:N=!1}var D;if(!(D=N)){var M;if(M=be===0){var se=String(x.D).match(tf)[1]||null;!se&&a.self&&a.self.location&&(se=a.self.location.protocol.slice(0,-1)),M=!dc.test(se?se.toLowerCase():"")}D=M}if(D)kt(x,"complete"),kt(x,"success");else{x.m=6;try{var le=2<Jr(x)?x.g.statusText:""}catch{le=""}x.l=le+" ["+x.Z()+"]",Qg(x)}}finally{Fa(x)}}}}function Fa(x,N){if(x.g){af(x);const D=x.g,M=x.v[0]?()=>{}:null;x.g=null,x.v=null,N||kt(x,"ready");try{D.onreadystatechange=M}catch{}}}function af(x){x.I&&(a.clearTimeout(x.I),x.I=null)}t.isActive=function(){return!!this.g};function Jr(x){return x.g?x.g.readyState:0}t.Z=function(){try{return 2<Jr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(x){if(this.g){var N=this.g.responseText;return x&&N.indexOf(x)==0&&(N=N.substring(x.length)),Bg(N)}};function _r(x){try{if(!x.g)return null;if("response"in x.g)return x.g.response;switch(x.H){case"":case"text":return x.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in x.g)return x.g.mozResponseArrayBuffer}return null}catch{return null}}function t0(x){const N={};x=(x.g&&2<=Jr(x)&&x.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<x.length;M++){if(w(x[M]))continue;var D=A(x[M]);const se=D[0];if(D=D[1],typeof D!="string")continue;D=D.trim();const le=N[se]||[];N[se]=le,le.push(D)}I(N,function(M){return M.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ss(x,N,D){return D&&D.internalChannelParams&&D.internalChannelParams[x]||N}function n0(x){this.Aa=0,this.i=[],this.j=new _a,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ss("failFast",!1,x),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ss("baseRetryDelayMs",5e3,x),this.cb=ss("retryDelaySeedMs",1e4,x),this.Wa=ss("forwardChannelMaxRetries",2,x),this.wa=ss("forwardChannelRequestTimeoutMs",2e4,x),this.pa=x&&x.xmlHttpFactory||void 0,this.Xa=x&&x.Tb||void 0,this.Ca=x&&x.useFetchStreams||!1,this.L=void 0,this.J=x&&x.supportsCrossDomainXhr||!1,this.K="",this.h=new Zd(x&&x.concurrentRequestLimit),this.Da=new Yg,this.P=x&&x.fastHandshake||!1,this.O=x&&x.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=x&&x.Rb||!1,x&&x.xa&&this.j.xa(),x&&x.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&x&&x.detectBufferingProxy||!1,this.ja=void 0,x&&x.longPollingTimeout&&0<x.longPollingTimeout&&(this.ja=x.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=n0.prototype,t.la=8,t.G=1,t.connect=function(x,N,D,M){Hn(0),this.W=x,this.H=N||{},D&&M!==void 0&&(this.H.OSID=D,this.H.OAID=M),this.F=this.X,this.I=df(this,null,this.W),fc(this)};function lf(x){if(Xu(x),x.G==3){var N=x.U++,D=Xr(x.I);if(xt(D,"SID",x.K),xt(D,"RID",N),xt(D,"TYPE","terminate"),pc(x,D),N=new Ii(x,x.j,N),N.L=2,N.v=Hu(Xr(D)),D=!1,a.navigator&&a.navigator.sendBeacon)try{D=a.navigator.sendBeacon(N.v.toString(),"")}catch{}!D&&a.Image&&(new Image().src=N.v,D=!0),D||(N.g=o0(N.j,null),N.g.ea(N.v)),N.F=Date.now(),Uo(N)}hf(x)}function qu(x){x.g&&(no(x),x.g.cancel(),x.g=null)}function Xu(x){qu(x),x.u&&(a.clearTimeout(x.u),x.u=null),La(x),x.h.cancel(),x.s&&(typeof x.s=="number"&&a.clearTimeout(x.s),x.s=null)}function fc(x){if(!Qd(x.h)&&!x.s){x.s=!0;var N=x.Ga;ee||ie(),z||(ee(),z=!0),X.add(N,x),x.B=0}}function s0(x,N){return bn(x.h)>=x.h.j-(x.s?1:0)?!1:x.s?(x.i=N.D.concat(x.i),!0):x.G==1||x.G==2||x.B>=(x.Va?0:x.Wa)?!1:(x.s=Na(d(x.Ga,x,N),i0(x,x.B)),x.B++,!0)}t.Ga=function(x){if(this.s)if(this.s=null,this.G==1){if(!x){this.U=Math.floor(1e5*Math.random()),x=this.U++;const se=new Ii(this,this.j,x);let le=this.o;if(this.S&&(le?(le=T(le),E(le,this.S)):le=this.S),this.m!==null||this.O||(se.H=le,le=null),this.P)e:{for(var N=0,D=0;D<this.i.length;D++){t:{var M=this.i[D];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(N+=M,4096<N){N=D;break e}if(N===4096||D===this.i.length-1){N=D+1;break e}}N=1e3}else N=1e3;N=Yu(this,se,N),D=Xr(this.I),xt(D,"RID",x),xt(D,"CVER",22),this.D&&xt(D,"X-HTTP-Session-Id",this.D),pc(this,D),le&&(this.O?N="headers="+encodeURIComponent(String(Jg(le)))+"&"+N:this.m&&of(D,this.m,le)),Er(this.h,se),this.Ua&&xt(D,"TYPE","init"),this.P?(xt(D,"$req",N),xt(D,"SID","null"),se.T=!0,$a(se,D,null)):$a(se,D,N),this.G=2}}else this.G==3&&(x?cf(this,x):this.i.length==0||Qd(this.h)||cf(this))};function cf(x,N){var D;N?D=N.l:D=x.U++;const M=Xr(x.I);xt(M,"SID",x.K),xt(M,"RID",D),xt(M,"AID",x.T),pc(x,M),x.m&&x.o&&of(M,x.m,x.o),D=new Ii(x,x.j,D,x.B+1),x.m===null&&(D.H=x.o),N&&(x.i=N.D.concat(x.i)),N=Yu(x,D,1e3),D.I=Math.round(.5*x.wa)+Math.round(.5*x.wa*Math.random()),Er(x.h,D),$a(D,M,N)}function pc(x,N){x.H&&$(x.H,function(D,M){xt(N,M,D)}),x.l&&Gu({},function(D,M){xt(N,M,D)})}function Yu(x,N,D){D=Math.min(x.i.length,D);var M=x.l?d(x.l.Na,x.l,x):null;e:{var se=x.i;let le=-1;for(;;){const be=["count="+D];le==-1?0<D?(le=se[0].g,be.push("ofs="+le)):le=0:be.push("ofs="+le);let wt=!0;for(let Sn=0;Sn<D;Sn++){let ot=se[Sn].g;const Dn=se[Sn].map;if(ot-=le,0>ot)le=Math.max(0,se[Sn].g-100),wt=!1;else try{Ku(Dn,be,"req"+ot+"_")}catch{M&&M(Dn)}}if(wt){M=be.join("&");break e}}}return x=x.i.splice(0,D),N.D=x,M}function mc(x){if(!x.g&&!x.u){x.Y=1;var N=x.Fa;ee||ie(),z||(ee(),z=!0),X.add(N,x),x.v=0}}function gc(x){return x.g||x.u||3<=x.v?!1:(x.Y++,x.u=Na(d(x.Fa,x),i0(x,x.v)),x.v++,!0)}t.Fa=function(){if(this.u=null,uf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var x=2*this.R;this.j.info("BP detection timer enabled: "+x),this.A=Na(d(this.ab,this),x)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Hn(10),qu(this),uf(this))};function no(x){x.A!=null&&(a.clearTimeout(x.A),x.A=null)}function uf(x){x.g=new Ii(x,x.j,"rpc",x.Y),x.m===null&&(x.g.H=x.o),x.g.O=0;var N=Xr(x.qa);xt(N,"RID","rpc"),xt(N,"SID",x.K),xt(N,"AID",x.T),xt(N,"CI",x.F?"0":"1"),!x.F&&x.ja&&xt(N,"TO",x.ja),xt(N,"TYPE","xmlhttp"),pc(x,N),x.m&&x.o&&of(N,x.m,x.o),x.L&&(x.g.I=x.L);var D=x.g;x=x.ia,D.L=1,D.v=Hu(Xr(N)),D.m=null,D.P=!0,Tr(D,x)}t.Za=function(){this.C!=null&&(this.C=null,qu(this),gc(this),Hn(19))};function La(x){x.C!=null&&(a.clearTimeout(x.C),x.C=null)}function r0(x,N){var D=null;if(x.g==N){La(x),no(x),x.g=null;var M=2}else if(xs(x.h,N))D=N.D,Aa(x.h,N),M=1;else return;if(x.G!=0){if(N.o)if(M==1){D=N.m?N.m.length:0,N=Date.now()-N.F;var se=x.B;M=Bo(),kt(M,new sc(M,D)),fc(x)}else mc(x);else if(se=N.s,se==3||se==0&&0<N.X||!(M==1&&s0(x,N)||M==2&&gc(x)))switch(D&&0<D.length&&(N=x.h,N.i=N.i.concat(D)),se){case 1:$r(x,5);break;case 4:$r(x,10);break;case 3:$r(x,6);break;default:$r(x,2)}}}function i0(x,N){let D=x.Ta+Math.floor(Math.random()*x.cb);return x.isActive()||(D*=2),D*N}function $r(x,N){if(x.j.info("Error code "+N),N==2){var D=d(x.fb,x),M=x.Xa;const se=!M;M=new Kn(M||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Da(M,"https"),Hu(M),se?vx(M.toString(),D):xx(M.toString(),D)}else Hn(2);x.G=0,x.l&&x.l.sa(N),hf(x),Xu(x)}t.fb=function(x){x?(this.j.info("Successfully pinged google.com"),Hn(2)):(this.j.info("Failed to ping google.com"),Hn(1))};function hf(x){if(x.G=0,x.ka=[],x.l){const N=oc(x.h);(N.length!=0||x.i.length!=0)&&(m(x.ka,N),m(x.ka,x.i),x.h.i.length=0,g(x.i),x.i.length=0),x.l.ra()}}function df(x,N,D){var M=D instanceof Kn?Xr(D):new Kn(D);if(M.g!="")N&&(M.g=N+"."+M.g),Yr(M,M.s);else{var se=a.location;M=se.protocol,N=N?N+"."+se.hostname:se.hostname,se=+se.port;var le=new Kn(null);M&&Da(le,M),N&&(le.g=N),se&&Yr(le,se),D&&(le.l=D),M=le}return D=x.D,N=x.ya,D&&N&&xt(M,D,N),xt(M,"VER",x.la),pc(x,M),M}function o0(x,N,D){if(N&&!x.J)throw Error("Can't create secondary domain capable XhrIo object.");return N=x.Ca&&!x.pa?new zt(new lc({eb:D})):new zt(x.pa),N.Ha(x.J),N}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function a0(){}t=a0.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Cn(x,N){Rt.call(this),this.g=new n0(N),this.l=x,this.h=N&&N.messageUrlParams||null,x=N&&N.messageHeaders||null,N&&N.clientProtocolHeaderRequired&&(x?x["X-Client-Protocol"]="webchannel":x={"X-Client-Protocol":"webchannel"}),this.g.o=x,x=N&&N.initMessageHeaders||null,N&&N.messageContentType&&(x?x["X-WebChannel-Content-Type"]=N.messageContentType:x={"X-WebChannel-Content-Type":N.messageContentType}),N&&N.va&&(x?x["X-WebChannel-Client-Profile"]=N.va:x={"X-WebChannel-Client-Profile":N.va}),this.g.S=x,(x=N&&N.Sb)&&!w(x)&&(this.g.m=x),this.v=N&&N.supportsCrossDomainXhr||!1,this.u=N&&N.sendRawJson||!1,(N=N&&N.httpSessionIdParam)&&!w(N)&&(this.g.D=N,x=this.h,x!==null&&N in x&&(x=this.h,N in x&&delete x[N])),this.j=new Ti(this)}p(Cn,Rt),Cn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Cn.prototype.close=function(){lf(this.g)},Cn.prototype.o=function(x){var N=this.g;if(typeof x=="string"){var D={};D.__data__=x,x=D}else this.u&&(D={},D.__data__=Fo(x),x=D);N.i.push(new Wg(N.Ya++,x)),N.G==3&&fc(N)},Cn.prototype.N=function(){this.g.l=null,delete this.j,lf(this.g),delete this.g,Cn.aa.N.call(this)};function l0(x){Bu.call(this),x.__headers__&&(this.headers=x.__headers__,this.statusCode=x.__status__,delete x.__headers__,delete x.__status__);var N=x.__sm__;if(N){e:{for(const D in N){x=D;break e}x=void 0}(this.i=x)&&(x=this.i,N=N!==null&&x in N?N[x]:void 0),this.data=N}else this.data=x}p(l0,Bu);function c0(){Vu.call(this),this.status=1}p(c0,Vu);function Ti(x){this.g=x}p(Ti,a0),Ti.prototype.ua=function(){kt(this.g,"a")},Ti.prototype.ta=function(x){kt(this.g,new l0(x))},Ti.prototype.sa=function(x){kt(this.g,new c0)},Ti.prototype.ra=function(){kt(this.g,"b")},Cn.prototype.send=Cn.prototype.o,Cn.prototype.open=Cn.prototype.m,Cn.prototype.close=Cn.prototype.close,Yd.NO_ERROR=0,Yd.TIMEOUT=8,Yd.HTTP_ERROR=6,Si.COMPLETE="complete",Lo.EventType=Mo,Mo.OPEN="a",Mo.CLOSE="b",Mo.ERROR="c",Mo.MESSAGE="d",Rt.prototype.listen=Rt.prototype.K,zt.prototype.listenOnce=zt.prototype.L,zt.prototype.getLastError=zt.prototype.Ka,zt.prototype.getLastErrorCode=zt.prototype.Ba,zt.prototype.getStatus=zt.prototype.Z,zt.prototype.getResponseJson=zt.prototype.Oa,zt.prototype.getResponseText=zt.prototype.oa,zt.prototype.send=zt.prototype.ea,zt.prototype.setWithCredentials=zt.prototype.Ha}).apply(typeof P0<"u"?P0:typeof self<"u"?self:typeof window<"u"?window:{});const A_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Is.UNAUTHENTICATED=new Is(null),Is.GOOGLE_CREDENTIALS=new Is("google-credentials-uid"),Is.FIRST_PARTY=new Is("first-party-uid"),Is.MOCK_USER=new Is("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ym="10.12.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ld=new qI("@firebase/firestore");function Lr(t,...e){if(ld.logLevel<=St.DEBUG){const n=e.map(ok);ld.debug(`Firestore (${ym}): ${t}`,...n)}}function ik(t,...e){if(ld.logLevel<=St.ERROR){const n=e.map(ok);ld.error(`Firestore (${ym}): ${t}`,...n)}}function hQ(t,...e){if(ld.logLevel<=St.WARN){const n=e.map(ok);ld.warn(`Firestore (${ym}): ${t}`,...n)}}function ok(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ak(t="Unexpected state"){const e=`FIRESTORE (${ym}) INTERNAL ASSERTION FAILED: `+t;throw ik(e),new Error(e)}function CC(t,e){t||ak()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ns={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class _s extends Do{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e5{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class dQ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Is.UNAUTHENTICATED))}shutdown(){}}class fQ{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class pQ{constructor(e){this.t=e,this.currentUser=Is.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let s=this.i;const r=l=>this.i!==s?(s=this.i,n(l)):Promise.resolve();let i=new Uh;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Uh,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{Lr("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Lr("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Uh)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(Lr("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(CC(typeof s.accessToken=="string"),new e5(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return CC(e===null||typeof e=="string"),new Is(e)}}class mQ{constructor(e,n,s){this.l=e,this.h=n,this.P=s,this.type="FirstParty",this.user=Is.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class gQ{constructor(e,n,s){this.l=e,this.h=n,this.P=s}getToken(){return Promise.resolve(new mQ(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Is.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class yQ{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class vQ{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const s=i=>{i.error!=null&&Lr("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,Lr("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{Lr("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?r(i):Lr("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(CC(typeof n.token=="string"),this.R=n.token,new yQ(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xQ(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wQ{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let s="";for(;s.length<20;){const r=xQ(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<n&&(s+=e.charAt(r[i]%e.length))}return s}}function t5(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bQ{constructor(e,n,s,r,i,o,a,l,c){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class p2{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new p2("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof p2&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var D_,ht;(ht=D_||(D_={}))[ht.OK=0]="OK",ht[ht.CANCELLED=1]="CANCELLED",ht[ht.UNKNOWN=2]="UNKNOWN",ht[ht.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ht[ht.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ht[ht.NOT_FOUND=5]="NOT_FOUND",ht[ht.ALREADY_EXISTS=6]="ALREADY_EXISTS",ht[ht.PERMISSION_DENIED=7]="PERMISSION_DENIED",ht[ht.UNAUTHENTICATED=16]="UNAUTHENTICATED",ht[ht.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ht[ht.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ht[ht.ABORTED=10]="ABORTED",ht[ht.OUT_OF_RANGE=11]="OUT_OF_RANGE",ht[ht.UNIMPLEMENTED=12]="UNIMPLEMENTED",ht[ht.INTERNAL=13]="INTERNAL",ht[ht.UNAVAILABLE=14]="UNAVAILABLE",ht[ht.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new QF([4294967295,4294967295],0);function Cw(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CQ{constructor(e,n,s=1e3,r=1.5,i=6e4){this.oi=e,this.timerId=n,this.No=s,this.Lo=r,this.Bo=i,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();const n=Math.floor(this.ko+this.Uo()),s=Math.max(0,Date.now()-this.Qo),r=Math.max(0,n-s);r>0&&Lr("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.ko} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,r,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(e,n,s,r,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new Uh,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,s,r,i){const o=Date.now()+s,a=new lk(e,n,o,r,i);return a.start(s),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new _s(Ns.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function SQ(t,e){if(ik("AsyncQueue",`${e}: ${t}`),t5(t))return new _s(Ns.UNAVAILABLE,`${e}: ${t}`);throw t}var P_,O_;(O_=P_||(P_={})).J_="default",O_.Cache="cache";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IQ{constructor(e,n,s,r){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=r,this.user=Is.UNAUTHENTICATED,this.clientId=wQ.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(s,async i=>{Lr("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(s,i=>(Lr("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new _s(Ns.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Uh;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=SQ(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n5(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_=new Map;function kQ(t,e,n,s){if(e===!0&&s===!0)throw new _s(Ns.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function TQ(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ak()}function EQ(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new _s(Ns.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=TQ(t);throw new _s(Ns.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{constructor(e){var n,s;if(e.host===void 0){if(e.ssl!==void 0)throw new _s(Ns.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new _s(Ns.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}kQ("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=n5((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new _s(Ns.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new _s(Ns.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new _s(Ns.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,r){return s.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class s5{constructor(e,n,s,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new L_({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new _s(Ns.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new _s(Ns.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new L_(e),e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new dQ;switch(s.type){case"firstParty":return new gQ(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new _s(Ns.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const s=F_.get(n);s&&(Lr("ComponentProvider","Removing Datastore"),F_.delete(n),s.terminate())}(this),Promise.resolve()}}function NQ(t,e,n,s={}){var r;const i=(t=EQ(t,s5))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&hQ("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),s.mockUserToken){let a,l;if(typeof s.mockUserToken=="string")a=s.mockUserToken,l=Is.MOCK_USER;else{a=fF(s.mockUserToken,(r=t._app)===null||r===void 0?void 0:r.options.projectId);const c=s.mockUserToken.sub||s.mockUserToken.user_id;if(!c)throw new _s(Ns.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Is(c)}t._authCredentials=new fQ(new e5(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _Q{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new CQ(this,"async_queue_retry"),this.hu=()=>{const n=Cw();n&&Lr("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Yo.Wo()};const e=Cw();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;const n=Cw();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});const n=new Uh;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}async Tu(){if(this.su.length!==0){try{await this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!t5(e))throw e;Lr("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}}Iu(e){const n=this.iu.then(()=>(this.uu=!0,e().catch(s=>{this.au=s,this.uu=!1;const r=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(s);throw ik("INTERNAL UNHANDLED ERROR: ",r),s}).then(s=>(this.uu=!1,s))));return this.iu=n,n}enqueueAfterDelay(e,n,s){this.Pu(),this.lu.indexOf(e)>-1&&(n=0);const r=lk.createAndSchedule(this,e,n,s,i=>this.Eu(i));return this._u.push(r),r}Pu(){this.au&&ak()}verifyOperationInProgress(){}async du(){let e;do e=this.iu,await e;while(e!==this.iu)}Au(e){for(const n of this._u)if(n.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this._u)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){const n=this._u.indexOf(e);this._u.splice(n,1)}}class $Q extends s5{constructor(e,n,s,r){super(e,n,s,r),this.type="firestore",this._queue=function(){return new _Q}(),this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||AQ(this),this._firestoreClient.terminate()}}function RQ(t,e){const n=typeof t=="object"?t:YI(),s=typeof t=="string"?t:"(default)",r=ky(n,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=uF("firestore");i&&NQ(r,...i)}return r}function AQ(t){var e,n,s;const r=t._freezeSettings(),i=function(a,l,c,u){return new bQ(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,n5(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,r);t._firestoreClient=new IQ(t._authCredentials,t._appCheckCredentials,t._queue,i),!((n=r.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((s=r.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}(function(e,n=!0){(function(r){ym=r})(Su),nu(new $l("firestore",(s,{instanceIdentifier:r,options:i})=>{const o=s.getProvider("app").getImmediate(),a=new $Q(new pQ(s.getProvider("auth-internal")),new vQ(s.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new _s(Ns.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new p2(c.options.projectId,u)}(o,r),o);return i=Object.assign({useFetchStreams:n},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),vo(A_,"4.6.3",e),vo(A_,"4.6.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r5="firebasestorage.googleapis.com",i5="storageBucket",DQ=2*60*1e3,PQ=10*60*1e3,OQ=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn extends Do{constructor(e,n,s=0){super(Sw(e),`Firebase Storage: ${n} (${Sw(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,rn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Sw(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Xt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Xt||(Xt={}));function Sw(t){return"storage/"+t}function ck(){const t="An unknown error occurred, please check the error payload for server response.";return new rn(Xt.UNKNOWN,t)}function FQ(t){return new rn(Xt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function LQ(t){return new rn(Xt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function MQ(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new rn(Xt.UNAUTHENTICATED,t)}function BQ(){return new rn(Xt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function VQ(t){return new rn(Xt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function o5(){return new rn(Xt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function a5(){return new rn(Xt.CANCELED,"User canceled the upload/download.")}function UQ(t){return new rn(Xt.INVALID_URL,"Invalid URL '"+t+"'.")}function zQ(t){return new rn(Xt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function WQ(){return new rn(Xt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+i5+"' property when initializing the app?")}function l5(){return new rn(Xt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function jQ(){return new rn(Xt.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function GQ(){return new rn(Xt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function HQ(t){return new rn(Xt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function SC(t){return new rn(Xt.INVALID_ARGUMENT,t)}function c5(){return new rn(Xt.APP_DELETED,"The Firebase app was deleted.")}function KQ(t){return new rn(Xt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function cp(t,e){return new rn(Xt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function If(t){throw new rn(Xt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let s;try{s=Xs.makeFromUrl(e,n)}catch{return new Xs(e,"")}if(s.path==="")return s;throw zQ(e)}static makeFromUrl(e,n){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i(C){C.path.charAt(C.path.length-1)==="/"&&(C.path_=C.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),l={bucket:1,path:3};function c(C){C.path_=decodeURIComponent(C.path)}const u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",f=new RegExp(`^https?://${h}/${u}/b/${r}/o${d}`,"i"),p={bucket:1,path:3},g=n===r5?"(?:storage.googleapis.com|storage.cloud.google.com)":n,m="([^?#]*)",y=new RegExp(`^https?://${g}/${r}/${m}`,"i"),b=[{regex:a,indices:l,postModify:i},{regex:f,indices:p,postModify:c},{regex:y,indices:{bucket:1,path:2},postModify:c}];for(let C=0;C<b.length;C++){const k=b[C],$=k.regex.exec(e);if($){const I=$[k.indices.bucket];let T=$[k.indices.path];T||(T=""),s=new Xs(I,T),k.postModify(s);break}}if(s==null)throw UQ(e);return s}}class qQ{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XQ(t,e,n){let s=1,r=null,i=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...m){c||(c=!0,e.apply(null,m))}function h(m){r=setTimeout(()=>{r=null,t(f,l())},m)}function d(){i&&clearTimeout(i)}function f(m,...y){if(c){d();return}if(m){d(),u.call(null,m,...y);return}if(l()||o){d(),u.call(null,m,...y);return}s<64&&(s*=2);let b;a===1?(a=2,b=0):b=(s+Math.random())*1e3,h(b)}let p=!1;function g(m){p||(p=!0,d(),!c&&(r!==null?(m||(a=2),clearTimeout(r),h(0)):m||(a=1)))}return h(0),i=setTimeout(()=>{o=!0,g(!0)},n),g}function YQ(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JQ(t){return t!==void 0}function ZQ(t){return typeof t=="function"}function QQ(t){return typeof t=="object"&&!Array.isArray(t)}function Ry(t){return typeof t=="string"||t instanceof String}function M_(t){return uk()&&t instanceof Blob}function uk(){return typeof Blob<"u"}function IC(t,e,n,s){if(s<e)throw SC(`Invalid value for '${t}'. Expected ${e} or greater.`);if(s>n)throw SC(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ku(t,e,n){let s=e;return n==null&&(s=`https://${e}`),`${n}://${s}/v0${t}`}function u5(t){const e=encodeURIComponent;let n="?";for(const s in t)if(t.hasOwnProperty(s)){const r=e(s)+"="+e(t[s]);n=n+r+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jc;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(jc||(jc={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h5(t,e){const n=t>=500&&t<600,r=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eee{constructor(e,n,s,r,i,o,a,l,c,u,h,d=!0){this.url_=e,this.method_=n,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((f,p)=>{this.resolve_=f,this.reject_=p,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new O0(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===jc.NO_ERROR,l=i.getStatus();if(!a||h5(l,this.additionalRetryCodes_)&&this.retry){const u=i.getErrorCode()===jc.ABORT;s(!1,new O0(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;s(!0,new O0(c,i))})},n=(s,r)=>{const i=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());JQ(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=ck();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(r.canceled){const l=this.appDelete_?c5():a5();o(l)}else{const l=o5();o(l)}};this.canceled_?n(!1,new O0(!1,null,!0)):this.backoffId_=XQ(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&YQ(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class O0{constructor(e,n,s){this.wasSuccessCode=e,this.connection=n,this.canceled=!!s}}function tee(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function nee(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function see(t,e){e&&(t["X-Firebase-GMPID"]=e)}function ree(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function iee(t,e,n,s,r,i,o=!0){const a=u5(t.urlParams),l=t.url+a,c=Object.assign({},t.headers);return see(c,e),tee(c,n),nee(c,i),ree(c,s),new eee(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oee(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function aee(...t){const e=oee();if(e!==void 0){const n=new e;for(let s=0;s<t.length;s++)n.append(t[s]);return n.getBlob()}else{if(uk())return new Blob(t);throw new rn(Xt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function lee(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cee(t){if(typeof atob>"u")throw HQ("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fo={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Iw{constructor(e,n){this.data=e,this.contentType=n||null}}function uee(t,e){switch(t){case fo.RAW:return new Iw(d5(e));case fo.BASE64:case fo.BASE64URL:return new Iw(f5(t,e));case fo.DATA_URL:return new Iw(dee(e),fee(e))}throw ck()}function d5(t){const e=[];for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=s,o=t.charCodeAt(++n);s=65536|(i&1023)<<10|o&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function hee(t){let e;try{e=decodeURIComponent(t)}catch{throw cp(fo.DATA_URL,"Malformed data URL.")}return d5(e)}function f5(t,e){switch(t){case fo.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw cp(t,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case fo.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw cp(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=cee(e)}catch(r){throw r.message.includes("polyfill")?r:cp(t,"Invalid character found")}const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}class p5{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw cp(fo.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=n[1]||null;s!=null&&(this.base64=pee(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function dee(t){const e=new p5(t);return e.base64?f5(fo.BASE64,e.rest):hee(e.rest)}function fee(t){return new p5(t).contentType}function pee(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e,n){let s=0,r="";M_(e)?(this.data_=e,s=e.size,r=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,n){if(M_(this.data_)){const s=this.data_,r=lee(s,e,n);return r===null?null:new Qa(r)}else{const s=new Uint8Array(this.data_.buffer,e,n-e);return new Qa(s,!0)}}static getBlob(...e){if(uk()){const n=e.map(s=>s instanceof Qa?s.data_:s);return new Qa(aee.apply(null,n))}else{const n=e.map(o=>Ry(o)?uee(fo.RAW,o).data:o.data_);let s=0;n.forEach(o=>{s+=o.byteLength});const r=new Uint8Array(s);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)r[i++]=o[a]}),new Qa(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hk(t){let e;try{e=JSON.parse(t)}catch{return null}return QQ(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mee(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function gee(t,e){const n=e.split("/").filter(s=>s.length>0).join("/");return t.length===0?n:t+"/"+n}function m5(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yee(t,e){return e}class Us{constructor(e,n,s,r){this.server=e,this.local=n||e,this.writable=!!s,this.xform=r||yee}}let F0=null;function vee(t){return!Ry(t)||t.length<2?t:m5(t)}function Ay(){if(F0)return F0;const t=[];t.push(new Us("bucket")),t.push(new Us("generation")),t.push(new Us("metageneration")),t.push(new Us("name","fullPath",!0));function e(i,o){return vee(o)}const n=new Us("name");n.xform=e,t.push(n);function s(i,o){return o!==void 0?Number(o):o}const r=new Us("size");return r.xform=s,t.push(r),t.push(new Us("timeCreated")),t.push(new Us("updated")),t.push(new Us("md5Hash",null,!0)),t.push(new Us("cacheControl",null,!0)),t.push(new Us("contentDisposition",null,!0)),t.push(new Us("contentEncoding",null,!0)),t.push(new Us("contentLanguage",null,!0)),t.push(new Us("contentType",null,!0)),t.push(new Us("metadata","customMetadata",!0)),F0=t,F0}function xee(t,e){function n(){const s=t.bucket,r=t.fullPath,i=new Xs(s,r);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function wee(t,e,n){const s={};s.type="file";const r=n.length;for(let i=0;i<r;i++){const o=n[i];s[o.local]=o.xform(s,e[o.server])}return xee(s,t),s}function g5(t,e,n){const s=hk(e);return s===null?null:wee(t,s,n)}function bee(t,e,n,s){const r=hk(e);if(r===null||!Ry(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(c=>{const u=t.bucket,h=t.fullPath,d="/b/"+o(u)+"/o/"+o(h),f=ku(d,n,s),p=u5({alt:"media",token:c});return f+p})[0]}function dk(t,e){const n={},s=e.length;for(let r=0;r<s;r++){const i=e[r];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B_="prefixes",V_="items";function Cee(t,e,n){const s={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[B_])for(const r of n[B_]){const i=r.replace(/\/$/,""),o=t._makeStorageReference(new Xs(e,i));s.prefixes.push(o)}if(n[V_])for(const r of n[V_]){const i=t._makeStorageReference(new Xs(e,r.name));s.items.push(i)}return s}function See(t,e,n){const s=hk(n);return s===null?null:Cee(t,e,s)}class jl{constructor(e,n,s,r){this.url=e,this.method=n,this.handler=s,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bo(t){if(!t)throw ck()}function Dy(t,e){function n(s,r){const i=g5(t,r,e);return bo(i!==null),i}return n}function Iee(t,e){function n(s,r){const i=See(t,e,r);return bo(i!==null),i}return n}function kee(t,e){function n(s,r){const i=g5(t,r,e);return bo(i!==null),bee(i,r,t.host,t._protocol)}return n}function $d(t){function e(n,s){let r;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?r=BQ():r=MQ():n.getStatus()===402?r=LQ(t.bucket):n.getStatus()===403?r=VQ(t.path):r=s,r.status=n.getStatus(),r.serverResponse=s.serverResponse,r}return e}function fk(t){const e=$d(t);function n(s,r){let i=e(s,r);return s.getStatus()===404&&(i=FQ(t.path)),i.serverResponse=r.serverResponse,i}return n}function y5(t,e,n){const s=e.fullServerUrl(),r=ku(s,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new jl(r,i,Dy(t,n),o);return a.errorHandler=fk(e),a}function Tee(t,e,n,s,r){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n.length>0&&(i.delimiter=n),s&&(i.pageToken=s),r&&(i.maxResults=r);const o=e.bucketOnlyServerUrl(),a=ku(o,t.host,t._protocol),l="GET",c=t.maxOperationRetryTime,u=new jl(a,l,Iee(t,e.bucket),c);return u.urlParams=i,u.errorHandler=$d(e),u}function Eee(t,e,n){const s=e.fullServerUrl(),r=ku(s,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new jl(r,i,kee(t,n),o);return a.errorHandler=fk(e),a}function Nee(t,e,n,s){const r=e.fullServerUrl(),i=ku(r,t.host,t._protocol),o="PATCH",a=dk(n,s),l={"Content-Type":"application/json; charset=utf-8"},c=t.maxOperationRetryTime,u=new jl(i,o,Dy(t,s),c);return u.headers=l,u.body=a,u.errorHandler=fk(e),u}function _ee(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function v5(t,e,n){const s=Object.assign({},n);return s.fullPath=t.path,s.size=e.size(),s.contentType||(s.contentType=_ee(null,e)),s}function $ee(t,e,n,s,r){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let b="";for(let C=0;C<2;C++)b=b+Math.random().toString().slice(2);return b}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=v5(e,s,r),u=dk(c,n),h="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,d=`\r
--`+l+"--",f=Qa.getBlob(h,s,d);if(f===null)throw l5();const p={name:c.fullPath},g=ku(i,t.host,t._protocol),m="POST",y=t.maxUploadRetryTime,w=new jl(g,m,Dy(t,n),y);return w.urlParams=p,w.headers=o,w.body=f.uploadData(),w.errorHandler=$d(e),w}class m2{constructor(e,n,s,r){this.current=e,this.total=n,this.finalized=!!s,this.metadata=r||null}}function pk(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{bo(!1)}return bo(!!n&&(e||["active"]).indexOf(n)!==-1),n}function Ree(t,e,n,s,r){const i=e.bucketOnlyServerUrl(),o=v5(e,s,r),a={name:o.fullPath},l=ku(i,t.host,t._protocol),c="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${s.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=dk(o,n),d=t.maxUploadRetryTime;function f(g){pk(g);let m;try{m=g.getResponseHeader("X-Goog-Upload-URL")}catch{bo(!1)}return bo(Ry(m)),m}const p=new jl(l,c,f,d);return p.urlParams=a,p.headers=u,p.body=h,p.errorHandler=$d(e),p}function Aee(t,e,n,s){const r={"X-Goog-Upload-Command":"query"};function i(c){const u=pk(c,["active","final"]);let h=null;try{h=c.getResponseHeader("X-Goog-Upload-Size-Received")}catch{bo(!1)}h||bo(!1);const d=Number(h);return bo(!isNaN(d)),new m2(d,s.size(),u==="final")}const o="POST",a=t.maxUploadRetryTime,l=new jl(n,o,i,a);return l.headers=r,l.errorHandler=$d(e),l}const U_=256*1024;function Dee(t,e,n,s,r,i,o,a){const l=new m2(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=s.size()),s.size()!==l.total)throw jQ();const c=l.total-l.current;let u=c;r>0&&(u=Math.min(u,r));const h=l.current,d=h+u;let f="";u===0?f="finalize":c===u?f="upload, finalize":f="upload";const p={"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":`${l.current}`},g=s.slice(h,d);if(g===null)throw l5();function m(C,k){const $=pk(C,["active","final"]),I=l.current+u,T=s.size();let R;return $==="final"?R=Dy(e,i)(C,k):R=null,new m2(I,T,$==="final",R)}const y="POST",w=e.maxUploadRetryTime,b=new jl(n,y,m,w);return b.headers=p,b.body=g.uploadData(),b.progressCallback=a||null,b.errorHandler=$d(t),b}const cr={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function kw(t){switch(t){case"running":case"pausing":case"canceling":return cr.RUNNING;case"paused":return cr.PAUSED;case"success":return cr.SUCCESS;case"canceled":return cr.CANCELED;case"error":return cr.ERROR;default:return cr.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pee{constructor(e,n,s){if(ZQ(e)||n!=null||s!=null)this.next=e,this.error=n??void 0,this.complete=s??void 0;else{const i=e;this.next=i.next,this.error=i.error,this.complete=i.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eh(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class Oee{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=jc.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=jc.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=jc.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,s,r){if(this.sent_)throw If("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),r!==void 0)for(const i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw If("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw If("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw If("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw If("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Fee extends Oee{initXhr(){this.xhr_.responseType="text"}}function Jo(){return new Fee}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lee{constructor(e,n,s=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=s,this._mappings=Ay(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=r=>{if(this._request=void 0,this._chunkMultiplier=1,r._codeEquals(Xt.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const i=this.isExponentialBackoffExpired();if(h5(r.status,[]))if(i)r=o5();else{this.sleepTime=Math.max(this.sleepTime*2,OQ),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=r,this._transition("error")}},this._metadataErrorHandler=r=>{this._request=void 0,r._codeEquals(Xt.CANCELED)?this.completeTransitions_():(this._error=r,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((r,i)=>{this._resolve=r,this._reject=i,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,s])=>{switch(this._state){case"running":e(n,s);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const s=Ree(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(s,Jo,e,n);this._request=r,r.getPromise().then(i=>{this._request=void 0,this._uploadUrl=i,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,s)=>{const r=Aee(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(r,Jo,n,s);this._request=i,i.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=U_*this._chunkMultiplier,n=new m2(this._transferred,this._blob.size()),s=this._uploadUrl;this._resolveToken((r,i)=>{let o;try{o=Dee(this._ref._location,this._ref.storage,s,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(l){this._error=l,this._transition("error");return}const a=this._ref.storage._makeRequest(o,Jo,r,i,!1);this._request=a,a.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){U_*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const s=y5(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(s,Jo,e,n);this._request=r,r.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const s=$ee(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(s,Jo,e,n);this._request=r,r.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=a5(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=kw(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,s,r){const i=new Pee(n||void 0,s||void 0,r||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(kw(this._state)){case cr.SUCCESS:eh(this._resolve.bind(null,this.snapshot))();break;case cr.CANCELED:case cr.ERROR:const n=this._reject;eh(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(kw(this._state)){case cr.RUNNING:case cr.PAUSED:e.next&&eh(e.next.bind(e,this.snapshot))();break;case cr.SUCCESS:e.complete&&eh(e.complete.bind(e))();break;case cr.CANCELED:case cr.ERROR:e.error&&eh(e.error.bind(e,this._error))();break;default:e.error&&eh(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,n){this._service=e,n instanceof Xs?this._location=n:this._location=Xs.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ru(e,n)}get root(){const e=new Xs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return m5(this._location.path)}get storage(){return this._service}get parent(){const e=mee(this._location.path);if(e===null)return null;const n=new Xs(this._location.bucket,e);return new ru(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw KQ(e)}}function Mee(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new Lee(t,new Qa(e),n)}function Bee(t){const e={prefixes:[],items:[]};return x5(t,e).then(()=>e)}async function x5(t,e,n){const r=await Vee(t,{pageToken:n});e.prefixes.push(...r.prefixes),e.items.push(...r.items),r.nextPageToken!=null&&await x5(t,e,r.nextPageToken)}function Vee(t,e){e!=null&&typeof e.maxResults=="number"&&IC("options.maxResults",1,1e3,e.maxResults);const n=e||{},s=Tee(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(s,Jo)}function Uee(t){t._throwIfRoot("getMetadata");const e=y5(t.storage,t._location,Ay());return t.storage.makeRequestWithTokens(e,Jo)}function zee(t,e){t._throwIfRoot("updateMetadata");const n=Nee(t.storage,t._location,e,Ay());return t.storage.makeRequestWithTokens(n,Jo)}function Wee(t){t._throwIfRoot("getDownloadURL");const e=Eee(t.storage,t._location,Ay());return t.storage.makeRequestWithTokens(e,Jo).then(n=>{if(n===null)throw GQ();return n})}function jee(t,e){const n=gee(t._location.path,e),s=new Xs(t._location.bucket,n);return new ru(t.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gee(t){return/^[A-Za-z]+:\/\//.test(t)}function Hee(t,e){return new ru(t,e)}function w5(t,e){if(t instanceof mk){const n=t;if(n._bucket==null)throw WQ();const s=new ru(n,n._bucket);return e!=null?w5(s,e):s}else return e!==void 0?jee(t,e):t}function Kee(t,e){if(e&&Gee(e)){if(t instanceof mk)return Hee(t,e);throw SC("To use ref(service, url), the first argument must be a Storage instance.")}else return w5(t,e)}function z_(t,e){const n=e==null?void 0:e[i5];return n==null?null:Xs.makeFromBucketSpec(n,t)}function qee(t,e,n,s={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:r}=s;r&&(t._overrideAuthToken=typeof r=="string"?r:fF(r,t.app.options.projectId))}class mk{constructor(e,n,s,r,i){this.app=e,this._authProvider=n,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=r5,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=DQ,this._maxUploadRetryTime=PQ,this._requests=new Set,r!=null?this._bucket=Xs.makeFromBucketSpec(r,this._host):this._bucket=z_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Xs.makeFromBucketSpec(this._url,e):this._bucket=z_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){IC("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){IC("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ru(this,e)}_makeRequest(e,n,s,r,i=!0){if(this._deleted)return new qQ(c5());{const o=iee(e,this._appId,s,r,n,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,s,r).getPromise()}}const W_="@firebase/storage",j_="0.12.5";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b5="storage";function Xee(t,e,n){return t=Ls(t),Mee(t,e,n)}function Yee(t){return t=Ls(t),Uee(t)}function Jee(t,e){return t=Ls(t),zee(t,e)}function Zee(t){return t=Ls(t),Bee(t)}function C5(t){return t=Ls(t),Wee(t)}function kC(t,e){return t=Ls(t),Kee(t,e)}function Qee(t=YI(),e){t=Ls(t);const s=ky(t,b5).getImmediate({identifier:e}),r=uF("storage");return r&&ete(s,...r),s}function ete(t,e,n,s={}){qee(t,e,n,s)}function tte(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new mk(n,s,r,e,Su)}function nte(){nu(new $l(b5,tte,"PUBLIC").setMultipleInstances(!0)),vo(W_,j_,""),vo(W_,j_,"esm2017")}nte();const ste={apiKey:"AIzaSyDAOWla38KBbpy78WYPgWfLs32va1vxzh0",authDomain:"proiect-licenta-fc2a8.firebaseapp.com",projectId:"proiect-licenta-fc2a8",storageBucket:"proiect-licenta-fc2a8.appspot.com",messagingSenderId:"776641745931",appId:"1:776641745931:web:0e2886e5c75be34476230e"},gk=gF(ste),Bf=aQ(gk);RQ(gk);const TC=Qee(gk),rte=Cr.div`
.active {
  border-right: 4px solid var(--white);
  
  img {
    filter: invert(100%) sepia(0%) saturate(0%) hue-rotate(93deg)
    brightness(103%) contrast(103%);
  }
}
`,ite=Cr.div`
  height: 90vh;
  opacity: ${t=>t.$clicked==="true"?1:.2};
  transition: all 0.3s ease;
`,ote=Cr.button`
  &::before,
  &::after {
    content: "";
    background-color: var(--white);
    height: 2px;
    width: 1rem;
    position: absolute;
    transition: all 0.3s ease;
  }

  &::before {
    top: ${t=>t.$clicked==="true"?"1.5":"1rem"};
    transform: ${t=>t.$clicked==="true"?"rotate(135deg)":"rotate(0)"};
  }

  &::after {
    top: ${t=>t.$clicked==="true"?"1.2":"1.5rem"};
    transform: ${t=>t.$clicked==="true"?"rotate(-135deg)":"rotate(0)"};
  }
`,ate=Cr.ul`
width: ${t=>t.$clicked==="true"?"20rem":"3.5rem"};
transition: all 0.5s ease;
border-radius: 0 30px 30px 0;
`,th=Cr(BW)`
text-decoration: none;
color: var(--white);
width: 100%;
padding: 1rem 0;
cursor: pointer;

display: flex;
padding-left: 1rem;

&:hover {
  border-right: 4px solid var(--white);
  
  img {
    filter: invert(100%) sepia(0%) saturate(0%) hue-rotate(93deg)
    brightness(103%) contrast(103%);
  }
}

img {
  width: 1.2rem;
  height: auto;
}
`,lte=Cr.div`
width: ${t=>t.$clicked==="true"?"24rem":"3rem"};
margin-left: ${t=>t.$clicked==="true"?"20rem":"0"};
transition: all 0.3s ease;

img {
  width: 2rem;
  height: auto;
  &:hover {
    border: 2px solid var(--grey);
    padding: 2px;
  }
}
`,cte=Cr.div`
display: ${t=>t.$clicked==="true"?"flex":"none"};
`,ute=Cr.div`
h4 {
  display: inline-block
}

a {
  font-size: 0.8rem;
  text-decoration: none;

  &:hover {
    text-decoration: underline;
  }
}
`,hte=Cr.button`
img {
  transition: all 0.3s ease;

  &:hover {
    border: none;
    padding: 0;
    opacity: 0.5;
  }
}
`,nh=Cr.span`
width: ${t=>t.$clicked==="true"?"100%":"0"};
overflow: hidden;
white-space: nowrap;
margin-left: ${t=>t.$clicked?"1.5rem":"0"};
transition: all 0.3s ease;
`,dte=({isAdmin:t,setIsLoggedIn:e,firstName:n,lastName:s})=>{const r=om(),[i,o]=J.useState(!1),[a,l]=J.useState(!1),c=()=>o(d=>!d),u=()=>l(d=>!d),h=()=>{zF(Bf).then(()=>{localStorage.removeItem("token"),e(!1),r("/Login")})};return U.jsxs(rte,{className:"fixed z-10  ",children:[U.jsx(ote,{className:"bg-primary-color border-none w-10 h-10 rounded-full mt-2 ml-2 cursor-pointer flex justify-center items-center relative",$clicked:i.toString(),onClick:c}),U.jsxs(ite,{as:Le.div,animate:{opacity:i||a?1:.2},initial:{opacity:.2},whileHover:{opacity:1},transition:{duration:.3},className:"bg-primary-color w-14 mt-4 rounded-r-[30px] py-4 flex flex-col items-center justify-between relative",children:[U.jsx("div",{className:"w-8",children:U.jsx("img",{className:"w-full h-auto",src:wX,alt:"logo"})}),U.jsxs(ate,{className:"text-white list-none flex flex-col items-center bg-primary-color py-8 absolute top-24 left-0",$clicked:i.toString(),children:[U.jsxs(th,{onClick:()=>o(!1),to:"/",children:[U.jsx("img",{src:fX,alt:"Home"}),U.jsx(nh,{$clicked:i.toString(),children:"Acasă"})]}),U.jsxs(th,{onClick:()=>o(!1),to:"/About",children:[U.jsx("img",{src:pX,alt:"About"}),U.jsx(nh,{$clicked:i.toString(),children:"Despre Noi"})]}),U.jsxs(th,{onClick:()=>o(!1),to:"/Dictionary",children:[U.jsx("img",{src:gX,alt:"Dictionary"}),U.jsx(nh,{$clicked:i.toString(),children:"Dicționar Mimico Gestual"})]}),U.jsxs(th,{onClick:()=>o(!1),to:"/Practice",children:[U.jsx("img",{src:yX,alt:"Practice"}),U.jsx(nh,{$clicked:i.toString(),children:"Exersați"})]}),t?U.jsxs(th,{onClick:()=>o(!1),to:"/Admin",children:[U.jsx("img",{src:vX,alt:"Admin"}),U.jsx(nh,{$clicked:i.toString(),children:"Panou Administrativ"})]}):U.jsx(U.Fragment,{}),U.jsxs(th,{onClick:()=>o(!1),to:"/UserProfile",children:[U.jsx("img",{src:dC,alt:"User Profile"}),U.jsx(nh,{$clicked:i.toString(),children:"Profil"})]})]}),U.jsxs(lte,{className:"h-12 py-2 px-4 rounded-[20px] flex items-center justify-center bg-primary-color text-white",$clicked:a.toString(),children:[U.jsx("img",{onClick:()=>u(),src:xX,alt:"Profile"}),U.jsxs(cte,{className:"w-full flex justify-between items-center",$clicked:a.toString(),children:[U.jsxs(ute,{className:"px-6 flex flex-col justify-center items-center",children:[U.jsx("h4",{children:`${n} ${s}`}),U.jsx("a",{href:"/UserProfile",children:"View profile"})]}),U.jsx(hte,{className:"border-none w-8 h-8 bg-transparent",onClick:()=>{h()},children:U.jsx("img",{className:"w-full h-auto",src:mX,alt:"Logout"})})]})]})]})]})};class Vf extends Error{}Vf.prototype.name="InvalidTokenError";function fte(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,n)=>{let s=n.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}function pte(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return fte(e)}catch{return atob(e)}}function sl(t,e){if(typeof t!="string")throw new Vf("Invalid token specified: must be a string");e||(e={});const n=e.header===!0?0:1,s=t.split(".")[n];if(typeof s!="string")throw new Vf(`Invalid token specified: missing part #${n+1}`);let r;try{r=pte(s)}catch(i){throw new Vf(`Invalid token specified: invalid base64 for part #${n+1} (${i.message})`)}try{return JSON.parse(r)}catch(i){throw new Vf(`Invalid token specified: invalid json for part #${n+1} (${i.message})`)}}const G_="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M3.17157%205.17157C2%206.34315%202%208.22876%202%2012C2%2015.7712%202%2017.6569%203.17157%2018.8284C4.34315%2020%206.22876%2020%2010%2020H14C17.7712%2020%2019.6569%2020%2020.8284%2018.8284C22%2017.6569%2022%2015.7712%2022%2012C22%208.22876%2022%206.34315%2020.8284%205.17157C19.6569%204%2017.7712%204%2014%204H10C6.22876%204%204.34315%204%203.17157%205.17157ZM18.5762%207.51986C18.8413%207.83807%2018.7983%208.31099%2018.4801%208.57617L16.2837%2010.4066C15.3973%2011.1452%2014.6789%2011.7439%2014.0448%2012.1517C13.3843%2012.5765%2012.7411%2012.8449%2012%2012.8449C11.2589%2012.8449%2010.6157%2012.5765%209.95518%2012.1517C9.32112%2011.7439%208.60271%2011.1452%207.71636%2010.4066L5.51986%208.57617C5.20165%208.31099%205.15866%207.83807%205.42383%207.51986C5.68901%207.20165%206.16193%207.15866%206.48014%207.42383L8.63903%209.22291C9.57199%2010.0004%2010.2197%2010.5384%2010.7666%2010.8901C11.2959%2011.2306%2011.6549%2011.3449%2012%2011.3449C12.3451%2011.3449%2012.7041%2011.2306%2013.2334%2010.8901C13.7803%2010.5384%2014.428%2010.0004%2015.361%209.22291L17.5199%207.42383C17.8381%207.15866%2018.311%207.20165%2018.5762%207.51986Z'%20fill='%231C274C'/%3e%3c/svg%3e",H_="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M5.25%2010.0546V8C5.25%204.27208%208.27208%201.25%2012%201.25C15.7279%201.25%2018.75%204.27208%2018.75%208V10.0546C19.8648%2010.1379%2020.5907%2010.348%2021.1213%2010.8787C22%2011.7574%2022%2013.1716%2022%2016C22%2018.8284%2022%2020.2426%2021.1213%2021.1213C20.2426%2022%2018.8284%2022%2016%2022H8C5.17157%2022%203.75736%2022%202.87868%2021.1213C2%2020.2426%202%2018.8284%202%2016C2%2013.1716%202%2011.7574%202.87868%2010.8787C3.40931%2010.348%204.13525%2010.1379%205.25%2010.0546ZM6.75%208C6.75%205.10051%209.10051%202.75%2012%202.75C14.8995%202.75%2017.25%205.10051%2017.25%208V10.0036C16.867%2010%2016.4515%2010%2016%2010H8C7.54849%2010%207.13301%2010%206.75%2010.0036V8ZM14%2016C14%2017.1046%2013.1046%2018%2012%2018C10.8954%2018%2010%2017.1046%2010%2016C10%2014.8954%2010.8954%2014%2012%2014C13.1046%2014%2014%2014.8954%2014%2016Z'%20fill='%231C274C'/%3e%3c/svg%3e",sh=Cr.div`
display: flex;
flex-direction: row;
align-items: center;
background-color: var(--tertiary-color);
width: 20rem;
height: 4rem;
border-radius: 0.33rem;

img {
    width: 1.2rem;
    margin: 0 0.75rem;
}

input {
    width: 16rem;
    height: 1.5rem;
    background: transparent;
    border: none;
    outline: none;
}

input::placeholder {
    color: white;
}
`,mte=Cr.div`
display: flex;
gap: 2rem;
margin: 0.875rem auto;

button {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 10rem;
    height: 3rem;
    background: #56E39F;
    border-radius: 2rem;
    font-size: 1.5rem;
    font-weight: 700;
    padding-bottom: 4px;
}
`;function gte({setIsLoggedIn:t}){const[e,n]=J.useState(""),[s,r]=J.useState(""),[i,o]=J.useState(""),[a,l]=J.useState(""),[c,u]=J.useState("Sign Up"),[h,d]=J.useState(""),[f,p]=J.useState(!1),g=om(),m=async k=>{k.preventDefault();try{const $=await fetch("https://europe-west1-proiect-licenta-fc2a8.cloudfunctions.net/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:i,password:a})}),I=await $.json();if($.ok){const R=(await b_(Bf,I.email,a)).user;if(R.emailVerified){const E=await R.getIdToken();localStorage.setItem("token",E),t(!0),C(),g("/")}else alert("Logarea a eșuat: email-ul nu a fost verificat încă.")}else alert("Logare eșuată: "+I.error)}catch($){console.error("Eroare la logare: ",$),alert("Credențiale invalide. Vă rugăm să incercați din nou.")}},y=async k=>{k.preventDefault();try{const $=await fetch("https://europe-west1-proiect-licenta-fc2a8.cloudfunctions.net/api/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,email:s,password:a,role:"user"})}),I=await $.json();if($.ok){const T=await b_(Bf,s,a);await KJ(T.user),u("Login"),C(),alert("Înregistrarea a fost executată cu succes. Vă rugăm să verificați email-ul."),await zF(Bf),u("Login")}else alert("Înregistrare eșuată: "+I.error)}catch($){console.error("Error during registration: ",$)}},w=async k=>{k.preventDefault();try{await HJ(Bf,h),alert("Email-ul pentru schimbarea parolei a fost trimis!"),p(!1)}catch($){console.error("Eroare la schimbarea parolei: ",$),alert("Failed to send password reset email.")}},b=k=>{c==="Sign Up"?y(k):m(k)},C=()=>{n(""),r(""),o(""),l("")};return U.jsxs("div",{className:"w-full h-screen flex justify-center items-center",children:[U.jsx("form",{onSubmit:b,className:"flex flex-col m-auto bg-primary-color pb-8 w-128 rounded-3xl",children:U.jsxs(Le.div,{initial:{height:c==="Sign Up"?"32rem":"28rem"},animate:{height:c==="Sign Up"?"32rem":"28rem"},transition:{duration:.1},className:"flex flex-col",children:[U.jsxs("div",{className:"flex flex-col items-center gap-2.5 w-full mt-8",children:[U.jsx(Le.h1,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,y:20},transition:{duration:.2},className:"text-5xl font-bold",children:c},c),U.jsx("div",{className:"w-16 h-1.5 bg-white rounded-xl"})]}),U.jsx("div",{className:"mt-8 flex flex-col items-center gap-6",children:U.jsx(vl,{mode:"wait",children:c==="Sign Up"?U.jsxs(U.Fragment,{children:[U.jsxs(sh,{as:Le.div,initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.5},transition:{duration:.2,delay:.1},children:[U.jsx("img",{src:dC,alt:"User"}),U.jsx("input",{type:"text",placeholder:"Introduceți username-ul",value:e,onChange:k=>n(k.target.value)})]},"signup-username"),U.jsxs(sh,{as:Le.div,initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.5},transition:{duration:.2,delay:.2},children:[U.jsx("img",{src:G_,alt:"Email"}),U.jsx("input",{type:"email",placeholder:"Introduceți email-ul",value:s,onChange:k=>r(k.target.value)})]},"signup-email"),U.jsxs(sh,{as:Le.div,initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.5},transition:{duration:.2,delay:.3},children:[U.jsx("img",{src:H_,alt:"Password"}),U.jsx("input",{type:"password",placeholder:"Introduceți parola",value:a,onChange:k=>l(k.target.value)})]},"signup-password")]}):U.jsxs(U.Fragment,{children:[U.jsxs(sh,{as:Le.div,initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.5},transition:{duration:.2,delay:.1},children:[U.jsx("img",{src:dC,alt:"User"}),U.jsx("input",{type:"text",placeholder:"Introduceți username sau email",value:i,onChange:k=>o(k.target.value)})]},"login-username"),U.jsxs(sh,{as:Le.div,initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.5},transition:{duration:.2,delay:.2},children:[U.jsx("img",{src:H_,alt:"Password"}),U.jsx("input",{type:"password",placeholder:"Introduceți parola",value:a,onChange:k=>l(k.target.value)})]},"login-password")]})})}),c==="Login"&&U.jsx("div",{className:"w-80 mt-1.5 ml-24 text-xl text-right cursor-pointer",onClick:()=>p(!0),children:"Ați uitat parola?"}),U.jsxs("div",{className:"flex flex-col items-center pt-4",children:[U.jsxs(mte,{children:[U.jsx(Le.button,{whileHover:{scale:[null,1.3,1.2]},transition:{duration:.2},type:"button",style:c==="Sign Up"?{}:{color:"rgba(4, 110, 143, 0.3)",backgroundColor:"var(--tertiary-color)"},onClick:()=>{u("Sign Up"),C()},children:"Înregistrare"}),U.jsx(Le.button,{whileHover:{scale:[null,1.3,1.2]},transition:{duration:.2},type:"button",style:c==="Login"?{}:{color:"rgba(4, 110, 143, 0.3)",backgroundColor:"var(--tertiary-color)"},onClick:()=>{u("Login"),C()},children:"Logare"})]}),U.jsx("button",{type:"submit",children:"Trimiteți"})]})]})}),U.jsx(vl,{children:f&&U.jsx(Le.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"w-full h-full fixed top-0 left-0 flex justify-center items-center bg-black bg-opacity-50",children:U.jsxs(Le.div,{initial:{opacity:.1,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},exit:{opacity:0,scale:.95},transition:{duration:.2},className:"w-1/3 bg-primary-color p-4 rounded-lg",children:[U.jsx("h2",{className:"text-2xl mb-4",children:"Schimbați parola"}),U.jsxs("form",{className:"flex flex-col items-center",onSubmit:w,children:[U.jsx("div",{className:"w-7/10 flex justify-center",children:U.jsxs(sh,{children:[U.jsx("img",{src:G_,alt:"Email"}),U.jsx("input",{type:"email",placeholder:"Introduceți email-ul",value:h,onChange:k=>d(k.target.value),required:!0})]})}),U.jsxs("div",{className:"flex justify-between w-9/10 mt-4",children:[U.jsx(Le.button,{type:"submit",className:"flex justify-center items-center w-32 h-12 bg-secondary-color rounded-3xl text-white font-bold text-sm",whileHover:{scale:[null,1.2,1.1]},transition:{duration:.2},children:"Trimiteți email pentru resetare"}),U.jsx(Le.button,{type:"button",className:"flex justify-center items-center w-24 h-12 bg-tertiary-color rounded-3xl text-white font-bold text-sm",whileHover:{scale:[null,1.2,1.1]},transition:{duration:.2},onClick:()=>p(!1),children:"Anulați"})]})]})]})})})]})}function Rd(t){return function(n){return U.jsx("div",{className:"ml-14 w-full h-full flex justify-center items-center",children:U.jsx(Le.div,{initial:{opacity:.1,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},exit:{opacity:.1,scale:.95},transition:{duration:.2},className:"w-9/10 h-9/10 rounded-[30px] relative flex flex-col overflow-hidden overflow-y-auto no-scrollbar bg-background-color-lower-alpha",children:U.jsx(t,{...n})})})}}function yte(){return U.jsx("div",{className:"w-full h-full absolute flex flex-row justify-center items-center gap-4",children:U.jsx("h1",{className:"text-5xl",children:"Home Page!"})})}const vte=Rd(yte);function xte(){return U.jsx("div",{className:"w-full h-full absolute flex flex-row justify-center items-center gap-4",children:U.jsx("h1",{className:"text-5xl",children:"Home Page!"})})}const wte=Rd(xte);var ei={};(function(){var t;function e(v){var S=0;return function(){return S<v.length?{done:!1,value:v[S++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(v,S,_){return v==Array.prototype||v==Object.prototype||(v[S]=_.value),v};function s(v){v=[typeof globalThis=="object"&&globalThis,v,typeof window=="object"&&window,typeof self=="object"&&self,typeof zn=="object"&&zn];for(var S=0;S<v.length;++S){var _=v[S];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var r=s(this);function i(v,S){if(S)e:{var _=r;v=v.split(".");for(var O=0;O<v.length-1;O++){var B=v[O];if(!(B in _))break e;_=_[B]}v=v[v.length-1],O=_[v],S=S(O),S!=O&&S!=null&&n(_,v,{configurable:!0,writable:!0,value:S})}}i("Symbol",function(v){function S(V){if(this instanceof S)throw new TypeError("Symbol is not a constructor");return new _(O+(V||"")+"_"+B++,V)}function _(V,W){this.h=V,n(this,"description",{configurable:!0,writable:!0,value:W})}if(v)return v;_.prototype.toString=function(){return this.h};var O="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",B=0;return S}),i("Symbol.iterator",function(v){if(v)return v;v=Symbol("Symbol.iterator");for(var S="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),_=0;_<S.length;_++){var O=r[S[_]];typeof O=="function"&&typeof O.prototype[v]!="function"&&n(O.prototype,v,{configurable:!0,writable:!0,value:function(){return o(e(this))}})}return v});function o(v){return v={next:v},v[Symbol.iterator]=function(){return this},v}function a(v){var S=typeof Symbol<"u"&&Symbol.iterator&&v[Symbol.iterator];return S?S.call(v):{next:e(v)}}function l(v){if(!(v instanceof Array)){v=a(v);for(var S,_=[];!(S=v.next()).done;)_.push(S.value);v=_}return v}var c=typeof Object.assign=="function"?Object.assign:function(v,S){for(var _=1;_<arguments.length;_++){var O=arguments[_];if(O)for(var B in O)Object.prototype.hasOwnProperty.call(O,B)&&(v[B]=O[B])}return v};i("Object.assign",function(v){return v||c});var u=typeof Object.create=="function"?Object.create:function(v){function S(){}return S.prototype=v,new S},h;if(typeof Object.setPrototypeOf=="function")h=Object.setPrototypeOf;else{var d;e:{var f={a:!0},p={};try{p.__proto__=f,d=p.a;break e}catch{}d=!1}h=d?function(v,S){if(v.__proto__=S,v.__proto__!==S)throw new TypeError(v+" is not extensible");return v}:null}var g=h;function m(v,S){if(v.prototype=u(S.prototype),v.prototype.constructor=v,g)g(v,S);else for(var _ in S)if(_!="prototype")if(Object.defineProperties){var O=Object.getOwnPropertyDescriptor(S,_);O&&Object.defineProperty(v,_,O)}else v[_]=S[_];v.ya=S.prototype}function y(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function w(v){if(v.m)throw new TypeError("Generator is already running");v.m=!0}y.prototype.u=function(v){this.i=v};function b(v,S){v.l={ma:S,na:!0},v.h=v.s||v.v}y.prototype.return=function(v){this.l={return:v},this.h=this.v};function C(v,S,_){return v.h=_,{value:S}}function k(v){this.h=new y,this.i=v}function $(v,S){w(v.h);var _=v.h.j;return _?I(v,"return"in _?_.return:function(O){return{value:O,done:!0}},S,v.h.return):(v.h.return(S),T(v))}function I(v,S,_,O){try{var B=S.call(v.h.j,_);if(!(B instanceof Object))throw new TypeError("Iterator result "+B+" is not an object");if(!B.done)return v.h.m=!1,B;var V=B.value}catch(W){return v.h.j=null,b(v.h,W),T(v)}return v.h.j=null,O.call(v.h,V),T(v)}function T(v){for(;v.h.h;)try{var S=v.i(v.h);if(S)return v.h.m=!1,{value:S.value,done:!1}}catch(_){v.h.i=void 0,b(v.h,_)}if(v.h.m=!1,v.h.l){if(S=v.h.l,v.h.l=null,S.na)throw S.ma;return{value:S.return,done:!0}}return{value:void 0,done:!0}}function R(v){this.next=function(S){return w(v.h),v.h.j?S=I(v,v.h.j.next,S,v.h.u):(v.h.u(S),S=T(v)),S},this.throw=function(S){return w(v.h),v.h.j?S=I(v,v.h.j.throw,S,v.h.u):(b(v.h,S),S=T(v)),S},this.return=function(S){return $(v,S)},this[Symbol.iterator]=function(){return this}}function E(v){function S(O){return v.next(O)}function _(O){return v.throw(O)}return new Promise(function(O,B){function V(W){W.done?O(W.value):Promise.resolve(W.value).then(S,_).then(V,B)}V(v.next())})}function A(v){return E(new R(new k(v)))}i("Promise",function(v){function S(W){this.i=0,this.j=void 0,this.h=[],this.u=!1;var q=this.l();try{W(q.resolve,q.reject)}catch(ae){q.reject(ae)}}function _(){this.h=null}function O(W){return W instanceof S?W:new S(function(q){q(W)})}if(v)return v;_.prototype.i=function(W){if(this.h==null){this.h=[];var q=this;this.j(function(){q.m()})}this.h.push(W)};var B=r.setTimeout;_.prototype.j=function(W){B(W,0)},_.prototype.m=function(){for(;this.h&&this.h.length;){var W=this.h;this.h=[];for(var q=0;q<W.length;++q){var ae=W[q];W[q]=null;try{ae()}catch(ye){this.l(ye)}}}this.h=null},_.prototype.l=function(W){this.j(function(){throw W})},S.prototype.l=function(){function W(ye){return function(Se){ae||(ae=!0,ye.call(q,Se))}}var q=this,ae=!1;return{resolve:W(this.I),reject:W(this.m)}},S.prototype.I=function(W){if(W===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(W instanceof S)this.L(W);else{e:switch(typeof W){case"object":var q=W!=null;break e;case"function":q=!0;break e;default:q=!1}q?this.F(W):this.s(W)}},S.prototype.F=function(W){var q=void 0;try{q=W.then}catch(ae){this.m(ae);return}typeof q=="function"?this.M(q,W):this.s(W)},S.prototype.m=function(W){this.v(2,W)},S.prototype.s=function(W){this.v(1,W)},S.prototype.v=function(W,q){if(this.i!=0)throw Error("Cannot settle("+W+", "+q+"): Promise already settled in state"+this.i);this.i=W,this.j=q,this.i===2&&this.K(),this.H()},S.prototype.K=function(){var W=this;B(function(){if(W.D()){var q=r.console;typeof q<"u"&&q.error(W.j)}},1)},S.prototype.D=function(){if(this.u)return!1;var W=r.CustomEvent,q=r.Event,ae=r.dispatchEvent;return typeof ae>"u"?!0:(typeof W=="function"?W=new W("unhandledrejection",{cancelable:!0}):typeof q=="function"?W=new q("unhandledrejection",{cancelable:!0}):(W=r.document.createEvent("CustomEvent"),W.initCustomEvent("unhandledrejection",!1,!0,W)),W.promise=this,W.reason=this.j,ae(W))},S.prototype.H=function(){if(this.h!=null){for(var W=0;W<this.h.length;++W)V.i(this.h[W]);this.h=null}};var V=new _;return S.prototype.L=function(W){var q=this.l();W.T(q.resolve,q.reject)},S.prototype.M=function(W,q){var ae=this.l();try{W.call(q,ae.resolve,ae.reject)}catch(ye){ae.reject(ye)}},S.prototype.then=function(W,q){function ae(Fe,Ne){return typeof Fe=="function"?function(He){try{ye(Fe(He))}catch(st){Se(st)}}:Ne}var ye,Se,Ge=new S(function(Fe,Ne){ye=Fe,Se=Ne});return this.T(ae(W,ye),ae(q,Se)),Ge},S.prototype.catch=function(W){return this.then(void 0,W)},S.prototype.T=function(W,q){function ae(){switch(ye.i){case 1:W(ye.j);break;case 2:q(ye.j);break;default:throw Error("Unexpected state: "+ye.i)}}var ye=this;this.h==null?V.i(ae):this.h.push(ae),this.u=!0},S.resolve=O,S.reject=function(W){return new S(function(q,ae){ae(W)})},S.race=function(W){return new S(function(q,ae){for(var ye=a(W),Se=ye.next();!Se.done;Se=ye.next())O(Se.value).T(q,ae)})},S.all=function(W){var q=a(W),ae=q.next();return ae.done?O([]):new S(function(ye,Se){function Ge(He){return function(st){Fe[He]=st,Ne--,Ne==0&&ye(Fe)}}var Fe=[],Ne=0;do Fe.push(void 0),Ne++,O(ae.value).T(Ge(Fe.length-1),Se),ae=q.next();while(!ae.done)})},S});function F(v,S){v instanceof String&&(v+="");var _=0,O=!1,B={next:function(){if(!O&&_<v.length){var V=_++;return{value:S(V,v[V]),done:!1}}return O=!0,{done:!0,value:void 0}}};return B[Symbol.iterator]=function(){return B},B}i("Array.prototype.keys",function(v){return v||function(){return F(this,function(S){return S})}}),i("Array.prototype.fill",function(v){return v||function(S,_,O){var B=this.length||0;for(0>_&&(_=Math.max(0,B+_)),(O==null||O>B)&&(O=B),O=Number(O),0>O&&(O=Math.max(0,B+O)),_=Number(_||0);_<O;_++)this[_]=S;return this}});function P(v){return v||Array.prototype.fill}i("Int8Array.prototype.fill",P),i("Uint8Array.prototype.fill",P),i("Uint8ClampedArray.prototype.fill",P),i("Int16Array.prototype.fill",P),i("Uint16Array.prototype.fill",P),i("Int32Array.prototype.fill",P),i("Uint32Array.prototype.fill",P),i("Float32Array.prototype.fill",P),i("Float64Array.prototype.fill",P),i("Object.is",function(v){return v||function(S,_){return S===_?S!==0||1/S===1/_:S!==S&&_!==_}}),i("Array.prototype.includes",function(v){return v||function(S,_){var O=this;O instanceof String&&(O=String(O));var B=O.length;for(_=_||0,0>_&&(_=Math.max(_+B,0));_<B;_++){var V=O[_];if(V===S||Object.is(V,S))return!0}return!1}}),i("String.prototype.includes",function(v){return v||function(S,_){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(S instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(S,_||0)!==-1}});var Z=this||self;function H(v,S){v=v.split(".");var _=Z;v[0]in _||typeof _.execScript>"u"||_.execScript("var "+v[0]);for(var O;v.length&&(O=v.shift());)v.length||S===void 0?_[O]&&_[O]!==Object.prototype[O]?_=_[O]:_=_[O]={}:_[O]=S}function j(v){var S;e:{if((S=Z.navigator)&&(S=S.userAgent))break e;S=""}return S.indexOf(v)!=-1}var ee=Array.prototype.map?function(v,S){return Array.prototype.map.call(v,S,void 0)}:function(v,S){for(var _=v.length,O=Array(_),B=typeof v=="string"?v.split(""):v,V=0;V<_;V++)V in B&&(O[V]=S.call(void 0,B[V],V,v));return O},z={},X=null;function ie(v){var S=v.length,_=3*S/4;_%3?_=Math.floor(_):"=.".indexOf(v[S-1])!=-1&&(_="=.".indexOf(v[S-2])!=-1?_-2:_-1);var O=new Uint8Array(_),B=0;return de(v,function(V){O[B++]=V}),B!==_?O.subarray(0,B):O}function de(v,S){function _(ae){for(;O<v.length;){var ye=v.charAt(O++),Se=X[ye];if(Se!=null)return Se;if(!/^[\s\xa0]*$/.test(ye))throw Error("Unknown base64 encoding at char: "+ye)}return ae}he();for(var O=0;;){var B=_(-1),V=_(0),W=_(64),q=_(64);if(q===64&&B===-1)break;S(B<<2|V>>4),W!=64&&(S(V<<4&240|W>>2),q!=64&&S(W<<6&192|q))}}function he(){if(!X){X={};for(var v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),S=["+/=","+/","-_=","-_.","-_"],_=0;5>_;_++){var O=v.concat(S[_].split(""));z[_]=O;for(var B=0;B<O.length;B++){var V=O[B];X[V]===void 0&&(X[V]=B)}}}}var fe=typeof Uint8Array<"u",ge=!(j("Trident")||j("MSIE"))&&typeof Z.btoa=="function";function pe(v){if(!ge){var S;S===void 0&&(S=0),he(),S=z[S];for(var _=Array(Math.floor(v.length/3)),O=S[64]||"",B=0,V=0;B<v.length-2;B+=3){var W=v[B],q=v[B+1],ae=v[B+2],ye=S[W>>2];W=S[(W&3)<<4|q>>4],q=S[(q&15)<<2|ae>>6],ae=S[ae&63],_[V++]=ye+W+q+ae}switch(ye=0,ae=O,v.length-B){case 2:ye=v[B+1],ae=S[(ye&15)<<2]||O;case 1:v=v[B],_[V]=S[v>>2]+S[(v&3)<<4|ye>>4]+ae+O}return _.join("")}for(S="";10240<v.length;)S+=String.fromCharCode.apply(null,v.subarray(0,10240)),v=v.subarray(10240);return S+=String.fromCharCode.apply(null,v),btoa(S)}var we=RegExp("[-_.]","g");function ke(v){switch(v){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function De(v){if(!ge)return ie(v);we.test(v)&&(v=v.replace(we,ke)),v=atob(v);for(var S=new Uint8Array(v.length),_=0;_<v.length;_++)S[_]=v.charCodeAt(_);return S}var _e;function Be(){return _e||(_e=new Uint8Array(0))}var Oe={},qe=typeof Uint8Array.prototype.slice=="function",Ue=0,Ye=0;function ut(v){var S=0>v;v=Math.abs(v);var _=v>>>0;v=Math.floor((v-_)/4294967296),S&&(_=a(vt(_,v)),S=_.next().value,v=_.next().value,_=S),Ue=_>>>0,Ye=v>>>0}function it(v){if(v=+v,v===0)0<1/v?Ue=Ye=0:(Ye=0,Ue=2147483648);else if(isNaN(v))Ye=0,Ue=2147483647;else{var S=0>v?-2147483648:0;if(v=S?-v:v,34028234663852886e22<v)Ye=0,Ue=(S|2139095040)>>>0;else if(11754943508222875e-54>v)v=Math.round(v/Math.pow(2,-149)),Ye=0,Ue=(S|v)>>>0;else{var _=Math.floor(Math.log(v)/Math.LN2);v*=Math.pow(2,-_),v=Math.round(8388608*v),16777216<=v&&++_,Ye=0,Ue=(S|_+127<<23|v&8388607)>>>0}}}var $t=typeof BigInt=="function";function vt(v,S){return S=~S,v?v=~v+1:S+=1,[v,S]}function Bs(v,S){this.i=v>>>0,this.h=S>>>0}function Ut(v){if(!v)return sr||(sr=new Bs(0,0));if(!/^-?\d+$/.test(v))return null;if(16>v.length)ut(Number(v));else if($t)v=BigInt(v),Ue=Number(v&BigInt(4294967295))>>>0,Ye=Number(v>>BigInt(32)&BigInt(4294967295));else{var S=+(v[0]==="-");Ye=Ue=0;for(var _=v.length,O=S,B=(_-S)%6+S;B<=_;O=B,B+=6)O=Number(v.slice(O,B)),Ye*=1e6,Ue=1e6*Ue+O,4294967296<=Ue&&(Ye+=Ue/4294967296|0,Ue%=4294967296);S&&(S=a(vt(Ue,Ye)),v=S.next().value,S=S.next().value,Ue=v,Ye=S)}return new Bs(Ue,Ye)}var sr;function jn(v,S){return Error("Invalid wire type: "+v+" (at position "+S+")")}function Vs(){return Error("Failed to read varint, encoding is invalid.")}function Gn(v,S){return Error("Tried to read past the end of the data "+S+" > "+v)}function xn(){throw Error("Invalid UTF8")}function Rt(v,S){return S=String.fromCharCode.apply(null,S),v==null?S:v+S}var kt=void 0,ns,Xi=typeof TextDecoder<"u",Oo,nc=typeof TextEncoder<"u",Yi;function Ji(v){if(v!==Oe)throw Error("illegal external caller")}function Zi(v,S){if(Ji(S),this.V=v,v!=null&&v.length===0)throw Error("ByteString should be constructed with non-empty values")}function Fo(){return Yi||(Yi=new Zi(null,Oe))}function Bg(v){Ji(Oe);var S=v.V;return S=S==null||fe&&S!=null&&S instanceof Uint8Array?S:typeof S=="string"?De(S):null,S==null?S:v.V=S}function mx(v){if(typeof v=="string")return{buffer:De(v),C:!1};if(Array.isArray(v))return{buffer:new Uint8Array(v),C:!1};if(v.constructor===Uint8Array)return{buffer:v,C:!1};if(v.constructor===ArrayBuffer)return{buffer:new Uint8Array(v),C:!1};if(v.constructor===Zi)return{buffer:Bg(v)||Be(),C:!0};if(v instanceof Uint8Array)return{buffer:new Uint8Array(v.buffer,v.byteOffset,v.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Qi(v,S){this.i=null,this.u=!1,this.h=this.j=this.m=0,Mu(this,v,S)}function Mu(v,S,_){_=_===void 0?{}:_,v.S=_.S===void 0?!1:_.S,S&&(S=mx(S),v.i=S.buffer,v.u=S.C,v.m=0,v.j=v.i.length,v.h=v.m)}Qi.prototype.reset=function(){this.h=this.m};function Lo(v,S){if(v.h=S,S>v.j)throw Gn(v.j,S)}function Mo(v){var S=v.i,_=v.h,O=S[_++],B=O&127;if(O&128&&(O=S[_++],B|=(O&127)<<7,O&128&&(O=S[_++],B|=(O&127)<<14,O&128&&(O=S[_++],B|=(O&127)<<21,O&128&&(O=S[_++],B|=O<<28,O&128&&S[_++]&128&&S[_++]&128&&S[_++]&128&&S[_++]&128&&S[_++]&128)))))throw Vs();return Lo(v,_),B}Qi.prototype.l=function(){return Mo(this)>>>0},Qi.prototype.s=function(){var v=this.i,S=this.h,_=v[S],O=v[S+1],B=v[S+2];return v=v[S+3],Lo(this,this.h+4),B=(_<<0|O<<8|B<<16|v<<24)>>>0,_=2*(B>>31)+1,O=B>>>23&255,B&=8388607,O==255?B?NaN:1/0*_:O==0?_*Math.pow(2,-149)*B:_*Math.pow(2,O-150)*(B+Math.pow(2,23))};function Bu(v,S){if(0>S)throw Error("Tried to read a negative byte length: "+S);var _=v.h,O=_+S;if(O>v.j)throw Gn(S,v.j-_);return v.h=O,_}var Vu=[];function eo(){this.h=[]}eo.prototype.length=function(){return this.h.length},eo.prototype.end=function(){var v=this.h;return this.h=[],v};function qd(v,S,_){for(;0<_||127<S;)v.h.push(S&127|128),S=(S>>>7|_<<25)>>>0,_>>>=7;v.h.push(S)}function Bo(v,S){for(;127<S;)v.h.push(S&127|128),S>>>=7;v.h.push(S)}function Xd(v,S){if(0<=S)Bo(v,S);else{for(var _=0;9>_;_++)v.h.push(S&127|128),S>>=7;v.h.push(1)}}function Vo(v){var S=Ue;v.h.push(S>>>0&255),v.h.push(S>>>8&255),v.h.push(S>>>16&255),v.h.push(S>>>24&255)}function Uu(v,S){if(Vu.length){var _=Vu.pop();Mu(_,v,S),v=_}else v=new Qi(v,S);this.h=v,this.j=this.h.h,this.i=this.l=-1,this.setOptions(S)}Uu.prototype.setOptions=function(v){v=v===void 0?{}:v,this.ca=v.ca===void 0?!1:v.ca},Uu.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function Hn(v){var S=v.h;if(S.h==S.j)return!1;v.j=v.h.h;var _=v.h.l();if(S=_>>>3,_&=7,!(0<=_&&5>=_))throw jn(_,v.j);if(1>S)throw Error("Invalid field number: "+S+" (at position "+v.j+")");return v.l=S,v.i=_,!0}function sc(v){switch(v.i){case 0:if(v.i!=0)sc(v);else e:{v=v.h;for(var S=v.h,_=S+10,O=v.i;S<_;)if(!(O[S++]&128)){Lo(v,S);break e}throw Vs()}break;case 1:v=v.h,Lo(v,v.h+8);break;case 2:v.i!=2?sc(v):(S=v.h.l(),v=v.h,Lo(v,v.h+S));break;case 5:v=v.h,Lo(v,v.h+4);break;case 3:S=v.l;do{if(!Hn(v))throw Error("Unmatched start-group tag: stream EOF");if(v.i==4){if(v.l!=S)throw Error("Unmatched end-group tag");break}sc(v)}while(!0);break;default:throw jn(v.i,v.j)}}function Na(v,S,_){var O=v.h.j,B=v.h.l(),V=v.h.h+B,W=V-O;if(0>=W&&(v.h.j=V,_(S,v,void 0,void 0,void 0),W=V-v.h.h),W)throw Error("Message parsing ended unexpectedly. Expected to read "+(B+" bytes, instead read "+(B-W)+" bytes, either the data ended unexpectedly or the message misreported its own length"));v.h.h=V,v.h.j=O}function _a(v,S,_){var O=v.h.l();for(O=v.h.h+O;v.h.h<O;)_.push(S.call(v.h))}var zu=[];function gx(){this.j=[],this.i=0,this.h=new eo}function Ir(v,S){S.length!==0&&(v.j.push(S),v.i+=S.length)}function Vg(v,S){return Si(v,S,2),S=v.h.end(),Ir(v,S),S.push(v.i),S}function Ug(v,S){var _=S.pop();for(_=v.i+v.h.length()-_;127<_;)S.push(_&127|128),_>>>=7,v.i++;S.push(_),v.i++}function Yd(v,S){if(S=S.R){Ir(v,v.h.end());for(var _=0;_<S.length;_++)Ir(v,Bg(S[_])||Be())}}function Si(v,S,_){Bo(v.h,8*S+_)}var kr=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function vs(v,S){return kr?v[kr]|=S:v.B!==void 0?v.B|=S:(Object.defineProperties(v,{B:{value:S,configurable:!0,writable:!0,enumerable:!1}}),S)}function Ii(v,S){var _=wn(v);return(_&S)!==S&&(Object.isFrozen(v)&&(v=Array.prototype.slice.call(v)),rr(v,_|S)),v}function Jd(v,S){kr?v[kr]&&(v[kr]&=~S):v.B!==void 0&&(v.B&=~S)}function wn(v){var S;return kr?S=v[kr]:S=v.B,S??0}function rr(v,S){kr?v[kr]=S:v.B!==void 0?v.B=S:Object.defineProperties(v,{B:{value:S,configurable:!0,writable:!0,enumerable:!1}})}function $a(v){return vs(v,1),v}function Tr(v){return!!(wn(v)&2)}function zg(v,S){rr(S,(v|0)&-51)}function Wu(v,S){rr(S,(v|18)&-41)}var Uo={};function rc(v){return v!==null&&typeof v=="object"&&!Array.isArray(v)&&v.constructor===Object}var to,Ra=[];rr(Ra,23),to=Object.freeze(Ra);function qr(v){if(Tr(v.o))throw Error("Cannot mutate an immutable Message")}function ic(v){var S=v.length;(S=S?v[S-1]:void 0)&&rc(S)?S.g=1:(S={},v.push((S.g=1,S)))}function Wg(v){if(v==null)return v;if(typeof v=="number"||v==="NaN"||v==="Infinity"||v==="-Infinity")return Number(v)}function Zd(v,S,_){var O=!1;if(v!=null&&typeof v=="object"&&!(O=Array.isArray(v))&&v.fa===Uo)return v;if(O)return new S(v);if(_)return new S}function Qd(v){var S=v.i+v.G;return v.A||(v.A=v.o[S]={})}function bn(v,S,_){return S===-1?null:S>=v.i?v.A?v.A[S]:void 0:_&&v.A&&(_=v.A[S],_!=null)?_:v.o[S+v.G]}function xs(v,S,_,O){qr(v),Er(v,S,_,O)}function Er(v,S,_,O){v.j&&(v.j=void 0),S>=v.i||O?Qd(v)[S]=_:(v.o[S+v.G]=_,(v=v.A)&&S in v&&delete v[S])}function Aa(v,S,_,O,B){var V=bn(v,S,O);Array.isArray(V)||(V=to);var W=wn(V);if(W&1||$a(V),B)W&2||vs(V,2),_&1||Object.freeze(V);else{B=!(_&2);var q=W&2;_&1||!q?B&&W&16&&!q&&Jd(V,16):(V=$a(Array.prototype.slice.call(V)),Er(v,S,V,O))}return V}function oc(v,S){return Aa(v,S,0,!1,Tr(v.o))}function ef(v,S){var _=bn(v,S),O=Wg(_);return O!=null&&O!==_&&Er(v,S,O),O}function ju(v,S){var _=Tr(v.o),O=Aa(v,S,1,void 0,_),B=wn(O);if(!(B&4)){Object.isFrozen(O)&&(O=$a(O.slice()),Er(v,S,O));for(var V=0,W=0;V<O.length;V++){var q=Wg(O[V]);q!=null&&(O[W++]=q)}W<V&&(O.length=W),vs(O,5),_&&(vs(O,2),Object.freeze(O))}return!_&&(B&2||Object.isFrozen(O))&&(O=Array.prototype.slice.call(O),vs(O,5),_=O,_=_==null?to:Ii(_,1),xs(v,S,_)),O}function Gu(v,S,_){var O=O===void 0?!1:O,B=bn(v,_,O);return S=Zd(B,S),S!==B&&S!=null&&(Er(v,_,S,O),vs(S.o,wn(v.o)&18)),B=S,B==null||Tr(v.o)||(S=Wo(B),S!==B&&(B=S,Er(v,_,B,O))),B}function tf(v,S,_,O,B){v.h||(v.h={});var V=v.h[_],W=Aa(v,_,3,void 0,B);if(!V){var q=W;V=[];var ae=!!(wn(v.o)&16);W=Tr(q);var ye=q;!B&&W&&(q=Array.prototype.slice.call(q));for(var Se=W,Ge=0;Ge<q.length;Ge++){var Fe=q[Ge],Ne=S,He=!1;if(He=He===void 0?!1:He,Fe=Array.isArray(Fe)?new Ne(Fe):He?new Ne:void 0,Fe!==void 0){Ne=Fe.o;var st=He=wn(Ne);W&&(st|=2),ae&&(st|=16),st!=He&&rr(Ne,st),Ne=st,Se=Se||!!(2&Ne),V.push(Fe)}}return v.h[_]=V,ae=wn(q),S=ae|33,S=Se?S&-9:S|8,ae!=S&&(Se=q,Object.isFrozen(Se)&&(Se=Array.prototype.slice.call(Se)),rr(Se,S),q=Se),ye!==q&&Er(v,_,q),(B||O&&W)&&vs(V,2),O&&Object.freeze(V),V}return B||(B=Object.isFrozen(V),O&&!B?Object.freeze(V):!O&&B&&(V=Array.prototype.slice.call(V),v.h[_]=V)),V}function nf(v,S,_){var O=Tr(v.o);if(S=tf(v,S,_,O,O),v=Aa(v,_,3,void 0,O),!(O||wn(v)&8)){for(O=0;O<S.length;O++){_=S[O];var B=Wo(_);_!==B&&(S[O]=B,v[O]=B.o)}vs(v,8)}return S}function Kn(v,S,_){if(_!=null&&typeof _!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof _+": "+_);xs(v,S,_)}function Xr(v,S,_,O,B){qr(v);var V=tf(v,_,S,!1,!1);return _=O??new _,v=Aa(v,S,2,void 0,!1),B!=null?(V.splice(B,0,_),v.splice(B,0,_.o)):(V.push(_),v.push(_.o)),_.C()&&Jd(v,8),_}function Da(v,S){return v=bn(v,S),v??0}function Yr(v,S){return v??S}function Nr(v,S,_){return _=_===void 0?0:_,Yr(ef(v,S),_)}var xt;function Hu(v){switch(typeof v){case"number":return isFinite(v)?v:String(v);case"object":if(v)if(Array.isArray(v)){if(wn(v)&128)return v=Array.prototype.slice.call(v),ic(v),v}else{if(fe&&v!=null&&v instanceof Uint8Array)return pe(v);if(v instanceof Zi){var S=v.V;return S==null?"":typeof S=="string"?S:v.V=pe(S)}}}return v}function Pa(v,S,_,O){if(v!=null){if(Array.isArray(v))v=zo(v,S,_,O!==void 0);else if(rc(v)){var B={},V;for(V in v)B[V]=Pa(v[V],S,_,O);v=B}else v=S(v,O);return v}}function zo(v,S,_,O){var B=wn(v);O=O?!!(B&16):void 0,v=Array.prototype.slice.call(v);for(var V=0;V<v.length;V++)v[V]=Pa(v[V],S,_,O);return _(B,v),v}function yx(v){return v.fa===Uo?v.toJSON():Hu(v)}function jg(v,S){v&128&&ic(S)}function Gg(v,S,_){if(_=_===void 0?Wu:_,v!=null){if(fe&&v instanceof Uint8Array)return v.length?new Zi(new Uint8Array(v),Oe):Fo();if(Array.isArray(v)){var O=wn(v);return O&2?v:S&&!(O&32)&&(O&16||O===0)?(rr(v,O|2),v):(v=zo(v,Gg,O&4?Wu:_,!0),S=wn(v),S&4&&S&2&&Object.freeze(v),v)}return v.fa===Uo?Kg(v):v}}function Hg(v,S,_,O,B,V,W){if(v=v.h&&v.h[_]){if(O=wn(v),O&2?O=v:(V=ee(v,Kg),Wu(O,V),Object.freeze(V),O=V),qr(S),V=O==null?to:$a([]),O!=null){for(W=!!O.length,v=0;v<O.length;v++){var q=O[v];W=W&&!Tr(q.o),V[v]=q.o}V=Ii(V,(W?8:0)|1),S.h||(S.h={}),S.h[_]=O}else S.h&&(S.h[_]=void 0);Er(S,_,V,B)}else xs(S,_,Gg(O,V,W),B)}function Kg(v){return Tr(v.o)||(v=qg(v,!0),vs(v.o,2)),v}function qg(v,S){var _=v.o,O=[];vs(O,16);var B=v.constructor.h;if(B&&O.push(B),B=v.A,B){O.length=_.length,O.fill(void 0,O.length,_.length);var V={};O[O.length-1]=V}wn(_)&128&&ic(O),S=S||v.C()?Wu:zg,V=v.constructor,xt=O,O=new V(O),xt=void 0,v.R&&(O.R=v.R.slice()),V=!!(wn(_)&16);for(var W=B?_.length-1:_.length,q=0;q<W;q++)Hg(v,O,q-v.G,_[q],!1,V,S);if(B)for(var ae in B)Hg(v,O,+ae,B[ae],!0,V,S);return O}function Wo(v){if(!Tr(v.o))return v;var S=qg(v,!1);return S.j=v,S}function Tt(v,S,_){v==null&&(v=xt),xt=void 0;var O=this.constructor.i||0,B=0<O,V=this.constructor.h,W=!1;if(v==null){v=V?[V]:[];var q=48,ae=!0;B&&(O=0,q|=128),rr(v,q)}else{if(!Array.isArray(v)||V&&V!==v[0])throw Error();var ye=q=vs(v,0);if((ae=(16&ye)!==0)&&((W=(32&ye)!==0)||(ye|=32)),B){if(128&ye)O=0;else if(0<v.length){var Se=v[v.length-1];if(rc(Se)&&"g"in Se){O=0,ye|=128,delete Se.g;var Ge=!0,Fe;for(Fe in Se){Ge=!1;break}Ge&&v.pop()}}}else if(128&ye)throw Error();q!==ye&&rr(v,ye)}this.G=(V?0:-1)-O,this.h=void 0,this.o=v;e:{if(V=this.o.length,O=V-1,V&&(V=this.o[O],rc(V))){this.A=V,this.i=O-this.G;break e}S!==void 0&&-1<S?(this.i=Math.max(S,O+1-this.G),this.A=void 0):this.i=Number.MAX_VALUE}if(!B&&this.A&&"g"in this.A)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(_){S=ae&&!W&&!0,B=this.i;var Ne;for(ae=0;ae<_.length;ae++)W=_[ae],W<B?(W+=this.G,(O=v[W])?sf(O,S):v[W]=to):(Ne||(Ne=Qd(this)),(O=Ne[W])?sf(O,S):Ne[W]=to)}}Tt.prototype.toJSON=function(){return zo(this.o,yx,jg)},Tt.prototype.C=function(){return Tr(this.o)};function sf(v,S){if(Array.isArray(v)){var _=wn(v),O=1;!S||_&2||(O|=16),(_&O)!==O&&rr(v,_|O)}}Tt.prototype.fa=Uo,Tt.prototype.toString=function(){return this.o.toString()};function rf(v,S,_){if(_){var O={},B;for(B in _){var V=_[B],W=V.qa;W||(O.J=V.wa||V.oa.W,V.ja?(O.aa=lc(V.ja),W=function(q){return function(ae,ye,Se){return q.J(ae,ye,Se,q.aa)}}(O)):V.ka?(O.Z=cc(V.da.P,V.ka),W=function(q){return function(ae,ye,Se){return q.J(ae,ye,Se,q.Z)}}(O)):W=O.J,V.qa=W),W(S,v,V.da),O={J:O.J,aa:O.aa,Z:O.Z}}}Yd(S,v)}var ac=Symbol();function jo(v,S,_){return v[ac]||(v[ac]=function(O,B){return S(O,B,_)})}function Xg(v){var S=v[ac];if(!S){var _=Fa(v);S=function(O,B){return af(O,B,_)},v[ac]=S}return S}function vx(v){var S=v.ja;if(S)return Xg(S);if(S=v.va)return jo(v.da.P,S,v.ka)}function xx(v){var S=vx(v),_=v.da,O=v.oa.U;return S?function(B,V){return O(B,V,_,S)}:function(B,V){return O(B,V,_)}}function ki(v,S){var _=v[S];return typeof _=="function"&&_.length===0&&(_=_(),v[S]=_),Array.isArray(_)&&(dc in _||Oa in _||0<_.length&&typeof _[0]=="function")?_:void 0}function Yg(v,S,_,O,B,V){S.P=v[0];var W=1;if(v.length>W&&typeof v[W]!="number"){var q=v[W++];_(S,q)}for(;W<v.length;){_=v[W++];for(var ae=W+1;ae<v.length&&typeof v[ae]!="number";)ae++;switch(q=v[W++],ae-=W,ae){case 0:O(S,_,q);break;case 1:(ae=ki(v,W))?(W++,B(S,_,q,ae)):O(S,_,q,v[W++]);break;case 2:ae=W++,ae=ki(v,ae),B(S,_,q,ae,v[W++]);break;case 3:V(S,_,q,v[W++],v[W++],v[W++]);break;case 4:V(S,_,q,v[W++],v[W++],v[W++],v[W++]);break;default:throw Error("unexpected number of binary field arguments: "+ae)}}return S}var Ku=Symbol();function lc(v){var S=v[Ku];if(!S){var _=zt(v);S=function(O,B){return Jr(O,B,_)},v[Ku]=S}return S}function cc(v,S){var _=v[Ku];return _||(_=function(O,B){return rf(O,B,S)},v[Ku]=_),_}var Oa=Symbol();function uc(v,S){v.push(S)}function hc(v,S,_){v.push(S,_.W)}function Jg(v,S,_,O){var B=lc(O),V=zt(O).P,W=_.W;v.push(S,function(q,ae,ye){return W(q,ae,ye,V,B)})}function of(v,S,_,O,B,V){var W=cc(O,V),q=_.W;v.push(S,function(ae,ye,Se){return q(ae,ye,Se,O,W)})}function zt(v){var S=v[Oa];return S||(S=Yg(v,v[Oa]=[],uc,hc,Jg,of),dc in v&&Oa in v&&(v.length=0),S)}var dc=Symbol();function wx(v,S){v[0]=S}function Zg(v,S,_,O){var B=_.U;v[S]=O?function(V,W,q){return B(V,W,q,O)}:B}function Qg(v,S,_,O,B){var V=_.U,W=Xg(O),q=Fa(O).P;v[S]=function(ae,ye,Se){return V(ae,ye,Se,q,W,B)}}function e0(v,S,_,O,B,V,W){var q=_.U,ae=jo(O,B,V);v[S]=function(ye,Se,Ge){return q(ye,Se,Ge,O,ae,W)}}function Fa(v){var S=v[dc];return S||(S=Yg(v,v[dc]={},wx,Zg,Qg,e0),dc in v&&Oa in v&&(v.length=0),S)}function af(v,S,_){for(;Hn(S)&&S.i!=4;){var O=S.l,B=_[O];if(!B){var V=_[0];V&&(V=V[O])&&(B=_[O]=xx(V))}if(!B||!B(S,v,O)){B=S,O=v,V=B.j,sc(B);var W=B;if(!W.ca){if(B=W.h.h-V,W.h.h=V,W=W.h,B==0)B=Fo();else{if(V=Bu(W,B),W.S&&W.u)B=W.i.subarray(V,V+B);else{W=W.i;var q=V;B=V+B,B=q===B?Be():qe?W.slice(q,B):new Uint8Array(W.subarray(q,B))}B=B.length==0?Fo():new Zi(B,Oe)}(V=O.R)?V.push(B):O.R=[B]}}}return v}function Jr(v,S,_){for(var O=_.length,B=O%2==1,V=B?1:0;V<O;V+=2)(0,_[V+1])(S,v,_[V]);rf(v,S,B?_[0]:void 0)}function _r(v,S){return{U:v,W:S}}function t0(v,S,_){return v.i!==5&&v.i!==2?!1:(S=oc(S,_),v.i==2?_a(v,Qi.prototype.s,S):S.push(v.h.s()),!0)}var ss=_r(function(v,S,_){return v.i!==5?!1:(xs(S,_,v.h.s()),!0)},function(v,S,_){S=ef(S,_),S!=null&&(Si(v,_,5),v=v.h,it(S),Vo(v))}),n0=_r(t0,function(v,S,_){if(S=ju(S,_),S!=null)for(var O=0;O<S.length;O++){var B=v,V=S[O];V!=null&&(Si(B,_,5),B=B.h,it(V),Vo(B))}}),lf=_r(t0,function(v,S,_){if(S=ju(S,_),S!=null&&S.length)for(Si(v,_,2),Bo(v.h,4*S.length),_=0;_<S.length;_++){var O=v.h;it(S[_]),Vo(O)}}),qu=_r(function(v,S,_){if(v.i!==0)return!1;var O=v.h,B=0,V=v=0,W=O.i,q=O.h;do{var ae=W[q++];B|=(ae&127)<<V,V+=7}while(32>V&&ae&128);for(32<V&&(v|=(ae&127)>>4),V=3;32>V&&ae&128;V+=7)ae=W[q++],v|=(ae&127)<<V;if(Lo(O,q),128>ae)O=B>>>0,ae=v>>>0,(v=ae&2147483648)&&(O=~O+1>>>0,ae=~ae>>>0,O==0&&(ae=ae+1>>>0)),O=4294967296*ae+(O>>>0);else throw Vs();return xs(S,_,v?-O:O),!0},function(v,S,_){S=bn(S,_),S!=null&&(typeof S=="string"&&Ut(S),S!=null&&(Si(v,_,0),typeof S=="number"?(v=v.h,ut(S),qd(v,Ue,Ye)):(_=Ut(S),qd(v.h,_.i,_.h))))}),Xu=_r(function(v,S,_){return v.i!==0?!1:(xs(S,_,Mo(v.h)),!0)},function(v,S,_){S=bn(S,_),S!=null&&S!=null&&(Si(v,_,0),Xd(v.h,S))}),fc=_r(function(v,S,_){if(v.i!==2)return!1;var O=v.h.l();v=v.h;var B=Bu(v,O);if(v=v.i,Xi){var V=v,W;(W=ns)||(W=ns=new TextDecoder("utf-8",{fatal:!0})),v=B+O,V=B===0&&v===V.length?V:V.subarray(B,v);try{var q=W.decode(V)}catch(Ge){if(kt===void 0){try{W.decode(new Uint8Array([128]))}catch{}try{W.decode(new Uint8Array([97])),kt=!0}catch{kt=!1}}throw!kt&&(ns=void 0),Ge}}else{q=B,O=q+O,B=[];for(var ae=null,ye,Se;q<O;)ye=v[q++],128>ye?B.push(ye):224>ye?q>=O?xn():(Se=v[q++],194>ye||(Se&192)!==128?(q--,xn()):B.push((ye&31)<<6|Se&63)):240>ye?q>=O-1?xn():(Se=v[q++],(Se&192)!==128||ye===224&&160>Se||ye===237&&160<=Se||((V=v[q++])&192)!==128?(q--,xn()):B.push((ye&15)<<12|(Se&63)<<6|V&63)):244>=ye?q>=O-2?xn():(Se=v[q++],(Se&192)!==128||(ye<<28)+(Se-144)>>30||((V=v[q++])&192)!==128||((W=v[q++])&192)!==128?(q--,xn()):(ye=(ye&7)<<18|(Se&63)<<12|(V&63)<<6|W&63,ye-=65536,B.push((ye>>10&1023)+55296,(ye&1023)+56320))):xn(),8192<=B.length&&(ae=Rt(ae,B),B.length=0);q=Rt(ae,B)}return xs(S,_,q),!0},function(v,S,_){if(S=bn(S,_),S!=null){var O=!1;if(O=O===void 0?!1:O,nc){if(O&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(S))throw Error("Found an unpaired surrogate");S=(Oo||(Oo=new TextEncoder)).encode(S)}else{for(var B=0,V=new Uint8Array(3*S.length),W=0;W<S.length;W++){var q=S.charCodeAt(W);if(128>q)V[B++]=q;else{if(2048>q)V[B++]=q>>6|192;else{if(55296<=q&&57343>=q){if(56319>=q&&W<S.length){var ae=S.charCodeAt(++W);if(56320<=ae&&57343>=ae){q=1024*(q-55296)+ae-56320+65536,V[B++]=q>>18|240,V[B++]=q>>12&63|128,V[B++]=q>>6&63|128,V[B++]=q&63|128;continue}else W--}if(O)throw Error("Found an unpaired surrogate");q=65533}V[B++]=q>>12|224,V[B++]=q>>6&63|128}V[B++]=q&63|128}}S=B===V.length?V:V.subarray(0,B)}Si(v,_,2),Bo(v.h,S.length),Ir(v,v.h.end()),Ir(v,S)}}),s0=_r(function(v,S,_,O,B){if(v.i!==2)return!1;qr(S);var V=bn(S,_);return O=Wo(Zd(V,O,!0)),V!==O&&Er(S,_,O),Na(v,O,B),!0},function(v,S,_,O,B){S=Gu(S,O,_),S!=null&&(_=Vg(v,_),B(S,v),Ug(v,_))}),cf=_r(function(v,S,_,O,B){return v.i!==2?!1:(Na(v,Xr(S,_,O),B),!0)},function(v,S,_,O,B){if(S=nf(S,O,_),S!=null)for(O=0;O<S.length;O++){var V=Vg(v,_);B(S[O],v),Ug(v,V)}}),pc=_r(function(v,S,_){return v.i!==0&&v.i!==2?!1:(S=oc(S,_),v.i==2?_a(v,Qi.prototype.l,S):S.push(v.h.l()),!0)},function(v,S,_){if(S=oc(S,_),S!=null)for(var O=0;O<S.length;O++){var B=v,V=S[O];V!=null&&(Si(B,_,0),Bo(B.h,V))}}),Yu=_r(function(v,S,_){return v.i!==0?!1:(xs(S,_,Mo(v.h)),!0)},function(v,S,_){S=bn(S,_),S!=null&&(S=parseInt(S,10),Si(v,_,0),Xd(v.h,S))});function mc(v){return function(S,_){e:{if(zu.length){var O=zu.pop();O.setOptions(_),Mu(O.h,S,_),S=O}else S=new Uu(S,_);try{var B=Fa(v),V=af(new B.P,S,B);break e}finally{B=S.h,B.i=null,B.u=!1,B.m=0,B.j=0,B.h=0,B.S=!1,S.l=-1,S.i=-1,100>zu.length&&zu.push(S)}V=void 0}return V}}function gc(v){return function(){var S=new gx;Jr(this,S,zt(v)),Ir(S,S.h.end());for(var _=new Uint8Array(S.i),O=S.j,B=O.length,V=0,W=0;W<B;W++){var q=O[W];_.set(q,V),V+=q.length}return S.j=[_],_}}function no(v){Tt.call(this,v)}m(no,Tt);var uf=[no,1,Xu,2,ss,3,fc,4,fc];no.prototype.l=gc(uf);function La(v){Tt.call(this,v,-1,r0)}m(La,Tt),La.prototype.addClassification=function(v,S){return Xr(this,1,no,v,S),this};var r0=[1],i0=mc([La,1,cf,uf]);function $r(v){Tt.call(this,v)}m($r,Tt);var hf=[$r,1,ss,2,ss,3,ss,4,ss,5,ss];$r.prototype.l=gc(hf);function df(v){Tt.call(this,v,-1,o0)}m(df,Tt);var o0=[1],a0=mc([df,1,cf,hf]);function Cn(v){Tt.call(this,v,-1,l0)}m(Cn,Tt),Cn.prototype.getRows=function(){return Da(this,1)},Cn.prototype.getCols=function(){return Da(this,2)},Cn.prototype.getPackedDataList=function(){return ju(this,3)},Cn.prototype.getLayout=function(){return Yr(bn(this,4),0)};var l0=[3],c0=[Cn,1,Xu,2,Xu,3,lf,4,Yu];function Ti(v){Tt.call(this,v)}m(Ti,Tt);var x=[Ti,1,ss,2,ss,3,ss,4,ss,5,ss,6,qu],N=mc(x);Ti.prototype.l=gc(x);function D(v){Tt.call(this,v,-1,M)}m(D,Tt),D.prototype.getVertexType=function(){return Yr(bn(this,1),0)},D.prototype.getPrimitiveType=function(){return Yr(bn(this,2),0)},D.prototype.getVertexBufferList=function(){return ju(this,3)},D.prototype.getIndexBufferList=function(){return oc(this,4)};var M=[3,4],se=[D,1,Yu,2,Yu,3,n0,4,pc];function le(v){Tt.call(this,v)}m(le,Tt),le.prototype.getMesh=function(){return Gu(this,D,1)},le.prototype.getPoseTransformMatrix=function(){return Gu(this,Cn,2)};var be=mc([le,1,s0,se,2,s0,c0]),wt=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],Sn=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],ot=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],Dn=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],Pn=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],Go=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],Rr=[].concat(l(wt),l(Sn),l(ot),l(Dn),l(Pn),l(Go));function yc(v,S,_){if(_=v.createShader(_===0?v.VERTEX_SHADER:v.FRAGMENT_SHADER),v.shaderSource(_,S),v.compileShader(_),!v.getShaderParameter(_,v.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+v.getShaderInfoLog(_));return _}function ff(v){return nf(v,no,1).map(function(S){return{index:Da(S,1),score:Nr(S,2),label:bn(S,3)!=null?Yr(bn(S,3),""):void 0,displayName:bn(S,4)!=null?Yr(bn(S,4),""):void 0}})}function XB(v){return{x:Nr(v,1),y:Nr(v,2),z:Nr(v,3),visibility:ef(v,4)!=null?Nr(v,4):void 0}}function Ju(v){return nf(a0(v),$r,1).map(XB)}function bx(v,S){this.i=v,this.h=S,this.m=0}function pE(v,S,_){return YB(v,S),typeof v.h.canvas.transferToImageBitmap=="function"?Promise.resolve(v.h.canvas.transferToImageBitmap()):_?Promise.resolve(v.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(v.h.canvas):(v.j===void 0&&(v.j=document.createElement("canvas")),new Promise(function(O){v.j.height=v.h.canvas.height,v.j.width=v.h.canvas.width,v.j.getContext("2d",{}).drawImage(v.h.canvas,0,0,v.h.canvas.width,v.h.canvas.height),O(v.j)}))}function YB(v,S){var _=v.h;if(v.s===void 0){var O=yc(_,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),B=yc(_,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),V=_.createProgram();if(_.attachShader(V,O),_.attachShader(V,B),_.linkProgram(V),!_.getProgramParameter(V,_.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+_.getProgramInfoLog(V));O=v.s=V,_.useProgram(O),B=_.getUniformLocation(O,"sampler0"),v.l={O:_.getAttribLocation(O,"aVertex"),N:_.getAttribLocation(O,"aTex"),xa:B},v.v=_.createBuffer(),_.bindBuffer(_.ARRAY_BUFFER,v.v),_.enableVertexAttribArray(v.l.O),_.vertexAttribPointer(v.l.O,2,_.FLOAT,!1,0,0),_.bufferData(_.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),_.STATIC_DRAW),_.bindBuffer(_.ARRAY_BUFFER,null),v.u=_.createBuffer(),_.bindBuffer(_.ARRAY_BUFFER,v.u),_.enableVertexAttribArray(v.l.N),_.vertexAttribPointer(v.l.N,2,_.FLOAT,!1,0,0),_.bufferData(_.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),_.STATIC_DRAW),_.bindBuffer(_.ARRAY_BUFFER,null),_.uniform1i(B,0)}O=v.l,_.useProgram(v.s),_.canvas.width=S.width,_.canvas.height=S.height,_.viewport(0,0,S.width,S.height),_.activeTexture(_.TEXTURE0),v.i.bindTexture2d(S.glName),_.enableVertexAttribArray(O.O),_.bindBuffer(_.ARRAY_BUFFER,v.v),_.vertexAttribPointer(O.O,2,_.FLOAT,!1,0,0),_.enableVertexAttribArray(O.N),_.bindBuffer(_.ARRAY_BUFFER,v.u),_.vertexAttribPointer(O.N,2,_.FLOAT,!1,0,0),_.bindFramebuffer(_.DRAW_FRAMEBUFFER?_.DRAW_FRAMEBUFFER:_.FRAMEBUFFER,null),_.clearColor(0,0,0,0),_.clear(_.COLOR_BUFFER_BIT),_.colorMask(!0,!0,!0,!0),_.drawArrays(_.TRIANGLE_FAN,0,4),_.disableVertexAttribArray(O.O),_.disableVertexAttribArray(O.N),_.bindBuffer(_.ARRAY_BUFFER,null),v.i.bindTexture2d(0)}function JB(v){this.h=v}var ZB=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function QB(v,S){return S+v}function mE(v,S){window[v]=S}function eV(v){var S=document.createElement("script");return S.setAttribute("src",v),S.setAttribute("crossorigin","anonymous"),new Promise(function(_){S.addEventListener("load",function(){_()},!1),S.addEventListener("error",function(){_()},!1),document.body.appendChild(S)})}function tV(){return A(function(v){switch(v.h){case 1:return v.s=2,C(v,WebAssembly.instantiate(ZB),4);case 4:v.h=3,v.s=0;break;case 2:return v.s=0,v.l=null,v.return(!1);case 3:return v.return(!0)}})}function Cx(v){if(this.h=v,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ha=!0,this.I=Promise.resolve(),this.ga="",this.D={},this.locateFile=v&&v.locateFile||QB,typeof window=="object")var S=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")S=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ia=S,v.options){S=a(Object.keys(v.options));for(var _=S.next();!_.done;_=S.next()){_=_.value;var O=v.options[_].default;O!==void 0&&(this.l[_]=typeof O=="function"?O():O)}}}t=Cx.prototype,t.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function nV(v){var S,_,O,B,V,W,q,ae,ye,Se,Ge;return A(function(Fe){switch(Fe.h){case 1:return v.ha?(S=v.h.files===void 0?[]:typeof v.h.files=="function"?v.h.files(v.l):v.h.files,C(Fe,tV(),2)):Fe.return();case 2:if(_=Fe.i,typeof window=="object")return mE("createMediapipeSolutionsWasm",{locateFile:v.locateFile}),mE("createMediapipeSolutionsPackedAssets",{locateFile:v.locateFile}),W=S.filter(function(Ne){return Ne.data!==void 0}),q=S.filter(function(Ne){return Ne.data===void 0}),ae=Promise.all(W.map(function(Ne){var He=Sx(v,Ne.url);if(Ne.path!==void 0){var st=Ne.path;He=He.then(function(Wt){return v.overrideFile(st,Wt),Promise.resolve(Wt)})}return He})),ye=Promise.all(q.map(function(Ne){return Ne.simd===void 0||Ne.simd&&_||!Ne.simd&&!_?eV(v.locateFile(Ne.url,v.ia)):Promise.resolve()})).then(function(){var Ne,He,st;return A(function(Wt){if(Wt.h==1)return Ne=window.createMediapipeSolutionsWasm,He=window.createMediapipeSolutionsPackedAssets,st=v,C(Wt,Ne(He),2);st.i=Wt.i,Wt.h=0})}),Se=function(){return A(function(Ne){return v.h.graph&&v.h.graph.url?Ne=C(Ne,Sx(v,v.h.graph.url),0):(Ne.h=0,Ne=void 0),Ne})}(),C(Fe,Promise.all([ye,ae,Se]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return O=S.filter(function(Ne){return Ne.simd===void 0||Ne.simd&&_||!Ne.simd&&!_}).map(function(Ne){return v.locateFile(Ne.url,v.ia)}),importScripts.apply(null,l(O)),B=v,C(Fe,createMediapipeSolutionsWasm(Module),6);case 6:B.i=Fe.i,v.m=new OffscreenCanvas(1,1),v.i.canvas=v.m,V=v.i.GL.createContext(v.m,{antialias:!1,alpha:!1,ua:typeof WebGL2RenderingContext<"u"?2:1}),v.i.GL.makeContextCurrent(V),Fe.h=4;break;case 7:if(v.m=document.createElement("canvas"),Ge=v.m.getContext("webgl2",{}),!Ge&&(Ge=v.m.getContext("webgl",{}),!Ge))return alert("Failed to create WebGL canvas context when passing video frame."),Fe.return();v.K=Ge,v.i.canvas=v.m,v.i.createContext(v.m,!0,!0,{});case 4:v.j=new v.i.SolutionWasm,v.ha=!1,Fe.h=0}})}function sV(v){var S,_,O,B,V,W,q,ae;return A(function(ye){if(ye.h==1){if(v.h.graph&&v.h.graph.url&&v.ga===v.h.graph.url)return ye.return();if(v.u=!0,!v.h.graph||!v.h.graph.url){ye.h=2;return}return v.ga=v.h.graph.url,C(ye,Sx(v,v.h.graph.url),3)}for(ye.h!=2&&(S=ye.i,v.j.loadGraph(S)),_=a(Object.keys(v.D)),O=_.next();!O.done;O=_.next())B=O.value,v.j.overrideFile(B,v.D[B]);if(v.D={},v.h.listeners)for(V=a(v.h.listeners),W=V.next();!W.done;W=V.next())q=W.value,aV(v,q);ae=v.l,v.l={},v.setOptions(ae),ye.h=0})}t.reset=function(){var v=this;return A(function(S){v.j&&(v.j.reset(),v.s={},v.v={}),S.h=0})},t.setOptions=function(v,S){var _=this;if(S=S||this.h.options){for(var O=[],B=[],V={},W=a(Object.keys(v)),q=W.next();!q.done;V={X:V.X,Y:V.Y},q=W.next())if(q=q.value,!(q in this.l&&this.l[q]===v[q])){this.l[q]=v[q];var ae=S[q];ae!==void 0&&(ae.onChange&&(V.X=ae.onChange,V.Y=v[q],O.push(function(ye){return function(){var Se;return A(function(Ge){if(Ge.h==1)return C(Ge,ye.X(ye.Y),2);Se=Ge.i,Se===!0&&(_.u=!0),Ge.h=0})}}(V))),ae.graphOptionXref&&(q=Object.assign({},{calculatorName:"",calculatorIndex:0},ae.graphOptionXref,{valueNumber:ae.type===1?v[q]:0,valueBoolean:ae.type===0?v[q]:!1,valueString:ae.type===2?v[q]:""}),B.push(q)))}(O.length!==0||B.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(B),this.F=(this.F===void 0?[]:this.F).concat(O))}};function rV(v){var S,_,O,B,V,W,q;return A(function(ae){switch(ae.h){case 1:if(!v.u)return ae.return();if(!v.F){ae.h=2;break}S=a(v.F),_=S.next();case 3:if(_.done){ae.h=5;break}return O=_.value,C(ae,O(),4);case 4:_=S.next(),ae.h=3;break;case 5:v.F=void 0;case 2:if(v.H){for(B=new v.i.GraphOptionChangeRequestList,V=a(v.H),W=V.next();!W.done;W=V.next())q=W.value,B.push_back(q);v.j.changeOptions(B),B.delete(),v.H=void 0}v.u=!1,ae.h=0}})}t.initialize=function(){var v=this;return A(function(S){return S.h==1?C(S,nV(v),2):S.h!=3?C(S,sV(v),3):C(S,rV(v),0)})};function Sx(v,S){var _,O;return A(function(B){return S in v.L?B.return(v.L[S]):(_=v.locateFile(S,""),O=fetch(_).then(function(V){return V.arrayBuffer()}),v.L[S]=O,B.return(O))})}t.overrideFile=function(v,S){this.j?this.j.overrideFile(v,S):this.D[v]=S},t.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},t.send=function(v,S){var _=this,O,B,V,W,q,ae,ye,Se,Ge;return A(function(Fe){switch(Fe.h){case 1:return _.h.inputs?(O=1e3*(S??performance.now()),C(Fe,_.I,2)):Fe.return();case 2:return C(Fe,_.initialize(),3);case 3:for(B=new _.i.PacketDataList,V=a(Object.keys(v)),W=V.next();!W.done;W=V.next())if(q=W.value,ae=_.h.inputs[q]){e:{var Ne=v[q];switch(ae.type){case"video":var He=_.s[ae.stream];if(He||(He=new bx(_.i,_.K),_.s[ae.stream]=He),He.m===0&&(He.m=He.i.createTexture()),typeof HTMLVideoElement<"u"&&Ne instanceof HTMLVideoElement)var st=Ne.videoWidth,Wt=Ne.videoHeight;else typeof HTMLImageElement<"u"&&Ne instanceof HTMLImageElement?(st=Ne.naturalWidth,Wt=Ne.naturalHeight):(st=Ne.width,Wt=Ne.height);Wt={glName:He.m,width:st,height:Wt},st=He.h,st.canvas.width=Wt.width,st.canvas.height=Wt.height,st.activeTexture(st.TEXTURE0),He.i.bindTexture2d(He.m),st.texImage2D(st.TEXTURE_2D,0,st.RGBA,st.RGBA,st.UNSIGNED_BYTE,Ne),He.i.bindTexture2d(0),He=Wt;break e;case"detections":for(He=_.s[ae.stream],He||(He=new JB(_.i),_.s[ae.stream]=He),He.data||(He.data=new He.h.DetectionListData),He.data.reset(Ne.length),Wt=0;Wt<Ne.length;++Wt){st=Ne[Wt];var Ft=He.data,rs=Ft.setBoundingBox,Zr=Wt,ir=st.la,pt=new Ti;if(Kn(pt,1,ir.ra),Kn(pt,2,ir.sa),Kn(pt,3,ir.height),Kn(pt,4,ir.width),Kn(pt,5,ir.rotation),xs(pt,6,ir.pa),ir=pt.l(),rs.call(Ft,Zr,ir),st.ea)for(Ft=0;Ft<st.ea.length;++Ft){pt=st.ea[Ft],rs=He.data,Zr=rs.addNormalizedLandmark,ir=Wt,pt=Object.assign({},pt,{visibility:pt.visibility?pt.visibility:0});var is=new $r;Kn(is,1,pt.x),Kn(is,2,pt.y),Kn(is,3,pt.z),pt.visibility&&Kn(is,4,pt.visibility),pt=is.l(),Zr.call(rs,ir,pt)}if(st.ba)for(Ft=0;Ft<st.ba.length;++Ft)rs=He.data,Zr=rs.addClassification,ir=Wt,pt=st.ba[Ft],is=new no,Kn(is,2,pt.score),pt.index&&xs(is,1,pt.index),pt.label&&xs(is,3,pt.label),pt.displayName&&xs(is,4,pt.displayName),pt=is.l(),Zr.call(rs,ir,pt)}He=He.data;break e;default:He={}}}switch(ye=He,Se=ae.stream,ae.type){case"video":B.pushTexture2d(Object.assign({},ye,{stream:Se,timestamp:O}));break;case"detections":Ge=ye,Ge.stream=Se,Ge.timestamp=O,B.pushDetectionList(Ge);break;default:throw Error("Unknown input config type: '"+ae.type+"'")}}return _.j.send(B),C(Fe,_.I,4);case 4:B.delete(),Fe.h=0}})};function iV(v,S,_){var O,B,V,W,q,ae,ye,Se,Ge,Fe,Ne,He,st,Wt;return A(function(Ft){switch(Ft.h){case 1:if(!_)return Ft.return(S);for(O={},B=0,V=a(Object.keys(_)),W=V.next();!W.done;W=V.next())q=W.value,ae=_[q],typeof ae!="string"&&ae.type==="texture"&&S[ae.stream]!==void 0&&++B;1<B&&(v.M=!1),ye=a(Object.keys(_)),W=ye.next();case 2:if(W.done){Ft.h=4;break}if(Se=W.value,Ge=_[Se],typeof Ge=="string")return st=O,Wt=Se,C(Ft,oV(v,Se,S[Ge]),14);if(Fe=S[Ge.stream],Ge.type==="detection_list"){if(Fe){for(var rs=Fe.getRectList(),Zr=Fe.getLandmarksList(),ir=Fe.getClassificationsList(),pt=[],is=0;is<rs.size();++is){var Ma=N(rs.get(is)),uV=Nr(Ma,1),hV=Nr(Ma,2),dV=Nr(Ma,3),fV=Nr(Ma,4),pV=Nr(Ma,5,0),u0=void 0;u0=u0===void 0?0:u0,Ma={la:{ra:uV,sa:hV,height:dV,width:fV,rotation:pV,pa:Yr(bn(Ma,6),u0)},ea:Ju(Zr.get(is)),ba:ff(i0(ir.get(is)))},pt.push(Ma)}rs=pt}else rs=[];O[Se]=rs,Ft.h=7;break}if(Ge.type==="proto_list"){if(Fe){for(rs=Array(Fe.size()),Zr=0;Zr<Fe.size();Zr++)rs[Zr]=Fe.get(Zr);Fe.delete()}else rs=[];O[Se]=rs,Ft.h=7;break}if(Fe===void 0){Ft.h=3;break}if(Ge.type==="float_list"){O[Se]=Fe,Ft.h=7;break}if(Ge.type==="proto"){O[Se]=Fe,Ft.h=7;break}if(Ge.type!=="texture")throw Error("Unknown output config type: '"+Ge.type+"'");return Ne=v.v[Se],Ne||(Ne=new bx(v.i,v.K),v.v[Se]=Ne),C(Ft,pE(Ne,Fe,v.M),13);case 13:He=Ft.i,O[Se]=He;case 7:Ge.transform&&O[Se]&&(O[Se]=Ge.transform(O[Se])),Ft.h=3;break;case 14:st[Wt]=Ft.i;case 3:W=ye.next(),Ft.h=2;break;case 4:return Ft.return(O)}})}function oV(v,S,_){var O;return A(function(B){return typeof _=="number"||_ instanceof Uint8Array||_ instanceof v.i.Uint8BlobList?B.return(_):_ instanceof v.i.Texture2dDataOut?(O=v.v[S],O||(O=new bx(v.i,v.K),v.v[S]=O),B.return(pE(O,_,v.M))):B.return(void 0)})}function aV(v,S){for(var _=S.name||"$",O=[].concat(l(S.wants)),B=new v.i.StringList,V=a(S.wants),W=V.next();!W.done;W=V.next())B.push_back(W.value);V=v.i.PacketListener.implement({onResults:function(q){for(var ae={},ye=0;ye<S.wants.length;++ye)ae[O[ye]]=q.get(ye);var Se=v.listeners[_];Se&&(v.I=iV(v,ae,S.outs).then(function(Ge){Ge=Se(Ge);for(var Fe=0;Fe<S.wants.length;++Fe){var Ne=ae[O[Fe]];typeof Ne=="object"&&Ne.hasOwnProperty&&Ne.hasOwnProperty("delete")&&Ne.delete()}Ge&&(v.I=Ge)}))}}),v.j.attachMultiListener(B,V),B.delete()}t.onResults=function(v,S){this.listeners[S||"$"]=v},H("Solution",Cx),H("OptionType",{BOOL:0,NUMBER:1,ta:2,0:"BOOL",1:"NUMBER",2:"STRING"});function lV(v){return v.map(cV)}function cV(v){v=be(v);var S=v.getMesh();if(!S)return v;var _=new Float32Array(S.getVertexBufferList());S.getVertexBufferList=function(){return _};var O=new Uint32Array(S.getIndexBufferList());return S.getIndexBufferList=function(){return O},v}function gE(v){var S=this;v=v||{},this.h=new Cx({locateFile:v.locateFile,files:[{url:"holistic_solution_packed_assets_loader.js"},{simd:!1,url:"holistic_solution_wasm_bin.js"},{simd:!0,url:"holistic_solution_simd_wasm_bin.js"}],graph:{url:"holistic.binarypb"},inputs:{image:{type:"video",stream:"input_frames_gpu"}},listeners:[{wants:"left_hand_landmarks right_hand_landmarks face_landmarks pose_landmarks world_landmarks segmentation_mask image_transformed multi_face_geometry".split(" "),outs:{image:{type:"texture",stream:"image_transformed"},leftHandLandmarks:{type:"proto",stream:"left_hand_landmarks",transform:Ju},rightHandLandmarks:{type:"proto",stream:"right_hand_landmarks",transform:Ju},faceLandmarks:{type:"proto",stream:"face_landmarks",transform:Ju},poseLandmarks:{type:"proto",stream:"pose_landmarks",transform:Ju},za:{type:"proto",stream:"world_landmarks",transform:Ju},segmentationMask:{type:"texture",stream:"segmentation_mask"},multiFaceGeometry:{type:"proto_list",stream:"multi_face_geometry",transform:lV}}}],options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},enableFaceGeometry:{type:0,graphOptionXref:{calculatorName:"EnableFaceGeometryConstant",calculatorType:"ConstantSidePacketCalculator",fieldName:"bool_value"}},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelComplexity:{type:1,default:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(_){var O,B,V,W;return A(function(q){if(q.h==1){switch(O="",_){case 1:O="pose_landmark_full.tflite";break;case 2:O="pose_landmark_heavy.tflite";break;default:O="pose_landmark_lite.tflite"}return B="third_party/mediapipe/modules/pose_landmark/"+O,V=S.h.locateFile(O,""),C(q,fetch(V),3)}return q.h!=2?C(q,q.i.arrayBuffer(),2):(W=q.i,S.h.overrideFile(B,W),C(q,S.h.reset(),0))})}},smoothLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothLandmarks",fieldName:"bool_value"}},enableSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorEnableSegmentation",fieldName:"bool_value"}},smoothSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothSegmentation",fieldName:"bool_value"}},refineFaceLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorRefineFaceLandmarks",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"holisticlandmarkgpu__poselandmarkgpu__posedetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"holisticlandmarkgpu__poselandmarkgpu__poselandmarkbyroigpu__tensorstoposelandmarksandsegmentation__ThresholdingCalculator",fieldName:"threshold"}},cameraNear:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"near"}},cameraFar:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"far"}},cameraVerticalFovDegrees:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"vertical_fov_degrees"}}}})}t=gE.prototype,t.close=function(){return this.h.close(),Promise.resolve()},t.onResults=function(v){this.h.onResults(v)},t.initialize=function(){var v=this;return A(function(S){return C(S,v.h.initialize(),0)})},t.reset=function(){this.h.reset()},t.send=function(v){var S=this;return A(function(_){return C(_,S.h.send(v),0)})},t.setOptions=function(v){this.h.setOptions(v)},H("Holistic",gE),H("FACE_GEOMETRY",{Layout:{COLUMN_MAJOR:0,ROW_MAJOR:1,0:"COLUMN_MAJOR",1:"ROW_MAJOR"},PrimitiveType:{TRIANGLE:0,0:"TRIANGLE"},VertexType:{VERTEX_PT:0,0:"VERTEX_PT"},DEFAULT_CAMERA_PARAMS:{verticalFovDegrees:63,near:1,far:1e4}}),H("FACEMESH_LIPS",wt),H("FACEMESH_LEFT_EYE",Sn),H("FACEMESH_LEFT_EYEBROW",ot),H("FACEMESH_LEFT_IRIS",[[474,475],[475,476],[476,477],[477,474]]),H("FACEMESH_RIGHT_EYE",Dn),H("FACEMESH_RIGHT_EYEBROW",Pn),H("FACEMESH_RIGHT_IRIS",[[469,470],[470,471],[471,472],[472,469]]),H("FACEMESH_FACE_OVAL",Go),H("FACEMESH_CONTOURS",Rr),H("FACEMESH_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]]),H("HAND_CONNECTIONS",[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]]),H("POSE_CONNECTIONS",[[0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]]),H("POSE_LANDMARKS",{NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,LEFT_RIGHT:9,RIGHT_LEFT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32}),H("POSE_LANDMARKS_LEFT",{LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,LEFT_EAR:7,LEFT_RIGHT:9,LEFT_SHOULDER:11,LEFT_ELBOW:13,LEFT_WRIST:15,LEFT_PINKY:17,LEFT_INDEX:19,LEFT_THUMB:21,LEFT_HIP:23,LEFT_KNEE:25,LEFT_ANKLE:27,LEFT_HEEL:29,LEFT_FOOT_INDEX:31}),H("POSE_LANDMARKS_RIGHT",{RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,RIGHT_EAR:8,RIGHT_LEFT:10,RIGHT_SHOULDER:12,RIGHT_ELBOW:14,RIGHT_WRIST:16,RIGHT_PINKY:18,RIGHT_INDEX:20,RIGHT_THUMB:22,RIGHT_HIP:24,RIGHT_KNEE:26,RIGHT_ANKLE:28,RIGHT_HEEL:30,RIGHT_FOOT_INDEX:32}),H("POSE_LANDMARKS_NEUTRAL",{NOSE:0}),H("matrixDataToMatrix",function(v){for(var S=v.getCols(),_=v.getRows(),O=v.getPackedDataList(),B=[],V=0;V<_;V++)B.push(Array(S));for(V=0;V<_;V++)for(var W=0;W<S;W++){var q=v.getLayout()===1?V*S+W:W*_+V;B[V][W]=O[q]}return B}),H("VERSION","0.5.1675471629")}).call(zn);var bte={};(function(){function t(E){var A=0;return function(){return A<E.length?{done:!1,value:E[A++]}:{done:!0}}}var e=typeof Object.defineProperties=="function"?Object.defineProperty:function(E,A,F){return E==Array.prototype||E==Object.prototype||(E[A]=F.value),E};function n(E){E=[typeof globalThis=="object"&&globalThis,E,typeof window=="object"&&window,typeof self=="object"&&self,typeof zn=="object"&&zn];for(var A=0;A<E.length;++A){var F=E[A];if(F&&F.Math==Math)return F}throw Error("Cannot find global object")}var s=n(this);function r(E,A){if(A)e:{var F=s;E=E.split(".");for(var P=0;P<E.length-1;P++){var Z=E[P];if(!(Z in F))break e;F=F[Z]}E=E[E.length-1],P=F[E],A=A(P),A!=P&&A!=null&&e(F,E,{configurable:!0,writable:!0,value:A})}}r("Symbol",function(E){function A(H){if(this instanceof A)throw new TypeError("Symbol is not a constructor");return new F(P+(H||"")+"_"+Z++,H)}function F(H,j){this.g=H,e(this,"description",{configurable:!0,writable:!0,value:j})}if(E)return E;F.prototype.toString=function(){return this.g};var P="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",Z=0;return A}),r("Symbol.iterator",function(E){if(E)return E;E=Symbol("Symbol.iterator");for(var A="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),F=0;F<A.length;F++){var P=s[A[F]];typeof P=="function"&&typeof P.prototype[E]!="function"&&e(P.prototype,E,{configurable:!0,writable:!0,value:function(){return i(t(this))}})}return E});function i(E){return E={next:E},E[Symbol.iterator]=function(){return this},E}function o(E){var A=typeof Symbol<"u"&&Symbol.iterator&&E[Symbol.iterator];return A?A.call(E):{next:t(E)}}function a(){this.i=!1,this.g=null,this.o=void 0,this.j=1,this.m=0,this.h=null}function l(E){if(E.i)throw new TypeError("Generator is already running");E.i=!0}a.prototype.l=function(E){this.o=E};function c(E,A){E.h={F:A,G:!0},E.j=E.m}a.prototype.return=function(E){this.h={return:E},this.j=this.m};function u(E){this.g=new a,this.h=E}function h(E,A){l(E.g);var F=E.g.g;return F?d(E,"return"in F?F.return:function(P){return{value:P,done:!0}},A,E.g.return):(E.g.return(A),f(E))}function d(E,A,F,P){try{var Z=A.call(E.g.g,F);if(!(Z instanceof Object))throw new TypeError("Iterator result "+Z+" is not an object");if(!Z.done)return E.g.i=!1,Z;var H=Z.value}catch(j){return E.g.g=null,c(E.g,j),f(E)}return E.g.g=null,P.call(E.g,H),f(E)}function f(E){for(;E.g.j;)try{var A=E.h(E.g);if(A)return E.g.i=!1,{value:A.value,done:!1}}catch(F){E.g.o=void 0,c(E.g,F)}if(E.g.i=!1,E.g.h){if(A=E.g.h,E.g.h=null,A.G)throw A.F;return{value:A.return,done:!0}}return{value:void 0,done:!0}}function p(E){this.next=function(A){return l(E.g),E.g.g?A=d(E,E.g.g.next,A,E.g.l):(E.g.l(A),A=f(E)),A},this.throw=function(A){return l(E.g),E.g.g?A=d(E,E.g.g.throw,A,E.g.l):(c(E.g,A),A=f(E)),A},this.return=function(A){return h(E,A)},this[Symbol.iterator]=function(){return this}}function g(E){function A(P){return E.next(P)}function F(P){return E.throw(P)}return new Promise(function(P,Z){function H(j){j.done?P(j.value):Promise.resolve(j.value).then(A,F).then(H,Z)}H(E.next())})}r("Promise",function(E){function A(j){this.h=0,this.i=void 0,this.g=[],this.o=!1;var ee=this.j();try{j(ee.resolve,ee.reject)}catch(z){ee.reject(z)}}function F(){this.g=null}function P(j){return j instanceof A?j:new A(function(ee){ee(j)})}if(E)return E;F.prototype.h=function(j){if(this.g==null){this.g=[];var ee=this;this.i(function(){ee.l()})}this.g.push(j)};var Z=s.setTimeout;F.prototype.i=function(j){Z(j,0)},F.prototype.l=function(){for(;this.g&&this.g.length;){var j=this.g;this.g=[];for(var ee=0;ee<j.length;++ee){var z=j[ee];j[ee]=null;try{z()}catch(X){this.j(X)}}}this.g=null},F.prototype.j=function(j){this.i(function(){throw j})},A.prototype.j=function(){function j(X){return function(ie){z||(z=!0,X.call(ee,ie))}}var ee=this,z=!1;return{resolve:j(this.A),reject:j(this.l)}},A.prototype.A=function(j){if(j===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(j instanceof A)this.C(j);else{e:switch(typeof j){case"object":var ee=j!=null;break e;case"function":ee=!0;break e;default:ee=!1}ee?this.v(j):this.m(j)}},A.prototype.v=function(j){var ee=void 0;try{ee=j.then}catch(z){this.l(z);return}typeof ee=="function"?this.D(ee,j):this.m(j)},A.prototype.l=function(j){this.u(2,j)},A.prototype.m=function(j){this.u(1,j)},A.prototype.u=function(j,ee){if(this.h!=0)throw Error("Cannot settle("+j+", "+ee+"): Promise already settled in state"+this.h);this.h=j,this.i=ee,this.h===2&&this.B(),this.H()},A.prototype.B=function(){var j=this;Z(function(){if(j.I()){var ee=s.console;typeof ee<"u"&&ee.error(j.i)}},1)},A.prototype.I=function(){if(this.o)return!1;var j=s.CustomEvent,ee=s.Event,z=s.dispatchEvent;return typeof z>"u"?!0:(typeof j=="function"?j=new j("unhandledrejection",{cancelable:!0}):typeof ee=="function"?j=new ee("unhandledrejection",{cancelable:!0}):(j=s.document.createEvent("CustomEvent"),j.initCustomEvent("unhandledrejection",!1,!0,j)),j.promise=this,j.reason=this.i,z(j))},A.prototype.H=function(){if(this.g!=null){for(var j=0;j<this.g.length;++j)H.h(this.g[j]);this.g=null}};var H=new F;return A.prototype.C=function(j){var ee=this.j();j.s(ee.resolve,ee.reject)},A.prototype.D=function(j,ee){var z=this.j();try{j.call(ee,z.resolve,z.reject)}catch(X){z.reject(X)}},A.prototype.then=function(j,ee){function z(he,fe){return typeof he=="function"?function(ge){try{X(he(ge))}catch(pe){ie(pe)}}:fe}var X,ie,de=new A(function(he,fe){X=he,ie=fe});return this.s(z(j,X),z(ee,ie)),de},A.prototype.catch=function(j){return this.then(void 0,j)},A.prototype.s=function(j,ee){function z(){switch(X.h){case 1:j(X.i);break;case 2:ee(X.i);break;default:throw Error("Unexpected state: "+X.h)}}var X=this;this.g==null?H.h(z):this.g.push(z),this.o=!0},A.resolve=P,A.reject=function(j){return new A(function(ee,z){z(j)})},A.race=function(j){return new A(function(ee,z){for(var X=o(j),ie=X.next();!ie.done;ie=X.next())P(ie.value).s(ee,z)})},A.all=function(j){var ee=o(j),z=ee.next();return z.done?P([]):new A(function(X,ie){function de(ge){return function(pe){he[ge]=pe,fe--,fe==0&&X(he)}}var he=[],fe=0;do he.push(void 0),fe++,P(z.value).s(de(he.length-1),ie),z=ee.next();while(!z.done)})},A});var m=typeof Object.assign=="function"?Object.assign:function(E,A){for(var F=1;F<arguments.length;F++){var P=arguments[F];if(P)for(var Z in P)Object.prototype.hasOwnProperty.call(P,Z)&&(E[Z]=P[Z])}return E};r("Object.assign",function(E){return E||m});var y=this||self,w={facingMode:"user",width:640,height:480};function b(E,A){this.video=E,this.i=0,this.h=Object.assign(Object.assign({},w),A)}b.prototype.stop=function(){var E=this,A,F,P,Z;return g(new p(new u(function(H){if(E.g){for(A=E.g.getTracks(),F=o(A),P=F.next();!P.done;P=F.next())Z=P.value,Z.stop();E.g=void 0}H.j=0})))},b.prototype.start=function(){var E=this,A;return g(new p(new u(function(F){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||alert("No navigator.mediaDevices.getUserMedia exists."),A=E.h,F.return(navigator.mediaDevices.getUserMedia({video:{facingMode:A.facingMode,width:A.width,height:A.height}}).then(function(P){k(E,P)}).catch(function(P){var Z="Failed to acquire camera feed: "+P;throw console.error(Z),alert(Z),P}))})))};function C(E){window.requestAnimationFrame(function(){$(E)})}function k(E,A){E.g=A,E.video.srcObject=A,E.video.onloadedmetadata=function(){E.video.play(),C(E)}}function $(E){var A=null;E.video.paused||E.video.currentTime===E.i||(E.i=E.video.currentTime,A=E.h.onFrame()),A?A.then(function(){C(E)}):C(E)}var I=["Camera"],T=y;I[0]in T||typeof T.execScript>"u"||T.execScript("var "+I[0]);for(var R;I.length&&(R=I.shift());)I.length||b===void 0?T[R]&&T[R]!==Object.prototype[R]?T=T[R]:T=T[R]={}:T[R]=b}).call(zn);var zs={};(function(){function t(p){var g=0;return function(){return g<p.length?{done:!1,value:p[g++]}:{done:!0}}}var e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,g,m){return p==Array.prototype||p==Object.prototype||(p[g]=m.value),p};function n(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof zn=="object"&&zn];for(var g=0;g<p.length;++g){var m=p[g];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var s=n(this);function r(p,g){if(g)e:{var m=s;p=p.split(".");for(var y=0;y<p.length-1;y++){var w=p[y];if(!(w in m))break e;m=m[w]}p=p[p.length-1],y=m[p],g=g(y),g!=y&&g!=null&&e(m,p,{configurable:!0,writable:!0,value:g})}}function i(p){var g=typeof Symbol<"u"&&Symbol.iterator&&p[Symbol.iterator];return g?g.call(p):{next:t(p)}}var o=typeof Object.assign=="function"?Object.assign:function(p,g){for(var m=1;m<arguments.length;m++){var y=arguments[m];if(y)for(var w in y)Object.prototype.hasOwnProperty.call(y,w)&&(p[w]=y[w])}return p};r("Object.assign",function(p){return p||o}),r("Array.prototype.fill",function(p){return p||function(g,m,y){var w=this.length||0;for(0>m&&(m=Math.max(0,w+m)),(y==null||y>w)&&(y=w),y=Number(y),0>y&&(y=Math.max(0,w+y)),m=Number(m||0);m<y;m++)this[m]=g;return this}});function a(p){return p||Array.prototype.fill}r("Int8Array.prototype.fill",a),r("Uint8Array.prototype.fill",a),r("Uint8ClampedArray.prototype.fill",a),r("Int16Array.prototype.fill",a),r("Uint16Array.prototype.fill",a),r("Int32Array.prototype.fill",a),r("Uint32Array.prototype.fill",a),r("Float32Array.prototype.fill",a),r("Float64Array.prototype.fill",a);var l=this||self;function c(p,g){p=p.split(".");var m=l;p[0]in m||typeof m.execScript>"u"||m.execScript("var "+p[0]);for(var y;p.length&&(y=p.shift());)p.length||g===void 0?m[y]&&m[y]!==Object.prototype[y]?m=m[y]:m=m[y]={}:m[y]=g}var u={color:"white",lineWidth:4,radius:6,visibilityMin:.5};function h(p){return p=p||{},Object.assign({},u,{fillColor:p.color},p)}function d(p,g){return p instanceof Function?p(g):p}function f(p,g,m){return Math.max(Math.min(g,m),Math.min(Math.max(g,m),p))}c("clamp",f),c("drawLandmarks",function(p,g,m){if(g){m=h(m),p.save();var y=p.canvas,w=0;g=i(g);for(var b=g.next();!b.done;b=g.next())if(b=b.value,b!==void 0&&(b.visibility===void 0||b.visibility>m.visibilityMin)){p.fillStyle=d(m.fillColor,{index:w,from:b}),p.strokeStyle=d(m.color,{index:w,from:b}),p.lineWidth=d(m.lineWidth,{index:w,from:b});var C=new Path2D;C.arc(b.x*y.width,b.y*y.height,d(m.radius,{index:w,from:b}),0,2*Math.PI),p.fill(C),p.stroke(C),++w}p.restore()}}),c("drawConnectors",function(p,g,m,y){if(g&&m){y=h(y),p.save();var w=p.canvas,b=0;m=i(m);for(var C=m.next();!C.done;C=m.next()){var k=C.value;p.beginPath(),C=g[k[0]],k=g[k[1]],C&&k&&(C.visibility===void 0||C.visibility>y.visibilityMin)&&(k.visibility===void 0||k.visibility>y.visibilityMin)&&(p.strokeStyle=d(y.color,{index:b,from:C,to:k}),p.lineWidth=d(y.lineWidth,{index:b,from:C,to:k}),p.moveTo(C.x*w.width,C.y*w.height),p.lineTo(k.x*w.width,k.y*w.height)),++b,p.stroke()}p.restore()}}),c("drawRectangle",function(p,g,m){m=h(m),p.save();var y=p.canvas;p.beginPath(),p.lineWidth=d(m.lineWidth,{}),p.strokeStyle=d(m.color,{}),p.fillStyle=d(m.fillColor,{}),p.translate(g.xCenter*y.width,g.yCenter*y.height),p.rotate(g.rotation*Math.PI/180),p.rect(-g.width/2*y.width,-g.height/2*y.height,g.width*y.width,g.height*y.height),p.translate(-g.xCenter*y.width,-g.yCenter*y.height),p.stroke(),p.fill(),p.restore()}),c("lerp",function(p,g,m,y,w){return f(y*(1-(p-g)/(m-g))+w*(1-(m-p)/(m-g)),y,w)})}).call(zn);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cte=1e-7,Ste=1e-4;class S5{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class yk{refCount(e){return or("refCount")}incRef(e){return or("incRef")}timerAvailable(){return!0}time(e){return or("time")}read(e){return or("read")}readSync(e){return or("readSync")}readToGPU(e,n){return or("readToGPU")}numDataIds(){return or("numDataIds")}disposeData(e,n){return or("disposeData")}write(e,n,s){return or("write")}move(e,n,s,r,i){return or("move")}createTensorFromGPUData(e,n,s){return or("createTensorFromGPUData")}memory(){return or("memory")}floatPrecision(){return or("floatPrecision")}epsilon(){return this.floatPrecision()===32?Cte:Ste}dispose(){return or("dispose")}}function or(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ite(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,ch(t,e,n)}function iu(t,e,n){return Math.max(t,Math.min(e,n))}function vk(t){return t%2===0?t:t+1}function ch(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function kte(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function L(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function xk(t,e,n=""){L(yt(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function I5(t){L(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function ue(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function yt(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function cd(t){return t%1===0}function EC(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function zh(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function K_(t,e=r=>0,n,s){return new Promise((r,i)=>{let o=0;const a=()=>{if(t()){r();return}o++;const l=e(o);if(n!=null&&o>=n){i();return}s!=null?s(a,l):setTimeout(a,l)};a()})}function k5(t,e){let n=1,s=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(t[i]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${i}`);s=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(s===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const r=t.slice();return r[s]=e/n,r}function tt(t,e){const n=e.length;return t=t==null?e.map((s,r)=>r):[].concat(t),L(t.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),L(t.every(s=>cd(s)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(s=>s<0?n+s:s)}function Gl(t,e){const n=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||r?null:tt(e,t).sort();let o=0;for(let a=0;a<t.length;++a){if(i!=null){if(i[o]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(i[o]==null||i[o]>a)&&t[a]===1&&(n.push(t[a]),s.push(a)),i[o]<=a&&o++}t[a]!==1&&(n.push(t[a]),s.push(a))}return{newShape:n,keptDims:s}}function ds(t,e){return an(t,e)}function an(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function Tte(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function Ete(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function T5(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function g2(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function Nte(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function vm(t){return typeof t=="string"||t instanceof String}function _te(t){return typeof t=="boolean"}function NC(t){return typeof t=="number"}function Ad(t){return Array.isArray(t)?Ad(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":NC(t)?"float32":vm(t)?"string":_te(t)?"bool":"float32"}function _C(t){return!!(t&&t.constructor&&t.call&&t.apply)}function $C(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Pe(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let s=e-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}function E5(t,e,n,s=!1){const r=new Array;if(e.length===1){const i=e[0]*(s?2:1);for(let o=0;o<i;o++)r[o]=n[t+o]}else{const i=e[0],o=e.slice(1),a=o.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<i;l++)r[l]=E5(t+l*a,o,n,s)}return r}function Bi(t,e,n=!1){if(t.length===0)return e[0];const s=t.reduce((r,i)=>r*i)*(n?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return E5(0,t,e,n)}function $te(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function wk(t,e){const n=fs(t,e);for(let s=0;s<n.length;s++)n[s]=1;return n}function fs(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function N5(t,e){const n=t.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return Bi(t,new Float32Array(n));if(e==="int32")return Bi(t,new Int32Array(n));if(e==="bool")return Bi(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function Ia(t){t.forEach(e=>{L(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function Co(t,e,n){if(e===0)return 0;if(e===1)return t[0];let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=n[r]*t[r];return s}function Dd(t,e,n){if(e===0)return[];if(e===1)return[t];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(t/n[r]),t-=s[r]*n[r];return s[s.length-1]=t,s}function bk(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q_="tfjsflags";class Rte{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Ate,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(oe().getBool("IS_TEST")||oe().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,s){if(this.flagRegistry[e]={evaluationFn:n,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];oe().getBool("IS_TEST")||oe().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(bk(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);q_ in e&&e[q_].split(",").forEach(s=>{const[r,i]=s.split(":");this.urlFlags[r]=Pte(r,i)})}}function Ate(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(Dte(e,s[0],s[1]),s.join("="))),e}function Dte(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function Pte(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function oe(){return _5}let _5=null;function Ote(t){_5=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Tw;function $5(){if(Tw==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");Tw=t}return Tw}function Fte(){const t=$5();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function Ck(t,e){const n=Fte();if(n.has(t))return n.get(t);{const s=e();return n.set(t,s),n.get(t)}}const Py="Abs",xm="Acos",wm="Acosh",Pd="Add",Sk="AddN",Ik="All",kk="Any",Oy="ArgMax",Fy="ArgMin",bm="Asin",Cm="Asinh",Sm="Atan",Im="Atanh",km="Atan2",Ly="AvgPool",Tk="AvgPoolGrad",My="AvgPool3D",Ek="AvgPool3DGrad",By="BatchMatMul",Vy="BatchToSpaceND",Nk="Bincount",_k="BitwiseAnd",Lte="BroadcastTo",R5="BroadcastArgs",Tm="Cast",Em="Ceil",Nm="ClipByValue",$k="Complex",Uy="ComplexAbs",zy="Concat",Wy="Conv2D",Rk="Conv2DBackpropFilter",jy="Conv2DBackpropInput",Gy="Conv3D",Ak="Conv3DBackpropFilterV2",Dk="Conv3DBackpropInputV2",_m="Cos",$m="Cosh",Pk="Cumprod",Hy="Cumsum",Ok="CropAndResize",Fk="DenseBincount",Lk="DepthToSpace",Ky="DepthwiseConv2dNative",Mk="DepthwiseConv2dNativeBackpropFilter",Bk="DepthwiseConv2dNativeBackpropInput",A5="Diag",qy="Dilation2D",RC="Dilation2DBackpropInput",AC="Dilation2DBackpropFilter",Mte="Draw",Rm="RealDiv",Vk="Einsum",Am="Elu",Uk="EluGrad",Dm="Erf",Xy="Equal",Pm="Exp",Yy="ExpandDims",Om="Expm1",zk="FFT",Wk="Fill",jk="FlipLeftRight",Fm="Floor",Lm="FloorDiv",Jy="FusedBatchNorm",Zy="GatherV2",D5="GatherNd",Qy="Greater",Mm="GreaterEqual",Bm="Identity",Gk="IFFT",Hk="Imag",Vm="IsFinite",Um="IsInf",zm="IsNan",ev="LeakyRelu",tv="Less",nv="LessEqual",P5="LinSpace",Wm="Log",jm="Log1p",sv="LogicalAnd",rv="LogicalNot",iv="LogicalOr",Bte="LogSoftmax",ov="LRN",Kk="LRNGrad",av="Max",Gm="Maximum",lv="MaxPool",qk="MaxPoolGrad",cv="MaxPool3D",Xk="MaxPool3DGrad",O5="MaxPoolWithArgmax",uv="Mean",hv="Min",Hm="Minimum",dv="MirrorPad",Km="Mod",F5="Multinomial",qm="Multiply",fv="Neg",pv="NotEqual",Yk="NonMaxSuppressionV3",Jk="NonMaxSuppressionV4",Zk="NonMaxSuppressionV5",mv="OnesLike",gv="OneHot",yv="Pack",vv="PadV2",Xm="Pow",xv="Prelu",wv="Prod",L5="RaggedGather",M5="RaggedRange",B5="RaggedTensorToTensor",Qk="Range",eT="Real",Ym="Reciprocal",Jm="Relu",bv="Reshape",Cv="ResizeNearestNeighbor",tT="ResizeNearestNeighborGrad",Sv="ResizeBilinear",nT="ResizeBilinearGrad",Zm="Relu6",Iv="Reverse",Qm="Round",eg="Rsqrt",V5="ScatterNd",U5="TensorScatterUpdate",z5="SearchSorted",kv="Select",tg="Selu",Tv="Slice",ng="Sin",sg="Sinh",rg="Sign",ig="Sigmoid",og="Softplus",ag="Sqrt",Ev="Sum",Nv="SpaceToBatchND",_v="SplitV",$v="Softmax",W5="SparseFillEmptyRows",j5="SparseReshape",G5="SparseSegmentMean",H5="SparseSegmentSum",K5="SparseToDense",lg="SquaredDifference",sT="Square",rT="StaticRegexReplace",iT="StridedSlice",q5="StringNGrams",X5="StringSplit",Y5="StringToHashBucketFast",cg="Sub",ug="Tan",hg="Tanh",dg="Tile",oT="TopK",aT="Transform",Wh="Transpose",lT="Unique",Rv="Unpack",Av="UnsortedSegmentSum",Dv="ZerosLike",fg="Step",Vte="FromPixels",cT="RotateWithOffset",y2="_FusedMatMul",v2="FusedConv2D",J5="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Or(...t){oe().getBool("IS_TEST")||oe().getBool("PROD")||console.warn(...t)}function Ute(...t){oe().getBool("IS_TEST")||oe().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x2=Ck("kernelRegistry",()=>new Map),DC=Ck("gradRegistry",()=>new Map);function X_(t,e){const n=Q5(t,e);return x2.get(n)}function Y_(t){return DC.get(t)}function J_(t){const e=x2.entries(),n=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[i,o]=r,[a]=i.split("_");a===t&&n.push(o)}return n}function Z5(t){const{kernelName:e,backendName:n}=t,s=Q5(e,n);x2.has(s)&&Or(`The kernel '${e}' for backend '${n}' is already registered`),x2.set(s,t)}function zte(t){const{kernelName:e}=t;DC.has(e)&&oe().getBool("DEBUG")&&Or(`Overriding the gradient for '${e}'`),DC.set(e,t)}function Q5(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eL(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var tL=Bt,ci=null;try{ci=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Bt(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Bt.prototype.__isLong__;Object.defineProperty(Bt.prototype,"__isLong__",{value:!0});function Sr(t){return(t&&t.__isLong__)===!0}Bt.isLong=Sr;var Z_={},Q_={};function Tu(t,e){var n,s,r;return e?(t>>>=0,(r=0<=t&&t<256)&&(s=Q_[t],s)?s:(n=Vt(t,(t|0)<0?-1:0,!0),r&&(Q_[t]=n),n)):(t|=0,(r=-128<=t&&t<128)&&(s=Z_[t],s)?s:(n=Vt(t,t<0?-1:0,!1),r&&(Z_[t]=n),n))}Bt.fromInt=Tu;function ui(t,e){if(isNaN(t))return e?Fc:hi;if(e){if(t<0)return Fc;if(t>=nL)return iL}else{if(t<=-t$)return pr;if(t+1>=t$)return rL}return t<0?ui(-t,e).neg():Vt(t%ud|0,t/ud|0,e)}Bt.fromNumber=ui;function Vt(t,e,n){return new Bt(t,e,n)}Bt.fromBits=Vt;var w2=Math.pow;function uT(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return hi;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return uT(t.substring(1),e,n).neg();for(var r=ui(w2(n,8)),i=hi,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+a),n);if(a<8){var c=ui(w2(n,a));i=i.mul(c).add(ui(l))}else i=i.mul(r),i=i.add(ui(l))}return i.unsigned=e,i}Bt.fromString=uT;function Ki(t,e){return typeof t=="number"?ui(t,e):typeof t=="string"?uT(t,e):Vt(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Bt.fromValue=Ki;var e$=65536,Wte=1<<24,ud=e$*e$,nL=ud*ud,t$=nL/2,n$=Tu(Wte),hi=Tu(0);Bt.ZERO=hi;var Fc=Tu(0,!0);Bt.UZERO=Fc;var Rh=Tu(1);Bt.ONE=Rh;var sL=Tu(1,!0);Bt.UONE=sL;var PC=Tu(-1);Bt.NEG_ONE=PC;var rL=Vt(-1,2147483647,!1);Bt.MAX_VALUE=rL;var iL=Vt(-1,-1,!0);Bt.MAX_UNSIGNED_VALUE=iL;var pr=Vt(0,-2147483648,!1);Bt.MIN_VALUE=pr;var Ie=Bt.prototype;Ie.toInt=function(){return this.unsigned?this.low>>>0:this.low};Ie.toNumber=function(){return this.unsigned?(this.high>>>0)*ud+(this.low>>>0):this.high*ud+(this.low>>>0)};Ie.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(pr)){var n=ui(e),s=this.div(n),r=s.mul(n).sub(this);return s.toString(e)+r.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=ui(w2(e,6),this.unsigned),o=this,a="";;){var l=o.div(i),c=o.sub(l.mul(i)).toInt()>>>0,u=c.toString(e);if(o=l,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};Ie.getHighBits=function(){return this.high};Ie.getHighBitsUnsigned=function(){return this.high>>>0};Ie.getLowBits=function(){return this.low};Ie.getLowBitsUnsigned=function(){return this.low>>>0};Ie.getNumBitsAbs=function(){if(this.isNegative())return this.eq(pr)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};Ie.isZero=function(){return this.high===0&&this.low===0};Ie.eqz=Ie.isZero;Ie.isNegative=function(){return!this.unsigned&&this.high<0};Ie.isPositive=function(){return this.unsigned||this.high>=0};Ie.isOdd=function(){return(this.low&1)===1};Ie.isEven=function(){return(this.low&1)===0};Ie.equals=function(e){return Sr(e)||(e=Ki(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};Ie.eq=Ie.equals;Ie.notEquals=function(e){return!this.eq(e)};Ie.neq=Ie.notEquals;Ie.ne=Ie.notEquals;Ie.lessThan=function(e){return this.comp(e)<0};Ie.lt=Ie.lessThan;Ie.lessThanOrEqual=function(e){return this.comp(e)<=0};Ie.lte=Ie.lessThanOrEqual;Ie.le=Ie.lessThanOrEqual;Ie.greaterThan=function(e){return this.comp(e)>0};Ie.gt=Ie.greaterThan;Ie.greaterThanOrEqual=function(e){return this.comp(e)>=0};Ie.gte=Ie.greaterThanOrEqual;Ie.ge=Ie.greaterThanOrEqual;Ie.compare=function(e){if(Sr(e)||(e=Ki(e)),this.eq(e))return 0;var n=this.isNegative(),s=e.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Ie.comp=Ie.compare;Ie.negate=function(){return!this.unsigned&&this.eq(pr)?pr:this.not().add(Rh)};Ie.neg=Ie.negate;Ie.add=function(e){Sr(e)||(e=Ki(e));var n=this.high>>>16,s=this.high&65535,r=this.low>>>16,i=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,h=0,d=0,f=0;return f+=i+c,d+=f>>>16,f&=65535,d+=r+l,h+=d>>>16,d&=65535,h+=s+a,u+=h>>>16,h&=65535,u+=n+o,u&=65535,Vt(d<<16|f,u<<16|h,this.unsigned)};Ie.subtract=function(e){return Sr(e)||(e=Ki(e)),this.add(e.neg())};Ie.sub=Ie.subtract;Ie.multiply=function(e){if(this.isZero())return hi;if(Sr(e)||(e=Ki(e)),ci){var n=ci.mul(this.low,this.high,e.low,e.high);return Vt(n,ci.get_high(),this.unsigned)}if(e.isZero())return hi;if(this.eq(pr))return e.isOdd()?pr:hi;if(e.eq(pr))return this.isOdd()?pr:hi;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(n$)&&e.lt(n$))return ui(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,r=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,h=0,d=0,f=0,p=0;return p+=o*u,f+=p>>>16,p&=65535,f+=i*u,d+=f>>>16,f&=65535,f+=o*c,d+=f>>>16,f&=65535,d+=r*u,h+=d>>>16,d&=65535,d+=i*c,h+=d>>>16,d&=65535,d+=o*l,h+=d>>>16,d&=65535,h+=s*u+r*c+i*l+o*a,h&=65535,Vt(f<<16|p,h<<16|d,this.unsigned)};Ie.mul=Ie.multiply;Ie.divide=function(e){if(Sr(e)||(e=Ki(e)),e.isZero())throw Error("division by zero");if(ci){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?ci.div_u:ci.div_s)(this.low,this.high,e.low,e.high);return Vt(n,ci.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Fc:hi;var s,r,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Fc;if(e.gt(this.shru(1)))return sL;i=Fc}else{if(this.eq(pr)){if(e.eq(Rh)||e.eq(PC))return pr;if(e.eq(pr))return Rh;var o=this.shr(1);return s=o.div(e).shl(1),s.eq(hi)?e.isNegative()?Rh:PC:(r=this.sub(e.mul(s)),i=s.add(r.div(e)),i)}else if(e.eq(pr))return this.unsigned?Fc:hi;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=hi}for(r=this;r.gte(e);){s=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(s)/Math.LN2),l=a<=48?1:w2(2,a-48),c=ui(s),u=c.mul(e);u.isNegative()||u.gt(r);)s-=l,c=ui(s,this.unsigned),u=c.mul(e);c.isZero()&&(c=Rh),i=i.add(c),r=r.sub(u)}return i};Ie.div=Ie.divide;Ie.modulo=function(e){if(Sr(e)||(e=Ki(e)),ci){var n=(this.unsigned?ci.rem_u:ci.rem_s)(this.low,this.high,e.low,e.high);return Vt(n,ci.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Ie.mod=Ie.modulo;Ie.rem=Ie.modulo;Ie.not=function(){return Vt(~this.low,~this.high,this.unsigned)};Ie.and=function(e){return Sr(e)||(e=Ki(e)),Vt(this.low&e.low,this.high&e.high,this.unsigned)};Ie.or=function(e){return Sr(e)||(e=Ki(e)),Vt(this.low|e.low,this.high|e.high,this.unsigned)};Ie.xor=function(e){return Sr(e)||(e=Ki(e)),Vt(this.low^e.low,this.high^e.high,this.unsigned)};Ie.shiftLeft=function(e){return Sr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Vt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Vt(0,this.low<<e-32,this.unsigned)};Ie.shl=Ie.shiftLeft;Ie.shiftRight=function(e){return Sr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Vt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Vt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Ie.shr=Ie.shiftRight;Ie.shiftRightUnsigned=function(e){if(Sr(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var s=this.low;return Vt(s>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?Vt(n,0,this.unsigned):Vt(n>>>e-32,0,this.unsigned)};Ie.shru=Ie.shiftRightUnsigned;Ie.shr_u=Ie.shiftRightUnsigned;Ie.toSigned=function(){return this.unsigned?Vt(this.low,this.high,!1):this};Ie.toUnsigned=function(){return this.unsigned?this:Vt(this.low,this.high,!0)};Ie.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Ie.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Ie.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Bt.fromBytes=function(e,n,s){return s?Bt.fromBytesLE(e,n):Bt.fromBytesBE(e,n)};Bt.fromBytesLE=function(e,n){return new Bt(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Bt.fromBytesBE=function(e,n){return new Bt(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const oL=pS(tL),jte=VR({__proto__:null,default:oL},[tL]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nc=oL||jte;function Pv(t){return Nc.fromString(t,!0,16)}const aL=Pv("c3a5c85c97cb3127"),Ec=Pv("b492b66fbe98f273"),Es=Pv("9ae16a3b2f90404f");function OC(t){return t.xor(t.shru(47))}function lL(t,e,n){const s=t.slice(e,e+n);return Nc.fromBytes(Array.from(s),!0,!0)}function Dt(t,e){return lL(t,e,8)}function s$(t,e){return lL(t,e,4)}function Mn(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function Cl(t,e,n=Pv("9ddfea08eb382d69")){let s=t.xor(e).mul(n);s=s.xor(s.shru(47));let r=e.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function Gte(t,e,n,s,r,i){r=r.add(t),i=Mn(i.add(r).add(s),21);const o=r;return r=r.add(e),r=r.add(n),i=i.add(Mn(r,44)),[r.add(s),i.add(o)]}function L0(t,e,n,s){return Gte(Dt(t,e),Dt(t,e+8),Dt(t,e+16),Dt(t,e+24),n,s)}function Hte(t,e=t.length){if(e>=8){const n=Es.add(e*2),s=Dt(t,0).add(Es),r=Dt(t,e-8),i=Mn(r,37).mul(n).add(s),o=Mn(s,25).add(r).mul(n);return Cl(i,o,n)}if(e>=4){const n=Es.add(e*2),s=s$(t,0);return Cl(s.shl(3).add(e),s$(t,e-4),n)}if(e>0){const n=t[0],s=t[e>>1],r=t[e-1],i=n+(s<<8),o=e+(r<<2);return OC(Es.mul(i).xor(aL.mul(o))).mul(Es)}return Es}function Kte(t,e=t.length){const n=Es.add(e*2),s=Dt(t,0).mul(Ec),r=Dt(t,8),i=Dt(t,e-8).mul(n),o=Dt(t,e-16).mul(Es);return Cl(Mn(s.add(r),43).add(Mn(i,30)).add(o),s.add(Mn(r.add(Es),18)).add(i),n)}function qte(t,e=t.length){const n=Es.add(e*2),s=Dt(t,0).mul(Es),r=Dt(t,8),i=Dt(t,e-8).mul(n),o=Dt(t,e-16).mul(Es),a=Mn(s.add(r),43).add(Mn(i,30)).add(o),l=Cl(a,s.add(Mn(r.add(Es),18)).add(i),n),c=Dt(t,16).mul(n),u=Dt(t,24),h=a.add(Dt(t,e-32)).mul(n),d=l.add(Dt(t,e-24)).mul(n);return Cl(Mn(c.add(u),43).add(Mn(h,30)).add(d),c.add(Mn(u.add(s),18)).add(h),n)}function Xte(t,e=t.length){const n=Nc.fromNumber(81,!0);if(e<=32)return e<=16?Hte(t,e):Kte(t,e);if(e<=64)return qte(t,e);let s=n,r=n.mul(Ec).add(113),i=OC(r.mul(Es).add(113)).mul(Es),o=[Nc.UZERO,Nc.UZERO],a=[Nc.UZERO,Nc.UZERO];s=s.mul(Es).add(Dt(t,0));let l=0;const c=(e-1>>6)*64,u=c+(e-1&63)-63;do s=Mn(s.add(r).add(o[0]).add(Dt(t,l+8)),37).mul(Ec),r=Mn(r.add(o[1]).add(Dt(t,l+48)),42).mul(Ec),s=s.xor(a[1]),r=r.add(o[0]).add(Dt(t,l+40)),i=Mn(i.add(a[0]),33).mul(Ec),o=L0(t,l,o[1].mul(Ec),s.add(a[0])),a=L0(t,l+32,i.add(a[1]),r.add(Dt(t,l+16))),[i,s]=[s,i],l+=64;while(l!==c);const h=Ec.add(i.and(255).shl(1));return l=u,a[0]=a[0].add(e-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),s=Mn(s.add(r).add(o[0]).add(Dt(t,l+8)),37).mul(h),r=Mn(r.add(o[1]).add(Dt(t,l+48)),42).mul(h),s=s.xor(a[1].mul(9)),r=r.add(o[0].mul(9).add(Dt(t,l+40))),i=Mn(i.add(a[0]),33).mul(h),o=L0(t,l,o[1].mul(h),s.add(a[0])),a=L0(t,l+32,i.add(a[1]),r.add(Dt(t,l+16))),[i,s]=[s,i],Cl(Cl(o[0],a[0],h).add(OC(r).mul(aL)).add(i),Cl(o[1],a[1],h).add(s),h)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hl(t,e){return e==="string"?Sl(t):Eu([t],e)}function Yte(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Eu(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=ou(t)),oe().getBool("DEBUG")&&Tte(t,e),Yte(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let s=0;s<n.length;++s)Math.round(t[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${e}`)}function Hs(){return oe().platform.now()}function Sl(t,e="utf-8"){return e=e||"utf-8",oe().platform.encode(t,e)}function Rl(t,e="utf-8"){return e=e||"utf-8",oe().platform.decode(t,e)}function vi(t){return oe().platform.isTypedArray!=null?oe().platform.isTypedArray(t):eL(t)}function ou(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||bk(t)||t==null||vi(t)&&n)e.push(t);else if(Array.isArray(t)||vi(t))for(let s=0;s<t.length;++s)ou(t[s],e,n);else{let s=-1;for(const r of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)ou(t[r],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jte{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new Qte)}profileKernel(e,n,s){let r;const i=()=>{r=s()};let o;const a=Hs();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const c of r)c.dataSync();o=Promise.resolve({kernelMs:Hs()-a})}if(oe().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const u=r[c];u.data().then(h=>{Zte(h,u.dtype,e)})}return{kernelName:e,outputs:r,inputs:n,timeMs:o.then(c=>c.kernelMs),extraInfo:o.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:s,timeMs:r,inputs:i,extraInfo:o}=e;s.forEach(a=>{Promise.all([a.data(),r,o]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],i,l[2])})})}}function Zte(t,e,n){if(e!=="float32")return!1;for(let s=0;s<t.length;s++){const r=t[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class Qte{logKernelProfile(e,n,s,r,i,o){const a=typeof r=="number"?zh(`${r}ms`,9):r.error,l=zh(e,25),c=n.rank,u=n.size,h=zh(n.shape.toString(),14);let d="";for(const f in i){const p=i[f];if(p!=null){const g=p.shape||n.shape,m=g.length;d+=`${f}: ${m}D ${m>0?g:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${h}	%c${u}	%c${d}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ene(t,e,n){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<t.length;l++){const c=t[l],u=c.inputs;for(const h in u){const d=u[h];let f=!1;for(let p=0;p<e.length;p++)if(s[d.id]){c.outputs.forEach(g=>s[g.id]=!0),f=!0,r[c.id]=!0;break}if(f)break}}const i={};i[n.id]=!0;const o={};for(let l=t.length-1;l>=0;l--){const c=t[l],u=c.inputs;for(let h=0;h<c.outputs.length;h++)if(i[c.outputs[h].id]){for(const d in u)i[u[d].id]=!0,o[c.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const c=t[l];if(r[c.id]&&o[c.id]){const u={};for(const d in c.inputs){const f=c.inputs[d];s[f.id]&&(u[d]=f)}const h=Object.assign({},c);h.inputs=u,h.outputs=c.outputs,a.push(h)}}return a}function tne(t,e,n,s){for(let r=e.length-1;r>=0;r--){const i=e[r],o=[];if(i.outputs.forEach(l=>{const c=t[l.id];c!=null?o.push(c):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const a=i.gradient(o);for(const l in i.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=n(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=i.inputs[l];if(!yt(c.shape,u.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(t[u.id]==null)t[u.id]=c;else{const h=t[u.id];t[u.id]=s(h,c),h.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r$=20,kf=3,Ew=7;function nne(t,e,n,s){const r=Pe(e),i=sne(t,e,n,r),o=e.length,a=w1(t,e,n,r,i),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function sne(t,e,n,s){const r=ue(e),i=s[s.length-1],o=new Array(i).fill(0),a=e.length,l=n==="complex64"?zf(t):t;if(a>1)for(let c=0;c<r/i;c++){const u=c*i;for(let h=0;h<i;h++)o[h]=Math.max(o[h],Uf(l[u+h],0,n).length)}return o}function Uf(t,e,n){let s;return Array.isArray(t)?s=`${parseFloat(t[0].toFixed(Ew))} + ${parseFloat(t[1].toFixed(Ew))}j`:vm(t)?s=`'${t}'`:n==="bool"?s=cL(t):s=parseFloat(t.toFixed(Ew)).toString(),zh(s,e)}function cL(t){return t===0?"false":"true"}function w1(t,e,n,s,r,i=!0){const o=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const g=zf(t);return[Uf(g[0],0,n)]}return n==="bool"?[cL(t[0])]:[t[0].toString()]}if(l===1){if(a>r$){const m=kf*o;let y=Array.from(t.slice(0,m)),w=Array.from(t.slice((a-kf)*o,a*o));return n==="complex64"&&(y=zf(y),w=zf(w)),["["+y.map((b,C)=>Uf(b,r[C],n)).join(", ")+", ..., "+w.map((b,C)=>Uf(b,r[a-kf+C],n)).join(", ")+"]"]}return["["+(n==="complex64"?zf(t):Array.from(t)).map((m,y)=>Uf(m,r[y],n)).join(", ")+"]"]}const c=e.slice(1),u=s.slice(1),h=s[0]*o,d=[];if(a>r$){for(let g=0;g<kf;g++){const m=g*h,y=m+h;d.push(...w1(t.slice(m,y),c,n,u,r,!1))}d.push("...");for(let g=a-kf;g<a;g++){const m=g*h,y=m+h;d.push(...w1(t.slice(m,y),c,n,u,r,g===a-1))}}else for(let g=0;g<a;g++){const m=g*h,y=m+h;d.push(...w1(t.slice(m,y),c,n,u,r,g===a-1))}const f=l===2?",":"";d[0]="["+(a>0?d[0]+f:"");for(let g=1;g<d.length-1;g++)d[g]=" "+d[g]+f;let p=`,
`;for(let g=2;g<l;g++)p+=`
`;return d[d.length-1]=" "+d[d.length-1]+"]"+(i?"":p),d}function zf(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zn{constructor(e,n,s){if(this.dtype=n,this.shape=e.slice(),this.size=ue(e),s!=null){const r=s.length;L(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||an(n,this.size),this.strides=Pe(e)}set(e,...n){n.length===0&&(n=[0]),L(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const r of e){if(r<0||r>=this.shape[n]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}n++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(e/this.strides[s]),e-=n[s]*this.strides[s];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return Di().makeTensor(this.values,this.shape,this.dtype)}}let Di=null,uh=null;function rne(t){Di=t}function ine(t){uh=t}class kn{constructor(e,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=ue(e),this.strides=Pe(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return uh.buffer(this.shape,this.dtype,e)}bufferSync(){return uh.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Bi(this.shape,e,this.dtype==="complex64")}arraySync(){return Bi(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Di().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(s=>Rl(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Di().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Di().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>Rl(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Di().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Di().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return uh.print(this,e)}clone(){return this.throwIfDisposed(),uh.clone(this)}toString(e=!1){const n=this.dataSync();return nne(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),uh.cast(this,e)}variable(e=!0,n,s){return this.throwIfDisposed(),Di().makeVariable(this,e,n,s)}}Object.defineProperty(kn,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function ce(){return Ck("Tensor",()=>kn)}ce();class b2 extends kn{constructor(e,n,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=n,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!yt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Di().disposeTensor(this),this.dataId=e.dataId,Di().incRef(this,null)}dispose(){Di().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(b2,Symbol.hasInstance,{value:t=>t instanceof kn&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var i$;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(i$||(i$={}));var FC;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(FC||(FC={}));var LC;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(LC||(LC={}));var MC;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(MC||(MC={}));var BC;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(BC||(BC={}));const one={float32:MC,int32:FC,bool:LC,complex64:BC};function xr(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return one[t][e]}function hT(t){return xr(t,"int32")}function uL(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function hL(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cn(t,e){if(t.dtype===e.dtype)return[t,e];const n=xr(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function dL(t){const e=[];return fL(t,e,new Set),e}function fL(t,e,n){if(t==null)return;if(t instanceof kn){e.push(t);return}if(!ane(t))return;const s=t;for(const r in s){const i=s[r];n.has(i)||(n.add(i),fL(i,e,n))}}function ane(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nw(t){return t.kernelName!=null}class o${constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class hd{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new o$}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,s=1){return e in this.registryFactory?(Or(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(e);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Jte(this.backendInstance),!0}setupRegisteredKernels(){J_(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){J_(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof yk)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,i=s.then(o=>r<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Or(`Initialization of backend ${e} failed`),Or(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return Or(`Initialization of backend ${e} failed`),Or(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n],{success:r,asyncInit:i}=this.initializeBackend(s);if(i||r)return{name:s,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const s=this.state.tensorInfo.get(n),r=s.backend,i=this.readSync(n),o=r.refCount(n);r.disposeData(n,!0),s.backend=e,e.move(n,i,s.shape,s.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let s=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,n,s){e();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return hd.nextTensorId++}nextVariableId(){return hd.nextVariableId++}clone(e){const n=Q.runKernel(Bm,{x:e}),s={x:e},r=o=>({x:()=>{const a="float32",l={x:o},c={dtype:a};return Q.runKernel(Tm,l,c)}}),i=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,i,{}),n}runKernel(e,n,s){if(this.backendName==null&&this.backend,!(X_(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,s){const r=this.backend.numDataIds();let i=0;s.forEach(l=>{i+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-n-i-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,s=[];const r=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const c=Nw(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Nw(e)){const{kernelName:p,inputs:g,attrs:m}=e;this.backendName==null&&this.backend;const y=X_(p,this.backendName);L(y!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const w=this.backend.numDataIds();l=y.kernelFunc({inputs:g,attrs:m,backend:this.backend});const b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,w,b);const C=b.map(k=>k.rank!=null?k:this.makeTensorFromTensorInfo(k));if(r){const k=this.getTensorsForGradient(p,g,C);s=this.saveTensorsForBackwardMode(k)}return C}}else{const{forwardFunc:p}=e,g=m=>{r&&(s=m.map(y=>this.keep(this.clone(y))))};a=()=>{const m=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,g));const y=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,m,y),y}}const{inputs:u,attrs:h}=e,d=Nw(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(f=this.profiler.profileKernel(c,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),r&&this.addTapeNode(c,u,n,d,s,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(p=>u[p]!=null?u[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,n,s){const r=Y_(e);if(r!=null){const i=r.inputsToSave||[],o=r.outputsToSave||[];let a;r.saveAllInputs?(L(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(c=>n[c])):a=i.map(c=>n[c]);const l=s.filter((c,u)=>o[u]);return a.concat(l)}return[]}makeTensor(e,n,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let i=e;s==="string"&&vm(e[0])&&(i=e.map(l=>Sl(l)));const o=r.write(i,n,s),a=new kn(n,s,o,this.nextTensorId());if(this.trackTensor(a,r),s==="string"){const l=this.state.tensorInfo.get(o),c=Nte(i);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(e,n,s,r){s=s||"float32";const i={dataId:e,shape:n,dtype:s};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(e,n){const{dataId:s,shape:r,dtype:i}=e,o=new kn(r,i,s,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const i=new b2(e,n,s,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*g2(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof b2||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*g2(e.dtype);this.state.numBytes-=s}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,s,r,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:s,saved:i},l=Y_(e);l!=null&&(r=l.gradFunc),r!=null&&(a.gradient=c=>(c=c.map((u,h)=>{if(u==null){const d=s[h],f=fs(d.size,d.dtype);return this.makeTensor(f,d.shape,d.dtype)}return u}),r(c.length>1?c:c[0],i,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=dL(e),s=new Set(n.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!s.has(o.id)&&o.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(i=>{!i.kept&&i.scopeId===r.id&&this.track(i)})}gradients(e,n,s,r=!1){if(L(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));L(i instanceof kn,()=>"The result y returned by f() must be a tensor.");const o=ene(this.state.activeTape,n,i);if(!r&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[i.id]=s??lne(i.shape),tne(a,o,c=>this.tidy(c),cne);const l=n.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return L(_C(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{L(n.every(a=>a instanceof kn),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((a,l)=>{r[l]=a});const i=(a,l)=>(s=e(...n,l),L(s.value instanceof kn,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),L(_C(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),o=(a,l)=>{const c=s.gradFunc(a,l),u=Array.isArray(c)?c:[c];L(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),L(u.every(d=>d instanceof kn),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const h={};return u.forEach((d,f)=>{h[f]=()=>d}),h};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=Hs(),s=await this.backend.time(e);return s.wallMs=Hs()-n,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new o$;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}hd.nextTensorId=0;hd.nextVariableId=0;function lne(t){const e=wk(ue(t),"float32");return Q.makeTensor(e,t,"float32")}function pL(){const t=$5();if(t._tfengine==null){const e=new Rte(t);t._tfengine=new hd(e)}return Ote(t._tfengine.ENV),rne(()=>t._tfengine),t._tfengine}const Q=pL();function cne(t,e){const n={a:t,b:e};return Q.runKernel(Pd,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function une(){return typeof navigator<"u"&&navigator!=null}function mL(t){if(t||une()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function gL(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zs=oe();Zs.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Zs.registerFlag("IS_BROWSER",()=>gL());Zs.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Zs.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Zs.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Zs.registerFlag("PROD",()=>!1);Zs.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Zs.getBool("DEBUG"));Zs.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Zs.registerFlag("IS_TEST",()=>!1);Zs.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Zs.getBool("DEBUG"));Zs.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Zs.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Zs.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ov(t,e){let n=t;if(vi(t))return e==="string"?[]:[t.length];if(uL(t)){const r=t.channels||"RGBA";return[t.height,t.width*r.length]}else if(hL(t))return[t.buffer.size/(e==null?4:g2(e))];if(!Array.isArray(t))return[];const s=[];for(;Array.isArray(n)||vi(n)&&e!=="string";)s.push(n.length),n=n[0];return Array.isArray(t)&&oe().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&yL(t,s,[]),s}function yL(t,e,n){if(n=n||[],!Array.isArray(t)&&!vi(t)){L(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}L(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),L(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const s=e.slice(1);for(let r=0;r<t.length;++r)yL(t[r],s,n.concat(r))}function a$(t,e,n,s){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${t} tensor, but got ${e} tensor`)}}function G(t,e,n,s="numeric"){if(t instanceof ce())return a$(s,t.dtype,e,n),t;let r=Ad(t);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),a$(s,r,e,n),t==null||!vi(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const i=Ov(t,r);!vi(t)&&!Array.isArray(t)&&(t=[t]);const a=r!=="string"?Eu(t,r):ou(t,[],!0);return Q.makeTensor(a,i,r)}function vL(t,e,n,s="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((i,o)=>G(i,`${e}[${o}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hne="__op";function ne(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+hne;const r=(...i)=>{Q.startScope(n);try{const o=s(...i);return bk(o)&&console.error("Cannot return a Promise inside of tidy."),Q.endScope(o),o}catch(o){throw Q.endScope(null),o}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dne(t,e){const n=G(t,"real","complex"),s=G(e,"imag","complex");xk(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return Q.runKernel($k,r)}const au=ne({complex_:dne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fv(t,e,n,s){if(s==null)s=Ad(t);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(hL(t)||uL(t)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return Q.backend.createTensorFromGPUData(t,e||n,s)}if(!vi(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Ia(e);const r=ue(e),i=ue(n);L(r===i,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${i}`);for(let o=0;o<n.length;++o){const a=n[o],l=o===n.length-1?a!==ue(e.slice(o)):!0;L(n[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!vi(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=s!=="string"?Eu(t,s):ou(t,[],!0),Q.makeTensor(t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gc(t,e,n){const s=Ov(t,n);return Fv(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C2={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Kl{static join(e){return new Kl(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>vi(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=n+r.byteLength;this.shards.push({buffer:r,start:n,end:i}),n=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=n-e,i=new ArrayBuffer(r),o=new Uint8Array(i);let a=0;for(let l=s;l<this.shards.length;l++){const c=this.shards[l],h=e+a-c.start,d=a,p=Math.min(n,c.end)-c.start,g=new Uint8Array(c.buffer,h,p-h);if(o.set(g,d),a+=g.length,n<c.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(r){return e<r.start?-1:e>=r.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=fne(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function fne(t,e){let n=0,s=t.length;for(;n<=s;){const r=Math.floor((s-n)/2)+n,i=e(t[r]);if(i===0)return r;i<0?s=r:n=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function io(){return Q}function l$(){return Q.memory()}function re(t,e){return Q.tidy(t,e)}function Ze(t){dL(t).forEach(n=>n.dispose())}function So(t){return Q.keep(t)}function xL(t,e,n=1){return Q.registerBackend(t,e,n)}function pne(){return Q.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dd=4;async function c$(t,e){const n=[],s=[],r=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<r.length;++o){const a=r[o],l=Array.isArray(t)?t[o].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async h=>{const d=await l.bytes(),f=d.reduce((m,y)=>m+y.length,0)+dd*d.length,p=new Uint8Array(f);let g=0;for(let m=0;m<d.length;m++){const y=d[m],w=new Uint8Array(new Uint32Array([y.length]).buffer);p.set(w,g),g+=dd,p.set(y,g),g+=y.length}h(p)});s.push(u)}else s.push(l.data());e!=null&&(c.group=e),n.push(c)}const i=await Promise.all(s);return{data:vne(i),specs:n}}function mne(t,e){const n=new Kl(t),s={};let r=0;for(const i of e){const o=gne(i,(a,l)=>n.slice(r+a,r+l));s[i.name]=yne(i,n.slice(r,r+o)),r+=o}return s}function gne(t,e){const n=ue(t.shape);let s;if("quantization"in t){const r=t.quantization;s=C2[r.dtype]}else if(t.dtype==="string"){let r=0;for(let i=0;i<n;i++)r+=dd+new Uint32Array(e(r,r+dd))[0];return r}else s=C2[t.dtype];return n*s}function yne(t,e){const n=t.name,s=t.dtype,r=t.shape,i=ue(r);let o,a=0;if("quantization"in t){const l=t.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${t.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${t.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const c=C2[l.dtype],u=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(s==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){o=new Float32Array(u.length);for(let h=0;h<u.length;h++){const d=u[h];o[h]=d*l.scale+l.min}}else if(l.dtype==="float16")o=Nne()(u);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(s==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);o=new Int32Array(u.length);for(let h=0;h<u.length;h++){const d=u[h];o[h]=Math.round(d*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);a+=i*c}else if(s==="string"){const l=ue(t.shape);o=[];for(let c=0;c<l;c++){const u=new Uint32Array(e.slice(a,a+dd))[0];a+=dd;const h=new Uint8Array(e.slice(a,a+u));o.push(h),a+=u}}else{const l=C2[s];if(s==="float32")o=new Float32Array(e);else if(s==="int32")o=new Int32Array(e);else if(s==="bool")o=new Uint8Array(e);else if(s==="complex64"){o=new Float32Array(e);const c=new Float32Array(o.length/2),u=new Float32Array(o.length/2);for(let p=0;p<c.length;p++)c[p]=o[p*2],u[p]=o[p*2+1];const h=Gc(c,r,"float32"),d=Gc(u,r,"float32"),f=au(h,d);return h.dispose(),d.dispose(),f}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);a+=i*l}return Gc(o,r,s)}function vne(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(i=>{if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const s=new Uint8Array(e);let r=0;return n.forEach(i=>{s.set(new Uint8Array(i.buffer),r),r+=i.byteLength}),s.buffer}const dT=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function u$(t){return dT?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function xne(t){if(dT)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let s=0,r=e.length;s<r;s++)n+=String.fromCharCode(e[s]);return btoa(n)}function wne(t){if(dT){const s=Buffer.from(t,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;++s)n.set([e.charCodeAt(s)],s);return n.buffer}function bne(t){return Kl.join(t)}function Cne(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function Sne(t,e,n){const s={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(s.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=e,s.weightData=n}return t.signature!=null&&(s.signature=t.signature),t.userDefinedMetadata!=null&&(s.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(s.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(s.initializerSignature=t.initializerSignature),s}async function Ine(t,e){let n,s;return t.weightsManifest!=null&&([n,s]=await e(t.weightsManifest)),Sne(t,n,s)}function fT(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:u$(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:u$(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new Kl(t.weightData).byteLength}}function h$(t){const e=[];for(const n of t)e.push(...n.weights);return e}function kne(){const t=n=>{let s=n<<13,r=0;for(;!(s&8388608);)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function Tne(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function Ene(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function Nne(){const t=kne(),e=Tne(),n=Ene();return s=>{const r=new ArrayBuffer(4*s.length),i=new Uint32Array(r);for(let o=0;o<s.length;o++){const a=s[o],l=t[n[a>>10]+(a&1023)]+e[a>>10];i[o]=l}return new Float32Array(r)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Fn.instance==null&&(Fn.instance=new Fn),Fn.instance}static registerSaveRouter(e){Fn.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Fn.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Fn.getHandlers(e,"save")}static getLoadHandlers(e,n){return Fn.getHandlers(e,"load",n)}static getHandlers(e,n,s){const r=[];return(n==="load"?Fn.getInstance().loadRouters:Fn.getInstance().saveRouters).forEach(o=>{const a=o(e,s);a!==null&&r.push(a)}),r}}const _ne=t=>Fn.getSaveHandlers(t),$ne=(t,e)=>Fn.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VC="tensorflowjs",UC=1,Lc="models_store",rl="model_info_store";function wL(){if(!oe().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function zC(t){const e=t.result;e.createObjectStore(Lc,{keyPath:"modelPath"}),e.createObjectStore(rl,{keyPath:"modelPath"})}class lu{constructor(e){if(this.indexedDB=wL(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((s,r)=>{const i=this.indexedDB.open(VC,UC);i.onupgradeneeded=()=>zC(i),i.onsuccess=()=>{const o=i.result;if(n==null){const a=o.transaction(Lc,"readonly"),c=a.objectStore(Lc).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return o.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=u=>(o.close(),r(c.error)),a.oncomplete=()=>o.close()}else{n.weightData=Kl.join(n.weightData);const a=fT(n),l=o.transaction(rl,"readwrite");let c=l.objectStore(rl),u;try{u=c.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(d){return r(d)}let h;u.onsuccess=()=>{h=o.transaction(Lc,"readwrite");const d=h.objectStore(Lc);let f;try{f=d.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return r(p)}f.onsuccess=()=>s({modelArtifactsInfo:a}),f.onerror=p=>{c=l.objectStore(rl);const g=c.delete(this.modelPath);g.onsuccess=()=>(o.close(),r(f.error)),g.onerror=m=>(o.close(),r(f.error))}},u.onerror=d=>(o.close(),r(u.error)),l.oncomplete=()=>{h==null?o.close():h.oncomplete=()=>o.close()}}},i.onerror=o=>r(i.error)})}}lu.URL_SCHEME="indexeddb://";const bL=t=>oe().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(lu.URL_SCHEME)?Rne(t.slice(lu.URL_SCHEME.length)):null;Fn.registerSaveRouter(bL);Fn.registerLoadRouter(bL);function Rne(t){return new lu(t)}function Ane(t){return t.startsWith(lu.URL_SCHEME)?t.slice(lu.URL_SCHEME.length):t}class Dne{constructor(){this.indexedDB=wL()}async listModels(){return new Promise((e,n)=>{const s=this.indexedDB.open(VC,UC);s.onupgradeneeded=()=>zC(s),s.onsuccess=()=>{const r=s.result,i=r.transaction(rl,"readonly"),a=i.objectStore(rl).getAll();a.onsuccess=()=>{const l={};for(const c of a.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},a.onerror=l=>(r.close(),n(a.error)),i.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(e){return e=Ane(e),new Promise((n,s)=>{const r=this.indexedDB.open(VC,UC);r.onupgradeneeded=()=>zC(r),r.onsuccess=()=>{const i=r.result,o=i.transaction(rl,"readwrite"),a=o.objectStore(rl),l=a.get(e);let c;l.onsuccess=()=>{if(l.result==null)return i.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=a.delete(e),h=()=>{c=i.transaction(Lc,"readwrite");const f=c.objectStore(Lc).delete(e);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=p=>s(l.error)};u.onsuccess=h,u.onerror=d=>(h(),i.close(),s(l.error))}},l.onerror=u=>(i.close(),s(l.error)),o.oncomplete=()=>{c==null?i.close():c.oncomplete=()=>i.close()}},r.onerror=i=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zo="/",hh="tensorflowjs_models",CL="info",Pne="model_topology",One="weight_specs",Fne="weight_data",Lne="model_metadata";function SL(t){return{info:[hh,t,CL].join(Zo),topology:[hh,t,Pne].join(Zo),weightSpecs:[hh,t,One].join(Zo),weightData:[hh,t,Fne].join(Zo),modelMetadata:[hh,t,Lne].join(Zo)}}function IL(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function Mne(t){const e=t.split(Zo);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Zo)}function Bne(t){return t.startsWith(cu.URL_SCHEME)?t.slice(cu.URL_SCHEME.length):t}class cu{constructor(e){if(!oe().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=SL(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=fT(e),i=Kl.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,xne(i));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:r}}catch{throw IL(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const a=JSON.parse(i);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=wne(o),n}}cu.URL_SCHEME="localstorage://";const kL=t=>oe().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(cu.URL_SCHEME)?Vne(t.slice(cu.URL_SCHEME.length)):null;Fn.registerSaveRouter(kL);Fn.registerLoadRouter(kL);function Vne(t){return new cu(t)}class Une{constructor(){L(oe().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),L(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=hh+Zo,s=Zo+CL;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(n)&&i.endsWith(s)){const o=Mne(i);e[o]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=Bne(e);const n=SL(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(n.info));return IL(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d$="://";class oo{constructor(){this.managers={}}static getInstance(){return oo.instance==null&&(oo.instance=new oo),oo.instance}static registerManager(e,n){L(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(d$)&&(e=e.slice(0,e.indexOf(d$))),L(e.length>0,()=>"scheme must not be an empty string.");const s=oo.getInstance();L(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=n}static getManager(e){const n=oo.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(oo.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zne{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!oe().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return eL(e)}}if(oe().get("IS_BROWSER")){oe().setPlatform("browser",new zne);try{oo.registerManager(cu.URL_SCHEME,new Une)}catch{}try{oo.registerManager(lu.URL_SCHEME,new Dne)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wne={importFetch:()=>require("node-fetch")};let _w;class jne{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return oe().global.fetch!=null?oe().global.fetch(e,n):(_w==null&&(_w=Wne.importFetch()),_w(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}oe().get("IS_NODE")&&!oe().get("IS_BROWSER")&&oe().setPlatform("node",new jne);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function et(t,e="float32",n){return e=e||"float32",Ia(t),new Zn(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gne(t,e){const n=G(t,"x","cast");if(!Ete(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:e};return Q.runKernel(Tm,s,r)}const Ee=ne({cast_:Gne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hne(t){const n={x:G(t,"x","clone","string_or_numeric")};return Q.runKernel(Bm,n)}const Hc=ne({clone_:Hne});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kne(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pL();const qne={buffer:et,cast:Ee,clone:Hc,print:Kne};ine(qne);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xne(t,e){let n=G(t,"a","add"),s=G(e,"b","add");[n,s]=cn(n,s);const r={a:n,b:s};return Q.runKernel(Pd,r)}const ve=ne({add_:Xne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yne(t,e){let n=G(t,"a","floorDiv"),s=G(e,"b","floorDiv");[n,s]=cn(n,s);const r={a:n,b:s};return Q.runKernel(Lm,r)}const TL=ne({floorDiv_:Yne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jne(t,e){let n=G(t,"a","div"),s=G(e,"b","div");if([n,s]=cn(n,s),n.dtype==="int32"&&s.dtype==="int32")return TL(n,s);const r={a:n,b:s},i={};return Q.runKernel(Rm,r,i)}const Ve=ne({div_:Jne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zne(t,e){let n=G(t,"a","mul"),s=G(e,"b","mul");[n,s]=cn(n,s);const r={a:n,b:s};return Q.runKernel(qm,r)}const Y=ne({mul_:Zne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qne(t){const e=G(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return Q.runKernel(Uy,n)}else{const n={x:e};return Q.runKernel(Py,n)}}const ks=ne({abs_:Qne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ese(t){const n={x:G(t,"x","acos")};return Q.runKernel(xm,n)}const tse=ne({acos_:ese});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nse(t){const n={x:G(t,"x","acosh")};return Q.runKernel(wm,n)}const sse=ne({acosh_:nse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rse(t,e=null,n=!1){const r={x:G(t,"x","all","bool")},i={axis:e,keepDims:n};return Q.runKernel(Ik,r,i)}const EL=ne({all_:rse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ise(t,e=null,n=!1){const r={x:G(t,"x","any","bool")},i={axis:e,keepDims:n};return Q.runKernel(kk,r,i)}const WC=ne({any_:ise});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ose(t,e=0){const s={x:G(t,"x","argMax")},r={axis:e};return Q.runKernel(Oy,s,r)}const Up=ne({argMax_:ose});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ase(t,e=0){const s={x:G(t,"x","argMin")},r={axis:e};return Q.runKernel(Fy,s,r)}const lse=ne({argMin_:ase});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cse(t){const n={x:G(t,"x","asin")};return Q.runKernel(bm,n)}const use=ne({asin_:cse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hse(t){const n={x:G(t,"x","asinh")};return Q.runKernel(Cm,n)}const dse=ne({asinh_:hse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fse(t){const n={x:G(t,"x","atan")};return Q.runKernel(Sm,n)}const pse=ne({atan_:fse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mse(t,e){let n=G(t,"a","atan2"),s=G(e,"b","atan2");[n,s]=cn(n,s);const r={a:n,b:s};return Q.runKernel(km,r)}const gse=ne({atan2_:mse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yse(t){const n={x:G(t,"x","atanh")};return Q.runKernel(Im,n)}const vse=ne({atanh_:yse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pg(t,e,n,s,r="NHWC",i){const o=t[3],a=[...e,o],l=Ta(r);return Qn(t,a,n,i,s,null,null,l)}function wi(t,e,n,s,r,i,o="channelsLast"){const[a,l]=zp(e);let c;if(o==="channelsLast")c=[a,l,t[3],t[3]];else if(o==="channelsFirst")c=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Qn(t,c,n,s,r,i,!1,o)}function ka(t,e,n,s,r,i,o="NDHWC"){const[a,l,c]=jC(e);let u,h;if(o==="NDHWC")h="channelsLast",u=[a,l,c,t[4],t[4]];else if(o==="NCDHW")h="channelsFirst",u=[a,l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return ql(t,u,n,s,r,!1,h,i)}function Qn(t,e,n,s,r,i,o=!1,a="channelsLast"){let[l,c,u,h]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,h]=t;else if(a==="channelsFirst")[l,h,c,u]=t;else throw new Error(`Unknown dataFormat ${a}`);const[d,f,,p]=e,[g,m]=zp(n),[y,w]=zp(s),b=jh(d,y),C=jh(f,w),{padInfo:k,outHeight:$,outWidth:I}=bse(r,c,u,g,m,b,C,i,a),T=o?p*h:p;let R;return a==="channelsFirst"?R=[l,T,$,I]:a==="channelsLast"&&(R=[l,$,I,T]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:h,outHeight:$,outWidth:I,outChannels:T,padInfo:k,strideHeight:g,strideWidth:m,filterHeight:d,filterWidth:f,effectiveFilterHeight:b,effectiveFilterWidth:C,dilationHeight:y,dilationWidth:w,inShape:t,outShape:R,filterShape:e}}function ql(t,e,n,s,r,i=!1,o="channelsLast",a){let[l,c,u,h,d]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,c,u,h,d]=t;else if(o==="channelsFirst")[l,d,c,u,h]=t;else throw new Error(`Unknown dataFormat ${o}`);const[f,p,g,,m]=e,[y,w,b]=jC(n),[C,k,$]=jC(s),I=jh(f,C),T=jh(p,k),R=jh(g,$),{padInfo:E,outDepth:A,outHeight:F,outWidth:P}=Cse(r,c,u,h,y,w,b,I,T,R,a),Z=i?m*d:m;let H;return o==="channelsFirst"?H=[l,Z,A,F,P]:o==="channelsLast"&&(H=[l,A,F,P,Z]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:u,inWidth:h,inChannels:d,outDepth:A,outHeight:F,outWidth:P,outChannels:Z,padInfo:E,strideDepth:y,strideHeight:w,strideWidth:b,filterDepth:f,filterHeight:p,filterWidth:g,effectiveFilterDepth:I,effectiveFilterHeight:T,effectiveFilterWidth:R,dilationDepth:C,dilationHeight:k,dilationWidth:$,inShape:t,outShape:H,filterShape:e}}function xse(t,e,n,s,r){s==null&&(s=pT(t,e,n));const i=t[0],o=t[1],a=Wp((i-e+2*s)/n+1,r),l=Wp((o-e+2*s)/n+1,r);return[a,l]}function wse(t,e,n,s,r,i){r==null&&(r=pT(t,e[0],s[0]));const o=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*r>=e[a]&&(o[a]=Wp((t[a]-e[a]+2*r)/s[a]+1,i));return o}function pT(t,e,n,s=1){const r=jh(e,s);return Math.floor((t[0]*(n-1)-n+r)/2)}function zp(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function jC(t){return typeof t=="number"?[t,t,t]:t}function jh(t,e){return e<=1?t:t+(t-1)*(e-1)}function bse(t,e,n,s,r,i,o,a,l){let c,u,h;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=xse([e,n],i,s,t,a);u=f[0],h=f[1]}else if(t==="same"){u=Math.ceil(e/s),h=Math.ceil(n/r);const d=Math.max(0,(u-1)*s+i-e),f=Math.max(0,(h-1)*r+o-n),p=Math.floor(d/2),g=d-p,m=Math.floor(f/2),y=f-m;c={top:p,bottom:g,left:m,right:y,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-i+1)/s),h=Math.ceil((n-o+1)/r);else if(typeof t=="object"){const d=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],g=l==="channelsLast"?t[2][1]:t[3][1];c={top:d,bottom:f,left:p,right:g,type:d===0&&f===0&&p===0&&g===0?"VALID":"EXPLICIT"},u=Wp((e-i+d+f)/s+1,a),h=Wp((n-o+p+g)/r+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:u,outWidth:h}}function Cse(t,e,n,s,r,i,o,a,l,c,u){let h,d,f,p;if(t==="valid"&&(t=0),typeof t=="number"){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const m=wse([e,n,s,1],[a,l,c],1,[r,i,o],t,u);d=m[0],f=m[1],p=m[2]}else if(t==="same"){d=Math.ceil(e/r),f=Math.ceil(n/i),p=Math.ceil(s/o);const g=(d-1)*r+a-e,m=(f-1)*i+l-n,y=(p-1)*o+c-s,w=Math.floor(g/2),b=g-w,C=Math.floor(m/2),k=m-C,$=Math.floor(y/2),I=y-$;h={top:C,bottom:k,left:$,right:I,front:w,back:b,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:h,outDepth:d,outHeight:f,outWidth:p}}function Wp(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function uu(t){const[e,n,s]=zp(t);return e===1&&n===1&&s===1}function ms(t,e){return uu(t)||uu(e)}function hu(t){return zp(t).every(e=>e>0)}function Ta(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function nr(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")L(cd(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{L(cd(r),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sse(t,e){const s={x:G(t,"x","reshape","string_or_numeric")},r={shape:e};return Q.runKernel(bv,s,r)}const te=ne({reshape_:Sse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ise(t,e,n,s,r){const i=G(t,"x","avgPool","float32"),o=1;L(ms(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let a=i,l=!1;i.rank===3&&(l=!0,a=te(i,[1,i.shape[0],i.shape[1],i.shape[2]])),L(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),nr("avgPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r};let h=Q.runKernel(Ly,c,u);return h=Ee(h,i.dtype),l?te(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const mT=ne({avgPool_:Ise});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kse(t,e,n,s,r,i="NDHWC"){const o=G(t,"x","avgPool3d","float32");let a=o,l=!1;o.rank===4&&(l=!0,a=te(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),L(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),L(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),L(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),nr("avgPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:i};let h=Q.runKernel(My,c,u);return h=Ee(h,a.dtype),l?te(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const Tse=ne({avgPool3d_:kse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ese(t,e=0){L(t.length>=1,()=>"Pass at least one tensor to concat");const n=vL(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return Hc(n[0]);const s=n,r={axis:e};return Q.runKernel(zy,s,r)}const Js=ne({concat_:Ese});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nse(t,e,n=!1,s=!1){let r=G(t,"a","matMul"),i=G(e,"b","matMul");[r,i]=cn(r,i);const o={a:r,b:i},a={transposeA:n,transposeB:s};return Q.runKernel(By,o,a)}const mt=ne({matMul_:Nse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _se(t){const n={x:G(t,"x","sigmoid","float32")};return Q.runKernel(ig,n)}const Od=ne({sigmoid_:_se});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $se(t,e,n){const s=G(t,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},i={begin:e,size:n};return Q.runKernel(Tv,r,i)}const Pt=ne({slice_:$se});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rse(t){const n={x:G(t,"x","tanh","float32")};return Q.runKernel(hg,n)}const Lv=ne({tanh_:Rse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ase(t,e,n){const s=G(t,"x","batchToSpaceND"),r=e.reduce((a,l)=>a*l);L(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),L(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),L(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const i={x:s},o={blockShape:e,crops:n};return Q.runKernel(Vy,i,o)}const gT=ne({batchToSpaceND_:Ase});function Dse(t){let e;return t.rank===0||t.rank===1?e=te(t,[1,1,1,t.size]):t.rank===2?e=te(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=te(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pse(t,e,n,s,r,i){i==null&&(i=.001);const o=G(t,"x","batchNorm"),a=G(e,"mean","batchNorm"),l=G(n,"variance","batchNorm");let c;r!=null&&(c=G(r,"scale","batchNorm"));let u;s!=null&&(u=G(s,"offset","batchNorm")),L(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),L(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),L(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d={x:Dse(o),scale:c,offset:u,mean:a,variance:l},f={varianceEpsilon:i},p=Q.runKernel(Jy,d,f);return te(p,o.shape)}const Mv=ne({batchNorm_:Pse});function Ose(t,e,n,s,r,i){const o=G(t,"x","batchNorm"),a=G(e,"mean","batchNorm"),l=G(n,"variance","batchNorm");let c;r!=null&&(c=G(r,"scale","batchNorm"));let u;return s!=null&&(u=G(s,"offset","batchNorm")),L(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),L(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),L(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&L(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&L(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),Mv(o,a,l,u,c,i)}const Fse=ne({batchNorm2d_:Ose});function Lse(t,e,n,s,r,i){const o=G(t,"x","batchNorm"),a=G(e,"mean","batchNorm"),l=G(n,"variance","batchNorm");let c;r!=null&&(c=G(r,"scale","batchNorm"));let u;return s!=null&&(u=G(s,"offset","batchNorm")),L(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),L(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),L(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&L(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&L(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),Mv(o,a,l,u,c,i)}const Mse=ne({batchNorm3d_:Lse});function Bse(t,e,n,s,r,i){const o=G(t,"x","batchNorm"),a=G(e,"mean","batchNorm"),l=G(n,"variance","batchNorm");let c;r!=null&&(c=G(r,"scale","batchNorm"));let u;return s!=null&&(u=G(s,"offset","batchNorm")),L(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),L(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),L(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&L(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&L(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),Mv(o,a,l,u,c,i)}const Vse=ne({batchNorm4d_:Bse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Use(t,e,n){const s=G(t,"x","bincount"),r=G(e,"weights","bincount");L(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),L(n>=0,()=>`size must be non-negative, but got ${n}.`),L(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const i={x:s,weights:r},o={size:n};return Q.runKernel(Nk,i,o)}const zse=ne({bincount_:Use});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wse(t,e){let n=G(t,"broadcastTo","x");const s=n.shape;if(Ia(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const c=n.shape.slice();for(;c.length<e.length;)c.unshift(1);n=te(n,c)}const r=n.shape,i=Array.from(e);for(let c=e.length-1;c>=0;c--)if(r[c]===e[c])i[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(i.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return Hc(n);const a={x:n},l={reps:i};return Q.runKernel(dg,a,l)}const up=ne({broadcastTo_:Wse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jse(t){const n={x:G(t,"x","ceil","float32")};return Q.runKernel(Em,n)}const Gse=ne({ceil_:jse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bv(t,e,n){Ia(t),n=n||Ad(e);const s={shape:t,value:e,dtype:n};return Q.runKernel(Wk,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hse(t,e,n){const s=G(t,"x","clipByValue");if(L(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Bv(s.shape,e,s.dtype);const r={x:s},i={clipValueMin:e,clipValueMax:n};return Q.runKernel(Nm,r,i)}const Wr=ne({clipByValue_:Hse});function Kse(t){return Js(t,0)}const qse=ne({concat1d_:Kse});function Xse(t,e){return Js(t,e)}const Yse=ne({concat2d_:Xse});function Jse(t,e){return Js(t,e)}const Zse=ne({concat3d_:Jse});function Qse(t,e){return Js(t,e)}const ere=ne({concat4d_:Qse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tre(t,e,n,s,r="NHWC",i=[1,1],o){const a=G(t,"x","conv2d","float32"),l=G(e,"filter","conv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),L(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),L(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),nr("conv2d",s,o);const h=r==="NHWC"?c.shape[3]:c.shape[1];L(h===l.shape[2],()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${l.shape[2]}.`),L(ms(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),L(hu(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),L(hu(n),()=>"Error in conv2D: Strides should be larger than 0.");const d={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o},p=Q.runKernel(Wy,d,f);return u?te(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const du=ne({conv2d_:tre});function nre(t,e,n,s,r="NWC",i=1,o){const a=G(t,"x","conv1d"),l=G(e,"filter","conv1d");let c=a,u=!1;a.rank===2&&(u=!0,c=te(a,[1,a.shape[0],a.shape[1]])),L(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),L(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),nr("conv1d",s,o),L(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),L(ms(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),L(hu(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),L(hu(n),()=>"Error in conv1D: Stride should be larger than 0."),L(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const h=te(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=te(c,[c.shape[0],1,c.shape[1],c.shape[2]]),m=du(d,h,[1,n],s,"NHWC",[1,i],o);return u?te(m,[m.shape[2],m.shape[3]]):te(m,[m.shape[0],m.shape[2],m.shape[3]])}const NL=ne({conv1d_:nre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sre(t,e,n,s,r,i="NHWC",o){L(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,c=!1;e.rank===3&&(c=!0,l=te(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),L(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),L(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),L(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const u=i==="NHWC"?a[3]:a[1],h=i==="NHWC"?l.shape[3]:l.shape[1];L(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),L(h===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${h}) must match output depth for filter ${n.shape[3]}.`),nr("conv2dDerInput",r,o);const d={dy:l,filter:n},f={strides:s,pad:r,dataFormat:i,dimRoundingMode:o,inputShape:a},p=Q.runKernel(jy,d,f);return c?te(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const yT=ne({conv2DBackpropInput_:sre});function rre(t,e,n,s,r,i){const o=G(t,"x","conv2dTranspose"),a=G(e,"filter","conv2dTranspose");return yT(n,o,a,s,r,"NHWC",i)}const _L=ne({conv2dTranspose_:rre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ire(t,e,n,s,r="NDHWC",i=[1,1,1]){const o=G(t,"x","conv3d"),a=G(e,"filter","conv3d");let l=o,c=!1;o.rank===4&&(c=!0,l=te(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),L(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),L(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),L(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),L(ms(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),L(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),L(hu(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),L(hu(n),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:l,filter:a},h={strides:n,pad:s,dataFormat:r,dilations:i},d=Q.runKernel(Gy,u,h);return c?te(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const ore=ne({conv3d_:ire});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function are(t,e,n,s,r){L(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,o=e,a=!1;e.rank===4&&(a=!0,o=te(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const l=i[4],c=o.shape[4];L(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),L(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),L(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),L(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),L(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const u={dy:o,filter:n},h={pad:r,strides:s,inputShape:i},d=Q.runKernel(Dk,u,h);return a?te(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const $L=ne({conv3DBackpropInput_:are});function lre(t,e,n,s,r){const i=G(t,"x","conv3dTranspose"),o=G(e,"filter","conv3dTranspose");return $L(n,i,o,s,r)}const cre=ne({conv3dTranspose_:lre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ure(t){const n={x:G(t,"x","cos","float32")};return Q.runKernel(_m,n)}const vT=ne({cos_:ure});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hre(t){const n={x:G(t,"x","cosh","float32")};return Q.runKernel($m,n)}const RL=ne({cosh_:hre});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dre(t,e=0,n=!1,s=!1){const i={x:G(t,"x","cumprod")},o={axis:e,exclusive:n,reverse:s};return Q.runKernel(Pk,i,o)}const GC=ne({cumprod_:dre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fre(t,e=0,n=!1,s=!1){const i={x:G(t,"x","cumsum")},o={axis:e,exclusive:n,reverse:s};return Q.runKernel(Hy,i,o)}const AL=ne({cumsum_:fre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pre(t,e,n,s=!1){const r=G(t,"x","denseBincount"),i=G(e,"weights","denseBincount");L(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),L(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),L(n>=0,()=>`size must be non-negative, but got ${n}.`),L(i.size===r.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${i.shape}.`);const o={x:r,weights:i},a={size:n,binaryOutput:s};return Q.runKernel(Fk,o,a)}const f$=ne({denseBincount_:pre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mre(t,e,n="NHWC"){const s=G(t,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],i=n==="NHWC"?s.shape[2]:s.shape[3],o=n==="NHWC"?s.shape[3]:s.shape[1];L(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),L(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),L(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${s.shape}`),L(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${s.shape}`);const a={x:s},l={blockSize:e,dataFormat:n};return Q.runKernel(Lk,a,l)}const gre=ne({depthToSpace_:mre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yre(t,e,n,s,r="NHWC",i=[1,1],o){const a=G(t,"x","depthwiseConv2d","float32"),l=G(e,"filter","depthwiseConv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),L(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),L(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const h=r==="NHWC"?c.shape[3]:c.shape[1];L(h===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${h}) must match the inChannels dimension in filter ${l.shape[2]}.`),nr("depthwiseConv2d",s,o);const d={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o},p=Q.runKernel(Ky,d,f);return u?te(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const xT=ne({depthwiseConv2d_:yre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vre(t,e,n,s,r=[1,1],i="NHWC"){const o=G(t,"x","dilation2d"),a=G(e,"filter","dilation2d");L(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),L(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),L(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=o,c=!1;o.rank===3&&(l=te(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),L(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const u={x:l,filter:a},h={strides:n,pad:s,dilations:r},d=Q.runKernel(qy,u,h);return c?te(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const xre=ne({dilation2d_:vre});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fd(t,e){const n=t.length,s=[];for(let r=0;r<n;r++){const i=n-1-r,o=t[i]||1;(e[e.length-1-r]||1)>1&&o===1&&s.unshift(i)}return s}function Rn(t,e){const n=[];for(let s=0;s<e.length;s++){const r=t[t.length-s-1],i=e.length-s-1,o=e[i];(r==null||r===1&&o>1)&&n.unshift(i)}return n}function Xe(t,e){const n=Math.max(t.length,e.length),s=new Array(n);for(let r=0;r<n;r++){let i=t[t.length-r-1];i==null&&(i=1);let o=e[e.length-r-1];if(o==null&&(o=1),i===1)s[n-r-1]=o;else if(o===1)s[n-r-1]=i;else if(i!==o){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else s[n-r-1]=i}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wre(t,e){let n=G(t,"a","equal","string_or_numeric"),s=G(e,"b","equal","string_or_numeric");[n,s]=cn(n,s),Xe(n.shape,s.shape);const r={a:n,b:s};return Q.runKernel(Xy,r)}const No=ne({equal_:wre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bre(t,e,n){const s=G(e,"a","where"),r=G(n,"b","where"),i=G(t,"condition","where","bool"),o=Xe(Xe(i.shape,s.shape),r.shape),a=up(i,o),l=up(s,o),c=up(r,o),u={condition:a,t:l,e:c};return Q.runKernel(kv,u)}const Ds=ne({where_:bre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cre(t){const n={x:G(t,"x","zerosLike")};return Q.runKernel(Dv,n)}const lt=ne({zerosLike_:Cre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sre(t,e){let n=G(t,"a","div"),s=G(e,"b","div");[n,s]=cn(n,s);const r=Ve(n,s),i=lt(r),o=No(s,i);return Ds(o,i,r)}const Ire=ne({divNoNan_:Sre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kre(t,e){const n=G(t,"t1","dot"),s=G(e,"t2","dot");L((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],i=s.rank===1?s.size:s.shape[0];if(L(r===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${i}.`),n.rank===1&&s.rank===1){const o=te(n,[1,-1]),a=te(s,[-1,1]),l=mt(o,a);return te(l,[])}else if(n.rank===1&&s.rank===2){const o=te(n,[1,-1]),a=te(s,[s.shape[0],s.shape[1]]),l=mt(o,a);return te(l,[l.size])}else if(n.rank===2&&s.rank===1){const o=te(s,[-1,1]),a=mt(n,o);return te(a,[a.size])}else{const o=te(s,[s.shape[0],s.shape[1]]);return mt(n,o)}}const Tre=ne({dot_:kre});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ere(t,...e){const n=e.map((r,i)=>G(r,`tensors${i}`,"einsum")),s={equation:t};return Q.runKernel(Vk,n,s)}const Tf=ne({einsum_:Ere});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nre(t){const n={x:G(t,"x","elu","float32")};return Q.runKernel(Am,n)}const Vv=ne({elu_:Nre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _re(t){let e=G(t,"x","erf");L(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Ee(e,"float32"));const n={x:e};return Q.runKernel(Dm,n)}const DL=ne({erf_:_re});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wT(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function PL(t,e,n){const s=t.length+e.length,r=[];let i=0,o=0;for(let a=0;a<s;a++)n.indexOf(a)===-1?r.push(t[i++]):r.push(e[o++]);return r}function Wn(t,e){const n=[],s=t.length;for(let i=0;i<s;i++)e.indexOf(i)===-1&&n.push(t[i]);const r=e.map(i=>t[i]);return[n,r]}function vn(t,e){const n=e.map(s=>1);return PL(t,n,e)}function es(t,e,n){L(wT(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function Zt(t,e){if(wT(t,e))return null;const n=[];for(let s=0;s<e;++s)t.indexOf(s)===-1&&n.push(s);return t.forEach(s=>n.push(s)),n}function Xl(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function un(t,e){const n=[];for(let s=e-t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $re(t,e=null,n=!1){const r={x:G(t,"x","max")},i={reductionIndices:e,keepDims:n};return Q.runKernel(av,r,i)}const Vi=ne({max_:$re});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rre(t,e=null,n=!1){const r={x:G(t,"x","min")},i={axis:e,keepDims:n};return Q.runKernel(hv,r,i)}const S2=ne({min_:Rre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Are(t,e){let n=G(t,"base","pow"),s=G(e,"exp","pow");[n,s]=cn(n,s);const r={a:n,b:s};return Q.runKernel(Xm,r)}const fu=ne({pow_:Are});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gt(t,e){if((vi(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&vi(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Fv(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dre(t){const n={x:G(t,"x","sqrt","float32")};return Q.runKernel(ag,n)}const ps=ne({sqrt_:Dre});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pre(t){const e=G(t,"x","square"),n={};return Q.runKernel("Square",{x:e},n)}const Mt=ne({square_:Pre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ore(t,e=null,n=!1){let s=G(t,"x","sum");s.dtype==="bool"&&(s=Ee(s,"int32"));const r={x:s},i={axis:e,keepDims:n};return Q.runKernel(Ev,r,i)}const Me=ne({sum_:Ore});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fre(t,e="euclidean",n=null,s=!1){t=G(t,"x","norm");const r=OL(t,e,n);let i=r.shape;if(s){const o=tt(n,t.shape);i=vn(r.shape,o)}return te(r,i)}function OL(t,e,n=null){if(t.rank===0)return ks(t);if(t.rank!==1&&n===null)return OL(te(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return Me(ks(t),n);if(e===1/0)return Vi(ks(t),n);if(e===-1/0)return S2(ks(t),n);if(e==="euclidean"||e===2)return ps(Me(fu(ks(t),gt(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Vi(Me(ks(t),n[0]),n[1]-1);if(e===1/0)return Vi(Me(ks(t),n[1]),n[0]);if(e===-1/0)return S2(Me(ks(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return ps(Me(Mt(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Uv=ne({norm_:Fre});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lre(t,e=null,n=!1){return Uv(t,"euclidean",e,n)}const Mre=ne({euclideanNorm_:Lre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bre(t){const n={x:G(t,"x","exp")};return Q.runKernel(Pm,n)}const _o=ne({exp_:Bre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vre(t,e=0){const n=G(t,"x","expandDims","string_or_numeric");L(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:e};return Q.runKernel(Yy,s,r)}const Ks=ne({expandDims_:Vre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ure(t){const n={x:G(t,"x","expm1")};return Q.runKernel(Om,n)}const zre=ne({expm1_:Ure});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wre(t,e){const n=G(t,"x","tile","string_or_numeric");L(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},r={reps:e};return Q.runKernel(dg,s,r)}const Oi=ne({tile_:Wre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jre(t,e,n,s="float32"){e==null&&(e=t);const r=et([t,e],s),i=t<=e?t:e;for(let a=0;a<i;++a)r.set(1,a,a);const o=te(r.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return Oi(Ks(o,0),[n[0],1,1]);if(n.length===2)return Oi(Ks(Ks(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return Oi(Ks(Ks(Ks(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const FL=ne({eye_:jre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gre(t){const n={x:G(t,"x","floor","float32")};return Q.runKernel(Fm,n)}const zv=ne({floor_:Gre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hre(t,e,n=0,s=0){const r=G(t,"x","gather"),i=G(e,"indices","gather","int32"),o={x:r,indices:i},a={axis:n,batchDims:s};return Q.runKernel(Zy,o,a)}const bT=ne({gather_:Hre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kre(t,e){let n=G(t,"a","greater","string_or_numeric"),s=G(e,"b","greater","string_or_numeric");[n,s]=cn(n,s),Xe(n.shape,s.shape);const r={a:n,b:s};return Q.runKernel(Qy,r)}const Hr=ne({greater_:Kre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qre(t,e){let n=G(t,"a","greaterEqual","string_or_numeric"),s=G(e,"b","greaterEqual","string_or_numeric");[n,s]=cn(n,s),Xe(n.shape,s.shape);const r={a:n,b:s};return Q.runKernel(Mm,r)}const Nu=ne({greaterEqual_:qre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xre(t){const n={input:G(t,"input","imag")};return Q.runKernel(Hk,n)}const CT=ne({imag_:Xre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yre(t){const n={x:G(t,"x","isFinite")};return Q.runKernel(Vm,n)}const Jre=ne({isFinite_:Yre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zre(t){const n={x:G(t,"x","isInf")};return Q.runKernel(Um,n)}const Qre=ne({isInf_:Zre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eie(t){const n={x:G(t,"x","isNaN")};return Q.runKernel(zm,n)}const tie=ne({isNaN_:eie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nie(t,e=.2){const s={x:G(t,"x","leakyRelu")},r={alpha:e};return Q.runKernel(ev,s,r)}const ST=ne({leakyRelu_:nie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sie(t,e){let n=G(t,"a","less","string_or_numeric"),s=G(e,"b","less","string_or_numeric");[n,s]=cn(n,s),Xe(n.shape,s.shape);const r={a:n,b:s};return Q.runKernel(tv,r)}const I2=ne({less_:sie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rie(t,e){let n=G(t,"a","lessEqual","string_or_numeric"),s=G(e,"b","lessEqual","string_or_numeric");[n,s]=cn(n,s),Xe(n.shape,s.shape);const r={a:n,b:s};return Q.runKernel(nv,r)}const Fd=ne({lessEqual_:rie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iie(t,e=5,n=1,s=1,r=.5){const i=G(t,"x","localResponseNormalization");L(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),L(cd(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,a=!1;i.rank===3&&(a=!0,o=te(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:o},c={depthRadius:e,bias:n,alpha:s,beta:r},u=Q.runKernel(ov,l,c);return a?te(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const oie=ne({localResponseNormalization_:iie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aie(t){const n={x:G(t,"x","log","float32")};return Q.runKernel(Wm,n)}const $o=ne({log_:aie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lie(t){const n={x:G(t,"x","log1p")};return Q.runKernel(jm,n)}const LL=ne({log1p_:lie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cie(t,e){L(_C(t),()=>"The f passed in variableGrads(f) must be a function"),L(e==null||Array.isArray(e)&&e.every(c=>c instanceof b2),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const c in Q.registeredVariables)e.push(Q.registeredVariables[c])}const s=n?e.filter(c=>!c.trainable):null,r=e.length;e=e.filter(c=>c.trainable),L(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const i=!0,{value:o,grads:a}=Q.gradients(t,e,null,i);L(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),L(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),s!=null&&s.forEach(c=>l[c.name]=null),{value:o,grads:l}}function pd(t){return Q.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uie(t){const n={x:G(t,"x","neg")};return Q.runKernel(fv,n)}const ln=ne({neg_:uie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hie(t){const n={x:G(t,"x","softplus")};return Q.runKernel(og,n)}const mg=ne({softplus_:hie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function die(t){const e=G(t,"x","logSigmoid");return pd(s=>({value:ln(mg(ln(s))),gradFunc:o=>Y(o,Od(ln(s)))}))(e)}const fie=ne({logSigmoid_:die});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pie(t,e){let n=G(t,"a","sub"),s=G(e,"b","sub");[n,s]=cn(n,s);const r={a:n,b:s};return Q.runKernel(cg,r)}const ze=ne({sub_:pie});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mie(t,e=-1){const n=G(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return pd((r,i)=>{const a=Vi(r,e,!0),l=ze(r,a),c=ze(Ee(l,"float32"),$o(Me(_o(l),e,!0)));return i([c]),{value:c,gradFunc:(h,d)=>{const[f]=d,p=!0,g=_o(f);return ze(h,Y(Me(h,e,p),g))}}})(n)}const ML=ne({logSoftmax_:mie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gie(t,e=null,n=!1){const s=G(t,"x","logSumExp"),r=tt(e,s.shape),i=Vi(s,r,!0),o=ze(s,i),a=_o(o),l=Me(a,r),c=$o(l),u=ve(te(i,c.shape),c);if(n){const h=vn(u.shape,r);return te(u,h)}return u}const BL=ne({logSumExp_:gie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yie(t,e){const n=G(t,"a","logicalAnd","bool"),s=G(e,"b","logicalAnd","bool");Xe(n.shape,s.shape);const r={a:n,b:s};return Q.runKernel(sv,r)}const ya=ne({logicalAnd_:yie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vie(t){const n={x:G(t,"x","logicalNot","bool")};return Q.runKernel(rv,n)}const IT=ne({logicalNot_:vie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xie(t,e){const n=G(t,"a","logicalOr","bool"),s=G(e,"b","logicalOr","bool");Xe(n.shape,s.shape);const r={a:n,b:s};return Q.runKernel(iv,r)}const VL=ne({logicalOr_:xie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wie(t,e){const n=G(t,"a","logicalXor","bool"),s=G(e,"b","logicalXor","bool");return Xe(n.shape,s.shape),ya(VL(t,e),IT(ya(t,e)))}const bie=ne({logicalXor_:wie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cie(t,e,n,s,r){const i=G(t,"x","maxPool"),o=1;let a=i,l=!1;i.rank===3&&(l=!0,a=te(i,[1,i.shape[0],i.shape[1],i.shape[2]])),L(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),L(ms(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),nr("maxPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r},h=Q.runKernel(lv,c,u);return l?te(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const kT=ne({maxPool_:Cie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sie(t,e=[1,1,1],n,s,r,i="NDHWC"){const o=G(t,"x","maxPool3d");let a=o,l=!1;o.rank===4&&(l=!0,a=te(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),L(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),L(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),nr("maxPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:i},h=Q.runKernel(cv,c,u);return l?te(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const Iie=ne({maxPool3d_:Sie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kie(t,e){let n=G(t,"a","maximum"),s=G(e,"b","maximum");[n,s]=cn(n,s),n.dtype==="bool"&&(n=Ee(n,"int32"),s=Ee(s,"int32")),Xe(n.shape,s.shape);const r={a:n,b:s};return Q.runKernel(Gm,r)}const Yl=ne({maximum_:kie});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tie(t,e=null,n=!1){const r={x:G(t,"x","mean")},i={axis:e,keepDims:n};return Q.runKernel(uv,r,i)}const yn=ne({mean_:Tie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bn(t,e="float32"){if(Ia(t),e==="complex64"){const s=Bn(t,"float32"),r=Bn(t,"float32");return au(s,r)}const n=fs(ue(t),e);return Q.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jl(t,e="float32"){if(Ia(t),e==="complex64"){const s=Jl(t,"float32"),r=Bn(t,"float32");return au(s,r)}const n=wk(ue(t),e);return Q.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eie(t,e){let n=G(t,"a","minimum"),s=G(e,"b","minimum");[n,s]=cn(n,s),n.dtype==="bool"&&(n=Ee(n,"int32"),s=Ee(s,"int32")),Xe(n.shape,s.shape);const r={a:n,b:s};return Q.runKernel(Hm,r)}const jp=ne({minimum_:Eie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nie(t,e,n){L(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=G(t,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");L(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=n==="reflect"?1:0;for(let a=0;a<s.rank;a++)L(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),L(e[a][0]>=0&&e[a][0]<=s.shape[a]-r&&e[a][1]>=0&&e[a][1]<=s.shape[a]-r,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-r} or less than 0 for input of shape ${s.shape}`);const i={paddings:e,mode:n},o={x:s};return Q.runKernel(dv,o,i)}const _ie=ne({mirrorPad_:Nie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ie(t,e){let n=G(t,"a","mod"),s=G(e,"b","mod");[n,s]=cn(n,s);const r={a:n,b:s};return Q.runKernel(Km,r)}const Rie=ne({mod_:$ie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aie(t,e=null,n=!1){t=G(t,"x","moments");const s=tt(e,t.shape),r=yn(t,s,n);let i=r.shape;n||(i=vn(r.shape,s));const o=Mt(ze(Ee(t,"float32"),te(r,i))),a=yn(o,s,n);return{mean:r,variance:a}}const TT=ne({moments_:Aie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Die(t,e){let n=G(t,"a","notEqual","string_or_numeric"),s=G(e,"b","notEqual","string_or_numeric");[n,s]=cn(n,s),Xe(n.shape,s.shape);const r={a:n,b:s};return Q.runKernel(pv,r)}const k2=ne({notEqual_:Die});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pie(t,e,n=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:G(t,"indices","oneHot","int32")},a={dtype:r,depth:e,onValue:n,offValue:s};return Q.runKernel(gv,o,a)}const UL=ne({oneHot_:Pie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oie(t){const n={x:G(t,"x","onesLike")};return Q.runKernel(mv,n)}const xi=ne({onesLike_:Oie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fie(t,e,n=0){const s=G(t,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:n},i={x:s};return Q.runKernel(vv,i,r)}const ET=ne({pad_:Fie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lie(t,e,n){const s=G(t,"x","spaceToBatchND");L(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),L(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),L(s.shape.reduce((o,a,l)=>l>0&&l<=e.length?o&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},i={blockShape:e,paddings:n};return Q.runKernel(Nv,r,i)}const NT=ne({spaceToBatchND_:Lie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mie(t,e,n,s,r,i,o){r==null&&(r=[1,1]),i==null&&(i=1),s===0&&(s="valid");const a=G(t,"x","maxPool");let l=a,c=!1;a.rank===3&&(c=!0,l=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),L(ms(i,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${r}'`);const u=wi(l.shape,e,i,r,s),h=[u.dilationHeight,u.dilationWidth];let d;s==="same"?d=Vie([u.filterHeight,u.filterWidth],h):d=[[0,0],[0,0]];const f=h[0]===1&&h[1]===1,[p,g]=Bie([u.inHeight,u.inWidth],h,d),m=f?s:"valid",y=f?l:NT(l,h,p),b=(n==="avg"?()=>mT(y,e,i,m,o):()=>kT(y,e,i,m,o))(),C=f?b:gT(b,h,g);return c?te(C,[C.shape[1],C.shape[2],C.shape[3]]):C}function Bie(t,e,n){const s=n.map(u=>u[0]),r=n.map(u=>u[1]),i=t.concat(s,r),o=e.map((u,h)=>(u-i[h]%u)%u),a=r.map((u,h)=>u+o[h]),l=e.map((u,h)=>[s[h],a[h]]),c=e.map((u,h)=>[0,o[h]]);return[l,c]}function Vie(t,e){const s=t.map((o,a)=>o+(o-1)*(e[a]-1)).map(o=>o-1),r=s.map(o=>Math.floor(o/2)),i=s.map((o,a)=>o-r[a]);return s.map((o,a)=>[r[a],i[a]])}const Uie=ne({pool_:Mie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zie(t,e){const n=G(t,"x","prelu"),s=G(e,"alpha","prelu"),r={x:n,alpha:s};return Q.runKernel(xv,r)}const _T=ne({prelu_:zie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wie(t,e=null,n=!1){let s=G(t,"x","prod");s.dtype==="bool"&&(s=Ee(s,"int32"));const r={x:s},i={axis:e,keepDims:n};return Q.runKernel(wv,r,i)}const jie=ne({prod_:Wie});var $T={exports:{}};$T.exports;(function(t){(function(e,n,s){function r(l){var c=this,u=a();c.next=function(){var h=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=h-(c.c=h|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function o(l,c){var u=new r(l),h=c&&c.state,d=u.next;return d.int32=function(){return u.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,h&&(typeof h=="object"&&i(h,u),d.state=function(){return i(u,{})}),d}function a(){var l=4022871197,c=function(u){u=String(u);for(var h=0;h<u.length;h++){l+=u.charCodeAt(h);var d=.02519603282416938*l;l=d>>>0,d-=l,d*=l,l=d>>>0,d-=l,l+=d*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=o:this.alea=o})(zn,t)})($T);var Gie=$T.exports,RT={exports:{}};RT.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(typeof u=="object"&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:this.xor128=o})(zn,t)})(RT);var Hie=RT.exports,AT={exports:{}};AT.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(typeof u=="object"&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:this.xorwow=o})(zn,t)})(AT);var Kie=AT.exports,DT={exports:{}};DT.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.x,h=l.i,d,f;return d=u[h],d^=d>>>7,f=d^d<<24,d=u[h+1&7],f^=d^d>>>10,d=u[h+3&7],f^=d^d>>>3,d=u[h+4&7],f^=d^d<<7,d=u[h+7&7],d=d^d<<13,f^=d^d<<9,u[h]=f,l.i=h+1&7,f};function c(u,h){var d,f=[];if(h===(h|0))f[0]=h;else for(h=""+h,d=0;d<h.length;++d)f[d&7]=f[d&7]<<15^h.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],u.x=f,u.i=0,d=256;d>0;--d)u.next()}c(l,a)}function i(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(u.x&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:this.xorshift7=o})(zn,t)})(DT);var qie=DT.exports,PT={exports:{}};PT.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.w,h=l.X,d=l.i,f,p;return l.w=u=u+1640531527|0,p=h[d+34&127],f=h[d=d+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=h[d]=p^f,l.i=d,p+(u^u>>>16)|0};function c(u,h){var d,f,p,g,m,y=[],w=128;for(h===(h|0)?(f=h,h=null):(h=h+"\0",f=0,w=Math.max(w,h.length)),p=0,g=-32;g<w;++g)h&&(f^=h.charCodeAt((g+32)%h.length)),g===0&&(m=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,g>=0&&(m=m+1640531527|0,d=y[g&127]^=f+m,p=d==0?p+1:0);for(p>=128&&(y[(h&&h.length||0)&127]=-1),p=127,g=4*128;g>0;--g)f=y[p+34&127],d=y[p=p+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,y[p]=f^d;u.w=m,u.X=y,u.i=p}c(l,a)}function i(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(u.X&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:this.xor4096=o})(zn,t)})(PT);var Xie=PT.exports,OT={exports:{}};OT.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var h=l.b,d=l.c,f=l.d,p=l.a;return h=h<<25^h>>>7^d,d=d-f|0,f=f<<24^f>>>8^p,p=p-h|0,l.b=h=h<<20^h>>>12^d,l.c=d=d-f|0,l.d=f<<16^d>>>16^p,l.a=p-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):c+=a;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var c=new r(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(typeof u=="object"&&i(u,c),h.state=function(){return i(c,{})}),h}n&&n.exports?n.exports=o:this.tychei=o})(zn,t)})(OT);var Yie=OT.exports,zL={exports:{}};const Jie={},Zie=Object.freeze(Object.defineProperty({__proto__:null,default:Jie},Symbol.toStringTag,{value:"Module"})),Qie=UR(Zie);(function(t){(function(e,n,s){var r=256,i=6,o=52,a="random",l=s.pow(r,i),c=s.pow(2,o),u=c*2,h=r-1,d;function f(C,k,$){var I=[];k=k==!0?{entropy:!0}:k||{};var T=y(m(k.entropy?[C,b(n)]:C??w(),3),I),R=new p(I),E=function(){for(var A=R.g(i),F=l,P=0;A<c;)A=(A+P)*r,F*=r,P=R.g(1);for(;A>=u;)A/=2,F/=2,P>>>=1;return(A+P)/F};return E.int32=function(){return R.g(4)|0},E.quick=function(){return R.g(4)/4294967296},E.double=E,y(b(R.S),n),(k.pass||$||function(A,F,P,Z){return Z&&(Z.S&&g(Z,R),A.state=function(){return g(R,{})}),P?(s[a]=A,F):A})(E,T,"global"in k?k.global:this==s,k.state)}function p(C){var k,$=C.length,I=this,T=0,R=I.i=I.j=0,E=I.S=[];for($||(C=[$++]);T<r;)E[T]=T++;for(T=0;T<r;T++)E[T]=E[R=h&R+C[T%$]+(k=E[T])],E[R]=k;(I.g=function(A){for(var F,P=0,Z=I.i,H=I.j,j=I.S;A--;)F=j[Z=h&Z+1],P=P*r+j[h&(j[Z]=j[H=h&H+F])+(j[H]=F)];return I.i=Z,I.j=H,P})(r)}function g(C,k){return k.i=C.i,k.j=C.j,k.S=C.S.slice(),k}function m(C,k){var $=[],I=typeof C,T;if(k&&I=="object")for(T in C)try{$.push(m(C[T],k-1))}catch{}return $.length?$:I=="string"?C:C+"\0"}function y(C,k){for(var $=C+"",I,T=0;T<$.length;)k[h&T]=h&(I^=k[h&T]*19)+$.charCodeAt(T++);return b(k)}function w(){try{var C;return d&&(C=d.randomBytes)?C=C(r):(C=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(C)),b(C)}catch{var k=e.navigator,$=k&&k.plugins;return[+new Date,e,$,e.screen,b(n)]}}function b(C){return String.fromCharCode.apply(0,C)}if(y(s.random(),n),t.exports){t.exports=f;try{d=Qie}catch{}}else s["seed"+a]=f})(typeof self<"u"?self:zn,[],Math)})(zL);var eoe=zL.exports,toe=Gie,noe=Hie,soe=Kie,roe=qie,ioe=Xie,ooe=Yie,_u=eoe;_u.alea=toe;_u.xor128=noe;_u.xorwow=soe;_u.xorshift7=roe;_u.xor4096=ioe;_u.tychei=ooe;var FT=_u;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WL{constructor(e,n,s,r,i){this.mean=e,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=FT.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,n,s=!1;for(;!s;){let r,i,o;do r=2*this.random()-1,i=2*this.random()-1,o=r*r+i*i;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*r*a,n=this.mean+this.stdDev*i*a,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class aoe{constructor(e=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=FT.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function loe(t,e=0,n=1,s,r){if(Ia(t),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const i=new WL(e,n,s,!1,r),o=et(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const coe=ne({randomNormal_:loe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uoe(t,e=0,n=1,s="float32",r){Ia(t);const i=et(t,s),o=new aoe(e,n,null,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const gg=ne({randomUniform_:uoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gp(t,e,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:t,stop:e,step:n,dtype:s};return Q.runKernel(Qk,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hoe(t){const n={input:G(t,"input","real")};return Q.runKernel(eT,n)}const T2=ne({real_:hoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function doe(t){const n={x:G(t,"x","reciprocal")};return Q.runKernel(Ym,n)}const foe=ne({reciprocal_:doe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function poe(t){const n={x:G(t,"x","relu")};return Q.runKernel(Jm,n)}const $u=ne({relu_:poe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function moe(t){const n={x:G(t,"x","relu6")};return Q.runKernel(Zm,n)}const jL=ne({relu6_:moe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function goe(t,e){const s={x:G(t,"x","reverse")},r={dims:e};return Q.runKernel(Iv,s,r)}const pu=ne({reverse_:goe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yoe(t){const n={x:G(t,"x","round")};return Q.runKernel(Qm,n)}const GL=ne({round_:yoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function voe(t){const n={x:G(t,"x","rsqrt","float32")};return Q.runKernel(eg,n)}const HL=ne({rsqrt_:voe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xoe(t){const n={x:G(t,"x","selu")};return Q.runKernel(tg,n)}const KL=ne({selu_:xoe});function woe(t,e,n,s,r,i=[1,1],o="NHWC"){const a=G(t,"x","separableConv2d"),l=G(e,"depthwiseFilter","separableConv2d"),c=G(n,"pointwiseFilter","separableConv2d");let u=a,h=!1;if(a.rank===3&&(h=!0,u=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");L(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),L(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),L(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),L(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),L(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const d=l.shape[2],f=l.shape[3];L(c.shape[2]===d*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*f}, but got ${c.shape[2]}.`);const p=xT(u,l,s,r,o,i),m=du(p,c,1,"valid",o);return h?te(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const qL=ne({separableConv2d_:woe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function boe(t){const n={x:G(t,"x","sign")};return Q.runKernel(rg,n)}const Coe=ne({sign_:boe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Soe(t){const n={x:G(t,"x","sin","float32")};return Q.runKernel(ng,n)}const XL=ne({sin_:Soe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ioe(t){const n={x:G(t,"x","sinh")};return Q.runKernel(sg,n)}const YL=ne({sinh_:Ioe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function koe(t,e,n){const s=G(t,"x","slice1d");return L(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),Pt(s,[e],[n])}const LT=ne({slice1d_:koe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Toe(t,e,n){const s=G(t,"x","slice2d");return L(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),Pt(s,e,n)}const JL=ne({slice2d_:Toe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eoe(t,e,n){const s=G(t,"x","slice3d");return L(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),Pt(s,e,n)}const MT=ne({slice3d_:Eoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Noe(t,e,n){const s=G(t,"x","slice4d");return L(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),Pt(s,e,n)}const E2=ne({slice4d_:Noe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _oe(t,e=-1){const n=G(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const s={logits:n},r={dim:e};return Q.runKernel($v,s,r)}const BT=ne({softmax_:_oe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $oe(t){L(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return Q.runKernel(zk,e)}const ZL=ne({fft_:$oe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Roe(t){L(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return Q.runKernel(Gk,e)}const HC=ne({ifft_:Roe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aoe(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const r=te(t,[n,e]);s=HC(r)}else{const r=[n,2*(e-1)],i=te(T2(t),[n,e]),o=te(CT(t),[n,e]),a=pu(Pt(i,[0,1],[n,e-2]),1),l=Y(pu(Pt(o,[0,1],[n,e-2]),1),gt(-1)),c=Js([i,a],1),u=Js([o,l],1),h=te(au(c,u),[r[0],r[1]]);s=HC(h)}if(s=T2(s),t.rank===3&&t.shape[0]!==0){const r=s,i=t.shape[0];s=te(s,[i,s.shape[0]/i,s.shape[1]]),r.dispose()}return s}const Doe=ne({irfft_:Aoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Poe(t,e,n=0){const r={x:G(t,"x","split")},i={numOrSizeSplits:e,axis:n};return Q.runKernel(_v,r,i)}const Vr=ne({split_:Poe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ooe(t,e){L(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const s=t.size/n;let r;if(e!=null&&e<n){const p=t.shape.map(m=>0),g=t.shape.map(m=>m);g[t.shape.length-1]=e,r=Pt(t,p,g),n=e}else if(e!=null&&e>n){const p=t.shape.map(g=>g);p[t.shape.length-1]=e-n,r=Js([t,Bn(p)],t.shape.length-1),n=e}else r=t;const i=lt(r),o=te(au(r,i),[s,n]),a=ZL(o),l=Math.floor(n/2)+1,c=T2(a),u=CT(a),h=Vr(c,[l,n-l],c.shape.length-1),d=Vr(u,[l,n-l],u.shape.length-1),f=r.shape.slice();return f[r.shape.length-1]=l,te(au(h[0],d[0]),f)}const Foe=ne({rfft_:Ooe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Loe(t,e){let n=G(t,"a","squaredDifference"),s=G(e,"b","squaredDifference");[n,s]=cn(n,s),Xe(n.shape,s.shape);const r={a:n,b:s},i={};return Q.runKernel(lg,r,i)}const Moe=ne({squaredDifference_:Loe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Boe(t,e){const n=G(t,"x","squeeze","string_or_numeric");return te(n,Gl(n.shape,e).newShape)}const yg=ne({squeeze_:Boe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Voe(t,e=0){const n=vL(t,"tensors","stack","string_or_numeric");L(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&L(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:e};return Q.runKernel(yv,s,r)}const va=ne({stack_:Voe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uoe(t,e=0){const s={x:G(t,"x","step")},r={alpha:e};return Q.runKernel(fg,s,r)}const vg=ne({step_:Uoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zoe(t,e,n,s,r=0,i=0,o=0,a=0,l=0){const u={x:G(t,"x","stridedSlice","string_or_numeric")},h={begin:e,end:n,strides:s,beginMask:r,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return Q.runKernel(iT,u,h)}const Woe=ne({stridedSlice_:zoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function joe(t){const n={x:G(t,"x","tan","float32")};return Q.runKernel(ug,n)}const Goe=ne({tan_:joe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mr(t,e){I5(t);const n=Ov(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Fv(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $w(t,e,n){if(I5(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Ov(t,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Fv(t,e,s,n)}function QL(t,e,n){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(i+` update.rank < ${r}. `);if(t.length<s+(n.rank-r))throw new Error(i+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+t.length-s)throw new Error(i+` update.rank != ${r+t.length-s}`);for(let o=0;o<r;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-r;++o)if(n.shape[o+r]!==t[o+s])throw new Error(i+` updates.shape[${o+r}] (${n.shape[o+r]}) != shape[${o+r}] (${t[o+r]})`)}function Hoe(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}QL(n,e,t)}function Ru(t,e,n){const s=e.shape.length,r=s>1?e.shape[s-1]:1,i=n.length;let o=1;for(let h=r;h<i;++h)o*=n[h];const a=r<1?1:r,l=ue(e.shape)/a,c=[...Pe(n.slice(0,r)),1],u=ue(n);return{sliceRank:r,numUpdates:l,sliceSize:o,strides:c,outputSize:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Koe(t,e=1,n=!0){const s=G(t,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const i={x:s},o={k:e,sorted:n},[a,l]=Q.runKernel(oT,i,o);return{values:a,indices:l}}const qoe=ne({topk_:Koe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xoe(t,e=0,n=1,s,r){if(Ia(t),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new WL(e,n,s,!0,r),o=et(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const eM=ne({truncatedNormal_:Xoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yoe(t,e=0){const n=G(t,"x","unique","string_or_numeric");L(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:e},[i,o]=Q.runKernel(lT,s,r);return{values:i,indices:o}}const Joe=ne({unique_:Yoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zoe(t,e,n){const s=G(t,"x","unsortedSegmentSum"),r=G(e,"segmentIds","unsortedSegmentSum","int32");L(cd(n),()=>"numSegments must be of dtype int");const i={x:s,segmentIds:r},o={numSegments:n};return Q.runKernel(Av,i,o)}const tM=ne({unsortedSegmentSum_:Zoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qoe(t,e=0){const n=G(t,"x","unstack","string_or_numeric");L(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:e};return Q.runKernel(Rv,s,r)}const mu=ne({unstack_:Qoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eae(t,e=!0,n,s){return Q.makeVariable(t,e,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nM(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const s=et(t,"int32"),r=et([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const o=s.indexToLoc(n[i]),a=i*t.length;r.values.set(o,a)}return r.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tae(t,e,n){const s=G(t,"x","transpose");if(e==null&&(e=s.shape.map((o,a)=>a).reverse()),L(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(o=>{L(o>=0&&o<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},i={perm:e};return s.dtype==="complex64"?re(()=>{let o=T2(s),a=CT(s);return o=Q.runKernel(Wh,{x:o},i),a=Q.runKernel(Wh,{x:a},i),n&&(a=ln(a)),au(o,a)}):Q.runKernel(Wh,r,i)}const at=ne({transpose_:tae});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nae(t,e){if(e==null)return t.shape.slice();if(yt(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let s=0;s<t.shape.length;s++)e[s]==null&&t.shape[s]!=null?n.push(t.shape[s]):n.push(e[s]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sae(t,e,n,s){const r=G(t,"x","dropout");if(L(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),L(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof kn?r.clone():r;const i=nae(r,n),o=1-e,a=Ve(zv(ve(gg(i,0,1,"float32",s),o)),o);return Y(r,a)}const rae=ne({dropout_:sae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iae(t,e,n,s,r,i="NHWC",o){let a=t;t.rank===3&&(a=te(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=te(e,[1,e.shape[0],e.shape[1],e.shape[2]])),L(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),L(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),L(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=i==="NHWC"?a.shape[3]:a.shape[1],u=i==="NHWC"?l.shape[3]:l.shape[1];L(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),L(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),nr("conv2dDerFilter",r,o);const h={x:a,dy:l},d={strides:s,pad:r,dataFormat:i,dimRoundingMode:o,filterShape:n};return Q.runKernel(Rk,h,d)}const VT=ne({conv2DBackpropFilter_:iae});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UT(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return Y(t,vg(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function zT(t,e){let n=e;const s=Rn(t.shape,e.shape);return s.length>0&&(n=Me(n,s)),te(n,t.shape)}function WT(t,e,n,s){if(e==="linear")return t;if(e==="relu")return $u(t);if(e==="elu")return Vv(t);if(e==="relu6")return jL(t);if(e==="prelu")return _T(t,n);if(e==="leakyrelu")return ST(t,s);if(e==="sigmoid")return Od(t);throw new Error(`Unknown fused activation ${e}.`)}const jT=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oae({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",jT(Q.state.gradientDepth,l)===!1){L(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let $=du(t,e,n,s,r,i,o);return a!=null&&($=ve($,a)),WT($,l,c,u)}const h=G(t,"x","conv2d","float32"),d=G(e,"filter","conv2d","float32");let f=h,p=!1;h.rank===3&&(p=!0,f=te(h,[1,h.shape[0],h.shape[1],h.shape[2]])),L(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),L(d.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`),nr("fused conv2d",s,o);const g=r==="NHWC"?f.shape[3]:f.shape[1];L(d.shape[2]===g,()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${d.shape[2]}.`),L(ms(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const m=Qn(f.shape,d.shape,n,i,s,o);let y;a!=null&&(y=G(a,"bias","fused conv2d"),[y]=cn(y,h),r==="NHWC"?Xe(m.outShape,y.shape):(L(y.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${y.shape.length}.`),L(y.shape.length===0||y.shape[0]===m.outChannels||y.shape[0]===1,()=>`Error in fused conv2d: bias shape (${y.shape}) is not compatible with the number of output channels (${m.outChannels})`)));let w;if(c!=null){const $=c.shape;if(L($.length<=1||$.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${$.length}.`),$.length===1)L($[0]===1||$[0]===m.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${$}) is not compatible with the number of output channels (${m.outChannels}).`);else if($.length===3)try{Xe($,m.outShape)}catch{const T=`Error in fused conv2d: PReLU activation weights (${$}) is not compatible with the output shape of the conv2d (${m.outShape}).`;throw Error(T)}w=G(c,"prelu weights","fused conv2d")}const b=($,I)=>{L(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[T,R,E,A]=I,F=UT($,E,l);L(uu(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const P=yT(R.shape,F,T,n,s),Z=VT(R,F,T.shape,n,s),H=[P,Z];if(A!=null){const j=zT(A,F);H.push(j)}return H},C={x:f,filter:d,bias:y,preluActivationWeights:w},k={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:u};return a==null?pd((I,T,R)=>{let E=Q.runKernel(v2,C,k);return R([T,I,E]),p&&(E=te(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:b}})(f,d):pd((I,T,R,E)=>{let A=Q.runKernel(v2,C,k);return E([T,I,A,R]),p&&(A=te(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:b}})(f,d,y)}const aae=ne({fusedConv2d_:oae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lae(t,e,n,s,r,i=[1,1],o){let a=t;t.rank===3&&(a=te(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=te(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:a,dy:l},u={strides:s,pad:r,dimRoundingMode:o,dilations:i,filterShape:n};return Q.runKernel(Mk,c,u)}const cae=ne({depthwiseConv2dNativeBackpropFilter_:lae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uae(t,e,n,s,r,i=[1,1],o){let a=e,l=!1;e.rank===3&&(l=!0,a=te(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:a,filter:n},u={strides:s,pad:r,dimRoundingMode:o,dilations:i,inputShape:t},h=Q.runKernel(Bk,c,u);return l?te(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const hae=ne({depthwiseConv2dNativeBackpropInput_:uae});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dae({a:t,b:e,transposeA:n=!1,transposeB:s=!1,bias:r,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(jT(Q.state.gradientDepth,i)===!1){let A=mt(t,e,n,s);return r!=null&&(A=ve(A,r)),WT(A,i,o,a)}let l=G(t,"a","fused matMul"),c=G(e,"b","fused matMul");[l,c]=cn(l,c);const u=n?l.shape[l.rank-2]:l.shape[l.rank-1],h=s?c.shape[c.rank-1]:c.shape[c.rank-2],d=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=s?c.shape[c.rank-2]:c.shape[c.rank-1],p=l.shape.slice(0,-2),g=c.shape.slice(0,-2),m=ue(p),y=ue(g);L(u===h,()=>`Error in fused matMul: inner shapes (${u}) and (${h}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${s} must match.`);const b=Xe(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([d,f]),C=n?te(l,[m,u,d]):te(l,[m,d,u]),k=s?te(c,[y,f,h]):te(c,[y,h,f]);let $;r!=null&&($=G(r,"bias","fused matMul"),[$]=cn($,l),Xe(b,$.shape));let I;o!=null&&(I=G(o,"prelu weights","fused matMul"));const T=(A,F)=>{const[P,Z,H,j]=F,ee=UT(te(A,H.shape),H,i);let z,X;if(!n&&!s?(z=mt(ee,Z,!1,!0),X=mt(P,ee,!0,!1)):!n&&s?(z=mt(ee,Z,!1,!1),X=mt(ee,P,!0,!1)):n&&!s?(z=mt(Z,ee,!1,!0),X=mt(P,ee,!1,!1)):(z=mt(Z,ee,!0,!0),X=mt(ee,P,!0,!0)),r!=null){const ie=zT(j,ee);return[z,X,ie]}else return[z,X]},R={a:C,b:k,bias:$,preluActivationWeights:I},E={transposeA:n,transposeB:s,activation:i,leakyreluAlpha:a};return r==null?pd((F,P,Z)=>{const H=Q.runKernel(y2,R,E);return Z([F,P,H]),{value:te(H,b),gradFunc:T}})(C,k):pd((F,P,Z,H)=>{const j=Q.runKernel(y2,R,E);return H([F,P,j,Z]),{value:te(j,b),gradFunc:T}})(C,k,$)}const p$=ne({fusedMatMul_:dae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fae(t,e,n,s,r="bilinear",i=0){const o=G(t,"image","cropAndResize"),a=G(e,"boxes","cropAndResize","float32"),l=G(n,"boxInd","cropAndResize","int32"),c=a.shape[0];L(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),L(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),L(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),L(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),L(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),L(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const u={image:o,boxes:a,boxInd:l},h={method:r,extrapolationValue:i,cropSize:s};return Q.runKernel(Ok,u,h)}const pae=ne({cropAndResize_:fae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mae(t){const e=G(t,"image","flipLeftRight","float32");L(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return Q.runKernel(jk,n,{})}const gae=ne({flipLeftRight_:mae});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yae(t){const e=G(t,"image","grayscaleToRGB"),n=e.rank-1,s=e.shape[n];L(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),L(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,n),r[n]=3,Oi(e,r)}const vae=ne({grayscaleToRGB_:yae});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xae(t){const e=G(t,"image","RGBToGrayscale"),n=e.rank-1,s=e.shape[n];L(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),L(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,i=Ee(e,"float32"),o=mr([.2989,.587,.114]);let a;switch(e.rank){case 2:a=Tf("ij,j->i",i,o);break;case 3:a=Tf("ijk,k->ij",i,o);break;case 4:a=Tf("ijkl,l->ijk",i,o);break;case 5:a=Tf("ijklm,m->ijkl",i,o);break;case 6:a=Tf("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return a=Ks(a,-1),Ee(a,r)}const wae=ne({rgbToGrayscale_:xae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bae(t,e,n=0,s=.5){const r=G(t,"image","rotateWithOffset","float32");L(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const i={image:r},o={radians:e,fillValue:n,center:s};return Q.runKernel(cT,i,o)}const Cae=ne({rotateWithOffset_:bae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ld(t,e,n,s,r,i){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=t.shape[0];return n=Math.min(n,o),L(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),L(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),L(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),L(e.rank===1,()=>"scores must be a 1D tensor"),L(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),L(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sae(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const i=G(t,"boxes","nonMaxSuppression","float32"),o=G(e,"scores","nonMaxSuppression","float32"),a=Ld(i,o,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return Q.runKernel(Yk,{boxes:i,scores:o},l)}const Iae=ne({nonMaxSuppression_:Sae});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kae(t,e,n){const s=Tae(t,e,n),r=s<0?-(s+1):s;t.splice(r,0,e)}function Tae(t,e,n){return Nae(t,e,n||Eae)}function Eae(t,e){return t>e?1:t<e?-1:0}function Nae(t,e,n){let s=0,r=t.length,i=0,o=!1;for(;s<r;){i=s+(r-s>>>1);const a=n(e,t[i]);a>0?s=i+1:(r=i,o=!a)}return o?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GT(t,e,n,s,r){return qT(t,e,n,s,r,0)}function HT(t,e,n,s,r,i){return qT(t,e,n,s,r,0,!1,i,!0)}function KT(t,e,n,s,r,i){return qT(t,e,n,s,r,i,!0)}function qT(t,e,n,s,r,i,o=!1,a=!1,l=!1){const c=[];for(let m=0;m<e.length;m++)e[m]>r&&c.push({score:e[m],boxIndex:m,suppressBeginIndex:0});c.sort(m$);const u=i>0?-.5/i:0,h=[],d=[];for(;h.length<n&&c.length>0;){const m=c.pop(),{score:y,boxIndex:w,suppressBeginIndex:b}=m;if(y<r)break;let C=!1;for(let k=h.length-1;k>=b;--k){const $=_ae(t,w,h[k]);if($>=s){C=!0;break}if(m.score=m.score*$ae(s,u,$),m.score<=r)break}m.suppressBeginIndex=h.length,C||(m.score===y?(h.push(w),d.push(m.score)):m.score>r&&kae(c,m,m$))}const f=h.length,p=n-f;a&&p>0&&(h.push(...new Array(p).fill(0)),d.push(...new Array(p).fill(0)));const g={selectedIndices:h};return o&&(g.selectedScores=d),l&&(g.validOutputs=f),g}function _ae(t,e,n){const s=t.subarray(e*4,e*4+4),r=t.subarray(n*4,n*4+4),i=Math.min(s[0],s[2]),o=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),h=Math.max(r[0],r[2]),d=Math.max(r[1],r[3]),f=(a-i)*(l-o),p=(h-c)*(d-u);if(f<=0||p<=0)return 0;const g=Math.max(i,c),m=Math.max(o,u),y=Math.min(a,h),w=Math.min(l,d),b=Math.max(y-g,0)*Math.max(w-m,0);return b/(f+p-b)}function $ae(t,e,n){const s=Math.exp(e*n*n);return n<=t?s:0}function m$(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Rae(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const i=G(t,"boxes","nonMaxSuppressionAsync"),o=G(e,"scores","nonMaxSuppressionAsync"),a=Ld(i,o,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l=await Promise.all([i.data(),o.data()]),c=l[0],u=l[1],{selectedIndices:h}=GT(c,u,n,s,r);return i!==t&&i.dispose(),o!==e&&o.dispose(),mr(h,"int32")}const Aae=Rae;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dae(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const o=G(t,"boxes","nonMaxSuppression"),a=G(e,"scores","nonMaxSuppression"),l=Ld(o,a,n,s,r,i);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c={boxes:o,scores:a},u={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:i},h=Q.runKernel(Zk,c,u);return{selectedIndices:h[0],selectedScores:h[1]}}const Pae=ne({nonMaxSuppressionWithScore_:Dae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Oae(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const o=G(t,"boxes","nonMaxSuppressionAsync"),a=G(e,"scores","nonMaxSuppressionAsync"),l=Ld(o,a,n,s,r,i);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c=await Promise.all([o.data(),a.data()]),u=c[0],h=c[1],{selectedIndices:d,selectedScores:f}=KT(u,h,n,s,r,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:mr(d,"int32"),selectedScores:mr(f)}}const Fae=Oae;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lae(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const o=G(t,"boxes","nonMaxSuppression"),a=G(e,"scores","nonMaxSuppression"),l=Ld(o,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,h=l.scoreThreshold,d={boxes:o,scores:a},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:h,padToMaxOutputSize:i},p=Q.runKernel(Jk,d,f);return{selectedIndices:p[0],validOutputs:p[1]}}const Mae=ne({nonMaxSuppressionPadded_:Lae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Bae(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const o=G(t,"boxes","nonMaxSuppressionAsync"),a=G(e,"scores","nonMaxSuppressionAsync"),l=Ld(o,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,h=l.scoreThreshold,[d,f]=await Promise.all([o.data(),a.data()]),{selectedIndices:p,validOutputs:g}=HT(d,f,c,u,h,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:mr(p,"int32"),validOutputs:gt(g,"int32")}}const Vae=Bae;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uae(t,e,n=!1,s=!1){const r=G(t,"images","resizeBilinear");L(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),L(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),L(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=r,o=!1;r.rank===3&&(o=!0,i=te(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:s,size:e},c=Q.runKernel(Sv,a,l);return o?te(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const sM=ne({resizeBilinear_:Uae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zae(t,e,n=!1,s=!1){const r=G(t,"images","resizeNearestNeighbor");L(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),L(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),L(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),L(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=r,o=!1;r.rank===3&&(o=!0,i=te(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:s,size:e},c=Q.runKernel(Cv,a,l);return o?te(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const rM=ne({resizeNearestNeighbor_:zae});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wae(t,e="binary",n=!1,s=.5){const r=G(t,"image","threshold"),i=.2989,o=.587,a=.114,l=r.shape[0]*r.shape[1];let c=Y(mr([s]),255),u,h,d,f;if(L(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),L(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),L(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),L(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[u,h,d]=Vr(r,[1,1,1],-1);const m=Y(u,i),y=Y(h,o),w=Y(d,a);f=ve(ve(m,y),w)}else f=t;if(e==="otsu"){const m=zse(Ee(GL(f),"int32"),Gc([]),256);c=jae(m,l)}const p=n?Fd(f,c):Hr(f,c);return Ee(Y(p,255),"int32")}function jae(t,e){let n=mr([-1]),s=mr([0]),r=mr([0]),i,o,a,l,c,u;for(let h=0;h<t.size-1;h++){i=Pt(t,0,h+1),o=Pt(t,h+1),c=Ve(Me(i),e),u=Ve(Me(o),e);const d=Me(Y(i,Gp(0,i.size)));a=Ve(d,Me(i));const f=Bv(o.shape,i.size),p=ve(Gp(0,o.size),f),g=Y(o,p);l=Ve(Me(g),Me(o));const m=ze(a,l),y=ze(a,l),w=Y(c,u);r=Y(Y(w,m),y);const b=Hr(r,s);s=Ds(b,r,s),n=Ds(b,mr([h]),n)}return n}const Gae=ne({threshold_:Wae});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hae(t,e,n="nearest",s="constant",r=0,i){const o=G(t,"image","transform","float32"),a=G(e,"transforms","transform","float32");L(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),L(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),L(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:o,transforms:a},c={interpolation:n,fillMode:s,fillValue:r,outputShape:i};return Q.runKernel(aT,l,c)}const Kae=ne({transform_:Hae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qae(t,e,n){const s=G(t,"a","bandPart");L(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[i,o]=s.shape.slice(-2);let a,l;typeof e=="number"?(L(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),L(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),a=G(e<0?i:e,"numLower","bandPart")):(L(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Ds(I2(e,0),i,jp(e,i))),typeof n=="number"?(L(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),L(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),l=G(n<0?o:n,"numUpper","bandPart")):(L(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Ds(I2(n,0),o,jp(n,o)));const c=te(Gp(0,i,1,"int32"),[-1,1]),u=Gp(0,o,1,"int32"),h=ze(c,u),d=ya(Fd(h,a),Nu(h,ln(l))),f=Bn([i,o],s.dtype);return te(va(mu(te(s,[-1,i,o])).map(p=>Ds(d,p,f))),r)}const Xae=ne({bandPart_:qae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yae(t){let e;if(Array.isArray(t)){e=!1,L(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=t[0].shape[0];for(let i=1;i<t.length;++i)L(t[i].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[i].shape[0]} vs. ${r})`)}else e=!0,t=Vr(t,t.shape[0],0).map(r=>yg(r,[0]));L(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],s=t;for(let r=0;r<t.length;++r)n.push(Q.tidy(()=>{let i=s[r];if(r>0)for(let o=0;o<r;++o){const a=Y(Me(Y(n[o],i)),n[o]);i=ze(i,a)}return Ve(i,Uv(i,"euclidean"))}));return e?va(n,0):n}const Jae=ne({gramSchmidt_:Yae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zae(t,e=!1){if(L(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return g$(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,c)=>l*c),s=mu(te(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),r=[],i=[];s.forEach(l=>{const[c,u]=g$(l,e);r.push(c),i.push(u)});const o=te(va(r,0),t.shape),a=te(va(i,0),t.shape);return[o,a]}}function g$(t,e=!1){return Q.tidy(()=>{L(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],s=t.shape[1];let r=FL(n),i=Hc(t);const o=$w([[1]],[1,1]);let a=Hc(o);const l=n>=s?s:n;for(let c=0;c<l;++c){const u=i,h=a,d=r;[a,i,r]=Q.tidy(()=>{const f=Pt(i,[c,c],[n-c,1]),p=Uv(f),g=Pt(i,[c,c],[1,1]),m=Ds(Hr(g,0),$w([[-1]]),$w([[1]])),y=ze(g,Y(m,p)),w=Ve(f,y);w.shape[0]===1?a=Hc(o):a=Js([o,Pt(w,[1,0],[w.shape[0]-1,w.shape[1]])],0);const b=ln(Ve(mt(m,y),p)),C=Pt(i,[c,0],[n-c,s]),k=Y(b,a),$=at(a);if(c===0)i=ze(C,mt(k,mt($,C)));else{const R=ze(C,mt(k,mt($,C)));i=Js([Pt(i,[0,0],[c,s]),R],0)}const I=at(k),T=Pt(r,[0,c],[n,r.shape[1]-c]);if(c===0)r=ze(T,mt(mt(T,a),I));else{const R=ze(T,mt(mt(T,a),I));r=Js([Pt(r,[0,0],[n,c]),R],1)}return[a,i,r]}),Ze([u,h,d])}return!e&&n>s&&(r=Pt(r,[0,0],[n,s]),i=Pt(i,[0,0],[s,s])),[r,i]})}const Qae=ne({qr_:Zae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oa={flipLeftRight:gae,grayscaleToRGB:vae,resizeNearestNeighbor:rM,resizeBilinear:sM,rgbToGrayscale:wae,rotateWithOffset:Cae,cropAndResize:pae,nonMaxSuppression:Iae,nonMaxSuppressionAsync:Aae,nonMaxSuppressionWithScore:Pae,nonMaxSuppressionWithScoreAsync:Fae,nonMaxSuppressionPadded:Mae,nonMaxSuppressionPaddedAsync:Vae,threshold:Gae,transform:Kae},ele={bandPart:Xae,gramSchmidt:Jae,qr:Qae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tle=new Map,nle=new Map;class Md{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class ai{constructor(){this.classNameMap={}}static getMap(){return ai.instance==null&&(ai.instance=new ai),ai.instance}static register(e){ai.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function me(t,e,n){L(t.className!=null,()=>"Class being registered does not have the static className property defined."),L(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),L(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const s=n,r=e+">"+s;return ai.register(t),tle.set(r,t),nle.set(t,r),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zl extends Md{minimize(e,n=!1,s){const{value:r,grads:i}=this.computeGradients(e,s);if(s!=null){const o=s.map(a=>({name:a.name,tensor:i[a.name]}));this.applyGradients(o)}else this.applyGradients(i);return Ze(i),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return cie(e,n)}dispose(){this.iterations_!=null&&Ze(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:gt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Zl,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iM extends Zl{static get className(){return"Adadelta"}constructor(e,n,s=null){super(),this.learningRate=e,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=Q.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Q.registeredVariables[s],o=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:re(()=>lt(i).variable(o))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:re(()=>lt(i).variable(o))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;re(()=>{const u=ve(Y(l,this.rho),Y(Mt(a),1-this.rho)),h=Y(Ve(ps(ve(c,this.epsilon)),ps(ve(l,this.epsilon))),a),d=ve(Y(c,this.rho),Y(Mt(h),1-this.rho));l.assign(u),c.assign(d);const f=ve(Y(h,-this.learningRate),i);i.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Ze(this.accumulatedGrads.map(e=>e.variable)),Ze(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oM extends Zl{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Q.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:re(()=>Bv(i.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const a=this.accumulatedGrads[r].variable;re(()=>{const l=ve(a,Mt(o));a.assign(l);const c=ve(Y(Ve(o,ps(ve(l,Q.backend.epsilon()))),-this.learningRate),i);i.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Ze(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aM extends Zl{static get className(){return"Adam"}constructor(e,n,s,r=null){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],re(()=>{this.accBeta1=gt(n).variable(),this.accBeta2=gt(s).variable()}),r==null&&(this.epsilon=Q.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);re(()=>{const s=ze(1,this.accBeta1),r=ze(1,this.accBeta2);n.forEach((i,o)=>{const a=Q.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:re(()=>lt(a).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:re(()=>lt(a).variable(l))});const c=Array.isArray(e)?e[o].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,h=this.accumulatedSecondMoment[o].variable,d=ve(Y(u,this.beta1),Y(c,1-this.beta1)),f=ve(Y(h,this.beta2),Y(Mt(c),1-this.beta2)),p=Ve(d,s),g=Ve(f,r);u.assign(d),h.assign(f);const m=ve(Y(Ve(p,ve(ps(g),this.epsilon)),-this.learningRate),a);a.assign(m)}),this.accBeta1.assign(Y(this.accBeta1,this.beta1)),this.accBeta2.assign(Y(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Ze(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Ze(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),re(()=>{this.accBeta1.assign(fu(this.beta1,this.iterations_+1)),this.accBeta2.assign(fu(this.beta2,this.iterations_+1))});const n=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lM extends Zl{static get className(){return"Adamax"}constructor(e,n,s,r=null,i=0){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],re(()=>{this.iteration=gt(0).variable(),this.accBeta1=gt(n).variable()}),r==null&&(this.epsilon=Q.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);re(()=>{const s=ze(1,this.accBeta1),r=Ve(-this.learningRate,ve(Y(this.iteration,this.decay),1));n.forEach((i,o)=>{const a=Q.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:lt(a).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:lt(a).variable(l)});const c=Array.isArray(e)?e[o].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,h=this.accumulatedWeightedInfNorm[o].variable,d=ve(Y(u,this.beta1),Y(c,1-this.beta1)),f=Y(h,this.beta2),p=ks(c),g=Yl(f,p);u.assign(d),h.assign(g);const m=ve(Y(Ve(r,s),Ve(d,ve(g,this.epsilon))),a);a.assign(m)}),this.iteration.assign(ve(this.iteration,1)),this.accBeta1.assign(Y(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Ze(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Ze(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XT extends Zl{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const o=Q.registeredVariables[s];re(()=>{const a=ve(Y(this.c,i),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=So(gt(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cM extends XT{static get className(){return"Momentum"}constructor(e,n,s=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=gt(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Q.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:re(()=>lt(i).variable(!1))});const o=this.accumulations[r].variable,a=Array.isArray(e)?e[r].tensor:e[s];a!=null&&re(()=>{let l;const c=ve(Y(this.m,o),a);this.useNesterov?l=ve(Y(this.c,ve(a,Y(c,this.m))),i):l=ve(Y(this.c,c),i),o.assign(c),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Ze(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uM extends Zl{static get className(){return"RMSProp"}constructor(e,n=.9,s=0,r=null,i=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,r==null&&(this.epsilon=Q.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Q.registeredVariables[s],o=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:re(()=>lt(i).variable(o))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:re(()=>lt(i).variable(o))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:re(()=>lt(i).variable(o))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;re(()=>{const u=ve(Y(l,this.decay),Y(Mt(a),1-this.decay));if(this.centered){const h=this.accumulatedMeanGrads[r].variable,d=ve(Y(h,this.decay),Y(a,1-this.decay)),f=Ve(Y(a,this.learningRate),ps(ze(u,ve(Mt(d),this.epsilon)))),p=ve(Y(c,this.momentum),f);l.assign(u),h.assign(d),c.assign(p);const g=ze(i,p);i.assign(g)}else{const h=ve(Y(l,this.decay),Y(Mt(a),1-this.decay)),d=ve(Y(c,this.momentum),Ve(Y(a,this.learningRate),ps(ve(h,this.epsilon))));l.assign(h),c.assign(d);const f=ze(i,d);i.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Ze(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Ze(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Ze(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sle=[iM,oM,aM,lM,cM,uM,XT];function rle(){for(const t of sle)me(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y$(t,e,n,s){o(t),n=n??0,s=s??1,a(n,s);let r=0;const i=l=>(l.then(c=>{const u=n+ ++r/t.length*(s-n);return e(u),c}),l);function o(l){L(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,c){L(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),L(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),L(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(t.map(i))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function ile(t,e){e==null&&(e={});const n=e.fetchFunc==null?oe().platform.fetch:e.fetchFunc,s=t.map(h=>n(h,e.requestInit,{isBinary:!0})),a=(e.onProgress==null?await Promise.all(s):await y$(s,e.onProgress,0,.5)).map(h=>h.arrayBuffer());return e.onProgress==null?await Promise.all(a):await y$(a,e.onProgress,.5,1)}function ole(t,e){var n;const s=e.fetchFunc==null?oe().platform.fetch:e.fetchFunc;let r=0,i;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async o=>{for(var a;r<t.length;){i||(i=(await s(t[r],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:c}=await i.read();if(l){r++,i=void 0,(a=e.onProgress)===null||a===void 0||a.call(e,r/t.length);continue}o.enqueue(c);return}o.close()}})}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ale="application/octet-stream",lle="application/json";class YT{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(L(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=oe().platform.fetch,L(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&L(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=Cne(e,s);if(n.body.append("model.json",new Blob([JSON.stringify(r)],{type:lle}),"model.json"),e.weightData!=null){const o=Kl.join(e.weightData);n.body.append("model.weights.bin",new Blob([o],{type:ale}),"model.weights.bin")}const i=await this.fetch(this.path,n);if(i.ok)return{modelArtifactsInfo:fT(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const s=n.modelTopology,r=n.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return Ine(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),s=h$(e.weightsManifest),r=()=>ole(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:s,getWeightStream:r})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=cle(n),i=this.weightPathPrefix||s,o=[],a=[];for(const l of e)for(const c of l.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(c)):o.push(i+c+r);return this.weightUrlConverter&&o.push(...await Promise.all(a)),o}async loadWeights(e){const n=await this.getWeightUrls(e),s=h$(e),r=await ile(n,this.loadOptions);return[s,r]}}YT.URL_SCHEME_REGEX=/^https?:\/\//;function cle(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),s=t.substring(0,e),r=n>e?t.substring(n):"";return[s+"/",r]}function v$(t){return t.match(YT.URL_SCHEME_REGEX)!=null}const hM=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(s=>v$(s)):n=v$(t),n)return dM(t,e)}return null};Fn.registerSaveRouter(hM);Fn.registerLoadRouter(hM);function dM(t,e){return new YT(t,e)}function ule(t,e){return dM(t,e)}function JT(t,e){const n=t.shape.length,s=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${n}`);if(ue(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const r=e.shape,i=r[r.length-1];let o=1;for(let h=0;h<r.length-1;++h)o*=r[h];const a=t.shape,l=r.slice();l.pop();let c=1;for(let h=i;h<n;++h)c*=a[h],l.push(a[h]);const u=[...Pe(t.shape).map(h=>h/c),1].slice(0,i);return[l,o,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KC=-2,hle=-1;function ZT(t,e,n){const s=t.shape.length;L(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),L(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)L(e[r]+n[r]<=t.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+n[r]}) would overflow input.shape[${r}] (${t.shape[r]})`)}function dle(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function QT(t,e,n){const s=[];for(let r=0;r<t.length;r++)s[r]=Math.ceil((e[r]-t[r])/n[r]);return s}function fM(t,e,n,s){const r=[...t];for(let i=r.length;i<s.length;i++)r.push(1);for(let i=0;i<n;i++)i===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function pM(t,e,n){return n<=t?n:n-(e-1)}function mM(t,e){const n=[];for(let s=0;s<t;s++)n.push(e+s);return n}function fle(t,e,n,s,r,i,o,a,l){const c=t.length;let u=new Array(c),h=new Array(c),d=new Array(c);if(e.length&&n>0){const f=e[0],p=n+1;u=gM(o,f,p,s,t),h=yM(a,f,p,r,t),d=fM(i,f,p,t)}else for(let f=0;f<c;f++)u[f]=xM(o,s,i,t,f,l),h[f]=wM(a,r,i,t,f,l),d[f]=vM(i,f,l);return{begin:u,end:h,strides:d}}function gM(t,e,n,s,r){const i=[...r],o=mM(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=0;else{const l=pM(e,n,a);let c=s[l];t&1<<l&&(c=0),i[a]=c}return i}function yM(t,e,n,s,r){const i=[...r],o=mM(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=Number.MAX_SAFE_INTEGER;else{const l=pM(e,n,a);let c=s[l];t&1<<l&&(c=Number.MAX_SAFE_INTEGER),i[a]=c}for(let a=0;a<i.length;a++){const l=r[a];i[a]<0&&(i[a]+=l),i[a]=iu(0,i[a],r[a])}return i}function vM(t,e,n){let s=t[e];return(n&1<<e||s==null)&&(s=1),s}function xM(t,e,n,s,r,i){let o=e[r];const a=n[r]||1;(t&1<<r||i&1<<r||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=s[r];return o<0&&(o+=l),o=iu(0,o,l-1),o}function wM(t,e,n,s,r,i){let o=e[r];const a=n[r]||1;(t&1<<r||i&1<<r||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=s[r];return o<0&&(o+=l),a>0?o=iu(0,o,l):o=iu(-1,o,l-1),o}function e3(t,e,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(e[r]>0||n[r]!==t[r])return!1;return!0}function t3(t,e){let n=t.length>0?t[t.length-1]:1;for(let s=0;s<t.length-1;s++)n+=t[s]*e[s];return n}function Wv(t,e,n){let s;const r=t.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(o=>{L(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(r).fill(-1):typeof n=="number"?i=[n,...new Array(r-1).fill(-1)]:n.length<r?i=n.concat(new Array(r-n.length).fill(-1)):i=n,i=i.map((o,a)=>o>=0?o:(L(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),t.shape[a]-s[a])),[s,i]}function n3(t,e,n,s,r,i,o,a,l){let c;if(s==null?(c=new Array(e.length),c.fill(1)):c=s,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const h={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:r,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let b=0;b<h.dims;b++)u&&1<<b&a&&h.numAddAxisAfterEllipsis++,1<<b&o&&(u=!0);u||(h.ellipsisMask|=1<<h.dims,h.dims++);const d={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};ple(h,d);let f=!0,p=!0,g=!0;const m=[],y=[];for(let b=0;b<t.length;++b){if(d.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);const C=!!(d.shrinkAxisMask&1<<b),k=t[b];if(k===-1){m.push(C?1:-1);continue}const $=[d.beginMask&1<<b,d.endMask&1<<b],I=[d.strides[b]>0?0:-1,d.strides[b]>0?k:k-1];if(C&&d.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&d.strides[b]===1;const T=!!(d.beginMask&1<<b&&d.endMask&1<<b);if(d.beginValid&&d.endValid){if(C){const F=d.begin[b]<0?k+d.begin[b]:d.begin[b];if(d.begin[b]=F,d.end[b]=d.begin[b]+1,F<0||F>=k)throw Error(`slice index ${d.begin[b]} of dimension ${b} out of bounds.`)}else d.begin[b]=x$(d.begin[b],0,d.strides[b],k,$,I),d.end[b]=x$(d.end[b],1,d.strides[b],k,$,I);const A=d.strides[b]===1&&d.begin[b]===0&&d.end[b]===k;f=f&&A,p=p&&(b===0&&d.strides[b]===1||A)}else f=f&&d.strides[b]===1&&T,p=p&&(b===0&&d.strides[b]===1||T);let R,E=!1;if(d.beginValid&&d.endValid?(R=d.end[b]-d.begin[b],E=!0):C?(R=1,E=!0):T&&k>=0&&(d.strides[b]<0?R=-k:R=k,E=!0),E){let A;R===0||R<0!=d.strides[b]<0?A=0:A=Math.trunc(R/d.strides[b])+(R%d.strides[b]!==0?1:0),m.push(A)}else m.push(-1)}for(let b=0;b<d.finalShapeGatherIndices.length;++b){const C=d.finalShapeGatherIndices[b];C>=0?y.push(m[C]):C===KC&&y.push(1)}return{finalShapeSparse:y.filter((b,C)=>d.finalShapeGatherIndices[C]!==KC),finalShape:y,isIdentity:f,sliceDim0:p,isSimpleSlice:g,begin:d.begin,end:d.end,strides:d.strides}}function ple(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<t.dims;s++)if(1<<s&t.ellipsisMask){const r=Math.min(e.dims-(t.dims-s)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<r;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&t.newAxisMask)e.finalShapeGatherIndices.push(KC),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[s]),t.end!=null&&(e.end[n]=t.end[s]),e.strides[n]=t.strides[s],t.beginMask&1<<s&&(e.beginMask|=1<<n),t.endMask&1<<s&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(hle),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[n]=s,n++}}function x$(t,e,n,s,r,i){if(r[e])return n>0?i[e]:i[e+1&1];{const o=t<0?s+t:t;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const mle=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:ZT,computeFlatOffset:t3,computeOutShape:QT,getNormalizedAxes:fle,isSliceContinous:e3,maskToAxes:dle,parseSliceParams:Wv,sliceInfo:n3,startForAxis:xM,startIndicesWithElidedDims:gM,stopForAxis:wM,stopIndicesWithElidedDims:yM,stridesForAxis:vM,stridesWithElidedDims:fM},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gle{static sgd(e){return new XT(e)}static momentum(e,n,s=!1){return new cM(e,n,s)}static rmsprop(e,n=.9,s=0,r=null,i=!1){return new uM(e,n,s,r,i)}static adam(e=.001,n=.9,s=.999,r=null){return new aM(e,n,s,r)}static adadelta(e=.001,n=.95,s=null){return new iM(e,n,s)}static adamax(e=.002,n=.9,s=.999,r=null,i=0){return new lM(e,n,s,r,i)}static adagrad(e,n=.1){return new oM(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rh=gle;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yle=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function bM(){return new Promise(t=>yle(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s3(t,e){const n=t[0].length;t.forEach((r,i)=>{L(r.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),L(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=t[0];t.forEach((r,i)=>{for(let o=0;o<n;o++)L(o===e||r[o]===s[o],()=>`Error in concat${n}D: Shape of tensors[${i}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${i}.`)})}function Io(t,e){const n=t[0].slice();for(let s=1;s<t.length;s++)n[e]+=t[s][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Pi;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(Pi||(Pi={}));function CM(t,e,n){let s=new Array;if(n==null&&e==null)return s;if(e==null)for(;s.length<t+n.length;)s.push(-1);else s=e.slice();if(n==null)return s;if(t+n.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const i=n[r],o=s[s.length-n.length+r],a=s[o];if(i>=0)if(a>=0){if(a!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+t}] = ${i} but shape[${r+t}] = ${a}`)}else s[o]=i}return s}function SM(t){const e={FIRST_DIM_SIZE:Pi.FIRST_DIM_SIZE,VALUE_ROWIDS:Pi.VALUE_ROWIDS,ROW_LENGTHS:Pi.ROW_LENGTHS,ROW_SPLITS:Pi.ROW_SPLITS,ROW_LIMITS:Pi.ROW_LIMITS,ROW_STARTS:Pi.ROW_STARTS},n=[];for(const s of t)if(s in e)n.push(e[s]);else break;return n}function IM(t){return t.length===0?0:t[0]===Pi.FIRST_DIM_SIZE?t.length-1:t.length}function kM(t,e){if(t==null||e==null)return;const n=t.length,s=e.length;if(n>=s)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const i=t[r],o=e[r+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-t.length}] = ${i} but ragged tensor input.flatValues.shape[${r-t.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r3=30;function jv(t){return t<=r3?t:$C(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i3(t,e,n){const s=n*(typeof t=="number"?t:t[0]),r=e*(typeof t=="number"?t:t[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xg(t,e,n,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const i=e.length;for(let o=0;o<i;++o)r=r.concat([t[o+1]/e[o],e[o]]);r=r.concat(t.slice(i+1))}return r}function wg(t,e,n=!0){const s=[];if(n){s.push(e);for(let r=e+1;r<t;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],i=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?i.push(o):r.push(o);s.push(...r),s.push(0),s.push(...i)}return s}function bg(t,e,n,s=!0){const r=[];s?r.push(t[0]/n):r.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?s?r.push(e[i-1]*t[i]):r.push(t[i]/e[i-1]):r.push(t[i]);return r}function o3(t,e){const n=[0];for(let s=0;s<e;++s)n.push(t[s][0]);return n}function a3(t,e,n){const s=t.slice(0,1);for(let r=0;r<n;++r)s.push(t[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gv=1.7580993408473768,Hv=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l3=.3275911,c3=.254829592,u3=-.284496736,h3=1.421413741,d3=-1.453152027,f3=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xa(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let s=0;s<n.length;s+=2)n[s]=t[s/2],n[s+1]=e[s/2];return n}function TM(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let s=0;s<t.length;s+=2)e[s/2]=t[s],n[s/2]=t[s+1];return{real:e,imag:n}}function EM(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function NM(t){const e=Math.floor(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function p3(t,e){const n=t[e*2],s=t[e*2+1];return{real:n,imag:s}}function _M(t,e,n,s){t[s*2]=e,t[s*2+1]=n}function $M(t,e){const n=new Float32Array(t/2),s=new Float32Array(t/2);for(let r=0;r<Math.ceil(t/2);r++){const i=(e?2:-2)*Math.PI*(r/t);n[r]=Math.cos(i),s[r]=Math.sin(i)}return{real:n,imag:s}}function RM(t,e,n){const s=(n?2:-2)*Math.PI*(t/e),r=Math.cos(s),i=Math.sin(s);return{real:r,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rw="->",vle=/->/g,w$=",",b$="...";function m3(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(vle,"").length)/Rw.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${Rw}").`);const[s,r]=t.split(Rw);L(s.indexOf(b$)===-1,()=>`The ellipsis notation ("${b$}") is not supported yet.`);const i=s.split(w$),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let d=0;d<r.length;++d){const f=r[d];if(!i.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let d=0;d<s.length;++d){const f=s[d];a.indexOf(f)===-1&&f!==w$&&a.push(f)}const l=new Array(i.length);for(let d=0;d<o;++d){if(new Set(i[d].split("")).size!==i[d].length)throw new Error(`Found duplicate axes in input component ${i[d]}. Support for duplicate axes in input is not implemented yet.`);l[d]=[];for(let f=0;f<i[d].length;++f)l[d].push(a.indexOf(i[d][f]))}const c=a.length,u=r.length,h=[];for(let d=u;d<c;++d)h.push(d);return{allDims:a,summedDims:h,idDims:l}}function g3(t,e){let n=new Array(t);n.fill(-1);for(let r=0;r<e.length;++r)n[e[r]]=r;const s=[];for(let r=0;r<t;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function y3(t,e,n){const s=new Array(t);for(let r=0;r<n.length;++r){const i=n[r].shape;for(let o=0;o<e[r].length;++o)s[e[r][o]]===void 0?s[e[r][o]]=i[o]:L(s[e[r][o]]===i[o],()=>`Expected dimension ${s[e[r][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function v3(t,e){const n=t,s=[];let r=0;t.length===0&&n.push(-1),r=t.length+1;for(let o=0;o<r;++o)s.push([]);const i=[];for(let o=0;o<n.length;++o){const a=n[o],l=xle(e,a);for(const c of l)i.indexOf(c)===-1&&(s[o].push(c),i.push(c))}return{path:n,steps:s}}function x3(t){return t.every((e,n)=>e===n)}function xle(t,e){const n=[];for(let s=0;s<t.length;++s)(t[s].length===0||t[s].indexOf(e)!==-1||e===-1)&&n.push(s);return n}function w3(t,e,n=0){let s=[];if(typeof e=="number")L(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(t.shape[n]/e);else{const r=e.reduce((o,a)=>(a===-1&&(o+=1),o),0);L(r<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const o=e.reduce((a,l)=>l>0?a+l:a);e[i]=t.shape[n]-o}L(t.shape[n]===e.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AM(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function DM(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function PM(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OM(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function FM(t,e){return`size ${t} must be non-negative, not ${e}`}function LM(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function MM(t,e){const n=ue(t),s=ue(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${t} outputShape= ${e}`}function BM(t,e){const n=ue(t),s=ue(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qC(){return"segment ids must be >= 0"}function VM(){return"segment ids are not increasing"}function UM(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function zM(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WM(t,e){let n=!1,s;for(t<=r3?(s=t,n=!0):s=$C(t,Math.floor(Math.sqrt(t)));!n;)s>e||s===t?n=!0:s=$C(t,s+1);return s}function jM(t,e,n){const s=[],r=t.length;for(let i=0;i<r;i++)i!==e?s.push(t[i]):s.push(n);return s}function b3(t,e,n,s){const r=e.shape.length,i=t.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>i)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${i}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let h=0;h<s;++h)if(t.shape[h]!==e.shape[h])throw new Error(`x.shape[${h}]: ${t.shape[h]} should be equal to indices.shape[${h}]: ${e.shape[h]}.`);const o=t.shape[n],a=[];let l=1,c=1,u=1;for(let h=0;h<s;++h)a.push(t.shape[h]),l*=t.shape[h];for(let h=s;h<n;h++)a.push(t.shape[h]),c*=t.shape[h];for(let h=s;h<r;h++)a.push(e.shape[h]);for(let h=n+1;h<i;h++)a.push(t.shape[h]),u*=t.shape[h];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:o,outputShape:a}}const wle=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:b3,computeOutShape:jM,segOpComputeOptimalWindowSize:WM},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wa(t){try{return t.map(e=>Rl(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function GM(t){return t.map(e=>Sl(e))}const ble=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:c3,ERF_A2:u3,ERF_A3:h3,ERF_A4:d3,ERF_A5:f3,ERF_P:l3,PARALLELIZE_THRESHOLD:r3,get RowPartitionType(){return Pi},SELU_SCALE:Hv,SELU_SCALEALPHA:Gv,applyActivation:WT,assertAndGetBroadcastShape:Xe,assertAxesAreInnerMostDims:es,assertParamsConsistent:s3,assignToTypedArray:_M,axesAreInnerMostDims:wT,calculateShapes:Ru,checkEinsumDimSizes:y3,checkPadOnDimRoundingMode:nr,combineLocations:PL,combineRaggedTensorToTensorShapes:CM,complexWithEvenIndex:EM,complexWithOddIndex:NM,computeConv2DInfo:Qn,computeConv3DInfo:ql,computeDefaultPad:pT,computeDilation2DInfo:pg,computeOptimalWindowSize:jv,computeOutAndReduceShapes:Wn,computeOutShape:Io,computePool2DInfo:wi,computePool3DInfo:ka,convertConv2DDataFormat:Ta,decodeEinsumEquation:m3,eitherStridesOrDilationsAreOne:ms,expandShapeToKeepDim:vn,exponent:RM,exponents:$M,fromStringArrayToUint8:GM,fromUint8ToStringArray:wa,getAxesPermutation:Zt,getBroadcastDims:fd,getComplexWithIndex:p3,getEinsumComputePath:v3,getEinsumPermutation:g3,getFusedBiasGradient:zT,getFusedDyActivation:UT,getImageCenter:i3,getInnerMostAxes:un,getPermuted:wg,getRaggedRank:IM,getReductionAxes:Rn,getReshaped:xg,getReshapedPermuted:bg,getRowPartitionTypesHelper:SM,getSliceBeginCoords:o3,getSliceSize:a3,getSparseFillEmptyRowsIndicesDenseShapeMismatch:AM,getSparseFillEmptyRowsNegativeIndexErrorMessage:DM,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:PM,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:LM,getSparseReshapeInputOutputMismatchErrorMessage:BM,getSparseReshapeInputOutputMultipleErrorMessage:MM,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:OM,getSparseReshapeNegativeOutputDimErrorMessage:FM,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:zM,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:qC,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:VM,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:UM,getUndoAxesPermutation:Xl,isIdentityPermutation:x3,log:Ute,mergeRealAndImagArrays:xa,prepareAndValidate:JT,prepareSplitSize:w3,segment_util:wle,shouldFuse:jT,slice_util:mle,splitRealAndImagArrays:TM,stridesOrDilationsArePositive:hu,tupleValuesAreOne:uu,upcastType:xr,validateDefaultValueShape:kM,validateInput:Hoe,validateUpdateShape:QL,warn:Or},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */rle();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HM={kernelName:Py,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(t,vg(Ee(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cle={kernelName:xm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Mt(Ee(n,"float32")),r=ps(ze(gt(1),s));return ln(Ve(t,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sle={kernelName:wm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=ps(ze(Mt(Ee(n,"float32")),1));return Ve(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ile={kernelName:Pd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Xe(n.shape,s.shape);return{a:()=>{let a=t;const l=Rn(n.shape,r);return l.length>0&&(a=Me(a,l)),te(a,n.shape)},b:()=>{let a=t;const l=Rn(s.shape,r);return l.length>0&&(a=Me(a,l)),te(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kle={kernelName:Sk,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((s,r)=>{n[r]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tle={kernelName:Oy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>lt(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ele={kernelName:Fy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>lt(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nle={kernelName:bm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ve(t,ps(ze(gt(1),Mt(Ee(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _le={kernelName:Cm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=ps(ve(gt(1),Mt(Ee(n,"float32"))));return Ve(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $le={kernelName:km,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Xe(n.shape,s.shape);return{a:()=>{const a=ve(Mt(n),Mt(s));let l=Y(t,Ve(s,a));const c=Rn(n.shape,r);return c.length>0&&(l=Me(l,c)),te(l,n.shape)},b:()=>{const a=ve(Mt(n),Mt(s));let l=ln(Y(t,Ve(n,a)));const c=Rn(s.shape,r);return c.length>0&&(l=Me(l,c)),te(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rle={kernelName:Sm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ve(t,ve(Mt(Ee(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ale={kernelName:Im,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ve(t,ze(gt(1),Mt(Ee(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dle(t,e,n,s,r,i){const o=G(t,"dy","avgPool3dGrad"),a=G(e,"input","avgPool3dGrad");let l=o,c=a,u=!1;a.rank===4&&(u=!0,l=te(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=te(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),L(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),L(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),nr("avgPool3dGrad",r,i);const h={dy:l,input:c},d={filterSize:n,strides:s,pad:r,dimRoundingMode:i},f=Q.runKernel(Ek,h,d);return u?te(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const Ple=ne({avgPool3dGrad_:Dle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ole={kernelName:My,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:i,pad:o,dimRoundingMode:a}=n;return{x:()=>Ple(t,s,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fle(t,e,n,s,r){const i=G(t,"dy","avgPoolGrad"),o=G(e,"input","avgPoolGrad");L(o.rank===i.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${i.rank})`);let a=o,l=i,c=!1;o.rank===3&&(c=!0,a=te(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=te(i,[1,i.shape[0],i.shape[1],i.shape[2]])),L(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),L(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const u={dy:l,input:a},h={filterSize:n,strides:s,pad:r},d=Q.runKernel(Tk,u,h);return c?te(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Lle=ne({avgPoolGrad_:Fle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mle={kernelName:Ly,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:i,pad:o}=n;return{x:()=>Lle(t,s,r,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ble={kernelName:By,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[s,r]=e,{transposeA:i,transposeB:o}=n;return!i&&!o?{a:()=>mt(t,r,!1,!0),b:()=>mt(s,t,!0,!1)}:!i&&o?{a:()=>mt(t,r,!1,!1),b:()=>mt(t,s,!0,!1)}:i&&!o?{a:()=>mt(r,t,!1,!0),b:()=>mt(s,t,!1,!1)}:{a:()=>mt(r,t,!0,!0),b:()=>mt(t,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vle={kernelName:Vy,gradFunc:(t,e,n)=>{const{blockShape:s,crops:r}=n;return{x:()=>NT(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ule={kernelName:Lte,gradFunc:(t,e,n)=>{const s=n,r=s.inputShape,i=s.shape,o=Array.from(i);for(let l=r.length-1;l>=0;l--)if(r[l]===i[l])o[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${i}].`);const a=[];for(let l=0;l<o.length;l++)o[l]>1&&a.push(l);return{x:()=>Me(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zle={kernelName:Tm,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wle={kernelName:Em,gradFunc:t=>({x:()=>lt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jle={kernelName:Nm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{clipValueMin:r,clipValueMax:i}=n;return{x:()=>Ds(ya(Nu(s,r),Fd(s,i)),t,lt(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gle={kernelName:Uy,inputsToSave:["x"],gradFunc:HM.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hle={kernelName:zy,saveAllInputs:!0,gradFunc:(t,e,n)=>{const s=e.map(l=>l.shape),{axis:r}=n,i=tt(r,e[0].shape)[0],o=s.map(l=>l[i]);return Vr(t,o,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kle={kernelName:Wy,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{dilations:i,strides:o,pad:a,dataFormat:l}=n;return L(uu(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>yT(s.shape,t,r,o,a,l),filter:()=>VT(s,t,r.shape,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qle={kernelName:jy,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{strides:i,pad:o,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>du(t,r,i,o,a,1,l),filter:()=>VT(t,s,r.shape,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xle(t,e,n,s,r){let i=t;t.rank===4&&(i=te(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;o.rank===4&&(o=te(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),L(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),L(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),L(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),L(i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),L(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:i,dy:o},l={strides:s,pad:r,filterShape:n};return Q.runKernel(Ak,a,l)}const Yle=ne({conv3DBackpropFilter_:Xle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jle={kernelName:Gy,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:i}=n;L(uu(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[o,a]=e;return{x:()=>$L(o.shape,t,a,r,i),filter:()=>Yle(o,t,a.shape,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zle={kernelName:_m,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(ln(XL(Ee(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qle={kernelName:$m,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(YL(Ee(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ece={kernelName:Hy,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r,exclusive:i,reverse:o}=n;return{x:()=>{const a=Zt([r],s.rank);let l=AL(t,r,i,!o);return a!=null&&(l=at(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tce={kernelName:Ky,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:i,dimRoundingMode:o}=n,a=s??[1,1];L(uu(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,c]=e;return L(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),L(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),L(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),L(ms(r,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${a}'.`),nr("depthwiseConv2d",i,o),{x:()=>hae(l.shape,t,c,r,i,a,o),filter:()=>cae(l,t,c.shape,r,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nce={kernelName:qy,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,i={x:s,filter:r,dy:t},o={x:s,filter:r,dy:t};return{x:()=>Q.runKernel(RC,i,n),filter:()=>Q.runKernel(AC,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sce={kernelName:Am,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,s={dy:t,y:n};return{x:()=>Q.runKernel(Uk,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rce={kernelName:Dm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=Y(_o(ln(Mt(n))),2/Math.sqrt(Math.PI));return{x:()=>Y(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ice={kernelName:Pm,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oce={kernelName:Yy,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>te(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ace={kernelName:Om,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(t,_o(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lce={kernelName:Fm,gradFunc:t=>({x:()=>lt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cce={kernelName:Lm,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Xe(n.shape,s.shape);return{a:()=>{const a=Ve(t,Ee(s,"float32")),l=Rn(n.shape,r);return l.length>0?te(Me(a,l),n.shape):a},b:()=>{let a=Y(t,Ee(n,"float32"));const l=Rn(s.shape,r);l.length>0&&(a=te(Me(a,l),s.shape));const c=Mt(s);return ln(Ve(a,Ee(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uce={kernelName:Jy,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:s}=n,[r,i,o,a]=e,l=a??gt(1),c=Rn(i.shape,r.shape),u=[];if(i.rank===1){for(let C=0;C<r.shape.length-1;++C)u.push(r.shape[C]);u.push(1)}const h=ze(r,i),d=Y(t,l),f=HL(ve(o,gt(s))),p=Y(Y(Y(f,f),f),gt(-.5));return{x:()=>i.rank===1?te(Y(Y(t,Oi(te(f,[1,1,1,i.shape[0]]),u)),l),r.shape):te(Y(Y(t,f),l),r.shape),mean:()=>{let C=Y(Y(f,gt(-1)),d);return i.rank===1&&(C=Me(C,c)),te(C,i.shape)},variance:()=>{let C=Y(Y(p,h),d);return i.rank===1&&(C=Me(C,c)),te(C,i.shape)},scale:()=>{const C=Y(h,f);let k=Y(t,C);return i.rank===1&&(k=Me(k,c)),te(k,i.shape)},offset:()=>{let C=t;return i.rank===1&&(C=Me(C,c)),te(C,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hce={kernelName:Zy,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[s,r]=e,{axis:i,batchDims:o}=n,a=tt(i,s.shape)[0],l=(c,u,h)=>()=>{const d=c.shape,f=u.size,p=d.slice(0,a),g=p.length,m=d.slice(i,d.length).slice(1),y=m.length,w=C$(0,g),b=C$(g+1,g+1+y),C=S$([p,[f],m]),k=te(h,C),$=te(u,[f]),I=S$([[g],w,b]),T=at(k,I);let R=tM(T,$,c.shape[a]);const E=Xl(I);return R=at(R,E),R};if(o===1){const c=s.shape[0],u=s.split(c,0);return{x:()=>va(u.map((f,p)=>l(f,r.slice(p,1),t.slice(p,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,t),indices:()=>r}}};function C$(t,e){const n=[];for(let s=t;s<e;++s)n.push(s);return n}function S$(t){const e=[];for(let n=0;n<t.length;++n)for(let s=0;s<t[n].length;++s)e.push(t[n][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dce={kernelName:Mm,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>lt(n),b:()=>lt(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fce={kernelName:Bm,gradFunc:t=>({x:()=>Ee(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pce={kernelName:Vm,gradFunc:t=>({x:()=>lt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mce={kernelName:Um,gradFunc:t=>({x:()=>lt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gce={kernelName:zm,gradFunc:t=>({x:()=>lt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yce={kernelName:ev,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{alpha:r}=n,i=Hr(s,0);return{x:()=>Ds(i,t,Y(t,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vce={kernelName:jm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ve(t,ve(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xce={kernelName:Wm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ve(t,Ee(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wce={kernelName:Bte,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;return{logits:()=>{const o=_o(s);return ze(t,Y(Me(t,r,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bce(t,e,n,s=5,r=1,i=1,o=.5){const a={x:t,y:e,dy:n},l={depthRadius:s,bias:r,alpha:i,beta:o};return Q.runKernel(Kk,a,l)}const Cce=ne({localResponseNormalizationBackprop_:bce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sce={kernelName:ov,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{depthRadius:i,bias:o,alpha:a,beta:l}=n;return{x:()=>Cce(s,r,t,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KM(t,e,n,s){return e.rank<n.rank&&(e=te(e,vn(e.shape,s))),t.rank<n.rank&&(t=te(t,vn(t.shape,s))),{x:()=>Y(t,Ee(No(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I$={kernelName:av,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{reductionIndices:r}=s,i=e[0],o=e[1],a=tt(r,i.shape),l=KM(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ice={kernelName:Gm,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>Y(t,Ee(Nu(n,s),"float32")),b:()=>Y(t,Ee(I2(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kce(t,e,n,s,r,i,o){const a=G(t,"dy","maxPool3dGrad"),l=G(e,"input","maxPool3dGrad"),c=G(n,"output","maxPool3dGrad");let u=a,h=l,d=c,f=!1;l.rank===4&&(f=!0,u=te(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),h=te(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=te(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),L(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),L(h.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${h.rank}.`),L(d.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${d.rank}.`),nr("maxPool3dGrad",i,o);const p={dy:u,input:h,output:d},g={filterSize:s,strides:r,pad:i,dimRoundingMode:o},m=Q.runKernel(Xk,p,g);return f?te(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const Tce=ne({maxPool3dGrad_:kce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ece={kernelName:cv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=n;return{x:()=>Tce(t,s,r,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nce(t,e,n,s,r,i,o){const a=G(t,"dy","maxPoolGrad"),l=G(e,"input","maxPoolGrad"),c=G(n,"output","maxPoolGrad");L(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),L(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),L(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),nr("maxPoolGrad",i,o);const u={dy:a,input:l,output:c},h={filterSize:s,strides:r,pad:i,dimRoundingMode:o};return Q.runKernel(qk,u,h)}const _ce=ne({maxPoolGrad_:Nce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ce={kernelName:lv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:i,strides:o,pad:a}=n;return{x:()=>_ce(t,s,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rce={kernelName:uv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n,i=tt(r,s.shape),a=Wn(s.shape,i)[1],l=ue(a);return{x:()=>{const u=s.shape.slice();i.forEach(f=>{u[f]=1});const h=te(t,u);return Ve(Y(h,Jl(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ace={kernelName:hv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{axis:r}=s,[i,o]=e,a=tt(r,i.shape),l=KM(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dce={kernelName:Hm,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>Y(t,Ee(Fd(n,s),"float32")),b:()=>Y(t,Ee(Hr(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pce={kernelName:dv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,i=r.map(o=>o[0]);return{x:()=>Pt(t,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oce={kernelName:Km,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Xe(n.shape,s.shape);return{a:()=>{const a=Rn(n.shape,r);return a.length>0?te(Me(t,a),n.shape):t},b:()=>{const a=Y(t,ln(zv(Ve(n,s)))),l=Rn(s.shape,r);return l.length>0?te(Me(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fce={kernelName:qm,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Xe(n.shape,s.shape);return{a:()=>{const a=Y(t,Ee(s,"float32")),l=Rn(n.shape,r);return l.length>0?te(Me(a,l),n.shape):a},b:()=>{const a=Y(t,Ee(n,"float32")),l=Rn(s.shape,r);return l.length>0?te(Me(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lce={kernelName:fv,gradFunc:t=>({x:()=>ln(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mce={kernelName:gv,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>Bn(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bce={kernelName:mv,gradFunc:t=>({x:()=>lt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vce={kernelName:yv,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:s}=n;return mu(t,s).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k$={kernelName:vv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,i=r.map(o=>o[0]);return{x:()=>Pt(t,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uce={kernelName:Xm,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,s,r]=e,i=n,o=s,a=Xe(i.shape,o.shape);return{a:()=>{const u=Ee(o,"float32");let h=Y(t,Y(u,fu(i,ze(u,gt(1)))));const d=Rn(i.shape,a);return d.length>0&&(h=Me(h,d)),te(h,i.shape)},b:()=>{const u=Hr(i,0),h=Ds(u,$o(i),lt(i));let d=Y(t,Y(r,h));const f=Rn(o.shape,a);return f.length>0&&(d=Me(d,f)),te(d,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zce={kernelName:xv,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,s]=e,r=Hr(n,0);return{x:()=>Ds(r,t,Y(t,s)),alpha:()=>{let i=Ds(r,lt(t),Y(t,n));const o=Rn(s.shape,t.shape);return o.length>0&&(i=Me(i,o)),te(i,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wce(t,e,n){const s=t.shape.slice();s[n]=1;const r=te(e,s),i=GC(t,n,!0,!1),o=GC(t,n,!0,!0),a=Y(i,o);return Y(r,a)}function jce(t,e,n){const s=t.shape.length,r=s-n.length,i=Zt(n,s);let o=t;i!=null&&(o=at(t,i));const a=o.shape.slice(),c=a.splice(s-n.length,n.length).reduce((d,f)=>d*f,1);a.push(c);const u=o.reshape(a);let h=Wce(u,e,r);if(h=h.reshape(o.shape),i!=null){const d=Xl(i);h=at(h,d)}return h}const Gce={kernelName:wv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;let i=[];return r==null?i=s.shape.map((o,a)=>a):typeof r=="number"?i=[r]:i=r,{x:()=>jce(s,t,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hce={kernelName:Rm,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Xe(n.shape,s.shape);return{a:()=>{const a=Ve(t,Ee(s,"float32")),l=Rn(n.shape,r);return l.length>0?te(Me(a,l),n.shape):a},b:()=>{let a=Y(t,Ee(n,"float32"));const l=Rn(s.shape,r);l.length>0&&(a=te(Me(a,l),s.shape));const c=Mt(s);return ln(Ve(a,Ee(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kce={kernelName:Ym,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ve(t,ln(Mt(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qce={kernelName:Zm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=Y(Fd(n,6),vg(n));return{x:()=>Y(t,Ee(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xce={kernelName:Jm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(t,Ee(vg(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yce={kernelName:bv,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>te(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jce={kernelName:Sv,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>Q.runKernel(nT,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zce={kernelName:Cv,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>Q.runKernel(tT,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qce={kernelName:Iv,gradFunc:(t,e,n)=>{const{dims:s}=n,r=tt(s,t.shape);return{x:()=>pu(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eue={kernelName:Qm,gradFunc:t=>({x:()=>lt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tue={kernelName:eg,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ln(Ve(t,Y(fu(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nue={kernelName:kv,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>Ee(lt(n),"float32"),t:()=>Y(t,Ee(n,t.dtype)),e:()=>Y(t,Ee(IT(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sue={kernelName:tg,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Hr(n,gt(0)),r=gt(Gv),i=gt(Hv),o=Y(t,i),a=Y(Y(t,r),_o(Ee(n,"float32")));return Ds(s,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rue={kernelName:ig,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(t,Y(n,ze(gt(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iue={kernelName:rg,gradFunc:t=>({x:()=>lt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oue={kernelName:ng,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(vT(Ee(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aue={kernelName:sg,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(RL(Ee(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lue={kernelName:Tv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{begin:r,size:i}=n,o=s.shape,[a,l]=Wv(s,r,i),c=[];for(let u=0;u<t.rank;u++)c.push([a[u],o[u]-a[u]-l[u]]);return{x:()=>ET(t,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cue={kernelName:$v,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{dim:r}=n,i=!0,o=Y(t,s);return{logits:()=>ze(o,Y(Me(o,[r],i),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uue={kernelName:og,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(t,Od(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T$={kernelName:Nv,gradFunc:(t,e,n)=>{const{blockShape:s,paddings:r}=n;return{x:()=>gT(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E$={kernelName:_v,gradFunc:(t,e,n)=>{const{axis:s}=n;return{x:()=>Js(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hue={kernelName:ag,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ve(t,Y(ps(Ee(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const due={kernelName:sT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(t,Y(Ee(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fue={kernelName:lg,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=gt(2);return{a:()=>Y(t,Y(r,ze(n,s))),b:()=>Y(t,Y(r,ze(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pue={kernelName:fg,gradFunc:t=>({x:()=>lt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mue={kernelName:cg,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Xe(n.shape,s.shape);return{a:()=>{let a=t;const l=Rn(n.shape,r);return l.length>0&&(a=Me(a,l)),te(a,n.shape)},b:()=>{let a=t;const l=Rn(s.shape,r);return l.length>0&&(a=Me(a,l)),te(ln(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gue={kernelName:Ev,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,r=s.shape.slice(),{axis:i}=n;tt(i,s.shape).forEach(c=>{r[c]=1});const a=te(t,r),l=Y(a,Jl(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yue={kernelName:ug,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ve(t,Mt(vT(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vue={kernelName:hg,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Y(ze(gt(1),Mt(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xue={kernelName:dg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{reps:r}=n;return{x:()=>{let o=lt(s);if(s.rank===1)for(let a=0;a<r[0];++a)o=ve(o,Pt(t,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)o=ve(o,Pt(t,[a*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)o=ve(o,Pt(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)for(let u=0;u<r[3];++u)o=ve(o,Pt(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2],u*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wue={kernelName:Wh,gradFunc:(t,e,n)=>{const s=n,{perm:r}=s,i=Xl(r);return{x:()=>at(t,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bue={kernelName:Rv,gradFunc:(t,e,n)=>{const s=n,{axis:r}=s;return{value:()=>va(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cue={kernelName:Av,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Sue(t,n)}}};function Sue(t,e){const n=Yl(e,lt(e)),s=bT(t,n);let r=Nu(e,gt(0,"int32"));const i=s.rank-r.rank;for(let a=0;a<i;++a)r=Ks(r,a+1);r=ya(r,Jl(s.shape,"bool"));const o=lt(s);return Ds(r,s,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iue={kernelName:Dv,gradFunc:t=>({x:()=>lt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kue=[HM,Cle,Sle,Ile,kle,Tle,Ele,Nle,_le,$le,Rle,Ale,Ole,Mle,Ble,Vle,Ule,zle,Wle,jle,Gle,Hle,qle,Kle,Jle,Zle,Qle,ece,tce,nce,Hce,sce,rce,ice,oce,ace,cce,lce,uce,hce,dce,fce,pce,mce,gce,yce,vce,xce,wce,Sce,I$,I$,Ice,Ece,$ce,Rce,Ace,Dce,Pce,Oce,Fce,Lce,Mce,Bce,Vce,k$,k$,Uce,zce,Gce,Kce,qce,Xce,Yce,Jce,Zce,Qce,eue,tue,nue,sue,rue,iue,oue,aue,lue,cue,uue,T$,T$,E$,E$,hue,fue,due,pue,mue,gue,yue,vue,xue,wue,bue,Cue,Iue];for(const t of kue)zte(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.abs=function(){return this.throwIfDisposed(),ks(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.acos=function(){return this.throwIfDisposed(),tse(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.acosh=function(){return this.throwIfDisposed(),sse(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.add=function(t){return this.throwIfDisposed(),ve(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.all=function(t,e){return this.throwIfDisposed(),EL(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.any=function(t,e){return this.throwIfDisposed(),WC(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.argMax=function(t){return this.throwIfDisposed(),Up(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.argMin=function(t){return this.throwIfDisposed(),lse(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.asScalar=function(){return this.throwIfDisposed(),L(this.size===1,()=>"The array must have only 1 element."),te(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.asType=function(t){return this.throwIfDisposed(),Ee(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as1D=function(){return this.throwIfDisposed(),te(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as2D=function(t,e){return this.throwIfDisposed(),te(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),te(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as4D=function(t,e,n,s){return this.throwIfDisposed(),te(this,[t,e,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as5D=function(t,e,n,s,r){return this.throwIfDisposed(),te(this,[t,e,n,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.asin=function(){return this.throwIfDisposed(),use(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.asinh=function(){return this.throwIfDisposed(),dse(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.atan=function(){return this.throwIfDisposed(),pse(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.atan2=function(t){return this.throwIfDisposed(),gse(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.atanh=function(){return this.throwIfDisposed(),vse(this)};ce().prototype.avgPool=function(t,e,n,s){return this.throwIfDisposed(),mT(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),gT(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.batchNorm=function(t,e,n,s,r){return this.throwIfDisposed(),Mv(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.broadcastTo=function(t){return this.throwIfDisposed(),up(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cast=function(t){return this.throwIfDisposed(),Ee(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.ceil=function(){return this.throwIfDisposed(),Gse(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Wr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof kn&&(t=[t]),Js([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.conv1d=function(t,e,n,s,r,i){return this.throwIfDisposed(),NL(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.conv2dTranspose=function(t,e,n,s,r){return this.throwIfDisposed(),_L(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.conv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),du(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cos=function(){return this.throwIfDisposed(),vT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cosh=function(){return this.throwIfDisposed(),RL(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),GC(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),AL(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),gre(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.depthwiseConv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),xT(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.dilation2d=function(t,e,n,s,r){return this.throwIfDisposed(),xre(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.divNoNan=function(t){return this.throwIfDisposed(),Ire(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.div=function(t){return this.throwIfDisposed(),Ve(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.dot=function(t){return this.throwIfDisposed(),Tre(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.elu=function(){return this.throwIfDisposed(),Vv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.equal=function(t){return this.throwIfDisposed(),No(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.erf=function(){return this.throwIfDisposed(),DL(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),Mre(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.exp=function(){return this.throwIfDisposed(),_o(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.expandDims=function(t){return this.throwIfDisposed(),Ks(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.expm1=function(){return this.throwIfDisposed(),zre(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.fft=function(){return this.throwIfDisposed(),ZL(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.flatten=function(){return this.throwIfDisposed(),te(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.floor=function(){return this.throwIfDisposed(),zv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.floorDiv=function(t){return this.throwIfDisposed(),TL(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.gather=function(t,e,n){return this.throwIfDisposed(),bT(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.greaterEqual=function(t){return this.throwIfDisposed(),Nu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.greater=function(t){return this.throwIfDisposed(),Hr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.ifft=function(){return this.throwIfDisposed(),HC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.irfft=function(){return this.throwIfDisposed(),Doe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.isFinite=function(){return this.throwIfDisposed(),Jre(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.isInf=function(){return this.throwIfDisposed(),Qre(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.isNaN=function(){return this.throwIfDisposed(),tie(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.leakyRelu=function(t){return this.throwIfDisposed(),ST(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.lessEqual=function(t){return this.throwIfDisposed(),Fd(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.less=function(t){return this.throwIfDisposed(),I2(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.localResponseNormalization=function(t,e,n,s){return this.throwIfDisposed(),oie(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logSigmoid=function(){return this.throwIfDisposed(),fie(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logSoftmax=function(t){return this.throwIfDisposed(),ML(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),BL(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.log=function(){return this.throwIfDisposed(),$o(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.log1p=function(){return this.throwIfDisposed(),LL(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logicalAnd=function(t){return this.throwIfDisposed(),ya(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logicalNot=function(){return this.throwIfDisposed(),IT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logicalOr=function(t){return this.throwIfDisposed(),VL(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logicalXor=function(t){return this.throwIfDisposed(),bie(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),mt(this,t,e,n)};ce().prototype.maxPool=function(t,e,n,s){return this.throwIfDisposed(),kT(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.max=function(t,e){return this.throwIfDisposed(),Vi(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.maximum=function(t){return this.throwIfDisposed(),Yl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.mean=function(t,e){return this.throwIfDisposed(),yn(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.min=function(t,e){return this.throwIfDisposed(),S2(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.minimum=function(t){return this.throwIfDisposed(),jp(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),_ie(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.mod=function(t){return this.throwIfDisposed(),Rie(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.mul=function(t){return this.throwIfDisposed(),Y(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.neg=function(){return this.throwIfDisposed(),ln(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.norm=function(t,e,n){return this.throwIfDisposed(),Uv(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.notEqual=function(t){return this.throwIfDisposed(),k2(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),UL(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.onesLike=function(){return this.throwIfDisposed(),xi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.pad=function(t,e){return this.throwIfDisposed(),ET(this,t,e)};ce().prototype.pool=function(t,e,n,s,r,i){return this.throwIfDisposed(),Uie(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.pow=function(t){return this.throwIfDisposed(),fu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.prelu=function(t){return this.throwIfDisposed(),_T(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.prod=function(t,e){return this.throwIfDisposed(),jie(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.reciprocal=function(){return this.throwIfDisposed(),foe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.relu=function(){return this.throwIfDisposed(),$u(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.relu6=function(){return this.throwIfDisposed(),jL(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.reshapeAs=function(t){return this.throwIfDisposed(),te(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.reshape=function(t){return this.throwIfDisposed(),te(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),sM(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),rM(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.reverse=function(t){return this.throwIfDisposed(),pu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.rfft=function(){return this.throwIfDisposed(),Foe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.round=function(){return this.throwIfDisposed(),GL(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.rsqrt=function(){return this.throwIfDisposed(),HL(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.selu=function(){return this.throwIfDisposed(),KL(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.separableConv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),qL(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sigmoid=function(){return this.throwIfDisposed(),Od(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sign=function(){return this.throwIfDisposed(),Coe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sin=function(){return this.throwIfDisposed(),XL(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sinh=function(){return this.throwIfDisposed(),YL(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.slice=function(t,e){return this.throwIfDisposed(),Pt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.softmax=function(t){return this.throwIfDisposed(),BT(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.softplus=function(){return this.throwIfDisposed(),mg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),NT(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.split=function(t,e){return this.throwIfDisposed(),Vr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sqrt=function(){return this.throwIfDisposed(),ps(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.square=function(){return this.throwIfDisposed(),Mt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.squaredDifference=function(t){return this.throwIfDisposed(),Moe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.squeeze=function(t){return this.throwIfDisposed(),yg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof kn?[this,t]:[this,...t];return va(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.step=function(t){return this.throwIfDisposed(),vg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.stridedSlice=function(t,e,n,s,r,i,o,a){return this.throwIfDisposed(),Woe(this,t,e,n,s,r,i,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sub=function(t){return this.throwIfDisposed(),ze(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sum=function(t,e){return this.throwIfDisposed(),Me(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.tan=function(){return this.throwIfDisposed(),Goe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.tanh=function(){return this.throwIfDisposed(),Lv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.tile=function(t){return this.throwIfDisposed(),Oi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.toBool=function(){return this.throwIfDisposed(),Ee(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.toFloat=function(){return this.throwIfDisposed(),Ee(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.toInt=function(){return this.throwIfDisposed(),Ee(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.topk=function(t,e){return this.throwIfDisposed(),qoe(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.transpose=function(t){return this.throwIfDisposed(),at(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.unique=function(t){return this.throwIfDisposed(),Joe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),tM(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.unstack=function(t){return this.throwIfDisposed(),mu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.where=function(t,e){return this.throwIfDisposed(),Ds(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.zerosLike=function(){return this.throwIfDisposed(),lt(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class lo extends Error{constructor(e){super(e),Object.setPrototypeOf(this,lo.prototype)}}class di extends Error{constructor(e){super(e),Object.setPrototypeOf(this,di.prototype)}}class K extends Error{constructor(e){super(e),Object.setPrototypeOf(this,K.prototype)}}class Je extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Je.prototype)}}class C3 extends Error{constructor(e){super(e),Object.setPrototypeOf(this,C3.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class qM{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gu(t,e){if(Array.isArray(t)){let n=[];for(let s=0;s<e;s++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function co(t,e){if(!t)throw new C3(e)}function N$(t,e){let n=0;for(const s of t)s===e&&n++;return n}function qs(t){return t.length===1?t[0]:t}function Ct(t){return Array.isArray(t)?t:[t]}function Yo(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function _c(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let ti={};function S3(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function XC(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>XC(e));else{const e=Object.keys(t);for(const n of e){const s=t[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?t[n]=s.value:XC(s))}}}function Cg(t,e={},n={},s="object",r=!1){if(typeof t=="string"){const i=t;let o;if(i in n)o=n[i];else if(i in ti)o=ti[i];else if(o=e[i],o==null)throw new K(`Unknown ${s}: ${t}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const i=t;if(i.className==null||i.config==null)throw new K(`${s}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const o=i.className;let a,l;if(o in n?[a,l]=n[o]:o in ti?[a,l]=ti.className:o in e&&([a,l]=e[o]),a==null)throw new K(`Unknown ${s}: ${o}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const f of Object.keys(ti))c[f]=ti[f];for(const f of Object.keys(n))c[f]=n[f];const u=i.config;u.customObjects=c;const h=Object.assign({},ti);for(const f of Object.keys(n))ti[f]=n[f];XC(i.config);const d=l(a,i.config,n,r);return ti=Object.assign({},h),d}else{const c=Object.assign({},ti);for(const h of Object.keys(n))ti[h]=n[h];const u=new a(i.config);return ti=Object.assign({},c),u}}}function Tue(t,e){return t<e?-1:t>e?1:0}function M0(t,e){return-1*Tue(t,e)}function Il(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function Eue(t){if(t==null)throw new K(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function Au(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new K(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function I3(t,e,n=0,s=1/0){return co(n>=0),co(s>=n),Array.isArray(t)&&t.length>=n&&t.length<=s&&t.every(r=>typeof r===e)}function Un(t,e){Array.isArray(t)?(L(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,s)=>Un(n,`element ${s+1} of ${e}`))):L(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${XM(t)}.`)}function XM(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>XM(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function Nue(t,e,n){let s=n!=null?n():Hs(),r;return(...o)=>{const a=n!=null?n():Hs();return a-s<e||(s=a,r=t(...o)),r}}function YM(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let _ue=0;function JM(){return _ue++}const B0={};function Kv(t=""){return t in B0||(B0[t]=0),B0[t]+=1,t+B0[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const $ue=["channelsFirst","channelsLast"],Rue=["nearest","bilinear"],Aue=["valid","same","causal"],Due=["max","avg"],Pue=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ih=new Map;function hn(t){Au($ue,"DataFormat",t)}function Oue(t){Au(Rue,"InterpolationFormat",t)}function Kr(t){Au(Aue,"PaddingMode",t)}function ZM(t){Au(Due,"PoolMode",t)}const hp=[],_$="/";function Kc(t,e){hp.push(t);try{const n=e();return hp.pop(),n}catch(n){throw hp.pop(),n}}function Fue(){return hp.length===0?"":hp.join(_$)+_$}function QM(t){if(!t6(t))throw new Error("Not a valid tensor name: '"+t+"'");return Fue()+t}function e6(t){if(!t6(t))throw new Error("Not a valid tensor name: '"+t+"'");ih.has(t)||ih.set(t,0);const e=ih.get(t);if(ih.set(t,ih.get(t)+1),e>0){const n=`${t}_${e}`;return ih.set(n,1),n}else return t}const Lue=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function t6(t){return!!t.match(Lue)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Mue(t){return t===parseInt(t.toString(),10)}function kl(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let s=1;for(let r=e;r<n;++r)s*=t[r];return s}function md(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s<e&&(e=s)}return e}function Al(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s>e&&(e=s)}return e}function ji(t,e){if(e<t)throw new K(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let s=t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Aw;function En(){return Aw==null&&(Aw=pne().epsilon()),Aw}function Gi(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ko(t,e){return Ee(t,e)}function Sg(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),te(t,n)}function Bue(t,e){return re(()=>{if(t.shape.length!==2)throw new K(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=Sg(t,1);return YC(n,[1,e,1])})}function Vue(t){const e=[kl(t.shape)];return te(t,e)}function Uue(t){if(t.rank<=1)throw new K(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],kl(t.shape,1)];return te(t,e)}function qc(t,e,n){return re(()=>{switch(t.rank){case 1:return LT(t,e,n);case 2:return JL(t,[e,0],[n,t.shape[1]]);case 3:return MT(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return E2(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return Pt(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return Pt(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new K(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Dw(t,e,n){return re(()=>{switch(t.rank){case 1:return LT(t,e,n);case 2:return JL(t,[0,e],[t.shape[0],n]);case 3:return MT(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return E2(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new K(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function V0(t,e,n,s){return re(()=>{switch(t.rank){case 1:return LT(t,e,n);case 2:switch(s){case 1:return qc(t,e,n);case 2:return Dw(t,e,n);default:throw new K(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return qc(t,e,n);case 2:return MT(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return Dw(t,e,n);default:throw new K(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return qc(t,e,n);case 2:return E2(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return E2(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return Dw(t,e,n);default:throw new K(`The axis is not within the rank of the tensor ${s}`)}default:throw new K(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function k3(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),Js(t,e)}function $$(t,e){switch(t.rank){case 1:return qse([t,e]);case 2:return Yse([t,e],0);case 3:return Zse([t,e],0);case 4:return ere([t,e],0);default:throw new K(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function YC(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new K(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return Oi(t,e)}function qv(t,e=0,n=1,s,r){return coe(t,e,n,s,r)}function To(t,e,n,s){if(t.rank<2||e.rank<2)throw new Je(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=t.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(r!==i)throw new Je(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return p$({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?JC(t.rank,s,Gi()):null,activation:n});{const r=t.shape.slice(),i=r.pop();t=te(t,[-1,i]);const o=e.shape.slice(),a=o.pop(),l=o.pop(),c=[...o,a],u=Array.from({length:e.rank},(p,g)=>g===0?e.rank-2:g<=e.rank-2?g-1:g);e=te(at(e,u),[l,-1]);const h=[...r,...c];return te(p$({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?JC(t.rank,s,Gi()):null,activation:n}),h)}}function n6(t,e,n){return re(()=>(Array.isArray(e)?e=mr(e,"int32"):e=Ee(e,"int32"),bT(t,e,n)))}function Ig(t){return Y(t,t)}function JC(t,e,n){const s=e.shape;if(e.rank!==1&&e.rank!==t)throw new K(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return s.length===1?te(e,[1,s[0],1,1,1]):te(e,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?te(e,[1,1,1,1,s[0]]):te(e,[1].concat(s))}else if(t===4){if(n==="channelsFirst")return s.length===1?te(e,[1,s[0],1,1]):te(e,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?te(e,[1,1,1,s[0]]):te(e,[1].concat(s))}else if(t===3){if(n==="channelsFirst")return s.length===1?te(e,[1,s[0],1]):te(e,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?te(e,[1,1,s[0]]):te(e,[1].concat(s))}else if(t<3)return e;throw new K(`Unsupported input rank by biasAdd: ${e.rank}`)}function qi(t,e,n){return re(()=>(n==null&&(n=Gi()),hn(n),ve(t,JC(t.rank,e,n))))}function zue(t,e=1){if(e!==1)throw new Je(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Vv(t)}function Wue(t){return re(()=>Ve(t,ve(ks(t),1)))}function s6(t,e,n,s){return re(()=>rae(t,e,n,s))}function jue(t){return re(()=>{const e=ve(.5,Y(.2,t));return Wr(e,0,1)})}function kg(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Gue=["fanIn","fanOut","fanAvg"],Hue=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Kue(t){Au(Gue,"FanMode",t)}function que(t){Au(Hue,"Distribution",t)}class bi extends Md{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class r6 extends bi{apply(e,n){return Bn(e,n)}}r6.className="Zeros";me(r6);class T3 extends bi{apply(e,n){return Jl(e,n)}}T3.className="Ones";me(T3);class i6 extends bi{constructor(e){if(super(),typeof e!="object")throw new K(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new K(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return re(()=>Y(gt(this.value),Jl(e,n)))}getConfig(){return{value:this.value}}}i6.className="Constant";me(i6);class o6 extends bi{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return gg(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}o6.className="RandomUniform";me(o6);class a6 extends bi{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Je(`randomNormal does not support dType ${n}.`);return qv(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}a6.className="RandomNormal";me(a6);class l6 extends bi{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Je(`truncatedNormal does not support dType ${n}.`);return eM(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}l6.className="TruncatedNormal";me(l6);class c6 extends bi{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return re(()=>{if(e.length!==2||e[0]!==e[1])throw new K("Identity matrix initializer can only be used for 2D square matrices.");return Y(this.gain,FL(e[0]))})}getConfig(){return{gain:this.gain}}}c6.className="Identity";me(c6);function Xue(t,e="channelsLast"){let n,s;if(hn(e),t.length===2)n=t[0],s=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const r=kl(t,2);n=t[1]*r,s=t[0]*r}else if(e==="channelsLast"){const r=kl(t,0,t.length-2);n=t[t.length-2]*r,s=t[t.length-1]*r}}else{const r=kl(t);n=Math.sqrt(r),s=Math.sqrt(r)}return[n,s]}class wr extends bi{constructor(e){if(super(),e.scale<0)throw new K(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,Kue(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,que(this.distribution),this.seed=e.seed}apply(e,n){const s=Xue(e),r=s[0],i=s[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,r):this.mode==="fanOut"?o/=Math.max(1,i):o/=Math.max(1,(r+i)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Je(`${this.getClassName()} does not support dType ${n}.`);return eM(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*o);return gg(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}wr.className="VarianceScaling";me(wr);class E3 extends wr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return wr.className}}E3.className="GlorotUniform";me(E3);class N3 extends wr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return wr.className}}N3.className="GlorotNormal";me(N3);class _3 extends wr{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return wr.className}}_3.className="HeNormal";me(_3);class $3 extends wr{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return wr.className}}$3.className="HeUniform";me($3);class R3 extends wr{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return wr.className}}R3.className="LeCunNormal";me(R3);class A3 extends wr{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return wr.className}}A3.className="LeCunUniform";me(A3);class u6 extends bi{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return re(()=>{if(e.length<2)throw new Je("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const s=ue(e.slice(0,-1)),r=e[e.length-1],i=s*r;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const o=[Math.max(r,s),Math.min(r,s)],a=qv(o,0,1,n,this.seed),l=ele.qr(a,!1);let c=l[0];const h=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return c=Y(c,h.sign()),s<r&&(c=c.transpose()),Y(gt(this.gain),c.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}u6.className="Orthogonal";me(u6);const R$={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function A$(t,e={}){return Cg(t,ai.getMap().classNameMap,e,"initializer")}function Jt(t){return S3(t)}function Kt(t){if(typeof t=="string"){const e=t in R$?R$[t]:t;if(e==="GlorotNormal")return new N3;if(e==="GlorotUniform")return new E3;if(e==="HeNormal")return new _3;if(e==="HeUniform")return new $3;if(e==="LeCunNormal")return new R3;if(e==="LeCunUniform")return new A3;{const n={};return n.className=e,n.config={},A$(n)}}else return t instanceof bi?t:A$(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ZC(t){return Array.isArray(t)&&Array.isArray(t[0])}function N2(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function je(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new K(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function dt(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new K(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _2(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const D$="Variable";class Yue{constructor(e,n="float32",s=D$,r=!0,i=null){this.dtype=n??"float32",this.shape=e.shape,this.id=JM(),s=s??D$,this.originalName=QM(s),this.name=e6(this.originalName),this.trainable_=r,this.constraint=i,this.val=eae(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),Jue(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function Jue(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function QC(t){return t.map(e=>e.read())}function D3(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Nn{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class Ro{constructor(e,n,s,r,i,o,a){this.dtype=e,this.shape=n,this.sourceLayer=s,this.inputs=r,this.callArgs=i,this.outputTensorIndex=a,this.id=JM(),o!=null&&(this.originalName=QM(o),this.name=e6(this.originalName)),this.rank=n.length}}let Zue=0;class Xv{constructor(e,n){this.callArgs=n,this.id=Zue++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let Que=0;class nt extends Md{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Que++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const s=this.getClassName();n=Yo(s)+"_"+Kv(s)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),s=[i].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new di(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new K(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return qs(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return qs(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new lo(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new lo(`Layer ${this.name} is not connected, no input to return.`);return qs(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new lo(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new lo(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return qs(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=Ct(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=Ct(this.inputSpec);if(n.length!==s.length)throw new K(`Layer ${this.name} expects ${s.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let r=0;r<n.length;r++){const i=n[r],o=s[r];if(o==null)continue;const a=i.rank;if(o.ndim!=null&&a!==o.ndim)throw new K(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${a}`);if(o.maxNDim!=null&&a>o.maxNDim)throw new K(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${a}`);if(o.minNDim!=null&&a<o.minNDim)throw new K(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${a}.`);if(o.dtype!=null&&i.dtype!==o.dtype)throw new K(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${i.dtype}.`);if(o.axes){const l=i.shape;for(const c in o.axes){const u=Number(c),h=o.axes[c],d=u>=0?l[u]:l[l.length+u];if(h!=null&&[h,null].indexOf(d)===-1)throw new K(`Input ${r} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${h} but got shape ${l}.`)}}if(o.shape!=null)for(let l=0;l<o.shape.length;++l){const c=o.shape[l],u=i.shape[l];if(c!=null&&u!=null&&c!==u)throw new K(`Input ${r} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${i.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const s=Ct(e),r=nhe(e),i=she(e);if(r===i)throw new K("Arguments to apply() must be all SymbolicTensors or all Tensors");return Kc(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const o=[];for(const a of Ct(e))o.push(a.shape);this.build(qs(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let o=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,o);const a=Ct(o),l=[];for(let c of a)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(o=qs(l),this.activityRegularizer!=null)throw new Je("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=ehe(e),a=this.computeOutputShape(o);let l;const c=the(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((u,h)=>new Ro(c,u,this,Ct(e),n,this.name,h)):l=new Ro(c,a,this,Ct(e),n,this.name),this.addInboundNode(e,l,null,null,o,a,n),this._refCount++,this.activityRegularizer!=null)throw new Je("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new lo(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new lo(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new di(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return _2(this.weights)}build(e){this.built=!0}getWeights(e=!1){return QC(e?this.trainableWeights:this.weights)}setWeights(e){re(()=>{const n=this.weights;if(n.length!==e.length)throw new K(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const s=[],r=QC(n);for(let i=0;i<r.length;++i){const o=r[i],a=n[i],l=e[i];if(!yt(o.shape,l.shape))throw new K(`Layer weight shape ${o.shape} not compatible with provided weight shape ${l.shape}`);s.push([a,l])}D3(s)})}addWeight(e,n,s,r,i,o,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new K(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():Kt("zeros"));const c=r.apply(n,s),u=new Yue(c,s,e,o,a);return c.dispose(),i!=null&&this.addLoss(()=>i.apply(u.read())),o==null&&(o=!0),o?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Ct(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s),i=Ct(n),o=Ct(r);if(i.length!==o.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let a=0;a<i.length;a++)i[a].kerasMask=o[a]}addInboundNode(e,n,s,r,i,o,a=null){const l=Ct(e);n=Ct(n),s=Ct(s),r=Ct(r),i=N2(i),o=N2(o);const c=[],u=[],h=[];for(const d of l)c.push(d.sourceLayer),u.push(d.nodeIndex),h.push(d.tensorIndex);new Xv({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:h,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:r,inputShapes:i,outputShapes:o},a);for(let d=0;d<n.length;d++)n[d].sourceLayer=this,n[d].nodeIndex=this.inboundNodes.length-1,n[d].tensorIndex=d}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function ehe(t){t=Ct(t);const e=[];for(const n of t)e.push(n.shape);return qs(e)}function the(t){return"float32"}function h6(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const s=e.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let i=0;i<s.inboundLayers.length;i++){const o=s.inputTensors[i],a=s.inboundLayers[i],l=s.nodeIndices[i],c=h6(o,a,l);for(const u of c)r.indexOf(u)===-1&&r.push(u)}return r}}}function nhe(t){let e=!0;for(const n of Ct(t))if(!(n instanceof Ro)){e=!1;break}return e}function she(t){let e=!0;for(const n of Ct(t))if(n instanceof Ro){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Tg extends nt{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:Kv("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new K("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new K("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new K("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const r=new Ro(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new Xv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new K(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Tg.className="InputLayer";me(Tg);function rhe(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new K("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new Tg({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ihe(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return Ee(e,t.dtype)}catch{throw new K(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class il{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof il)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=ihe(e,n),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new K(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof Ro){if(this.id2Value[e.id]==null)throw new K(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new K(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof Ro){if(this.id2Value[e.id]==null)throw new K(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new K(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Ze(this.id2Mask)}}const $2=new qM,R2=new qM;function ohe(t){$2!=null&&$2.setMaxEntries(t),R2!=null&&R2.setMaxEntries(t)}function Wf(t,e,n,s){const r=n==null?!1:n.training,i=Array.isArray(t),o=i?t:[t],a=o.map(p=>p.name),l=[],c=e.names();for(const p of a)c.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);const u=a.join(",")+"|"+e.names().sort().join(",");let h=$2.get(u),d;if(h==null){const p=ahe(o,e);h=p.sorted,d=p.recipientCounts,$2.put(u,h),R2.put(u,d)}d={},r||Object.assign(d,R2.get(u));const f=new il(e);for(let p=0;p<h.length;++p){const g=h[p],m=g.sourceLayer;if(m instanceof Tg)continue;const y=[],w=[],b=[];let C=!1;for(const R of g.inputs){const E=f.getValue(R),A=f.getMask(R);y.push(E),w.push(A),A!=null&&(C=!0),r||(d[R.name]--,d[R.name]===0&&!e.hasKey(R)&&a.indexOf(R.name)===-1&&!E.isDisposed&&R.sourceLayer.stateful!==!0&&b.push(E))}C&&(n=n||{},n.mask=w[0]);const k=Ct(m.apply(y,n));let $=null;m.supportsMasking&&($=m.computeMask(y,w));const I=che(g),T=Array.isArray(I)?I:[I];for(let R=0;R<T.length;++R){f.hasKey(T[R])||f.add(T[R],k[R],Array.isArray($)?$[0]:$);const E=a.indexOf(T[R].name);E!==-1&&(l[E]=k[R])}r||Ze(b)}return f.disposeMasks(),i?l:l[0]}function ahe(t,e){L(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(t.length===1){const r=P$(t[0],e);n=r.sorted,s=r.recipientMap}else{const r=new Set;for(const i of t){const{sorted:o,recipientMap:a}=P$(i,e);for(const l of o)r.has(l.name)||(n.push(l),r.add(l.name));for(const l in a)s[l]==null&&(s[l]=new Set),a[l].forEach(c=>s[l].add(c))}}return{sorted:n,recipientCounts:lhe(s)}}function lhe(t){const e={};for(const n in t)e[n]=t[n].size;return e}function P$(t,e){const n=new Set,s=[],r={};for(const a of e.names())n.add(a);const i=[],o=[];for(i.push(t);i.length>0;){const a=i[i.length-1];if(n.has(a.name)){i.pop();continue}const l=o[o.length-1]===i.length-1;if(a.inputs.length===0||l)i.pop(),s.push(a),n.add(a.name),l&&o.pop();else{o.push(i.length-1);for(const c of a.inputs)r[c.name]==null&&(r[c.name]=new Set),r[c.name].add(a.name),!n.has(c.name)&&i.push(c)}}return{sorted:s,recipientMap:r}}function che(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let s=0;s<t.sourceLayer.inboundNodes.length;++s)for(const r of t.sourceLayer.inboundNodes[s].outputTensors)if(r.id===t.id){n=s;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uhe=oe();uhe.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,ohe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function P3(t,e){return re(()=>ps(Me(Y(t,t),e,!0)))}class Eg extends Md{getConfig(){return{}}}class d6 extends Eg{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return re(()=>{const n=P3(e,this.axis),s=Wr(n,0,this.maxValue);return Y(e,Ve(s,ve(En(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}d6.className="MaxNorm";me(d6);class f6 extends Eg{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return re(()=>Ve(e,ve(En(),P3(e,this.axis))))}getConfig(){return{axis:this.axis}}}f6.className="UnitNorm";me(f6);class p6 extends Eg{apply(e){return $u(e)}}p6.className="NonNeg";me(p6);class m6 extends Eg{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return re(()=>{const n=P3(e,this.axis),s=ve(Y(this.rate,Wr(n,this.minValue,this.maxValue)),Y(1-this.rate,n));return Y(e,Ve(s,ve(En(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}m6.className="MinMaxNorm";me(m6);const O$={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function _n(t){return S3(t)}function F$(t,e={}){return Cg(t,ai.getMap().classNameMap,e,"constraint")}function $n(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in O$?O$[t]:t,config:{}};return F$(n)}else return t instanceof Eg?t:F$(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function xc(t){if(t==null)return;const e=[],n=[],s=[];for(const r in t){const i=t[r];if(typeof i!="number"){const o=i;e.push(o.data()),n.push(r),s.push(o)}}if(e.length>0){const r=await Promise.all(e);for(let i=0;i<r.length;++i)t[n[i]]=r[i][0];Ze(s)}}function g6(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var L$;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(L$||(L$={}));const hhe=125;class Hp{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class dhe{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class fhe extends Hp{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const r in n){const i=n[r];if(typeof i=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+i*s;else{let o;r in this.totals?o=this.totals[r]:this.totals[r]=0;const a=re(()=>ve(this.totals[r],Y(i,s)));this.totals[r]=a,o!=null&&o.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:re(()=>{const r=Y(Ve(1,this.seen),this.totals[s]);n[s]=r,this.totals[s].dispose(),So(n[s])}))}}class phe extends Hp{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const e=[],n=[],s=[];for(const i in this.history){const o=this.history[i];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const l=o[a];e.push(l.data()),n.push(i),s.push(a)}}const r=await Promise.all(e);for(let i=0;i<r.length;++i)this.history[n[i]][s[i]].dispose(),this.history[n[i]][s[i]]=r[i][0]}}class mhe extends Hp{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||bM,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=hhe),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");NC(this.yieldEvery)&&(this.maybeWait=Nue(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,s){const r=[];this.yield!=null&&(await xc(s),r.push(this.yield(e,n,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await xc(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const s=[];this.epochEnd!=null&&(await xc(n),s.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,n){this.batchBegin!=null&&(await xc(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const s=[];this.batchEnd!=null&&(await xc(n),s.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):NC(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await xc(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await xc(e),await this.trainEnd(e))}}function y6(t,e){return t==null&&(t={}),t instanceof Hp?[t]:Array.isArray(t)&&t[0]instanceof Hp?t:Ct(t).map(s=>new mhe(s,e))}class ri{constructor(){}static registerCallbackConstructor(e,n){L(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),ri.checkForDuplicate(n),ri.constructors[e]==null&&(ri.constructors[e]=[]),ri.constructors[e].push(n)}static checkForDuplicate(e){for(const n in ri.constructors)ri.constructors[+n].forEach(r=>{if(r===e)throw new K("Duplicate callback constructor.")})}static clear(){ri.constructors={}}static createCallbacks(e){const n=[];for(const s in ri.constructors){const r=+s;e>=r&&n.push(...ri.constructors[r])}return n.map(s=>new s)}}ri.constructors={};function v6(t,e,n,s,r,i,o,a,l){const c=new phe,u=[new fhe,...ri.createCallbacks(e)];t!=null&&u.push(...t),u.push(c);const h=new dhe(u);return h.setParams({epochs:n,initialEpoch:s,samples:r,steps:i,batchSize:o,verbose:e,doValidation:a,metrics:l}),{callbackList:h,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Eo(t,e={},n=!1){return Cg(t,ai.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function A2(t,e){return re(()=>{t.dtype!=="float32"&&(t=Ee(t,"float32"));const n=Me(Ig(t),e,!0),s=Bv(n.shape,En()),r=ps(Yl(n,s));return Ve(t,r)})}function Yv(t,e){return re(()=>yn(Ig(ze(e,t)),-1))}function O3(t,e){return re(()=>yn(ks(ze(e,t)),-1))}function F3(t,e){return re(()=>{const n=ze(t,e),s=Wr(ks(t),En(),Number.MAX_VALUE),r=ks(Ve(n,s));return Y(100,yn(r,-1))})}function ghe(t,e){return re(()=>{const n=Wr(e,En(),Number.MAX_VALUE),s=$o(ve(1,n)),r=Wr(t,En(),Number.MAX_VALUE),i=$o(ve(1,r));return yn(Ig(ze(s,i)),-1)})}function yhe(t,e){return re(()=>{const n=Yl(0,ze(1,Y(t,e)));return yn(Ig(n),-1)})}function vhe(t,e){return re(()=>{const n=Yl(0,ze(1,Y(t,e)));return yn(n,-1)})}function xhe(t,e){return re(()=>{const n=Me(Y(t,e),-1),s=Vi(Y(ze(1,t),e),-1);return Yl(0,ve(1,ze(s,n)))})}function whe(t,e){return re(()=>{const n=Math.log(2),s=ze(e,t),r=ze(ve(s,mg(Y(-2,s))),n);return yn(r,-1)})}function Kp(t,e,n=!1){return re(()=>{if(n)e=BT(e);else{const s=Me(e,e.shape.length-1,!0);e=Ve(e,s)}return e=Wr(e,En(),1-En()),ln(Me(Y(Ee(t,"float32"),$o(e)),e.shape.length-1))})}function D2(t,e,n=!1){return re(()=>{const s=Ee(zv(Vue(t)),"int32");e=Wr(e,En(),1-En());const r=e.shape,i=te(UL(s,r[r.length-1]),r);return Kp(i,e,n)})}function bhe(t,e){if(!yt(t.shape,e.shape))throw new K(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return re(()=>{const n=$u(e),s=ln(ks(e));return ve(ze(n,Y(e,t)),LL(_o(s)))})}function Jv(t,e){return re(()=>{let n;return n=Wr(e,En(),1-En()),n=$o(Ve(n,ze(1,n))),yn(bhe(t,n),-1)})}function Che(t,e){return re(()=>{const n=Wr(t,En(),1),s=Wr(e,En(),1);return Me(Y(t,$o(Ve(n,s))),-1)})}function She(t,e){return re(()=>{const n=$o(ve(En(),e));return yn(ze(e,Y(t,n)),-1)})}function x6(t,e){return re(()=>{const n=A2(t,-1),s=A2(e,-1),r=Y(n,s);return ln(Me(r,-1))})}const P2={meanSquaredError:Yv,meanAbsoluteError:O3,meanAbsolutePercentageError:F3,meanSquaredLogarithmicError:ghe,squaredHinge:yhe,hinge:vhe,categoricalHinge:xhe,logcosh:whe,categoricalCrossentropy:Kp,sparseCategoricalCrossentropy:D2,binaryCrossentropy:Jv,kullbackLeiblerDivergence:Che,poisson:She,cosineProximity:x6};function Pw(t){if(typeof t=="string"){if(t in P2)return P2[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new K(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function w6(t,e){return re(()=>{const n=Y(.5,xi(e)),s=ko(Hr(e,n),t.dtype);return yn(No(t,s),-1)})}function b6(t,e){return re(()=>ko(No(Up(t,-1),Up(e,-1)),"float32"))}function Ihe(t,e){return re(()=>Ee(Me(ya(No(t,1),No(e,1))),"float32"))}function khe(t,e){return re(()=>Ee(Me(ya(No(t,0),No(e,1))),"float32"))}function The(t,e){return re(()=>{const n=Ihe(t,e),s=khe(t,e),r=ve(n,s);return Ee(Ds(Hr(r,0),Ve(n,r),0),"float32")})}function Ehe(t,e){return Jv(t,e)}function Nhe(t,e){return t.rank===e.rank&&(t=yg(t,[t.rank-1])),e=Up(e,-1),e.dtype!==t.dtype&&(e=Ee(e,t.dtype)),Ee(No(t,e),"float32")}const _he=Yv,$he=Yv,Rhe=O3,Ahe=O3,Dhe=F3,Phe=F3,C6=Kp,Ohe=x6,S6=D2,O2={binaryAccuracy:w6,categoricalAccuracy:b6,precision:The,categoricalCrossentropy:C6,sparseCategoricalCrossentropy:S6,mse:_he,MSE:$he,mae:Rhe,MAE:Ahe,mape:Dhe,MAPE:Phe,cosine:Ohe};function Fhe(t){if(typeof t=="string"&&t in O2)return O2[t];if(typeof t!="string"&&t!=null)return t;throw new K(`Unknown metric ${t}`)}function U0(t){if(co(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(P2))if(P2[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(O2))if(O2[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Lhe(t){const e={Adagrad:()=>rh.adagrad(.01),Adadelta:()=>rh.adadelta(1,.95,En()),Adam:()=>rh.adam(.001,.9,.999,En()),Adamax:()=>rh.adamax(.002,.9,.999,En(),0),RMSProp:()=>rh.rmsprop(.001,.9,0,En()),SGD:()=>rh.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new K(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const M$=1*1024*1024;function B$(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!eS(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(t);s.length>M$&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${M$}.`)}}function eS(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!eS(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!eS(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Mhe(t,e,n,s=console.log){const r=Vhe(t),i=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(e*u)));let o;if(!r){i.push("Receives inputs"),o=[];for(const u in t.nodesByDepth)o.push(...t.nodesByDepth[u])}s("_".repeat(e)),F2(i,n,s),s("=".repeat(e));const a=t.layers;for(let u=0;u<a.length;++u)r?Uhe(a[u],n,s):zhe(a[u],n,o,s),s((u===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=Bhe(t),c=_2(t.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(e))}function Bhe(t){let e;return t.collectedTrainableWeights!=null?e=_2(t.collectedTrainableWeights):e=_2(t.trainableWeights),e}function Vhe(t){let e=!0;const n=[],s=[];for(const r in t.nodesByDepth)n.push(t.nodesByDepth[r]);for(const r of n){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of t.layers){let i=!1;for(const o of r.inboundNodes)if(s.indexOf(o)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function F2(t,e,n=console.log){let s="";for(let r=0;r<t.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=t[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);n(s)}function Uhe(t,e,n){let s,r;try{r=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const i=t.name,o=t.getClassName(),a=[`${i} (${o})`,r,s,t.countParams().toString()];F2(a,e,n)}function zhe(t,e,n,s){let r,i;try{i=t.inboundNodes.map(h=>JSON.stringify(h.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const o=[];for(const h of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(h)===-1))for(let d=0;d<h.inboundLayers.length;++d){const f=h.inboundLayers[d].name,p=h.nodeIndices[d],g=h.tensorIndices[d];o.push(`${f}[${p}][${g}]`)}const a=t.name,l=t.getClassName(),c=o.length===0?"":o[0],u=[`${a} (${l})`,i,r,t.countParams().toString(),c];F2(u,e,s);for(let h=1;h<o.length;++h)F2(["","","","",o[h]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function I6(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function L2(t,e){if(t===null)return null;if(typeof t=="string")return _c(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const i=t[r];I6(e,r,i)?n.push(i):n.push(L2(i,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s];if(s==="name"&&typeof r=="string")n[s]=r;else{const i=_c(s);n[i]=L2(r,i)}}return n}}function tS(t,e){if(t==null)return null;if(typeof t=="string")return Yo(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const i=t[r];I6(e,r,i)?n.push(i):n.push(tS(i,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s],i=Yo(s);(s==="name"||s==="className")&&typeof r=="string"?n[i]=r:n[i]=tS(r,s)}return n}}/** @license See the LICENSE file. */const k6="4.20.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Whe=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class _i extends nt{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const w=this.getClassName().toLowerCase();this.name=Kv(w)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Il(this.inputs).length!==this.inputs.length)throw new K(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(w=>w.name)}`);Il(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(w=>w.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const w of this.outputs){const b=w.sourceLayer,C=w.nodeIndex,k=w.tensorIndex;this.outputLayers.push(b),this.outputLayersNodeIndices.push(C),this.outputLayersTensorIndices.push(k)}for(const w of this.inputs){const b=w.sourceLayer,C=w.nodeIndex,k=w.tensorIndex;co(C===0,"input layer has >1 nodes"),co(k===0,"input layer has >1 tensors"),this.inputLayers.push(b),this.inputLayersNodeIndices.push(C),this.inputLayersTensorIndices.push(k)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let w=0;w<this.inputLayers.length;w++){const b=this.inputLayers[w];if(!(b instanceof Tg))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${w} (0-based) originates from layer type ${b.getClassName()}.`);this.inputNames.push(b.name),this.feedInputShapes.push(b.batchInputShape),this.feedInputNames.push(b.name)}for(const w of this.outputLayers)this.outputNames.push(w.name);this.internalInputShapes=this.inputs.map(w=>w.shape),this.internalOutputShapes=this.outputs.map(w=>w.shape);const n={},s={},r={},i={},o={},a=[],l=(w,b,C,k,$,I)=>{(k==null||$==null||I==null)&&(k=w.sourceLayer,$=w.nodeIndex,I=w.tensorIndex);const T=k.inboundNodes[$];if(C.indexOf(T)!==-1)throw new di(`The tensor ${w.name} at layer "${k.name}" is part of a cycle.`);if(b.indexOf(T)!==-1)return;this.containerNodes.add(_i.nodeKey(k,$)),k.id in o||(o[k.id]=Object.keys(o).length),C.indexOf(T)===-1&&C.push(T);const R=T.inboundLayers.length;for(let E=0;E<R;E++){const A=T.inputTensors[E],F=T.inboundLayers[E],P=T.nodeIndices[E],Z=T.tensorIndices[E];l(A,b,C,F,P,Z)}for(b.push(T);C.indexOf(T)>=0;)C.splice(C.indexOf(T),1);a.push(T)},c=[],u=[];for(const w of this.outputs)l(w,c,u);const h=a.slice().reverse();for(const w of h){s[w.id]=w,w.id in n||(n[w.id]=0);let b=n[w.id];const C=r[w.outboundLayer.id]==null?0:r[w.outboundLayer.id];b=Math.max(b,C),r[w.outboundLayer.id]=b,i[w.outboundLayer.id]=w.outboundLayer,n[w.id]=b;for(let k=0;k<w.inboundLayers.length;k++){const $=w.inboundLayers[k],I=w.nodeIndices[k],T=$.inboundNodes[I],R=n[T.id]==null?0:n[T.id];n[T.id]=Math.max(b+1,R),s[T.id]=T}}const d={};for(const w in n){const b=n[w];b in d||(d[b]=[]),d[b].push(s[w])}const f={};for(const w in r){const b=r[w];b in f||(f[b]=[]),f[b].push(i[w])}let p=Object.keys(f).map(w=>parseInt(w,10)).sort(M0);this.layers=[];for(const w of p){const b=f[w];b.sort((C,k)=>{const $=o[C.id],I=o[k.id];return $<I?-1:$>I?1:0});for(const C of b)C instanceof _i&&this.internalContainerRefs.push(C),this.layers.push(C)}this.layersByDepth=f,p=Object.keys(d).map(w=>parseInt(w,10)).sort(M0);const g=this.inputs.slice(),m=[];for(const w of p)for(const b of d[w]){const C=b.outboundLayer;if(C!=null){for(const k of b.inputTensors)if(g.indexOf(k)===-1)throw new di(`Graph disconnected: cannot obtain value for tensor ${k} at layer "${C.name}". The following previous layers were accessed without issue: ${m}`);for(const k of b.outputTensors)g.push(k);m.push(C.name)}}this.nodesByDepth=d;const y=this.layers.map(w=>w.name);for(const w of y){const b=y.filter(C=>C===w).length;if(b!==1)throw new di(`The name "${w}" is used ${b} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(y))}this.outboundNodes=[],this.inboundNodes=[],new Xv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(w=>null),outputMasks:this.outputs.map(w=>null),inputShapes:this.inputs.map(w=>w.shape),outputShapes:this.outputs.map(w=>w.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new K("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const s={};let r=0;const i=Whe(e);i&&this.parseWeights(e);for(const a of this.layers)for(const[l,c]of a.weights.entries()){const u=i?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(s[u]!=null)throw new K(`Duplicate weight name: ${u}`);s[u]=c,r++}const o=[];for(const a in e){let l=a;if(s[a]==null){const c=a.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(s[l]!=null)o.push([s[l],e[a]]);else if(n)throw new K(`Provided weight data has no target variable: ${a}`);delete s[l]}if(n){const a=[];for(const l in s)a.push(l);if(a.length>0)throw new K(`${a.length} of ${r} weights are not set: ${a}`)}D3(o)}parseWeights(e){for(const n in Object.keys(e)){const s=n.split("/"),r=["vars","layer_checkpoint_dependencies"],i=s.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!r.includes(o)).join("/");i!==n&&(e[i]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${k6}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const s=tS(this.updatedConfig());return n?JSON.stringify(s):s}call(e,n){return re(()=>{e=Ct(e);const s=new il;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return Wf(this.outputs,s,n)})}computeMask(e,n){return re(()=>{e=Ct(e);let s;return n==null?s=gu(null,e.length):s=Ct(n),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const n=N2(e);if(n.length!==this.inputLayers.length)throw new K(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],c=n[a],u=l.name+"_0_0";s[u]=c}const r=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(M0);if(r.length>1)for(const a of r){const l=this.nodesByDepth[a];for(const c of l){const u=c.outboundLayer;if(this.inputLayers.map(g=>g.id).indexOf(u.id)!==-1)continue;const h=[];for(let g=0;g<c.inboundLayers.length;g++){const m=c.inboundLayers[g],y=c.nodeIndices[g],w=c.tensorIndices[g],b=`${m.name}_${y}_${w}`,C=s[b];h.push(C)}const d=u.computeOutputShape(qs(h)),f=N2(d),p=u.inboundNodes.indexOf(c);for(let g=0;g<f.length;g++){const m=`${u.name}_${p}_${g}`;s[m]=f[g]}}}const i=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],h=`${l.name}_${c}_${u}`;o.push(h)}for(let a=0;a<o.length;a++){const l=o[a];co(l in s),i.push(s[l])}return qs(i)}runInternalGraph(e,n){n==null&&(n=gu(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],u=e[l],h=n[l];s[c.id]=[u,h]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(M0);for(const l of r){const c=this.nodesByDepth[l];for(const u of c){const h=u.outboundLayer,d=u.inputTensors,f=u.outputTensors,p=new Array;for(const g of d)g.id in s&&p.push(s[g.id]);if(p.length===d.length){let g={},m,y,w,b;if(u.callArgs!=null&&(g=u.callArgs),p.length===1){const[C,k]=p[0];g.mask==null&&(g.mask=k),w=Ct(h.call(C,g)),b=Ct(h.computeMask(C,k)),m=[C],y=[k]}else m=p.map(C=>C[0]),y=p.map(C=>C[1]),g.mask==null&&(g.mask=y),w=Ct(h.call(m,g)),b=Ct(h.computeMask(m,y));if(h.activityRegularizer)throw new Je("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let C=0;C<f.length;++C){const k=f[C],$=w[C],I=b[C];s[k.id]=[$,I]}}}}const i=[],o=[],a=[];for(const l of this.outputs){co(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=s[l.id];a.push(c.shape),i.push(c),o.push(u)}return[i,o,a]}buildNodeConversionMap(e){const n={};let s;for(const r of this.layers){s=r instanceof _i?1:0;for(let i=0;i<r.inboundNodes.length;i++){const o=_i.nodeKey(r,i);this.containerNodes.has(o)&&(n[o]=s,s+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new K("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new K(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new K(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return re(()=>{const e=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const r=_i.nodeKey(n,s);this.containerNodes.has(r)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const o of this.layers){const a=o.getClassName(),l=o.getConfig(),c=[];for(let h=0;h<o.inboundNodes.length;h++){const d=o.inboundNodes[h],f=_i.nodeKey(o,h);let p={};if(this.containerNodes.has(f)){if(d.callArgs)try{JSON.stringify(d.callArgs),p=d.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${d.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(d.inboundLayers.length>0){const g=[];for(let m=0;m<d.inboundLayers.length;m++){const y=d.inboundLayers[m],w=d.nodeIndices[m],b=d.tensorIndices[m],C=_i.nodeKey(y,w);let k=n[C];k==null&&(k=0),g.push([y.name,k,b,p])}c.push(g)}}}const u={};u.name=o.name,u.className=a,u.config=l,u.inboundNodes=c,s.push(u)}e.layers=s;const r=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],l=this.inputLayersNodeIndices[o],c=_i.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const h=this.inputLayersTensorIndices[o];r.push([a.name,u,h])}e.inputLayers=r;const i=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],l=this.outputLayersNodeIndices[o],c=_i.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const h=this.outputLayersTensorIndices[o];i.push([a.name,u,h])}return e.outputLayers=i,e}static fromConfig(e,n,s={},r=!1){const i={},o={};function a(m,y){m.name in o?o[m.name].push(y):o[m.name]=[y]}function l(m,y){const w=[];let b;for(const C of y){const k=C[0],$=C[1],I=C[2];if(b=C[3]==null?{}:C[3],!(k in i)){a(m,y);return}const T=i[k];if(T.inboundNodes.length<=$){a(m,y);return}const R=T.inboundNodes[$];w.push(R.outputTensors[I])}w.length>0&&m.apply(qs(w),b)}function c(m){const y=m.name,w=Eo(m,n.customObjects!=null?n.customObjects:{});w.setFastWeightInitDuringBuild(r),i[y]=w,m.inboundNodes.forEach(C=>{if(!(C instanceof Array))throw new K(`Corrupted configuration, expected array for nodeData: ${C}`);a(w,C)})}const u=n.name,h=n.layers;for(const m of h)c(m);for(;!Eue(o);)for(const m of h){const y=i[m.name];if(y.name in o){const w=o[y.name];delete o[y.name];for(const b of w)l(y,b)}}const d=[],f=[],p=n.inputLayers;for(const m of p){const y=m[0],w=m[1],b=m[2];co(y in i);const k=i[y].inboundNodes[w].outputTensors;d.push(k[b])}const g=n.outputLayers;for(const m of g){const y=m[0],w=m[1],b=m[2];co(y in i);const k=i[y].inboundNodes[w].outputTensors;f.push(k[b])}return new e({inputs:d,outputs:f,name:u})}get stateful(){if(this._stateful)throw new K("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){re(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jhe(t,e,n){const s=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>null);if(s===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==s)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const r=[];return e.forEach(i=>{i in t?r.push(t[i]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function T6(t,e){return jhe(t,e,"classWeight")}async function E6(t,e,n,s){if(n!=null){const r=re(()=>{if(t.shape.length===1)return Hc(t);if(t.shape.length===2){if(t.shape[1]>1)return Up(t,1);if(t.shape[1]===1)return te(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await r.data());Ze(r);const o=[];return i.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(n[a])}),mr(o,"float32")}else return null}function Ghe(t,e){return Y(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Hhe=32;function N6(t,e){let n,s;const r=e;n=r.xs,s=r.ys,L(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=V$("input",t.inputNames,n),o=V$("output",t.outputNames,s),a=i[0].shape[0];L(i.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),L(o.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<i.length;l++)L(i[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<o.length;l++)L(o[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:i,ys:o}}function V$(t,e,n){if(n instanceof kn)return[n];if(Array.isArray(n))return L(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const s=[];for(const r of e){if(n[r]==null)throw new K(`The feature data generated by the dataset lacks the required ${t} key '${r}'.`);s.push(n[r])}return s}}function Khe(t){if(t.length===3)throw new Je("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function qhe(t,e,n){const s=n.batchesPerEpoch!=null;if(L(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),L(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),L(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),L(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),L(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const r=n.validationData!=null;let i,o;if(r)if(U$(n.validationData))L(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const m=Khe(n.validationData);i=m.xs,o=m.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let c;r?c=l.slice().concat(l.map(m=>"val_"+m)):c=l.slice();const u=y6(n.callbacks,n.yieldEvery),h=n.verbose==null?1:n.verbose,{callbackList:d,history:f}=v6(u,h,n.epochs,null,null,Xhe(e,n),null,r,c);d.setModel(t),t.history=f,await d.onTrainBegin(),t.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,g=await e.iterator();for(;p<n.epochs;){const m={};await d.onEpochBegin(p);let y=0,w=0;for(s||(g=await e.iterator());!s||y<n.batchesPerEpoch;){const b=await g.next();if(s&&b.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${y} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(b.value!=null){const{xs:C,ys:k}=N6(t,b.value),$={};$.batch=w,$.size=C[0].shape[0],await d.onBatchBegin(w,$);const I=[];if(n.classWeight!=null){const E=T6(n.classWeight,t.outputNames);for(let A=0;A<E.length;++A)I.push(await E6(k[A],null,E[A]))}const T=C.concat(k).concat(I),R=a(T);Ze(T);for(let E=0;E<l.length;++E){const A=l[E],F=R[E];$[A]=F,So(F)}await d.onBatchEnd(w,$),g6($),w++,y++}if(s?y>=n.batchesPerEpoch:b.done){if(r){let C;U$(n.validationData)?C=Ct(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):C=Ct(t.evaluate(i,o,{batchSize:n.validationBatchSize==null?Hhe:n.validationBatchSize,verbose:0}));for(let k=0;k<t.metricsNames.length;++k)m[`val_${t.metricsNames[k]}`]=C[k]}break}if(t.stopTraining_)break}if(await d.onEpochEnd(p,m),p++,t.stopTraining_)break}return await d.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function Xhe(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function U$(t){return typeof t.iterator=="function"}function Yhe(t){return typeof t.next=="function"}async function Jhe(t,e,n){n=n||{};const s=n.batches!=null,r=t.testFunction;let i=[];if(n.verbose>0)throw new Je("Verbose mode is not implemented yet.");L(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const o=Yhe(e)?e:await e.iterator();let a=0,l=0;for(;!s||l<n.batches;){const c=await o.next();if(i=re(()=>{if(c.value){const{xs:u,ys:h}=N6(t,c.value),d=u.concat(h),f=re(()=>r(d));if(Ze(d),l===0)for(let g=0;g<f.length;++g)i.push(gt(0));const p=d[0].shape[0];for(let g=0;g<f.length;++g){const m=f[g],y=i[g];i[g]=re(()=>ve(i[g],Y(p,m))),l>0&&Ze(y)}Ze(f),a+=p,++l}return i}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<i.length;++c){const u=i[c];i[c]=Ve(i[c],a),Ze(u)}return qs(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ow(t){L(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function Ef(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(s=>qc(s,e,n-e)):qc(t,e,n-e)}function nS(t,e){return re(()=>t==null?null:Array.isArray(t)?t.map(n=>nS(n,e)):n6(t,e.dtype==="int32"?e:Ee(e,"int32")))}function Fw(t,e){const n=[];let s=0,r=null;for(;s<t;)r=s+e,r>=t&&(r=t),n.push([s,r]),s=r;return n}function _6(t){const e=[];t instanceof kn&&(t=[t]);for(let n=0;n<t.length;++n){const s=t[n];if(s.rank===1)e.push(Sg(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function Ni(t,e){if(t==null)return;const n=[];if(e instanceof kn)n.push(e.id);else if(Array.isArray(e))e.forEach(r=>n.push(r.id));else if(e!=null)for(const r in e){const i=e[r];n.push(i.id)}const s=[];if(t instanceof kn)n.indexOf(t.id)===-1&&s.push(t);else if(Array.isArray(t))t.forEach(r=>{n.indexOf(r.id)===-1&&s.push(r)});else if(t!=null)for(const r in t){const i=t[r];n.indexOf(i.id)===-1&&s.push(i)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Zhe(t){return t instanceof kn}function sS(t){return Array.isArray(t)}function z$(t){return!Zhe(t)&&!sS(t)}function W$(t,e,n,s=!0,r=""){if(e==null||e.length===0){if(t!=null){let o=!1;if(sS(t)&&t.length>0)o=!0;else if(z$(t)){for(const a in t)if(t.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new K(`Error when checking model ${r} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(o=>null);let i;if(z$(t)){t=t,i=[];for(const o of e){if(t[o]==null)throw new K(`No data provided for "${o}". Need data for each key in: ${e}`);i.push(t[o])}}else if(sS(t)){if(t=t,t.length!==e.length)throw new K(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);i=t}else{if(t=t,e.length>1)throw new K(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);i=[t]}if(i=_6(i),n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new K(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u>=0&&c!==u)throw new K(`${r} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${r} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return i}function Qhe(t,e,n){const s=Il(t.map(i=>i.shape[0]));s.sort();const r=Il(e.map(i=>i.shape[0]));if(r.sort(),s.length>1)throw new K(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(i=>i.shape))}`);if(r.length>1)throw new K(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(s.length>0&&r.length>0&&!yt(s,r))throw new K(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function ede(t,e,n){const s=[Yv,Jv,Kp];for(let r=0;r<t.length;++r){const i=t[r],o=e[r],a=n[r];if(o!=null){if(o===Kp&&i.shape[i.shape.length-1]===1)throw new K(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(o)!==-1){const l=i.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){const h=l[u],d=c[u];if(d!=null&&h!==d)throw new K(`A target Tensor with shape ${i.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function j$(t,e,n,s=!0,r=""){let i;if(Array.isArray(t)){if(t.length!==e.length)throw new K(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);i=t}else{if(e.length>1)throw new K(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);i=[t]}if(n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new K(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u!==c)throw new K(`Error when checking ${r}: expected ${e[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function tde(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(s=>n);{const s=[];for(const r of e){let i=n.hasOwnProperty(r)?n[r]:[];Array.isArray(i)||(i=[i]),s.push(i)}return s}}const nde="layers-model";class Gh extends _i{constructor(e){super(e),this.isTraining=!1}summary(e,n,s=console.log){if(!this.built)throw new K("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Mhe(this,e,n,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=Lhe(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Zl))throw new K("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const o in e.loss)if(this.outputNames.indexOf(o)===-1)throw new K(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)e.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),n.push(Pw(e.loss[o]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new K(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>Pw(a))}else{const o=Pw(e.loss);this.outputs.forEach(a=>{n.push(o)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],l=this.outputNames[o];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Kc("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const r=tde(e.metrics,this.outputNames),i=(o,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,o])};Kc("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=r[o];(c=>{const u="";let h,d,f;for(const p of c){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const m=this.internalOutputShapes[o];m[m.length-1]===1||this.lossFunctions[o]===Jv?["accuracy","acc"].indexOf(p)!==-1?d=w6:["crossentropy","ce"].indexOf(p)!==-1&&(d=Ehe):this.lossFunctions[o]===D2?["accuracy","acc"].indexOf(p)!==-1?d=Nhe:["crossentropy","ce"].indexOf(p)!==-1&&(d=S6):["accuracy","acc"].indexOf(p)!==-1?d=b6:["crossentropy","ce"].indexOf(p)!==-1&&(d=C6);let y;["accuracy","acc"].indexOf(p)!==-1?y="acc":["crossentropy","ce"].indexOf(p)!==-1&&(y="ce"),f=d,h=u+y}else f=Fhe(p),h=u+U0(p);let g;Kc(h,()=>{g=f}),i(o,h,g)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,s={}){const r=s.batchSize==null?32:s.batchSize;Ow(r);const o=this.standardizeUserDataXY(e,n,!0,r);try{const a=o[0].concat(o[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,a,r,s.verbose,s.steps);return qs(c)}finally{Ni(o[0],e),Ni(o[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),Jhe(this,e,n)}checkNumSamples(e,n,s,r="steps"){let i;if(s!=null){if(i=null,n!=null)throw new K(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new K(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return i}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new K("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),r=s?n:[n],i=this.retrieveSymbolicTensors(r),o=new il;if(e instanceof kn&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new K(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)o.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new K(`No value is provided for the model's input ${l.name}`);o.add(l,c)}const a=Wf(i,o);return s?a:a[0]}retrieveSymbolicTensors(e){const n=gu(null,e.length);let s=e.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],o=i.map(a=>a.name);for(let a=0;a<e.length;++a){const l=o.indexOf(e[a]);if(l!==-1&&(n[a]=i[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw n.forEach((i,o)=>{i==null&&r.push(e[o])}),new K(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return n}predictLoop(e,n=32,s=!1){return re(()=>{const r=this.checkNumSamples(e);if(s)throw new Je("Verbose predictLoop() is not implemented yet.");const i=Fw(r,n),o=this.outputs.map(a=>[]);for(let a=0;a<i.length;++a)re(()=>{const c=i[a][0],u=i[a][1],h=Ef(e,c,u),d=[];if(Array.isArray(h))for(let p=0;p<h.length;++p)d.push({key:this.inputs[p],value:h[p]});else d.push({key:this.inputs[0],value:h});const f=new il(d);return Wf(this.outputs,f)}).forEach((c,u)=>o[u].push(c));return qs(o.map(a=>Js(a,0)))})}predict(e,n={}){const s=_6(e);j$(s,this.inputNames,this.feedInputShapes,!1);try{const r=n.batchSize==null?32:n.batchSize;return Ow(r),this.predictLoop(s,r)}finally{Ni(s,e)}}predictOnBatch(e){j$(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,s=!0,r){if(this.optimizer_==null)throw new di("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===D2?i.push(a.slice(0,a.length-1).concat([1])):i.push(a)}if(e=W$(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=W$(n,this.feedOutputNames,i,!1,"target"),Qhe(e,n),ede(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new K(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,s,r,i=!0,o){const[a,l]=this.standardizeUserDataXY(e,n,i,o);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(r!=null){const u=T6(r,this.outputNames);c=[];for(let h=0;h<u.length;++h)c.push(await E6(l[h],null,u[h]))}return[a,l,c]}testLoop(e,n,s,r=0,i){return re(()=>{const o=this.checkNumSamples(n,s,i,"steps"),a=[];if(r>0)throw new Je("Verbose mode is not implemented yet.");if(i!=null)throw new Je("steps mode in testLoop() is not implemented yet");{const l=Fw(o,s),c=mr(ji(0,o));for(let u=0;u<l.length;++u){const h=l[u][0],d=l[u][1],f=qc(c,h,d-h),p=nS(n,f),g=e(p);if(u===0)for(let m=0;m<g.length;++m)a.push(gt(0));for(let m=0;m<g.length;++m){const y=g[m];a[m]=ve(a[m],Y(d-h,y))}}for(let u=0;u<a.length;++u)a[u]=Ve(a[u],o)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let s=0;s<e.length;++s){const r=e[s];let i=r;if(N$(e,r)>1){const o=N$(e.slice(0,s),r);i+=`_${o}`}n.push(i)}return n}makeTrainFunction(){return e=>{const n=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const h=[];for(let g=0;g<this.inputs.length;++g)h.push({key:this.inputs[g],value:s[g]});const d=new il(h),f=Wf(this.outputs,d,{training:!0});let p;for(let g=0;g<this.lossFunctions.length;++g){const m=this.lossFunctions[g];let y=m(r[g],f[g]);i[g]!=null&&(y=Ghe(y,i[g]));const w=yn(y);n.push(w),g===0?p=y:p=ve(p,y)}for(let g=0;g<this.metricsTensors.length;++g){let m;if(this.outputs.length>1&&g<this.outputs.length)m=n[g];else{const y=this.metricsTensors[g][0],w=this.metricsTensors[g][1];m=yn(y(r[w],f[w]))}So(m),o.push(m)}return p=yn(p),this.calculateLosses().forEach(g=>{p=ve(p,g)}),p},l=this.collectedTrainableWeights.map(h=>h.read());return[this.optimizer_.minimize(a,!0,l)].concat(o)}}makeTestFunction(){this.testFunction=e=>re(()=>{const n=[];let s;const r=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let c=0;c<this.inputs.length;++c)o.push({key:this.inputs[c],value:r[c]});const a=new il(o),l=Wf(this.outputs,a);for(let c=0;c<this.lossFunctions.length;++c){const u=this.lossFunctions[c],h=yn(u(i[c],l[c]));c===0?s=h:s=ve(s,h),n.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const u=this.metricsTensors[c][0],h=this.metricsTensors[c][1],d=yn(u(i[h],l[h]));n.push(d)}return n})}async fit(e,n,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,i,o,a,l,c,u,h,d;try{const f=s.batchSize==null?32:s.batchSize;Ow(f);const g=await this.standardizeUserData(e,n,s.sampleWeight,s.classWeight,!1,f);r=g[0],i=g[1],d=g[2];let m=!1,y;if(s.validationData!=null&&s.validationData.length>0){if(m=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new Je("validationData including sample weights is not supported yet."):new K(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const E=await this.standardizeUserData(l,c,null,null,!0,f);u=E[0],h=E[1],y=u.concat(h)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){m=!0;const R=Math.floor(r[0].shape[0]*(1-s.validationSplit)),E=r[0].shape[0];u=Ef(r,R,E),o=r,r=Ef(r,0,R),h=Ef(i,R,E),a=i,i=Ef(i,0,R),y=u.concat(h)}else s.validationSteps!=null&&(m=!0);const w=r.concat(i).concat(d);this.checkTrainableWeightsConsistency();const b=this.makeTrainFunction(),C=this.getDedupedMetricsNames();let k,$;m?(this.makeTestFunction(),k=this.testFunction,$=C.slice().concat(C.map(R=>"val_"+R))):(k=null,y=[],$=C.slice());const I=y6(s.callbacks,s.yieldEvery);return await this.fitLoop(b,w,C,f,s.epochs,s.verbose,I,k,y,s.shuffle,$,s.initialEpoch,null,null)}finally{this.isTraining=!1,Ni(r,e),Ni(i,n),Ni(o,e),Ni(a,n),Ni(u,l),Ni(h,c),d!=null&&Ze(d)}}async fitLoop(e,n,s,r,i,o,a,l,c,u,h,d,f,p){r==null&&(r=32),i==null&&(i=1),u==null&&(u=!0),d==null&&(d=0);let g=!1;if(l!=null&&c!=null&&(g=!0),p!=null&&(g=!0,f==null))throw new K("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const m=this.checkNumSamples(n,r,f,"steps_per_epoch");let y;m!=null&&(y=ji(0,m)),o==null&&(o=1);const{callbackList:w,history:b}=v6(a,o,i,d,m,f,r,g,h);w.setModel(this),this.history=b,await w.onTrainBegin(),this.stopTraining_=!1;for(let C=d;C<i;++C){await w.onEpochBegin(C);const k={};if(f!=null)throw new Je("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new Je("batch shuffling is not implemneted yet");u&&Ite(y);const $=mr(y),I=Fw(m,r);for(let T=0;T<I.length;++T){const R={};if(await w.onBatchBegin(T,R),re(()=>{const E=I[T][0],A=I[T][1],F=qc($,E,A-E);R.batch=T,R.size=A-E;const P=nS(n,F),Z=e(P);for(let H=0;H<s.length;++H){const j=s[H],ee=Z[H];R[j]=ee,So(ee)}if(T===I.length-1&&g){const H=this.testLoop(l,c,r);for(let j=0;j<s.length;++j){const ee=s[j],z=H[j];So(z),k["val_"+ee]=z}}}),await w.onBatchEnd(T,R),g6(R),this.stopTraining_)break}$.dispose()}if(await w.onEpochEnd(C,k),this.stopTraining_)break}return await w.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return qhe(this,e,n)}async trainOnBatch(e,n){const s=await this.standardizeUserData(e,n),r=s[0],i=s[1],a=this.makeTrainFunction()(r.concat(i)),l=[];for(const c of a){const u=await c.data();l.push(u[0])}return Ze(a),Ni(s[0],e),Ni(s[1],n),qs(l)}getNamedWeights(e){const n=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,i=this.getWeights(s);for(let o=0;o<r.length;++o)s&&!r[o].trainable||n.push({name:r[o].originalName,tensor:i[o]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=l$().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-l$().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Yo(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>Yo(n))}else{const n=Object.keys(this.loss);e={};const s=this.loss;for(const r of n)if(typeof s[r]=="string")e[r]=Yo(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Yo(U0(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Yo(U0(e)));{const e={};for(const n in this.metrics)e[n]=Yo(U0(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=L2(e.optimizer_config),s=Eo(n);let r;if(typeof e.loss=="string")r=_c(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(o=>_c(o));else if(e.loss!=null){r={};for(const o in e.loss)r[o]=_c(e.loss[o])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(o=>_c(o));else if(e.metrics!=null){i={};for(const o in e.metrics)i[o]=_c(e.metrics[o])}this.compile({loss:r,metrics:i,optimizer:s})}async save(e,n){if(typeof e=="string"){const c=_ne(e);if(c.length===0)throw new K(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new K(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new K("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await c$(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:nde,generatedBy:`TensorFlow.js tfjs-layers v${k6}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:u,specs:h}=await c$(await this.optimizer.getWeights(),c);s.specs.push(...h),s.data=bne([s.data,u])}return this.userDefinedMetadata!=null&&(B$(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,e.save(a)}setUserDefinedMetadata(e){B$(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Gh.className="Model";me(Gh);class $6 extends Gh{}$6.className="Functional";me($6);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function sde(t,e){if(e==null&&(e={}),typeof t=="string"){const n=$ne(t,e);if(n.length===0)n.push(ule(t,e));else if(n.length>1)throw new K(`Found more than one (${n.length}) load handlers for URL '${t}'`);t=n[0]}return rde(t,void 0,e)}async function rde(t,e,n){if(n==null&&(n={}),t.load==null)throw new K("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const s=await t.load();let r=s.modelTopology;r.model_config!=null&&(r=r.model_config);const i=n.strict==null?!0:n.strict,o=s.weightData!=null&&s.weightSpecs!=null&&i,a=Eo(L2(r),e,o),l=s.trainingConfig;if(l!=null&&a.loadTrainingConfig(l),s.userDefinedMetadata!=null&&a.setUserDefinedMetadata(s.userDefinedMetadata),s.weightData!=null){if(s.weightSpecs==null)throw new K("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:c,optimizerWeights:u}=ide(s.weightData,s.weightSpecs);a.loadWeights(c,i),a.optimizer!=null&&u.length>0&&await a.optimizer.setWeights(u),Ze(c),Ze(u.map(h=>h.tensor))}return a}function ide(t,e){const n=mne(t,e),s={},r=[];return e.forEach(i=>{i.group==="optimizer"?r.push({name:i.name,tensor:n[i.name]}):s[i.name]=n[i.name]}),{modelWeights:s,optimizerWeights:r}}class qp extends Gh{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:Kv("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new K(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof qp||e instanceof Gh;let s;if(n){if(s=e,s.outputs.length!==1)throw new K("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new K("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new K("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=rhe({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new K(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new K("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=h6(this.outputs[0])}this.inboundNodes=[],new Xv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:gu(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(dt(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Gh({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,s=console.log){this.built||this.build(),super.summary(e,n,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,s={}){if(!this.built)throw new di("The model needs to be compiled before being used.");return this.model.evaluate(e,n,s)}async evaluateDataset(e,n){if(!this.built)throw new di("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,s={}){if(!this.built)throw new di("The model needs to be compiled before being used.");return this.model.fit(e,n,s)}async fitDataset(e,n){if(!this.built)throw new di("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,s={},r=!1){let i,o={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new K("Legacy serialization format not supported yet.");i=n}else L(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=n.layers,delete n.layers,o=n;const a=new e(o);if(!(a instanceof qp))throw new Je(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of i){const u=Eo(l,void 0,r);r&&u.setFastWeightInitDuringBuild(!0),a.add(u)}return a}set stopTraining(e){if(this.model==null)throw new K("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new K("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),e.push(s)}return{name:this.name,layers:e}}}qp.className="Sequential";me(qp);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let gs=class extends Md{getConfig(){return{}}};class R6 extends gs{apply(e,n=1){return zue(e,n)}}R6.className="elu";me(R6);class A6 extends gs{apply(e){return KL(e)}}A6.className="selu";me(A6);class D6 extends gs{apply(e){return $u(e)}}D6.className="relu";me(D6);class P6 extends gs{apply(e){return re(()=>jp(6,$u(e)))}}P6.className="relu6";me(P6);class O6 extends gs{apply(e){return e}}O6.className="linear";me(O6);class F6 extends gs{apply(e){return Od(e)}}F6.className="sigmoid";me(F6);class L6 extends gs{apply(e){return jue(e)}}L6.className="hardSigmoid";me(L6);class M6 extends gs{apply(e){return mg(e)}}M6.className="softplus";me(M6);class B6 extends gs{apply(e){return Wue(e)}}B6.className="softsign";me(B6);class V6 extends gs{apply(e){return Lv(e)}}V6.className="tanh";me(V6);let L3=class extends gs{apply(e,n=-1){return BT(e,n)}};L3.className="softmax";me(L3);class U6 extends gs{apply(e,n=-1){return ML(e,n)}}U6.className="logSoftmax";me(U6);class z6 extends gs{apply(e){return re(()=>re(()=>{const n=Math.sqrt(2),s=Y(.5,ve(1,DL(Ve(e,n))));return Y(e,s)}))}}z6.className="gelu";me(z6);class W6 extends gs{apply(e){return re(()=>Y(.5,Y(e,ve(1,Lv(Y(ps(Ve(2,Math.PI)),ve(e,Y(.044715,fu(e,3)))))))))}}W6.className="gelu_new";me(W6);class j6 extends gs{apply(e){return re(()=>Y(e,Lv(mg(e))))}}j6.className="mish";me(j6);class G6 extends gs{apply(e,n=1){return re(()=>Y(Od(Y(e,n)),e))}}G6.className="swish";me(G6);function Dl(t){return t.getClassName()}function Lw(t,e={}){return Cg(t,ai.getMap().classNameMap,e,"activation")}function Pl(t){if(t==null){const e={};return e.className="linear",e.config={},Lw(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},Lw(e)}else return t instanceof gs?t:Lw(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ode(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class H6 extends Md{}class K6 extends H6{constructor(e){super(),ode(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return re(()=>{let n=Bn([1]);return this.hasL1&&(n=ve(n,Me(Y(this.l1,ks(e))))),this.hasL2&&(n=ve(n,Me(Y(this.l2,Ig(e))))),te(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}K6.className="L1L2";me(K6);const G$={l1l2:"L1L2"};function At(t){return S3(t)}function H$(t,e={}){return Cg(t,ai.getMap().classNameMap,e,"regularizer")}function qt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in G$?G$[t]:t,config:{}};return H$(n)}else return t instanceof H6?t:H$(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class q6 extends nt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=je(e);let s=$u(e);return this.maxValue!=null&&(s=Wr(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}q6.className="ReLU";me(q6);class X6 extends nt{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=je(e);return ST(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}X6.className="LeakyReLU";me(X6);class Y6 extends nt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=Kt(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=qt(e.alphaRegularizer),this.alphaConstraint=$n(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new K(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=dt(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)n[r-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new Nn({ndim:e.length,axes:s})],this.built=!0}call(e,n){return e=je(e),_T(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Jt(this.alphaInitializer),alphaRegularizer:At(this.alphaRegularizer),alphaConstraint:_n(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}Y6.className="PReLU";me(Y6);let J6=class extends nt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Je(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=je(e);return Vv(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};J6.className="ELU";me(J6);class Z6 extends nt{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const s=je(e);return Y(s,Ee(Hr(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}Z6.className="ThresholdedReLU";me(Z6);class Q6 extends nt{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new L3().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return re(()=>{let s=je(e);const r=n.mask;if(r!=null){const i=Y(ze(Jl(s.shape),Ee(r,s.dtype)),gt(-1e9));s=ve(s,i)}return this.axis instanceof Array?this.axis.length>1?_o(ze(s,BL(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}Q6.className="Softmax";me(Q6);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Hh(t,e,n){if(typeof t=="number")return gu(t,e);if(t.length!==e)throw new K(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const r=t[s];if(!Mue(r))throw new K(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${r}`)}return t}function Ui(t,e,n,s,r=1){if(t==null)return t;const i=e+(e-1)*(r-1);let o;return n==="same"?o=t:o=t-i+1,Math.floor((o+s-1)/s)}function uo(t,e,n,s){if(t==null)return null;if(s==="valid")t=t*e+Al([n-e,0]);else if(s==="same")t=t*e;else throw new K(`Unsupport padding mode: ${s}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function M3(t,e){return re(()=>(hn(e),e==="channelsFirst"?at(t,[0,2,3,1]):t))}function e9(t,e){return re(()=>(hn(e),e==="channelsFirst"?at(t,[0,2,3,4,1]):t))}function ade(t,e,n,s=1,r="valid",i,o=1){return re(()=>{if(i==null&&(i=Gi()),hn(i),t.shape.length!==3)throw new K(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new K(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new K(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(i==="channelsFirst"&&(t=at(t,[0,2,1])),r==="causal")throw new Je("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=NL(t,e,s,r==="same"?"same":"valid","NWC",o);return n!=null&&(a=qi(a,n)),a})}function K$(t,e,n,s=[1,1],r="valid",i,o,a=null){return re(()=>{if(i==null&&(i=Gi()),hn(i),t.rank!==3&&t.rank!==4)throw new K(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new K(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=M3(t,i);if(r==="causal")throw new Je("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=aae({x:l,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),i==="channelsFirst"&&(l=at(l,[0,3,1,2])),l})}function lde(t,e,n,s=[1,1,1],r="valid",i,o){return re(()=>{if(i==null&&(i=Gi()),hn(i),t.rank!==4&&t.rank!==5)throw new K(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new K(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=e9(t,i);if(r==="causal")throw new Je("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=ore(a,e,s,r==="same"?"same":"valid","NDHWC",o),n!=null&&(a=qi(a,n)),i==="channelsFirst"&&(a=at(a,[0,4,1,2,3])),a})}class Zv extends nt{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Zv.verifyArgs(n),this.rank=e,Un(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Je(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Hh(n.kernelSize,e,"kernelSize"),this.strides=Hh(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,Kr(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,hn(this.dataFormat),this.activation=Pl(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=Kt(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=$n(n.biasConstraint),this.biasRegularizer=qt(n.biasRegularizer),this.activityRegularizer=qt(n.activityRegularizer),this.dilationRate=Hh(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new K(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new K(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new K(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(co("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!I3(e.kernelSize,"number",1,3))throw new K(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Dl(this.activation),useBias:this.useBias,biasInitializer:Jt(this.biasInitializer),biasRegularizer:At(this.biasRegularizer),activityRegularizer:At(this.activityRegularizer),biasConstraint:_n(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class Bd extends Zv{constructor(e,n){super(e,n),this.kernel=null,Bd.verifyArgs(n),this.filters=n.filters,Un(this.filters,"filters"),this.kernelInitializer=Kt(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=$n(n.kernelConstraint),this.kernelRegularizer=qt(n.kernelRegularizer)}build(e){e=dt(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new K(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(e,n){return re(()=>{e=je(e);let s;const r=this.bias==null?null:this.bias.read(),i=YM(this.activation.getClassName());if(i!=null&&this.rank===2)s=K$(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)s=ade(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=K$(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=lde(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Je("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=dt(e);const n=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<s.length;++i){const o=Ui(s[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);n.push(o)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(n),r.push(this.filters)):(r.push(this.filters),r=r.concat(n)),r}getConfig(){const e={filters:this.filters,kernelInitializer:Jt(this.kernelInitializer),kernelRegularizer:At(this.kernelRegularizer),kernelConstraint:_n(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new K(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Ng extends Bd{constructor(e){super(2,e),Ng.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!I3(e.kernelSize,"number",1,2))throw new K(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Ng.className="Conv2D";me(Ng);class _g extends Bd{constructor(e){super(3,e),_g.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new K(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}_g.className="Conv3D";me(_g);class t9 extends Ng{constructor(e){if(super(e),this.inputSpec=[new Nn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new K(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=dt(e),e.length!==4)throw new K("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new K("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Nn({ndim:4,axes:{[n]:s}})],this.built=!0}call(e,n){return re(()=>{let s=je(e);if(s.shape.length!==4)throw new K(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const l=r[o],c=r[a],u=this.kernelSize[0],h=this.kernelSize[1],d=this.strides[0],f=this.strides[1],p=uo(l,d,u,this.padding),g=uo(c,f,h,this.padding),m=[i,p,g,this.filters];this.dataFormat!=="channelsLast"&&(s=at(s,[0,2,3,1]));let y=_L(s,this.kernel.read(),m,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(y=at(y,[0,3,1,2])),this.bias!=null&&(y=qi(y,this.bias.read(),this.dataFormat)),this.activation!=null&&(y=this.activation.apply(y)),y})}computeOutputShape(e){e=dt(e);const n=e.slice();let s,r,i;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3):(s=3,r=1,i=2);const o=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[s]=this.filters,n[r]=uo(n[r],l,o,this.padding),n[i]=uo(n[i],c,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}t9.className="Conv2DTranspose";me(t9);class n9 extends _g{constructor(e){if(super(e),this.inputSpec=[new Nn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new K(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=dt(e),e.length!==5)throw new K("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new K("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Nn({ndim:5,axes:{[n]:s}})],this.built=!0}call(e,n){return re(()=>{let s=je(e);if(s.shape.length!==5)throw new K(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let o,a,l;this.dataFormat==="channelsFirst"?(l=2,o=3,a=4):(l=1,o=2,a=3);const c=r[l],u=r[o],h=r[a],d=this.kernelSize[0],f=this.kernelSize[1],p=this.kernelSize[2],g=this.strides[0],m=this.strides[1],y=this.strides[2],w=uo(c,g,d,this.padding),b=uo(u,m,f,this.padding),C=uo(h,y,p,this.padding),k=[i,w,b,C,this.filters];this.dataFormat!=="channelsLast"&&(s=at(s,[0,2,3,4,1]));let $=cre(s,this.kernel.read(),k,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&($=at($,[0,4,1,2,3])),this.bias!==null&&($=qi($,this.bias.read(),this.dataFormat)),this.activation!==null&&($=this.activation.apply($)),$})}computeOutputShape(e){e=dt(e);const n=e.slice();let s,r,i,o;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3,o=4):(s=4,r=1,i=2,o=3);const a=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],h=this.strides[1],d=this.strides[2];return n[s]=this.filters,n[r]=uo(n[r],u,a,this.padding),n[i]=uo(n[i],h,l,this.padding),n[o]=uo(n[o],d,c,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}n9.className="Conv3DTranspose";me(n9);class s9 extends Bd{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new K("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new K("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new K(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=Kt(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=qt(n.depthwiseRegularizer),this.depthwiseConstraint=$n(n.depthwiseConstraint),this.pointwiseInitializer=Kt(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=qt(n.pointwiseRegularizer),this.pointwiseConstraint=$n(n.pointwiseConstraint)}build(e){if(e=dt(e),e.length<this.rank+2)throw new K(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new K(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const s=e[n],r=this.kernelSize.concat([s,this.depthMultiplier]),i=[];for(let a=0;a<this.rank;++a)i.push(1);i.push(s*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new Nn({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(e,n){return re(()=>{e=je(e);let s;if(this.rank===1)throw new Je("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=at(e,[0,2,3,1])),s=qL(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=qi(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=at(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Jt(this.depthwiseInitializer),e.pointwiseInitializer=Jt(this.pointwiseInitializer),e.depthwiseRegularizer=At(this.depthwiseRegularizer),e.pointwiseRegularizer=At(this.pointwiseRegularizer),e.depthwiseConstraint=_n(this.depthwiseConstraint),e.pointwiseConstraint=_n(this.pointwiseConstraint),e}}s9.className="SeparableConv";class r9 extends s9{constructor(e){super(2,e)}}r9.className="SeparableConv2D";me(r9);class Qv extends Bd{constructor(e){super(1,e),Qv.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!I3(e.kernelSize,"number",1,1))throw new K(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}Qv.className="Conv1D";me(Qv);class i9 extends nt{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return re(()=>{if(e=je(e),this.dataFormat==="channelsLast"){const s=V0(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return V0(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=V0(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return V0(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}i9.className="Cropping2D";me(i9);class o9 extends nt{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,hn(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,Oue(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,s]}else{const n=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],n,s,e[3]]}}call(e,n){return re(()=>{let s=je(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=at(s,[0,2,3,1]);const i=this.size[0]*r[2],o=this.size[1]*r[3],a=this.interpolation==="nearest"?oa.resizeNearestNeighbor(s,[i,o]):oa.resizeBilinear(s,[i,o]);return at(a,[0,3,1,2])}else{const i=this.size[0]*r[1],o=this.size[1]*r[2];return this.interpolation==="nearest"?oa.resizeNearestNeighbor(s,[i,o]):oa.resizeBilinear(s,[i,o])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}o9.className="UpSampling2D";me(o9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function cde(t,e,n=[1,1],s="valid",r,i){return re(()=>{r==null&&(r=Gi()),hn(r);let o=M3(t,r);if(t.rank!==4)throw new K(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new K(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return o=xT(o,e,n,s==="same"?"same":"valid","NHWC",i),r==="channelsFirst"&&(o=at(o,[0,3,1,2])),o})}class a9 extends Zv{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=Kt(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=$n(e.depthwiseConstraint),this.depthwiseRegularizer=qt(e.depthwiseRegularizer)}build(e){if(e=dt(e),e.length<4)throw new K(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new K(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const s=e[n],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return re(()=>{e=je(e);let s=cde(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=qi(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=dt(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=Ui(n,this.kernelSize[0],this.padding,this.strides[0]),o=Ui(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,i,o]:[e[0],i,o,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Jt(this.depthwiseInitializer),e.depthwiseRegularizer=At(this.depthwiseRegularizer),e.depthwiseConstraint=_n(this.depthwiseRegularizer),e}}a9.className="DepthwiseConv2D";me(a9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function l9(t,e,n,s){if(Array.isArray(t)){if(e!=null||n!=null)throw new K("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=t.slice(t.length-s,t.length),t=t.slice(0,t.length-s)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function r(i){return i==null||Array.isArray(i)?i:[i]}return e=r(e),n=r(n),{inputs:t,initialState:e,constants:n}}function c9(t,e,n,s=!1,r,i,o=!1,a=!1){return re(()=>{const l=e.shape.length;if(l<3)throw new K(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(ji(2,l));e=at(e,c),o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=Ee(Ee(r,"bool"),"float32"),r.rank===l-1&&(r=Ks(r,-1)),r=at(r,c)),s&&(e=pu(e,0),r!=null&&(r=pu(r,0)));const u=[];let h,d=n;const f=e.shape[0],p=mu(e);let g;r!=null&&(g=mu(r));for(let y=0;y<f;++y){const w=p[y],b=re(()=>t(w,d));if(r==null)h=b[0],d=b[1];else{const C=re(()=>{const k=g[y],$=ze(xi(k),k),I=ve(Y(b[0],k),Y(d[0],$)),T=d.map((R,E)=>ve(Y(b[1][E],k),Y(R,$)));return{output:I,newStates:T}});h=C.output,d=C.newStates}a&&u.push(h)}let m;return a&&(m=va(u,1)),[h,m,d]})}class Ql extends nt{constructor(e){super(e);let n;if(e.cell==null)throw new K("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new U3({cells:e.cell}):n=e.cell,n.stateSize==null)throw new K("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Nn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return ji(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){ZC(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const i=[];for(const o of n)i.push([e[0],o]);return[r].concat(i)}else return r}computeMask(e,n){return re(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const r=this.states.map(i=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<e;++s)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Je("Constants support is not implemented in RNN yet.");ZC(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new Nn({shape:[n,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!yt(this.stateSpec.map(o=>o.shape[o.shape.length-1]),i))throw new K(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(o=>new Nn({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){re(()=>{if(!this.stateful)throw new lo("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new K("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>Bn([s,r])):this.states_=[Bn([s,this.cell.stateSize])];else if(e==null)Ze(this.states_),this.keptStates!=null&&(Ze(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>Bn([s,r])):this.states_[0]=Bn([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new K(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):Ze(this.states_);for(let r=0;r<this.states_.length;++r){const i=e[r],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,a=[s,o];if(!yt(i.shape,a))throw new K(`State ${r} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${i.shape}`);this.states_[r]=i}}this.states_=this.states_.map(r=>So(r.clone()))})}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const i=l9(e,s,r,this.numConstants);e=i.inputs,s=i.initialState,r=i.constants;let o=[],a=[];if(s!=null){n.initialState=s,o=o.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new Nn({shape:c.shape}));a=a.concat(this.stateSpec)}if(r!=null&&(n.constants=r,o=o.concat(r),this.numConstants=r.length),o[0]instanceof Ro){const c=[e].concat(o),u=this.inputSpec.concat(a),h=this.inputSpec;this.inputSpec=u;const d=super.apply(c,n);return this.inputSpec=h,d}else return super.apply(e,n)}call(e,n){return re(()=>{const s=n==null?null:n.mask,r=n==null?null:n.training;let i=n==null?null:n.initialState;e=je(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==o)throw new K(`RNN Layer has ${o} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:r},c=c9((p,g)=>{const m=this.cell.call([p].concat(g),a);return[m[0],m.slice(1)]},e,i,this.goBackwards,s,null,this.unroll,this.returnSequences),u=c[0],h=c[1],d=c[2];this.stateful&&this.resetStates(d,r);const f=this.returnSequences?h:u;return this.returnState?[f].concat(d):f})}getInitialState(e){return re(()=>{let n=Bn(e.shape);return n=Me(n,[1,2]),n=Sg(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?YC(n,[1,s]):n):this.cell.stateSize>1?[YC(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===Ql.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),n)}static fromConfig(e,n,s={}){const r=n.cell,i=Eo(r,s);return new e(Object.assign(n,{cell:i}))}}Ql.className="RNN";me(Ql);class ex extends nt{}class B3 extends ex{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Un(this.units,"units"),this.activation=Pl(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Kt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Kt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Kt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=qt(e.kernelRegularizer),this.recurrentRegularizer=qt(e.recurrentRegularizer),this.biasRegularizer=qt(e.biasRegularizer),this.kernelConstraint=$n(e.kernelConstraint),this.recurrentConstraint=$n(e.recurrentConstraint),this.biasConstraint=$n(e.biasConstraint),this.dropout=md([1,Al([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=md([1,Al([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=dt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return re(()=>{if(e=e,e.length!==2)throw new K(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ol({ones:()=>xi(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ol({ones:()=>xi(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let i;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?i=To(Y(e,o),this.kernel.read()):i=To(e,this.kernel.read()),this.bias!=null&&(i=qi(i,this.bias.read())),a!=null&&(s=Y(s,a));let l=ve(i,To(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Dl(this.activation),useBias:this.useBias,kernelInitializer:Jt(this.kernelInitializer),recurrentInitializer:Jt(this.recurrentInitializer),biasInitializer:Jt(this.biasInitializer),kernelRegularizer:At(this.kernelRegularizer),recurrentRegularizer:At(this.recurrentRegularizer),biasRegularizer:At(this.biasRegularizer),activityRegularizer:At(this.activityRegularizer),kernelConstraint:_n(this.kernelConstraint),recurrentConstraint:_n(this.recurrentConstraint),biasConstraint:_n(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}B3.className="SimpleRNNCell";me(B3);class u9 extends Ql{constructor(e){e.cell=new B3(e),super(e)}call(e,n){return re(()=>{this.cell.dropoutMask!=null&&(Ze(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ze(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return new e(n)}}u9.className="SimpleRNN";me(u9);class V3 extends ex{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new K("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Un(this.units,"units"),this.activation=Pl(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Pl(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Kt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Kt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Kt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=qt(e.kernelRegularizer),this.recurrentRegularizer=qt(e.recurrentRegularizer),this.biasRegularizer=qt(e.biasRegularizer),this.kernelConstraint=$n(e.kernelConstraint),this.recurrentConstraint=$n(e.recurrentConstraint),this.biasConstraint=$n(e.biasConstraint),this.dropout=md([1,Al([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=md([1,Al([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=dt(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return re(()=>{if(e=e,e.length!==2)throw new K(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training==null?!1:n.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ol({ones:()=>xi(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ol({ones:()=>xi(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let a,l,c;0<this.dropout&&this.dropout<1&&(e=Y(e,i[0]));let u=To(e,this.kernel.read());this.useBias&&(u=qi(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=Y(r,o[0]));const h=this.recurrentKernel.read(),[d,f]=Vr(h,[2*this.units,this.units],h.rank-1),p=To(r,d),[g,m,y]=Vr(u,3,u.rank-1),[w,b]=Vr(p,2,p.rank-1);a=this.recurrentActivation.apply(ve(g,w)),l=this.recurrentActivation.apply(ve(m,b));const C=To(Y(l,r),f);c=this.activation.apply(ve(y,C));const k=ve(Y(a,r),Y(ve(1,ln(a)),c));return[k,k]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Dl(this.activation),recurrentActivation:Dl(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Jt(this.kernelInitializer),recurrentInitializer:Jt(this.recurrentInitializer),biasInitializer:Jt(this.biasInitializer),kernelRegularizer:At(this.kernelRegularizer),recurrentRegularizer:At(this.recurrentRegularizer),biasRegularizer:At(this.biasRegularizer),activityRegularizer:At(this.activityRegularizer),kernelConstraint:_n(this.kernelConstraint),recurrentConstraint:_n(this.recurrentConstraint),biasConstraint:_n(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}V3.className="GRUCell";me(V3);class h9 extends Ql{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new V3(e),super(e)}call(e,n){return re(()=>{this.cell.dropoutMask!=null&&(Ze(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ze(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}h9.className="GRU";me(h9);class tx extends ex{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Un(this.units,"units"),this.activation=Pl(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Pl(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Kt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Kt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Kt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=qt(e.kernelRegularizer),this.recurrentRegularizer=qt(e.recurrentRegularizer),this.biasRegularizer=qt(e.biasRegularizer),this.kernelConstraint=$n(e.kernelConstraint),this.recurrentConstraint=$n(e.recurrentConstraint),this.biasConstraint=$n(e.biasConstraint),this.dropout=md([1,Al([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=md([1,Al([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=dt(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,o=this.units;r=new(n=class extends bi{apply(l,c){const u=i.apply([o]),h=new T3().apply([o]),d=i.apply([o*2]);return $$($$(u,h),d)}},n.className="CustomInit",n)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return re(()=>{const s=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new K(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ol({ones:()=>xi(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ol({ones:()=>xi(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let l,c,u,h;0<this.dropout&&this.dropout<1&&(e=Y(e,o[0]));let d=To(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=Y(r,a[0])),d=ve(d,To(r,this.recurrentKernel.read())),this.useBias&&(d=qi(d,this.bias.read()));const[f,p,g,m]=Vr(d,4,d.rank-1);l=this.recurrentActivation.apply(f),c=this.recurrentActivation.apply(p),u=ve(Y(c,i),Y(l,this.activation.apply(g))),h=this.recurrentActivation.apply(m);const y=Y(h,this.activation.apply(u));return[y,y,u]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Dl(this.activation),recurrentActivation:Dl(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Jt(this.kernelInitializer),recurrentInitializer:Jt(this.recurrentInitializer),biasInitializer:Jt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:At(this.kernelRegularizer),recurrentRegularizer:At(this.recurrentRegularizer),biasRegularizer:At(this.biasRegularizer),activityRegularizer:At(this.activityRegularizer),kernelConstraint:_n(this.kernelConstraint),recurrentConstraint:_n(this.recurrentConstraint),biasConstraint:_n(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}tx.className="LSTMCell";me(tx);class d9 extends Ql{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new tx(e),super(e)}call(e,n){return re(()=>{this.cell.dropoutMask!=null&&(Ze(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ze(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}d9.className="LSTM";me(d9);class U3 extends ex{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return re(()=>{e=e;let s=e.slice(1);const r=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?r.push(s.splice(0,a.stateSize.length)):r.push(s.splice(0,1));r.reverse();const i=[];let o;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];s=r[a],a===0?o=[e[0]].concat(s):o=[o[0]].concat(s),o=l.call(o,n),i.push(o.slice(1))}s=[];for(const a of i.slice().reverse())s.push(...a);return[o[0]].concat(s)})}build(e){ZC(e)&&(e=e[0]),e=e;let n;this.cells.forEach((s,r)=>{Kc(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=i=>({className:i.getClassName(),config:i.getConfig()}),r={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,n,s={}){const r=[];for(const i of n.cells)r.push(Eo(i,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return QC(e)}setWeights(e){const n=[];for(const s of this.cells){const r=s.weights.length,i=e.splice(r);for(let o=0;o<s.weights.length;++o)n.push([s.weights[o],i[o]])}D3(n)}}U3.className="StackedRNNCells";me(U3);function Ol(t){const{ones:e,rate:n,training:s=!1,count:r=1,dropoutFunc:i}=t,o=()=>i!=null?i(e(),n):s6(e(),n),a=()=>kg(o,e,s);return!r||r<=1?So(a().clone()):Array(r).fill(void 0).map(a).map(c=>So(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var ude=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};class f9 extends Ql{constructor(e){if(e.unroll)throw new Je("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Je("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Nn({ndim:5})]}call(e,n){return re(()=>{if(this.cell.dropoutMask!=null&&(Ze(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ze(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new K("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return re(()=>{const{stateSize:n}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)],o=Bn(i);return Array.isArray(n)?Array(n.length).fill(o):[o]})}resetStates(e,n=!1){re(()=>{if(!this.stateful)throw new lo("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)];if(s[0]==null)throw new K("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Bn(i)):this.states_=[Bn(i)];else if(e==null)Ze(this.states_),this.keptStates!=null&&(Ze(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Bn(i)):this.states_[0]=Bn(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new K(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):Ze(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],c=i;if(!yt(l.shape,c))throw new K(`State ${a} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>So(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:s,kernelSize:r,padding:i,strides:o,dilationRate:a}=this.cell,l=n==="channelsFirst",c=e[l?3:2],u=e[l?4:3],h=Ui(c,r[0],i,o[0],a[0]),d=Ui(u,r[1],i,o[1],a[1]);return[...e.slice(0,2),...l?[s,h,d]:[h,d,s]]}}f9.className="ConvRNN2D";class z3 extends tx{constructor(e){const{filters:n,kernelSize:s,strides:r,padding:i,dataFormat:o,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,Un(this.filters,"filters"),this.kernelSize=Hh(s,2,"kernelSize"),this.kernelSize.forEach(l=>Un(l,"kernelSize")),this.strides=Hh(r||1,2,"strides"),this.strides.forEach(l=>Un(l,"strides")),this.padding=i||"valid",Kr(this.padding),this.dataFormat=o||"channelsLast",hn(this.dataFormat),this.dilationRate=Hh(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>Un(l,"dilationRate"))}build(e){var n;e=dt(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new K(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],i=4,o=this.kernelSize.concat([r,this.filters*i]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,u=this.filters;l=new(n=class extends bi{apply(d,f){const p=c.apply([u]),g=Jl([u]),m=c.apply([u*2]);return k3([p,g,m])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return re(()=>{if(e.length!==3)throw new K(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training||!1,r=e[0],i=e[1],o=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ol({ones:()=>xi(r),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(ie,de,he)=>!de||!de[he]?ie:Y(de[he],ie);let u=c(r,l,0),h=c(r,l,1),d=c(r,l,2),f=c(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ol({ones:()=>xi(i),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let g=c(i,p,0),m=c(i,p,1),y=c(i,p,2),w=c(i,p,3);const b=3,[C,k,$,I]=Vr(this.kernel.read(),a,b),[T,R,E,A]=this.useBias?Vr(this.bias.read(),a):[null,null,null,null];u=this.inputConv(u,C,T,this.padding),h=this.inputConv(h,k,R,this.padding),d=this.inputConv(d,$,E,this.padding),f=this.inputConv(f,I,A,this.padding);const[F,P,Z,H]=Vr(this.recurrentKernel.read(),a,b);g=this.recurrentConv(g,F),m=this.recurrentConv(m,P),y=this.recurrentConv(y,Z),w=this.recurrentConv(w,H);const j=this.recurrentActivation.apply(ve(u,g)),ee=this.recurrentActivation.apply(ve(h,m)),z=ve(Y(ee,o),Y(j,this.activation.apply(ve(d,y)))),X=Y(this.recurrentActivation.apply(ve(f,w)),this.activation.apply(z));return[X,X,z]})}getConfig(){const e=super.getConfig(),n=ude(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),s)}inputConv(e,n,s,r){const i=du(e,n,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?qi(i,s,this.dataFormat):i}recurrentConv(e,n){return du(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}z3.className="ConvLSTM2DCell";me(z3);class p9 extends f9{constructor(e){const n=new z3(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}p9.className="ConvLSTM2D";me(p9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class W3 extends nt{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?n[r]:this.noiseShape[r]);return s}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=je(e);if(0<this.rate&&this.rate<1){const r=n.training==null?!1:n.training,i=this.getNoiseShape(s);return kg(()=>s6(s,this.rate,i,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}W3.className="Dropout";me(W3);class m9 extends W3{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}m9.className="SpatialDropout1D";me(m9);class g9 extends nt{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,Un(this.units,"units"),this.activation=Pl(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=Kt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Kt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=$n(e.kernelConstraint),this.biasConstraint=$n(e.biasConstraint),this.kernelRegularizer=qt(e.kernelRegularizer),this.biasRegularizer=qt(e.biasRegularizer),this.activityRegularizer=qt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=dt(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=dt(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=je(e),r=YM(this.activation.getClassName());let i;return r!=null?i=To(s,this.kernel.read(),r,this.bias?this.bias.read():null):(i=To(s,this.kernel.read()),this.bias!=null&&(i=qi(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:Dl(this.activation),useBias:this.useBias,kernelInitializer:Jt(this.kernelInitializer),biasInitializer:Jt(this.biasInitializer),kernelRegularizer:At(this.kernelRegularizer),biasRegularizer:At(this.biasRegularizer),activityRegularizer:At(this.activityRegularizer),kernelConstraint:_n(this.kernelConstraint),biasConstraint:_n(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}g9.className="Dense";me(g9);class y9 extends nt{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=dt(e);for(const n of e.slice(1))if(n==null)throw new K(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],kl(e,1)]}call(e,n){return re(()=>{this.invokeCallHook(e,n);let s=je(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let i=2;i<s.rank;++i)r.push(i);r.push(1),s=at(s,r)}return Uue(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}y9.className="Flatten";me(y9);class v9 extends nt{constructor(e){super(e),this.supportsMasking=!0,this.activation=Pl(e.activation)}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=je(e);return this.activation.apply(s)})}getConfig(){const e={activation:Dl(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}v9.className="Activation";me(v9);class x9 extends nt{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return re(()=>(e=je(e),Bue(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}x9.className="RepeatVector";me(x9);class w9 extends nt{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const s="Total size of new array must be unchanged.",r=n.slice();let i=1,o=null;for(let l=0;l<r.length;++l){const c=r[l];if(this.isUnknown(c))if(o===null)o=l;else throw new K("Can only specifiy one unknown dimension.");else i*=c}const a=kl(e);if(o!==null){if(i===0||a%i!==0)throw new K(s);r[o]=a/i}else if(a!==i)throw new K(s);return r}computeOutputShape(e){let n=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=je(e),r=s.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return te(s,i)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}w9.className="Reshape";me(w9);class b9 extends nt{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=ji(1,e.dims.length+1);if(!yt(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Nn({ndim:this.dims.length+1})]}computeOutputShape(e){e=dt(e);const n=e.slice();return this.dims.forEach((s,r)=>{n[r+1]=e[s]}),n}call(e,n){return at(je(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}b9.className="Permute";me(b9);class C9 extends nt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const s=je(e);return WC(k2(s,this.maskValue),-1)}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=je(e),o=WC(k2(s,this.maskValue),-1,!0);return Y(s,Ee(o,s.dtype))})}}C9.className="Masking";me(C9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class S9 extends nt{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Ct(e.inputLength))}this.inputDim=e.inputDim,Un(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Un(this.outputDim,"outputDim"),this.embeddingsInitializer=Kt(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=qt(e.embeddingsRegularizer),this.activityRegularizer=qt(e.activityRegularizer),this.embeddingsConstraint=$n(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return re(()=>this.maskZero?(e=je(e),k2(e,lt(e))):null)}computeOutputShape(e){if(e=dt(e),this.inputLength==null)return[...e,this.outputDim];const n=Ct(this.inputLength);if(n.length!==e.length-1)throw new K(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<n.length;++r){const i=n[r],o=e[r+1];if(i!=null&&o!=null&&i!==o)throw new K(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(n[s]=o),s++}}return[e[0],...n,this.outputDim]}call(e,n){return re(()=>{this.invokeCallHook(e,n);let s=je(e);s.dtype!=="int32"&&(s=ko(s,"int32"));const r=n6(this.embeddings.read(),te(s,[s.size]));return te(r,dt(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Jt(this.embeddingsInitializer),embeddingsRegularizer:At(this.embeddingsRegularizer),activityRegularizer:At(this.activityRegularizer),embeddingsConstraint:_n(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}S9.className="Embedding";me(S9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Du extends nt{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Je}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const s=e.slice(0,e.length-n.length);for(let r=0;r<n.length;++r){const i=e[e.length-n.length+r],o=n[r];if(i==null||o==null||i<0||o<0)s.push(null);else if(i===1)s.push(o);else if(o===1)s.push(i);else{if(i!==o)throw new K("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));s.push(i)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[dt(e)]),e=e,e.length<2)throw new K(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const i of e)i!=null&&i[0]!==null&&n.push(i[0]);if(n=Il(n),n.length>1)throw new K(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const o=e[i]==null?null:e[i].slice(1);s=this.computeElementwiseOpOutputShape(s,o)}const r=e.map(i=>i.length);e.indexOf(null)===-1&&Il(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return re(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(i=>i.rank);if(r.indexOf(null)===-1){const i=Al(r);for(let o of e){const a=o.rank;for(let l=0;l<i-a;++l)o=Sg(o,1);s.push(o)}return this.mergeFunction(s)}else{let i=!1;for(const l of e){const c=l.rank;if(c==null){const u=l.shape,h=u[0],d=u.slice(1).concat([h]);let f=te(l,[h].concat(kl(u.slice(1))));f=at(f,[1,0]),f=te(f,d),s.push(f),i=!0}else if(c>1){const u=ji(1,c).concat([0]);s.push(at(l,u)),i=!0}else s.push(l)}let o=this.mergeFunction(s);const a=o.rank;if(i){if(a==null){const l=o.shape,c=l.length,u=l[c-1],h=[u].concat(l.slice(0,l.length-1));o=te(at(te(o,[-1,u]),[1,0]),h)}else if(a>1){const l=[a-1].concat(ji(0,a-1));o=at(o,l)}}return o}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let r=1;r<e.length;++r){const i=e[r]==null?null:e[r].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=Il(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(e,n){return re(()=>{if(n==null)return null;if(!Array.isArray(n))throw new K("`mask` should be an Array");if(!Array.isArray(e))throw new K("`inputs` should be an Array");if(n.length!==e.length)throw new K(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(r=>r==null))return null;n=n.map(r=>r==null?r:Ks(r,0));let s=n[0];for(let r=1;r<n.length-1;++r)s=ya(s,n[r]);return s})}}class I9 extends Du{constructor(e){super(e)}mergeFunction(e){return re(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ve(n,e[s]);return n})}}I9.className="Add";me(I9);class k9 extends Du{constructor(e){super(e)}mergeFunction(e){return re(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=Y(n,e[s]);return n})}}k9.className="Multiply";me(k9);class T9 extends Du{constructor(e){super(e)}mergeFunction(e){return re(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ve(n,e[s]);return Y(1/e.length,n)})}}T9.className="Average";me(T9);class E9 extends Du{constructor(e){super(e)}mergeFunction(e){return re(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Yl(n,e[s]);return n})}}E9.className="Maximum";me(E9);class N9 extends Du{constructor(e){super(e)}mergeFunction(e){return re(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=jp(n,e[s]);return n})}}N9.className="Minimum";me(N9);class _9 extends Du{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new K("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const r of e)if(r!=null){n=!1;break}if(n)return;const s=[];for(let r=0;r<e.length;++r){const i=e[r].slice();i.splice(this.axis,1);let o=!1;for(const a of s)if(yt(a,i)){o=!0;break}o||s.push(i)}if(s.length>1)throw new K("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return re(()=>k3(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new K("A `Concatenate` layer should be called on a list of inputs.");const n=e,s=n[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const i of n.slice(1)){if(s[r]==null||i[r]==null){s[r]=null;break}s[r]+=i[r]}return s}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new K("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new K("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new K(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return re(()=>{let s=!0;if(n.forEach(o=>{if(o!=null){s=!1;return}}),s)return null;const r=[];for(let o=0;o<e.length;++o)n[o]==null?r.push(Ee(xi(e[o]),"bool")):n[o].rank<e[o].rank?r.push(Ks(n[o],-1)):r.push(n[o]);const i=Js(r,this.axis);return EL(i,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}_9.className="Concatenate";me(_9);function Nf(t,e){for(;t<0;)t+=e;return t}function hde(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Je("batchDot is not implemented for tensors of 4D or higher rank yet");if(L(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),L(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new Je("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,r=e.shape.length;n==null&&(n=[s-1,r-2]);const i=n;return re(()=>{let o;if(s>r){o=s-r;const l=[];for(let c=0;c<o;++c)l.push(1);e=te(e,e.shape.concat(l))}else if(r>s){o=r-s;const l=[];for(let c=0;c<o;++c)l.push(1);t=te(t,t.shape.concat(l))}else o=0;let a;if(t.shape.length===2&&e.shape.length===2)i[0]===i[1]?a=Me(Y(t,e),i[0]):a=Me(Y(at(t,[1,0]),e),i[1]);else{const l=i[0]!==t.shape.length-1,c=i[1]===e.shape.length-1;a=mt(t,e,l,c)}if(o>0){let l;s>r?l=s+r-3:l=s-1;const c=[];for(let u=l;u<l+o;++u)c.push(u);a=yg(a,c)}return a.shape.length===1&&(a=Ks(a,1)),a})}class $9 extends Du{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){L(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],s=e[1];if(n.length>3||s.length>3)throw new Je("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);if(n[r[0]]!==s[r[1]])throw new K(`Dimension incompatibility: ${n[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new K(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((i,o)=>Nf(i,e[o].shape.length)):r=[Nf(this.axes,n.shape.length),Nf(this.axes,s.shape.length)],this.normalize&&(n=A2(n,r[0]),s=A2(s,r[1])),hde(n,s,r)}interpretAxes(e,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[Nf(this.axes,e.length),Nf(this.axes,n.length)],s}computeOutputShape(e){L(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),s=e[1].slice();if(n.length>3||s.length>3)throw new Je("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);n.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const i=n.concat(s);return i.length===1&&i.push(1),i}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}$9.className="Dot";me($9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class R9 extends nt{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=je(e);return kg(()=>ve(qv(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}R9.className="GaussianNoise";me(R9);class A9 extends nt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=je(e);return this.rate>0&&this.rate<1?kg(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return Y(s,qv(s.shape,1,i))},()=>s,n.training||!1):s})}}A9.className="GaussianDropout";me(A9);class D9 extends nt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||je(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return re(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return kg(()=>{const i=je(e),l=-1.6732632423543772*1.0507009873554805;let c=Nu(gg(s),this.rate);c=ko(c,"float32");const u=((1-this.rate)*(1+this.rate*l**2))**-.5,h=-u*l*this.rate,d=ve(Y(i,c),Y(ve(c,-1),l));return ve(Y(d,u),h)},()=>je(e),n.training||!1)}return e})}}D9.className="AlphaDropout";me(D9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Xp(t,e,n,s,r,i=.001){let o;if(t.rank===2)o=Fse(t,e,n,s,r,i);else if(t.rank===3)o=Mse(t,e,n,s,r,i);else if(t.rank===4)o=Vse(t,e,n,s,r,i);else throw new Je(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return o}function dde(t,e,n,s,r=.001){return re(()=>{const i=TT(t,s),o=i.mean,a=i.variance;return[Xp(t,o,a,n,e,r),o,a]})}function fde(t,e,n,s,r=.001){return re(()=>{const i=TT(t,s),o=i.mean,a=i.variance,l=[];for(const p of ji(0,t.rank))s.indexOf(p)!==-1?l.push(1):l.push(t.shape[p]);const c=te(o,l),u=te(a,l),h=e==null?null:te(e,l),d=n==null?null:te(n,l);return[Xp(t,c,u,d,h,r),o,a]})}function pde(t,e,n,s,r=.001){return yt(s.slice().sort(),ji(0,t.rank-1))?dde(t,e,n,s,r):fde(t,e,n,s,r)}class P9 extends nt{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Kt(e.betaInitializer||"zeros"),this.gammaInitializer=Kt(e.gammaInitializer||"ones"),this.movingMeanInitializer=Kt(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Kt(e.movingVarianceInitializer||"ones"),this.betaConstraint=$n(e.betaConstraint),this.gammaConstraint=$n(e.gammaConstraint),this.betaRegularizer=qt(e.betaRegularizer),this.gammaRegularizer=qt(e.gammaRegularizer)}build(e){e=dt(e);const n=this.axis>=0?this.axis:this.axis+e.length,s=e[n];if(s==null)throw new K(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Nn({ndim:e.length,axes:{[n]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return re(()=>{const s=n.training==null?!1:n.training,r=je(e),i=r.shape,o=i.length,a=ji(0,o),l=this.axis>=0?this.axis:this.axis+o;a.splice(l,1);const c=gu(1,o);c[l]=i[l];const u=a.slice();u.sort();const h=!yt(u,ji(0,o).slice(0,o-1)),d=()=>{if(h){const w=te(this.movingMean.read(),c),b=te(this.movingVariance.read(),c),C=this.center?te(this.beta.read(),c):null,k=this.scale?te(this.gamma.read(),c):null;return Xp(r,w,b,C,k,this.epsilon)}else return Xp(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return d();const[f,p,g]=pde(r,this.gamma.read(),this.beta.read(),a,this.epsilon),m=(w,b,C)=>{re(()=>{const k=1-C,$=w.read(),I=Y(ze($,b),k);w.write(ze($,I))})};return(()=>{m(this.movingMean,p,this.momentum),m(this.movingVariance,g,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Jt(this.betaInitializer),gammaInitializer:Jt(this.gammaInitializer),movingMeanInitializer:Jt(this.movingMeanInitializer),movingVarianceInitializer:Jt(this.movingVarianceInitializer),betaRegularizer:At(this.betaRegularizer),gammaRegularizer:At(this.gammaRegularizer),betaConstraint:_n(this.betaConstraint),gammaConstraint:_n(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}P9.className="BatchNormalization";me(P9);class O9 extends nt{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Kt(e.betaInitializer||"zeros"),this.gammaInitializer=Kt(e.gammaInitializer||"ones"),this.betaRegularizer=qt(e.betaRegularizer),this.gammaRegularizer=qt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=dt(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=n);for(const i of this.axis)if(i<0||i>=n)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==Il(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(i=>e[i]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,n){const s=je(e),r=s.shape,i=r.length;return re(()=>{let{mean:a,variance:l}=TT(s,this.axis,!0);const c=gu(1,i);for(const g of this.axis)c[g]=r[g];const u=g=>g!=null&&g.shape.length!==i?te(g,c):g;let h=this.scale?u(this.gamma.read()):null,d=this.center?u(this.beta.read()):null;const f=[],p=[];for(let g=0;g<i;++g)this.axis.indexOf(g)!==-1?(f.push(r[g]),p.push(1)):(f.push(1),p.push(r[g]));return a=Oi(a,f),l=Oi(l,f),h!=null&&(h=Oi(h,p)),d!=null&&(d=Oi(d,p)),Xp(s,a,l,d,h,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Jt(this.betaInitializer),gammaInitializer:Jt(this.gammaInitializer),betaRegularizer:At(this.betaRegularizer),gammaRegularizer:At(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}O9.className="LayerNormalization";me(O9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function mde(t,e,n){return re(()=>{if(t.rank!==4)throw new K(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new K("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Gi()),n!=="channelsLast"&&n!=="channelsFirst")throw new K(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],ET(t,s)})}class F9 extends nt{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Gi():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new K(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,s;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new K(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new K(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[n,s]}this.inputSpec=[new Nn({ndim:4})]}computeOutputShape(e){e=dt(e);let n,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],n,s]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],n,s,e[3]])}call(e,n){return re(()=>mde(je(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}F9.className="ZeroPadding2D";me(F9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nx(t,e,n,s,r,i){return re(()=>{hn(r),ZM(i),Kr(s),n==null&&(n=[1,1]),s==null&&(s="valid"),r==null&&(r=Gi()),i==null&&(i="max"),t=M3(t,r);let o;const a=s==="same"?"same":"valid";return i==="max"?o=kT(t,e,n,a):o=mT(t,e,n,a),r==="channelsFirst"&&(o=at(o,[0,3,1,2])),o})}function L9(t,e,n,s,r,i){return re(()=>{hn(r),ZM(i),Kr(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),r==null&&(r=Gi()),i==null&&(i="max"),t=e9(t,r);let o;const a=s==="same"?"same":"valid";return i==="max"?o=Iie(t,e,n,a):o=Tse(t,e,n,a),r==="channelsFirst"&&(o=at(o,[0,4,1,2,3])),o})}class M9 extends nt{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new K(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Un(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new K(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Un(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Kr(this.padding),this.inputSpec=[new Nn({ndim:3})]}computeOutputShape(e){e=dt(e);const n=Ui(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return re(()=>{this.invokeCallHook(e,n),e=Sg(je(e),2);const s=this.poolingFunction(je(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return yg(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class B9 extends M9{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return hn(i),Kr(r),nx(e,n,s,r,i,"max")}}B9.className="MaxPooling1D";me(B9);class V9 extends M9{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return hn(i),Kr(r),nx(e,n,s,r,i,"avg")}}V9.className="AveragePooling1D";me(V9);class U9 extends nt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new K(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Un(this.poolSize,"poolSize"),Un(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,hn(this.dataFormat),Kr(this.padding),this.inputSpec=[new Nn({ndim:4})]}computeOutputShape(e){e=dt(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=Ui(n,this.poolSize[0],this.padding,this.strides[0]),s=Ui(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s]:[e[0],n,s,e[3]]}call(e,n){return re(()=>(this.invokeCallHook(e,n),this.poolingFunction(je(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class z9 extends U9{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return hn(i),Kr(r),nx(e,n,s,r,i,"max")}}z9.className="MaxPooling2D";me(z9);class W9 extends U9{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return hn(i),Kr(r),nx(e,n,s,r,i,"avg")}}W9.className="AveragePooling2D";me(W9);class j9 extends nt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new K(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Un(this.poolSize,"poolSize"),Un(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,hn(this.dataFormat),Kr(this.padding),this.inputSpec=[new Nn({ndim:5})]}computeOutputShape(e){e=dt(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=Ui(n,this.poolSize[0],this.padding,this.strides[0]),s=Ui(s,this.poolSize[1],this.padding,this.strides[1]),r=Ui(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s,r]:[e[0],n,s,r,e[4]]}call(e,n){return re(()=>(this.invokeCallHook(e,n),this.poolingFunction(je(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class G9 extends j9{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return hn(i),Kr(r),L9(e,n,s,r,i,"max")}}G9.className="MaxPooling3D";me(G9);class H9 extends j9{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return hn(i),Kr(r),L9(e,n,s,r,i,"avg")}}H9.className="AveragePooling3D";me(H9);class K9 extends nt{constructor(e){super(e),this.inputSpec=[new Nn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new Je}}class q9 extends K9{constructor(e){super(e||{})}call(e,n){return re(()=>{const s=je(e);return yn(s,1)})}}q9.className="GlobalAveragePooling1D";me(q9);class X9 extends K9{constructor(e){super(e||{})}call(e,n){return re(()=>{const s=je(e);return Vi(s,1)})}}X9.className="GlobalMaxPooling1D";me(X9);class Y9 extends nt{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,hn(this.dataFormat),this.inputSpec=[new Nn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new Je}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class J9 extends Y9{call(e,n){return re(()=>{const s=je(e);return this.dataFormat==="channelsLast"?yn(s,[1,2]):yn(s,[2,3])})}}J9.className="GlobalAveragePooling2D";me(J9);class Z9 extends Y9{call(e,n){return re(()=>{const s=je(e);return this.dataFormat==="channelsLast"?Vi(s,[1,2]):Vi(s,[2,3])})}}Z9.className="GlobalMaxPooling2D";me(Z9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Q9 extends nt{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,s={}){const r=n.layer,i=Eo(r,s);delete n.layer;const o={layer:i};return Object.assign(o,n),new e(o)}}class e8 extends Q9{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=dt(e),e.length<3)throw new K(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=dt(e);const n=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(n),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,n){return re(()=>(e=je(e),c9((o,a)=>[je(this.layer.call(o,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}e8.className="TimeDistributed";me(e8);function gde(t){Au(Pue,"BidirectionalMergeMode",t)}const yde="concat";class t8 extends Q9{constructor(e){super(e);const n=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=n,this.forwardLayer=Eo(s),n.goBackwards=n.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=n,this.backwardLayer=Eo(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?yde:e.mergeMode,gde(this.mergeMode),e.weights)throw new Je("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,s=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,r,i;return this.returnState&&(i=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(i).concat(i.slice()):[s].concat(i).concat(i.slice()):qs(r)}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const i=l9(e,s,r,this.numConstants);if(e=i.inputs,s=i.initialState,r=i.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,n);const o=[],a=[];if(s!=null){const c=s.length;if(c%2>0)throw new K("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,o.push(...s);const u=s.map(h=>new Nn({shape:h.shape}));this.forwardLayer.stateSpec=u.slice(0,c/2),this.backwardLayer.stateSpec=u.slice(c/2),a.push(...u)}if(r!=null)throw new Je("Support for constants in Bidirectional layers is not implemented yet.");const l=o[0]instanceof Ro;for(const c of o)if(c instanceof Ro!==l)throw new K("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(o),u=this.inputSpec.concat(a),h=this.inputSpec;this.inputSpec=u;const d=super.apply(c,n);return this.inputSpec=h,d}else return super.apply(e,n)}call(e,n){return re(()=>{const s=n.initialState;let r,i;if(s==null)r=this.forwardLayer.call(e,n),i=this.backwardLayer.call(e,n);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(n,{initialState:c}))}let o;this.returnState&&(Array.isArray(r)&&(o=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=pu(i,1));let a;return this.mergeMode==="concat"?a=k3([r,i]):this.mergeMode==="sum"?a=ve(r,i):this.mergeMode==="ave"?a=Y(.5,ve(r,i)):this.mergeMode==="mul"?a=Y(r,i):this.mergeMode==null&&(a=[r,i]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Kc(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Kc(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const i=this.forwardLayer.states.map(o=>null);return Array.isArray(s)?s.concat(i).concat(i):[s].concat(i).concat(i)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const s=Eo(n.layer);if(delete n.layer,n.numConstants!=null)throw new Je("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=n;return r.layer=s,new e(r)}}t8.className="Bidirectional";me(t8);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class n8 extends nt{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return re(()=>(e=je(e),e.dtype!=="float32"&&(e=ko(e,"float32")),ve(Y(e,this.scale),this.offset)))}}n8.className="Rescaling";me(n8);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:vde,cropAndResize:xde}=oa;class s8 extends nt{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,s,r,i,o,a,l){return re(()=>{let c,u=!1;const h=n/o,d=s/a,f=(r+n)/o,p=(i+s)/a,g=[h,d,f,p],m=[];e.rank===3?(u=!0,c=va([e])):c=e;for(let k=0;k<c.shape[0];k++)m.push(g);const y=Gc(m,[m.length,4]),w=Gp(0,m.length,1,"int32"),C=xde(c,y,w,[r,i],"nearest");return ko(u?je(mu(C)):C,l)})}upsize(e,n,s,r){return re(()=>{const i=vde(e,[n,s]);return ko(i,r)})}call(e,n){return re(()=>{const s=je(e),r=s.dtype,i=s.shape,o=i[i.length-3],a=i[i.length-2];let l=0;o!==this.height&&(l=Math.floor((o-this.height)/2));let c=0;return a!==this.width&&(c=Math.floor((a-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(s,l,c,this.height,this.width,o,a,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=dt(e);const n=e.length-3,s=e.length-2;return e[n]=this.height,e[s]=this.width,e}}s8.className="CenterCrop";me(s8);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wde(t,e,n,s){let r=je(t);if(r.dtype!=="int32"&&(r=ko(r,"int32")),e==="int")return r;const i=r.shape;if(r.rank===0&&(r=Ks(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=Ks(r,-1)),r.rank>2)throw new K(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${r.rank}.`);const o=["multiHot","oneHot"].includes(e),a=r;let l;if(typeof s<"u"&&e==="count"?l=f$(a,s,n,o):l=f$(a,[],n,o),e!=="tfIdf")return l;if(s)return Y(l,s);throw new K("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class r8 extends nt{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=dt(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return re(()=>{e=je(e),e.dtype!=="int32"&&(e=ko(e,"int32"));let s;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new K(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);s=je(n.countWeights)}const r=Vi(e),i=S2(e),o=Hr(this.numTokens,r).bufferSync().get(0),a=Nu(i,0).bufferSync().get(0);if(!(o&&a))throw new K(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return wde(e,this.outputMode,this.numTokens,s)})}}r8.className="CategoryEncoding";me(r8);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const bde=["bilinear","nearest"],q$=new Set(bde);class i8 extends nt{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(q$.has(e.interpolation))this.interpolation=e.interpolation;else throw new K(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=dt(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return re(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return oa.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return oa.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...q$]} are supported`)})}}i8.className="Resizing";me(i8);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class o8{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}o8.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class a8 extends nt{constructor(e){super(e),this.randomGenerator=new o8(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}a8.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Cde=["bilinear","nearest"],X$=new Set(Cde);class l8 extends a8{constructor(e){super(e);const{factor:n,interpolation:s="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new K(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new K(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new K(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(X$.has(s))this.interpolation=s;else throw new K(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=dt(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return re(()=>{const s=je(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=gg([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*r;i=Math.round(i);const o=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return oa.resizeBilinear(e,o);case"nearest":return oa.resizeNearestNeighbor(e,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...X$]} are supported`)}})}}l8.className="RandomWidth";me(l8);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sde=oe();Sde.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Y$;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(Y$||(Y$={}));var J$;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(J$||(J$={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Z$;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(Z$||(Z$={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Re(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&L(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ide=nM;class sx extends yk{nextDataId(){return sx.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new S5(this,io())}write(e,n,s){this.firstUse&&(this.firstUse=!1,oe().get("IS_NODE")&&Or(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&vm(s[0])){const i=s.map(o=>Sl(o));r=this.write(i,e,n)}else r=this.write(s,e,n);return{dataId:r,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,s,r,i){this.data.set(e,{values:n,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:s}=this.data.get(e);if(n==="complex64"){const r=this.readSync(s.real.dataId),i=this.readSync(s.imag.dataId);return xa(r,i)}return $te(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>Rl(r));return et(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return et(e.shape,e.dtype,n)}makeOutput(e,n,s){return io().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=Hs();return e(),{kernelMs:Hs()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Re([e],"where");const n=this.readSync(e.dataId);return Ide(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}sx.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c8(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const kde=t=>{const{x:e}=t.inputs,n=t.backend;Re(e,"abs");let s=new Float32Array(ue(e.shape));const r=n.data.get(e.dataId).values;return s=c8(r),n.makeOutput(s,e.shape,e.dtype)},Tde={kernelName:Py,backendName:"cpu",kernelFunc:kde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dn(t){return(e,n,s,r,i)=>{const o=Xe(e,n),a=o.length,l=Pe(o),c=ue(o),u=ds(i,c),h=e.length,d=n.length,f=Pe(e),p=Pe(n),g=fd(e,o),m=fd(n,o);if(g.length+m.length===0)for(let y=0;y<u.length;++y)u[y]=t(s[y%s.length],r[y%r.length]);else for(let y=0;y<u.length;++y){const w=Dd(y,a,l),b=w.slice(-h);g.forEach(I=>b[I]=0);const C=Co(b,h,f),k=w.slice(-d);m.forEach(I=>k[I]=0);const $=Co(k,d,p);u[y]=t(s[C],r[$])}return[u,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hr(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,a=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",i),imag:n.makeTensorInfo(r.shape,"float32",o)},a}const Ede={kernelName:$k,backendName:"cpu",kernelFunc:hr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M2(t,e,n="float32"){if(n==="complex64"){const r=M2(t,e,"float32"),i=M2(t,e,"float32");return hr({inputs:{real:r,imag:i},backend:t})}const s=fs(ue(e),n);return t.makeTensorInfo(e,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ao(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const Nde={kernelName:Bm,backendName:"cpu",kernelFunc:Ao};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yu(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.real,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}const _de={kernelName:eT,backendName:"cpu",kernelFunc:yu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u8(t,e,n,s){if(s==="int32"){const r=Int32Array.from(t);return[e,"int32",r]}if(s==="bool"){const r=Eu([0],n),[i,o]=dn((a,l)=>a!==l?1:0)(e,[],t,r,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function Fl(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return Ao({inputs:{x:r},backend:n});const u=M2(n,r.shape,r.dtype),h=Fl({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),d=hr({inputs:{real:h,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),d}if(r.dtype==="complex64"){const u=yu({inputs:{input:r},backend:n}),h=Fl({inputs:{x:u},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(u),h}if(!T5(r.dtype,i)){const u=Ao({inputs:{x:r},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:i}}const o=n.data.get(r.dataId).values,[a,l,c]=u8(o,r.shape,r.dtype,i);return n.makeTensorInfo(a,l,c)}const $de={kernelName:Tm,backendName:"cpu",kernelFunc:Fl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function An(t,e,n,s){return n==null?({inputs:r,backend:i})=>{const{a:o,b:a}=r,l=i;Re([o,a],t);const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,h=o.dtype==="string"?wa(c):c,d=o.dtype==="string"?wa(u):u,f=s||o.dtype,[p,g]=e(o.shape,a.shape,h,d,f);return l.makeTensorInfo(g,f,p)}:({inputs:r,backend:i})=>{const{a:o,b:a}=r,l=i;if(o.dtype==="complex64"||a.dtype==="complex64"){const c=Fl({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),h=u.complexTensorInfos.real,d=u.complexTensorInfos.imag,f=l.data.get(h.dataId).values,p=l.data.get(d.dataId).values,g=Fl({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),m=l.data.get(g.dataId),y=m.complexTensorInfos.real,w=m.complexTensorInfos.imag,b=l.data.get(y.dataId).values,C=l.data.get(w.dataId).values,[k,$,I]=n(o.shape,a.shape,f,p,b,C),T=l.makeTensorInfo(I,"float32",k),R=l.makeTensorInfo(I,"float32",$),E=hr({inputs:{real:T,imag:R},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(g),l.disposeIntermediateTensorInfo(T),l.disposeIntermediateTensorInfo(R),E}else{const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,h=s||o.dtype,[d,f]=e(o.shape,a.shape,c,u,h);return l.makeTensorInfo(f,h,d)}}}function j3(t){return(e,n,s,r,i,o)=>{const a=Xe(e,n),l=ue(a),c=a.length,u=Pe(a),h=ds("float32",l),d=ds("float32",l),f=fd(e,a),p=fd(n,a),g=xa(s,r),m=xa(i,o),y=e.length,w=Pe(e),b=n.length,C=Pe(n);if(f.length+p.length===0)for(let k=0;k<h.length;k++){const $=k%g.length,I=k%m.length,T=t(g[$*2],g[$*2+1],m[I*2],m[I*2+1]);h[k]=T.real,d[k]=T.imag}else for(let k=0;k<h.length;k++){const $=Dd(k,c,u),I=$.slice(-y);f.forEach(F=>I[F]=0);const T=Co(I,y,w),R=$.slice(-b);p.forEach(F=>R[F]=0);const E=Co(R,b,C),A=t(g[T*2],g[T*2+1],m[E*2],m[E*2+1]);h[k]=A.real,d[k]=A.imag}return[h,d,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h8=dn((t,e)=>t+e),Rde=j3((t,e,n,s)=>({real:t+n,imag:e+s})),gd=An(Pd,h8,Rde),Ade={kernelName:Pd,backendName:"cpu",kernelFunc:gd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G3(t,e,n,s,r){const i=ue(s),o=fs(r,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(i>0?o[l]+=e[a]:o[l]+=1)}return o}function d8(t,e,n,s=!1){const r=t.shape[0],i=t.shape[1],o=et([r,n],e.dtype);for(let a=0;a<r;a++)for(let l=0;l<i;l++){const c=t.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(s?o.set(1,a,c):e.size>0?o.set(o.get(a,c)+e.get(a,l),a,c):o.set(o.get(a,c)+1,a,c))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f8=dn((t,e)=>t&e),Dde=An(_k,f8),Pde={kernelName:_k,backendName:"cpu",kernelFunc:Dde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Po(t){return(e,n,s)=>{const r=an(n,e.length);for(let i=0;i<e.length;++i)r[i]=t(e[i],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function It(t,e,n){const s=Po(e);return ec(t,s,n)}function ec(t,e,n){return({inputs:s,attrs:r,backend:i})=>{const{x:o}=s;Re(o,t);const a=i,l=a.data.get(o.dataId).values;let c;if(o.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=wa(l)}else c=l;const u=n||o.dtype,h=e(c,u,r);return a.makeTensorInfo(o.shape,u,h)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p8=Po(t=>Math.ceil(t)),Ode=ec(Em,p8),Fde={kernelName:Em,backendName:"cpu",kernelFunc:Ode};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m8(t,e,n,s){const r=an(n,ue(e));if(s&&n!=="string"){let i=0;t.forEach(o=>{const a=ue(o.shape);r.set(o.vals,i),i+=a})}else{let i=0;t.forEach(o=>{const a=n==="string"?wa(o.vals):o.vals;let l=0;for(let c=0;c<o.shape[0];++c){const u=c*e[1]+i;for(let h=0;h<o.shape[1];++h)r[u+h]=a[l++]}i+=o.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g8=dn((t,e)=>t===e?1:0),y8=An(Xy,g8,null,"bool"),Lde={kernelName:Xy,backendName:"cpu",kernelFunc:y8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v8=Po(t=>Math.exp(t)),x8=ec(Pm,v8,"float32"),Mde={kernelName:Pm,backendName:"cpu",kernelFunc:x8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w8=Po(t=>Math.expm1(t)),Bde=ec(Om,w8),Vde={kernelName:Om,backendName:"cpu",kernelFunc:Bde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b8=Po(t=>Math.floor(t)),Ude=ec(Fm,b8),zde={kernelName:Fm,backendName:"cpu",kernelFunc:Ude};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C8=dn((t,e)=>Math.floor(t/e)),Wde=An(Lm,C8,null,"int32"),jde={kernelName:Lm,backendName:"cpu",kernelFunc:Wde};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S8(t,e,n,s,r,i,o,a,l){const c=et([s,i],n);for(let u=0;u<s;u++){const h=[];let d=0;for(let f=0;f<r;f++){const p=t[u*r+f];d+=p*o[f],h.push(p)}if(d<0||d>=l/i)throw new Error(`Invalid indices: ${h} does not index into ${a}`);for(let f=0;f<i;f++)c.values[u*i+f]=e.get(...e.indexToLoc(d*i+f))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I8(t,e,n){const s=et(n,t.dtype);for(let r=0;r<s.size;++r){const o=s.indexToLoc(r).slice(),a=o[0],l=o[2],c=e.locToIndex([a,l]);o[2]=e.values[c];const u=t.locToIndex(o);0<=u&&u<t.values.length&&(s.values[r]=t.values[u])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k8=dn((t,e)=>t>e?1:0),Gde=An(Qy,k8,null,"bool"),Hde={kernelName:Qy,backendName:"cpu",kernelFunc:Gde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T8=dn((t,e)=>t>=e?1:0),Kde=An(Mm,T8,null,"bool"),qde={kernelName:Mm,backendName:"cpu",kernelFunc:Kde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E8=dn((t,e)=>t<e?1:0),Xde=An(tv,E8,null,"bool"),Yde={kernelName:tv,backendName:"cpu",kernelFunc:Xde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N8=dn((t,e)=>t<=e?1:0),Jde=An(nv,N8,null,"bool"),Zde={kernelName:nv,backendName:"cpu",kernelFunc:Jde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _8(t,e,n){const s=(e-t)/(n-1),r=fs(n,"float32");r[0]=t;for(let i=1;i<r.length;i++)r[i]=r[i-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $8=Po(t=>Math.log(t)),Qde=ec(Wm,$8),efe={kernelName:Wm,backendName:"cpu",kernelFunc:Qde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R8(t,e,n,s){const r=ds(s,ue(n));for(let i=0;i<r.length;++i){const o=i*e;let a=t[o];for(let l=0;l<e;++l){const c=t[o+l];(Number.isNaN(c)||c>a)&&(a=c)}r[i]=a}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A8=dn((t,e)=>Math.max(t,e)),tfe=An(Gm,A8),nfe={kernelName:Gm,backendName:"cpu",kernelFunc:tfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D8=dn((t,e)=>Math.min(t,e)),sfe=An(Hm,D8),rfe={kernelName:Hm,backendName:"cpu",kernelFunc:sfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H3=dn((t,e)=>t*e),ife=j3((t,e,n,s)=>({real:t*n-e*s,imag:t*s+e*n})),rx=An(qm,H3,ife),ofe={kernelName:qm,backendName:"cpu",kernelFunc:rx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P8(t,e,n){const s=Hl(-1,n);return H3([],e,s,t,n)}function afe(t){const{inputs:e,backend:n}=t,{x:s}=e;Re(s,"neg");const r=n.data.get(s.dataId).values,[i,o]=P8(r,s.shape,s.dtype);return n.makeTensorInfo(o,s.dtype,i)}const lfe={kernelName:fv,backendName:"cpu",kernelFunc:afe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O8=dn((t,e)=>t!==e?1:0),cfe=An(pv,O8,null,"bool"),ufe={kernelName:pv,backendName:"cpu",kernelFunc:cfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K3(t,e,n,s,r){const i=e.length,o=ue(e),a=Pe(e),l=Pe(r),c=ds(n,ue(r));for(let u=0;u<o;++u){const h=Dd(u,i,a),d=new Array(h.length);for(let p=0;p<d.length;p++)d[p]=h[s[p]];const f=Co(d,i,l);c[f]=t[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qs(t){const{inputs:e,attrs:n,backend:s}=t,{x:r}=e,{perm:i}=n;Re(r,"transpose");const o=r.shape.length,a=new Array(o);for(let h=0;h<a.length;h++)a[h]=r.shape[i[h]];const l=s.data.get(r.dataId).values,c=K3(l,r.shape,r.dtype,i,a);return{dataId:s.write(c,a,r.dtype),shape:a,dtype:r.dtype}}const hfe={kernelName:Wh,backendName:"cpu",kernelFunc:Qs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F8(t,e,n,s){const[r,i]=Wn(t,s),o=xr(e,"int32"),a=fs(ue(r),o),l=ue(i);for(let c=0;c<a.length;++c){const u=c*l;let h=1;for(let d=0;d<l;++d)h*=n[u+d];a[c]=h}return{outVals:a,outShape:r,outDtype:o}}function dfe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Re(r,"prod");const a=r.shape.length,l=tt(i,r.shape),c=Zt(l,a);let u=l,h=r;const d=[];c!=null&&(h=Qs({inputs:{x:r},backend:n,attrs:{perm:c}}),d.push(h),u=un(u.length,a));const f=n.data.get(h.dataId).values,{outVals:p,outShape:g,outDtype:m}=F8(h.shape,h.dtype,f,u);let y=g;return o&&(y=vn(g,l)),d.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.makeTensorInfo(y,m,p)}const ffe={kernelName:wv,backendName:"cpu",kernelFunc:dfe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pfe(t,e,n){t.forEach((s,r)=>{if(s<0||s>=n){const i=Dd(r,e.length,Pe(e)).join(",");throw new Error(`indices[${i}] = ${s} is not in [0, ${n})`)}})}function mfe(t,e){for(let n=0;n<t.length;++n){const s=t[n],r=n===t.length-1?e:t[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let i=1;i<s.length;++i)if(s[i-1]>s[i])throw new Error("Ragged splits must be sorted in ascending order")}}function gfe(t,e,n,s){const r=[];let i=0;const o=e.length-1+n.length,a=new Array(o).fill(null).map(()=>[0]);mfe(n,s);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const u=e[c+1];for(let h=1;h<l+1;++h)a[c].push(h*u)}for(let c=0;c<t.length;++c){let u=t[c],h=t[c]+1;for(let d=0;d<n.length;++d){const f=n[d],p=d+e.length-1;if(p>=0){const g=a[p],m=g[g.length-1]-f[u];for(let y=u;y<h;++y)a[p].push(f[y+1]+m)}u=f[u],h=f[h]}h!==u&&(r.push([u,h]),i+=h-u)}return{outSplits:a,valueSlices:r,numValues:i}}function yfe(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n].length,r=an("int32",s);e.push(r),t[n].forEach((i,o)=>r[o]=i)}return e}function Q$(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let s=e;s<t.length;s++)n[e-1]*=t[s];return n}function vfe(t,e,n,s,r,i){const o=Q$(e,2)[1],a=Q$(i,2)[1];let l=0;for(const c of n)for(let u=c[0];u<c[1];++u){for(let h=0;h<s;++h)r[l*a+h]=t[u*o+h];++l}}function xfe(t,e,n,s,r){const i=e.slice();i[0]=r;const o=an(n,ue(i)),a=t.length,l=a===0?0:a/e[0];return vfe(t,e,s,l,o,i),[o,i]}function L8(t,e,n,s,r,i,o,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(pfe(i,o,l),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:u,valueSlices:h,numValues:d}=gfe(i,o,t,c),f=yfe(u),p=xfe(n,s,r,h,d);return[f,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eR=2147483647;function M8(t,e,n,s,r,i,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=r.length===0,c=o.length===0,u=[];a||u.push(e[0]),l||u.push(r[0]),c||u.push(o[0]);for(let m=1;m<u.length;++m)if(u[m]!==u[m-1])throw new Error("starts, limits, and deltas must have the same shape");const h=u.length===0?1:u[0],d=an("int32",h+1);d[0]=0;for(let m=0;m<h;++m){const y=a?t[0]:t[m],w=l?s[0]:s[m],b=c?i[0]:i[m];if(b===0)throw new Error("Requires delta != 0");let C;if(b>0&&w<y||b<0&&w>y)C=0;else if(C=Math.ceil(Math.abs((w-y)/b)),C>eR)throw new Error(`Requires ((limit - start) / delta) <= ${eR}`);d[m+1]=d[m]+C}const f=d[h],p=an(n,f);let g=0;for(let m=0;m<h;++m){const y=d[m+1]-d[m];let w=a?t[0]:t[m];const b=c?i[0]:i[m];for(let C=0;C<y;++C)p[g++]=w,w+=b}return[d,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ni=Pi;class B2{constructor(e,n,s,r,i,o,a,l,c,u){this.shape=e,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=SM(u),this.raggedRank=IM(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===ni.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===ni.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case ni.VALUE_ROWIDS:return B2.getMaxWidthValueRowID(n);case ni.ROW_SPLITS:return B2.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${ni[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const i=e[r+1]-e[r];i>s&&(s=i)}return s}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let s=0,r=e[0],i=0;for(let o=1;o<n;++o){const a=e[o];a!==r&&(r=a,i=Math.max(o-s,i),s=o)}return Math.max(n-s,i)}tensorShapeFromTensor(e,n,s=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return nR(e,s)}calculateOutputSize(e){const n=this.valuesShape,s=this.defaultValueShape;kM(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=CM(this.raggedRank,r,n);o[0]<0&&(o[0]=e);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(e,n,s){const r=Math.min(e,s),i=[];let o=0;for(let a=0;a<r;++a,o+=n)i.push(o);for(let a=r;a<e;++a)i.push(-1);return L(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,n,s,r){const i=e.length,o=[];for(let a=0;a<i-1;++a){const l=e[a+1]-e[a];let c=Math.min(r,l),u=n[a];u===-1&&(c=0);for(let h=0;h<c;++h)o.push(u),u+=s;for(let h=0;h<l-c;++h)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,s,r){const i=e.length,o=[];if(i===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];o.push(c);for(let u=1;u<i;++u){const h=e[u];if(h===l)c>=0&&(++a,a<r?c+=s:c=-1);else{if(a=0,l=h,h>=n.length)throw new Error(`Got nextValueRowId=${h} which is not less than ${n.length}`);c=n[h]}o.push(c)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,s,r){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case ni.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,n,s,r);case ni.ROW_SPLITS:if(i.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(i,n,s,r);default:throw new Error(`Unsupported partition type: ${ni[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case ni.FIRST_DIM_SIZE:return e[0];case ni.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case ni.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${ni[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const i=nR(s,!1),o=an(this.valuesDType,ue(i));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,r[c],s[c]);this.setOutput(this.raggedRank,l,o,i)}return[i,o]}setOutput(e,n,s,r){if(s.length===0)return;const i=this.values,o=s;let a=r.slice();a=a.slice(e+1);const l=ue(a),c=n.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const p=this.defaultValueShape;re(()=>{const g=te(u,p);u=up(g,a).dataSync()})}let h=0,d=0,f=0;for(let p=0;p<=c;++p){let g=p<c?n[p]:-1;if(g===f){++f;continue}if(d<f){const m=i.subarray(h*l),y=o.subarray(d*l),w=(f-d)*l;tR(y,m,w)}if(p>=c){const m=s.length;g=Math.floor(m/l)}if(g>f)if(this.defaultValue.length===1)o.subarray(f*l,g*l).fill(this.defaultValue[0]),f=g;else for(;g>f;){const m=o.slice(f*l);tR(m,u,l),++f}g<0?(h=p+1,d=f):(h=p,d=f,f=d+1)}}}function tR(t,e,n){for(let s=0;s<n;s++)t[s]=e[s]}function nR(t,e){const n=[];for(let s of t){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function B8(t,e,n,s,r,i,o,a,l,c){return new B2(t,e,n,s,r,i,o,a,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V8(t,e,n,s){const r=t===e,i=t<e&&n<0,o=e<t&&n>1;if(r||i||o)return fs(0,s);const a=Math.abs(Math.ceil((e-t)/n)),l=fs(a,s);e<t&&n===1&&(n=-1),l[0]=t;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U8=Po(t=>1/Math.sqrt(t)),wfe=ec(eg,U8),bfe={kernelName:eg,backendName:"cpu",kernelFunc:wfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mc(t,e,n,s,r,i,o,a,l,c){const u=[s/r,r],h=t.values,d=e.values;if(s===0)return et(n,e.dtype);const f=l instanceof Zn?l:et(u,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<i;p++){const g=[];let m=0;for(let y=0;y<o;y++){const w=h[p*o+y];g.push(w),m+=w*a[y]}if(m<0||m>=s/r)throw new Error(`Invalid indices: ${g} does not index into ${n}`);for(let y=0;y<r;y++)c?f.values[m*r+y]+=d[p*r+y]:f.values[m*r+y]=e.rank===0?d[0]:d[p*r+y]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cfe=Po(t=>1/(1+Math.exp(-t))),z8=It(ig,t=>1/(1+Math.exp(-t))),Sfe={kernelName:ig,backendName:"cpu",kernelFunc:z8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W8(t,e,n,s,r){const i=e3(s,e,n),o=ue(n),a=Pe(s);if(i){const h=t3(e,a);return r==="string"?t.slice(h,h+o):t.subarray(h,h+o)}const l=r==="string"?wa(t):t,c=et(s,r,l),u=et(n,r);for(let h=0;h<u.size;++h){const d=u.indexToLoc(h),f=d.map((p,g)=>p+e[g]);u.set(c.get(...f),...d)}return r==="string"?GM(u.values):u.values}function vu(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,size:o}=s;Re(r,"slice");const[a,l]=Wv(r,i,o);ZT(r,a,l);const c=n.data.get(r.dataId).values,u=W8(c,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,u)}const Ife={kernelName:Tv,backendName:"cpu",kernelFunc:vu};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j8(t,e,n,s,r,i,o){const a=e[0],l=i[0],c=new Array(l),u=new Array(a),h=e[1];if(l===0){if(a!==0)throw new Error(AM(a));const m=an(n,0),y=an(r,0);return[m,[0,h],y,c,u]}let d=!0,f=0;const p=new Array(l).fill(0);for(let m=0;m<a;++m){const y=t[m*h];if(y<0)throw new Error(DM(m,y));if(y>=l)throw new Error(PM(m,y,l));++p[y],d=d&&y>=f,f=y}let g=!0;for(let m=0;m<l;++m){const y=p[m]===0;c[m]=y,g=g&&!y,p[m]=Math.max(p[m],1),m>0&&(p[m]+=p[m-1])}if(g&&d){const m=t,y=s;for(let w=0;w<a;++w)u[w]=w;return[m,[a,h],y,c,u]}else{const m=p[l-1],y=an(n,m*h),w=an(r,m),b=new Array(l).fill(0);for(let C=0;C<a;++C){const k=t[C*h],$=b[k],I=(k===0?0:p[k-1])+$;b[k]++;for(let T=0;T<h;++T)y[I*h+T]=t[C*h+T];w[I]=s[C],u[C]=I}for(let C=0;C<l;++C)if(b[C]===0){const $=C===0?0:p[C-1];y[$*h+0]=C;for(let I=1;I<h;++I)y[$*h+I]=0;w[$]=o}return[y,[m,h],w,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G8(t,e,n,s,r){const i=ue(s),o=e[0],a=r.length,l=[];let c=1,u=-1;for(let m=0;m<a;++m){const y=r[m];if(y===-1){if(u!==-1)throw new Error(OM(u,m));u=m,l.push(1)}else{if(y<0)throw new Error(FM(m,y));c*=y,l.push(y)}}if(u!==-1){if(c<=0)throw new Error(LM());const m=Math.trunc(i/c);if(c*m!==i)throw new Error(MM(s,l));l[u]=m}if(ue(l)!==i)throw new Error(BM(s,l));const d=s.length,f=[];if(d>0){f[d-1]=1;for(let m=d-2;m>=0;--m)f[m]=f[m+1]*s[m+1]}const p=[];if(a>0){p[a-1]=1;for(let m=a-2;m>=0;--m)p[m]=p[m+1]*l[m+1]}const g=an(n,o*a);for(let m=0;m<o;++m){let y=0;for(let w=0;w<d;++w)y+=t[m*d+w]*f[w];for(let w=0;w<a;++w)g[m*a+w]=Math.trunc(y/p[w]),y%=p[w]}return[g,[o,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q3(t,e,n,s,r,i=!1,o=0){const a=s.length,l=[e[0],t.length/e[0]],c=l[1],h=a>0?r[a-1]+1:0;if(h<0)throw new Error(qC());const d=e.slice();d[0]=h;const f=d.reduce((b,C)=>b*C,1),p=an(n,f);if(a===0)return h>0&&p.fill(o),[p,d];if(h<=0)throw new Error(qC());let g=0,m=1,y=0,w=r[g];for(;;){let b=0;if(m<a){if(b=r[m],w===b){++m;continue}if(w>=b)throw new Error(VM())}if(w<0||w>=h)throw new Error(UM(w,h));w>y&&p.fill(o,y*c,w*c);for(let C=g;C<m;++C){const k=s[C];if(k<0||k>=l[0])throw new Error(zM(C,s[C],l[0]));for(let $=0;$<c;$++)p[w*c+$]+=t[k*c+$]}if(i)for(let C=0;C<c;C++)p[w*c+C]/=m-g;if(g=m,++m,y=w+1,w=b,m>a)break}return y<h&&p.fill(o,y*c,h*c),[p,d]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kfe=Po(t=>Math.sqrt(t)),Tfe=It(ag,t=>Math.sqrt(t)),Efe={kernelName:ag,backendName:"cpu",kernelFunc:Tfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H8=dn((t,e)=>{const n=t-e;return n*n}),Nfe=An(lg,H8),_fe={kernelName:lg,backendName:"cpu",kernelFunc:Nfe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K8=Po((t,e)=>{const{pattern:n,replaceGlobal:s,rewrite:r}=e;return t.replace(new RegExp(n,s?"g":""),r)}),$fe=ec(rT,K8),Rfe={kernelName:rT,backendName:"cpu",kernelFunc:$fe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q8(t,e,n,s){const r=et(t,e.dtype);for(let i=0;i<r.size;i++){const o=r.indexToLoc(i),a=new Array(o.length);for(let l=0;l<a.length;l++)a[l]=o[l]*n[l]+s[l];r.set(e.get(...a),...o)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Afe{constructor(e,n,s,r,i,o){this.separator=Sl(e),this.nGramWidths=n,this.leftPad=Sl(s),this.rightPad=Sl(r),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const s=this.getPadWidth(n);return Math.max(0,e+2*s-n+1)}createNGrams(e,n,s,r,i,o){for(let a=0;a<i;++a){const l=this.getPadWidth(o),c=Math.max(0,l-a),u=Math.max(0,l-(i-(a+1))),h=o-(c+u),d=n+(c>0?0:a-l);let f=0;f+=c*this.leftPad.length;for(let w=0;w<h;++w)f+=e[d+w].length;f+=u*this.rightPad.length;const p=c+u+h-1;f+=p*this.separator.length,s[r+a]=new Uint8Array(f);const g=s[r+a];let m=0;const y=w=>w.forEach(b=>g[m++]=b);for(let w=0;w<c;++w)y(this.leftPad),y(this.separator);for(let w=0;w<h-1;++w)y(e[d+w]),y(this.separator);if(h>0){y(e[d+h-1]);for(let w=0;w<u;++w)y(this.separator),y(this.rightPad)}else{for(let w=0;w<u-1;++w)y(this.rightPad),y(this.separator);y(this.rightPad)}}}compute(e,n){const s=e.length,r=n.length;if(r>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<r;++c){let u=n[c]>=l;if(u=u&&n[c]<=s,!u)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${s}]`);l=n[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const i=r-1,o=an("int32",r);if(s===0||r===0){const l=new Array(s);for(let c=0;c<=i;++c)o[c]=0;return[l,o]}o[0]=0;for(let l=1;l<=i;++l){const c=n[l]-n[l-1];let u=0;this.nGramWidths.forEach(h=>{u+=this.getNumNGrams(c,h)}),this.preserveShort&&c>0&&u===0&&(u=1),o[l]=o[l-1]+u}const a=new Array(o[i]);for(let l=0;l<i;++l){const c=n[l];let u=o[l];if(this.nGramWidths.forEach(h=>{const d=n[l+1]-n[l],f=this.getNumNGrams(d,h);this.createNGrams(e,c,a,u,f,h),u+=f}),this.preserveShort&&u===o[l]){const h=n[l+1]-n[l];if(h===0)continue;const d=h+2*this.padWidth;this.createNGrams(e,c,a,u,1,d)}}return[a,o]}}function X8(t,e,n,s,r,i,o,a){return new Afe(n,s,r,i,o,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dfe(t,e,n,s){if(!t.length)return;if(e.length===0){for(let i=0;i<t.length;++i)s.push(t.subarray(i,i+1));return}if(e.length===1){const i=e[0];let o=t.indexOf(i);for(;o!==-1;){const a=t.subarray(0,o);(!n||a.length!==0)&&s.push(a),t=t.subarray(o+1),o=t.indexOf(i)}(!n||t.length!==0)&&s.push(t);return}let r=0;for(let i=0;i<t.length+1;i++)if(i===t.length||e.indexOf(t[i])!==-1){const o=t.subarray(r,i);(!n||o.length!==0)&&s.push(o),r=i+1}}function Y8(t,e,n){const s=t.length,r=[];let i=0,o=0;const a=new Array(s);for(let d=0;d<s;++d){const f=r.length;Dfe(t[d],e,n,r);const p=r.length-f;a[d]=p,i+=p,o=Math.max(o,p)}const l=an("int32",i*2),c=new Array(i),u=[s,o];let h=0;for(let d=0;d<s;++d)for(let f=0;f<a[d];++f)l[h*2]=d,l[h*2+1]=f,c[h]=r[h],++h;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J8(t,e){const n=an("int32",t.length);for(let s=0;s<t.length;++s)n[s]=Xte(t[s]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z8=dn((t,e)=>t-e),Pfe=j3((t,e,n,s)=>({real:t-n,imag:e-s})),X3=An(cg,Z8,Pfe),Ofe={kernelName:cg,backendName:"cpu",kernelFunc:X3};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q8(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const s=et(n,t.dtype);for(let r=0;r<s.values.length;++r){const i=s.indexToLoc(r),o=new Array(t.rank);for(let l=0;l<o.length;l++)o[l]=i[l]%t.shape[l];const a=t.locToIndex(o);s.values[r]=t.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jf=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function e7(t,e,n=0,s=t.length-1){for(;s>n;){if(s-n>600){const a=s-n+1,l=e-n+1,c=Math.log(a),u=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),d=Math.max(n,Math.floor(e-l*u/a+h)),f=Math.min(s,Math.floor(e+(a-l)*u/a+h));e7(t,e,d,f)}const r=t[e];let i=n,o=s;for(ch(t,n,e),jf(t[s],r)>0&&ch(t,n,s);i<o;){for(ch(t,i,o),i++,o--;jf(t[i],r)<0;)i=i+1;for(;jf(t[o],r)>0;)o=o-1}jf(t[n],r)===0?ch(t,n,o):(o=o+1,ch(t,o,s)),o<=e&&(n=o+1),e<=o&&(s=o-1)}}function t7(t,e,n,s,r){const i=e[e.length-1],[o,a]=[t.length/i,i],l=ds(n,o*s),c=ds("int32",o*s);for(let h=0;h<o;h++){const d=h*a,f=t.subarray(d,d+a);let p=new Array(f.length);f.forEach((w,b)=>p[b]={value:w,index:b}),s<p.length&&(e7(p,s),p=p.slice(0,s)),r&&p.sort(jf);const g=h*s,m=l.subarray(g,g+s),y=c.subarray(g,g+s);for(let w=0;w<s;w++)m[w]=p[w].value,y[w]=p[w].index}const u=e.slice();return u[u.length-1]=s,[et(u,n,l),et(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n7(t,e,n,s){const r=tt(e,n)[0],i=[1,n[0],1];for(let p=0;p<r;p++)i[0]*=n[p];i[1]=n[r];for(let p=r+1;p<n.length;p++)i[2]*=n[p];const o=new Map,a=new Int32Array(n[r]),l=new Zn(i,s,t),c=[],u=i[0]===1&&i[2]===1;for(let p=0;p<n[r];p++){let g;if(u)g=t[p].toString();else{const y=[];for(let w=0;w<i[0];w++)for(let b=0;b<i[2];b++)y.push(l.get(w,p,b));g=y.join(",")}const m=o.get(g);if(m!=null)a[p]=m;else{const y=o.size;o.set(g,y),a[p]=y,c.push(p)}}const h=i.slice();h[1]=o.size;const d=new Zn(h,s);c.forEach((p,g)=>{for(let m=0;m<i[0];m++)for(let y=0;y<i[2];y++)d.set(l.get(m,p,y),m,g,y)});const f=n.slice();return f[r]=h[1],{outputValues:d.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ffe=Object.freeze(Object.defineProperty({__proto__:null,addImpl:h8,bincountImpl:G3,bincountReduceImpl:d8,bitwiseAndImpl:f8,castImpl:u8,ceilImpl:p8,concatImpl:m8,equalImpl:g8,expImpl:v8,expm1Impl:w8,floorDivImpl:C8,floorImpl:b8,gatherNdImpl:S8,gatherV2Impl:I8,greaterEqualImpl:T8,greaterImpl:k8,lessEqualImpl:N8,lessImpl:E8,linSpaceImpl:_8,logImpl:$8,maxImpl:R8,maximumImpl:A8,minimumImpl:D8,multiplyImpl:H3,negImpl:P8,notEqualImpl:O8,prodImpl:F8,raggedGatherImpl:L8,raggedRangeImpl:M8,raggedTensorToTensorImpl:B8,rangeImpl:V8,rsqrtImpl:U8,scatterImpl:Mc,sigmoidImpl:Cfe,simpleAbsImpl:c8,sliceImpl:W8,sparseFillEmptyRowsImpl:j8,sparseReshapeImpl:G8,sparseSegmentReductionImpl:q3,sqrtImpl:kfe,squaredDifferenceImpl:H8,staticRegexReplaceImpl:K8,stridedSliceImpl:q8,stringNGramsImpl:X8,stringSplitImpl:Y8,stringToHashBucketFastImpl:J8,subImpl:Z8,tileImpl:Q8,topKImpl:t7,transposeImpl:K3,uniqueImpl:n7},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */xL("cpu",()=>new sx,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s7=It(Am,t=>t>=0?t:Math.exp(t)-1),Lfe={kernelName:Am,backendName:"cpu",kernelFunc:s7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r7(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:i}=s;Re([r],"leakyRelu");const o=ue(r.shape),a=n.data.get(r.dataId).values,l=ds("float32",o);for(let c=0;c<a.length;c++)l[c]=a[c]<0?i*a[c]:a[c];return n.makeTensorInfo(r.shape,"float32",l)}const Mfe={kernelName:ev,backendName:"cpu",kernelFunc:r7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bfe=dn((t,e)=>t<0?e*t:t);function i7(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e;Re([s,r],"prelu");const i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,[a,l]=Bfe(s.shape,r.shape,i,o,"float32");return n.makeTensorInfo(l,"float32",a)}const Vfe={kernelName:xv,backendName:"cpu",kernelFunc:i7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o7=It(Jm,t=>Math.max(0,t)),Ufe={kernelName:Jm,backendName:"cpu",kernelFunc:o7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a7=It(Zm,t=>Math.min(Math.max(0,t),6)),zfe={kernelName:Zm,backendName:"cpu",kernelFunc:a7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V2(t,e,n,s,r){if(n==="linear")return Ao({inputs:{x:e},backend:t});if(n==="relu")return o7({inputs:{x:e},backend:t});if(n==="elu")return s7({inputs:{x:e},backend:t});if(n==="relu6")return a7({inputs:{x:e},backend:t});if(n==="prelu")return i7({inputs:{x:e,alpha:s},backend:t});if(n==="leakyrelu")return r7({inputs:{x:e},backend:t,attrs:{alpha:r}});if(n==="sigmoid")return z8({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ot(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:i}=s,o=ue(r.shape),a=k5(i,o),l=ue(a);L(o===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const c=n.data.get(r.dataId);if(c.complexTensorInfos!=null){const u=c.complexTensorInfos.real,h=c.complexTensorInfos.imag;u.shape=a,h.shape=a}return{dataId:r.dataId,shape:a,dtype:r.dtype}}const Wfe={kernelName:bv,backendName:"cpu",kernelFunc:Ot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l7(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i}=e,{transposeA:o,transposeB:a}=s;Re([r,i],"matMul");const l=r.shape.length,c=i.shape.length,u=o?r.shape[l-2]:r.shape[l-1],h=a?i.shape[c-1]:i.shape[c-2],d=o?r.shape[l-1]:r.shape[l-2],f=a?i.shape[c-2]:i.shape[c-1],p=r.shape.slice(0,-2),g=i.shape.slice(0,-2),m=ue(p),y=ue(g),b=Xe(r.shape.slice(0,-2),i.shape.slice(0,-2)).concat([d,f]);L(u===h,()=>`Error in matMul: inner shapes (${u}) and (${h}) of Tensors with shapes ${r.shape} and ${i.shape} and transposeA=${o} and transposeB=${a} must match.`);const C=o?[m,u,d]:[m,d,u],k=a?[y,f,h]:[y,h,f],$=Ot({inputs:{x:r},backend:n,attrs:{shape:C}}),I=Ot({inputs:{x:i},backend:n,attrs:{shape:k}}),T=o?$.shape[1]:$.shape[2],R=o?$.shape[2]:$.shape[1],E=a?I.shape[1]:I.shape[2],A=Math.max(m,y),F=n.data.get($.dataId).values,P=n.data.get(I.dataId).values,Z=Pe($.shape),H=Pe(I.shape),[j,ee,z]=o?[Z[0],1,Z[1]]:[Z[0],Z[1],1],[X,ie,de]=a?[1,H[1],H[0]]:[H[1],1,H[0]],he=R*E,fe=et([A,R,E],$.dtype),ge=fe.values,pe=n.blockSize;for(let we=0;we<A;we++){const ke=we%m,De=we%y;for(let _e=0;_e<R;_e+=pe){const Be=Math.min(_e+pe,R);for(let Oe=0;Oe<E;Oe+=pe){const qe=Math.min(Oe+pe,E);for(let Ue=0;Ue<T;Ue+=pe){const Ye=Math.min(Ue+pe,T);for(let ut=_e;ut<Be;ut++)for(let it=Oe;it<qe;it++){let $t=0;for(let vt=Ue;vt<Ye;vt++){const Bs=F[ke*j+ut*ee+vt*z],Ut=P[vt*X+it*ie+De*de];$t+=Bs*Ut}ge[we*he+(ut*E+it)]+=$t}}}}}return n.disposeIntermediateTensorInfo($),n.disposeIntermediateTensorInfo(I),n.makeTensorInfo(b,fe.dtype,fe.values)}const jfe={kernelName:By,backendName:"cpu",kernelFunc:l7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gfe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=s;let d,f,p;const g=[];d=l7({inputs:{a:r,b:i},attrs:{transposeA:l,transposeB:c},backend:n}),o&&(f=gd({inputs:{a:d,b:o},backend:n}),g.push(d),d=f),u&&(p=V2(n,d,u,a,h),g.push(d),d=p);for(const y of g)n.disposeIntermediateTensorInfo(y);return d}const Hfe={kernelName:y2,backendName:"cpu",kernelFunc:Gfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kfe=It(xm,t=>Math.acos(t)),qfe={kernelName:xm,backendName:"cpu",kernelFunc:Kfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xfe=It(wm,t=>Math.acosh(t)),Yfe={kernelName:wm,backendName:"cpu",kernelFunc:Xfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jfe(t){const{inputs:e,backend:n}=t,s=e;Re(e,"addN");const r=s.map(a=>n.data.get(a.dataId).values),i=et(s[0].shape,s[0].dtype),o=i.values;for(let a=0;a<s.length;a++){const l=r[a];for(let c=0;c<o.length;c++)o[c]+=l[c]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}const Zfe={kernelName:Sk,backendName:"cpu",kernelFunc:Jfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qfe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Re(r,"all");const a=tt(i,r.shape);let l=a;const c=Zt(l,r.shape.length);let u=r;c!=null&&(u=Qs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=un(l.length,r.shape.length)),es("all",l,u.shape.length);const[h,d]=Wn(u.shape,l),f=ue(d),p=fs(ue(h),u.dtype),g=n.data.get(u.dataId).values;for(let y=0;y<p.length;++y){const w=y*f;let b=g[w];for(let C=0;C<f;++C){const k=g[w+C];b=b&&k}p[y]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const m=n.makeTensorInfo(h,u.dtype,p);if(o){const y=vn(h,a),w=Ot({inputs:{x:m},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(m),w}return m}const epe={kernelName:Ik,backendName:"cpu",kernelFunc:Qfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tpe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Re(r,"any");const a=tt(i,r.shape);let l=a;const c=Zt(l,r.shape.length);let u=r;c!=null&&(u=Qs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=un(l.length,r.shape.length)),es("any",l,u.shape.length);const[h,d]=Wn(u.shape,l),f=ue(d),p=fs(ue(h),u.dtype),g=n.data.get(u.dataId).values;for(let y=0;y<p.length;++y){const w=y*f;let b=g[w];for(let C=0;C<f;++C){const k=g[w+C];b=b||k}p[y]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const m=n.makeTensorInfo(h,u.dtype,p);if(o){const y=vn(h,a),w=Ot({inputs:{x:m},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(m),w}return m}const npe={kernelName:kk,backendName:"cpu",kernelFunc:tpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function spe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;Re(r,"argMax");let o=tt(i,r.shape);const a=Zt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=Qs({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=un(o.length,l.shape.length)),o=[o[0]],es("argMax",o,l.shape.length);const[u,h]=Wn(l.shape,o),d=ue(u),f=fs(d,"int32"),p=ue(h),g=n.data.get(l.dataId).values;for(let m=0;m<f.length;++m){const y=m*p;let w=g[y],b=0;for(let C=0;C<p;++C){const k=g[y+C];k>w&&(w=k,b=C)}f[m]=b}return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),n.makeTensorInfo(u,"int32",f)}const rpe={kernelName:Oy,backendName:"cpu",kernelFunc:spe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ipe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;Re(r,"argMin");let o=tt(i,r.shape);const a=Zt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=Qs({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=un(o.length,l.shape.length)),o=[o[0]],es("argMin",o,l.shape.length);const[u,h]=Wn(l.shape,o),d=ue(u),f=fs(d,"int32"),p=ue(h),g=n.data.get(l.dataId).values;for(let m=0;m<f.length;++m){const y=m*p;let w=g[y],b=0;for(let C=0;C<p;++C){const k=g[y+C];k<w&&(w=k,b=C)}f[m]=b}return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),n.makeTensorInfo(u,"int32",f)}const ope={kernelName:Fy,backendName:"cpu",kernelFunc:ipe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ape=It(bm,t=>Math.asin(t)),lpe={kernelName:bm,backendName:"cpu",kernelFunc:ape};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cpe=It(Cm,t=>Math.asinh(t)),upe={kernelName:Cm,backendName:"cpu",kernelFunc:cpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hpe=It(Sm,t=>Math.atan(t)),dpe={kernelName:Sm,backendName:"cpu",kernelFunc:hpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fpe=dn((t,e)=>Math.atan2(t,e)),ppe=An(km,fpe),mpe={kernelName:km,backendName:"cpu",kernelFunc:ppe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gpe=It(Im,t=>Math.atanh(t)),ype={kernelName:Im,backendName:"cpu",kernelFunc:gpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y3(t,e,n,s,r,i){const o=r.strideHeight,a=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,u=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,p=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=et(r.outShape,n),m=g.values,y=r.outShape[1]*r.outShape[2]*r.outShape[3],w=r.outShape[2]*r.outShape[3],b=r.outShape[3];for(let C=0;C<r.batchSize;++C){const k=C*y,$=C*s[0];for(let I=0;I<r.inChannels;++I)for(let T=0;T<r.outHeight;++T){const R=T*o-d,E=Math.max(0,R),A=Math.min(r.inHeight,u+R),F=k+T*w;for(let P=0;P<r.outWidth;++P){const Z=P*a-f,H=Math.max(0,Z),j=Math.min(r.inWidth,h+Z);let ee=p,z=0,X=0;for(let de=E;de<A;de+=l){const he=$+de*s[1];for(let fe=H;fe<j;fe+=c){const ge=he+fe*s[2],pe=t[ge+I];i==="max"&&pe>ee?ee=pe:i==="avg"&&(z+=pe,X++)}if(isNaN(ee))break}const ie=F+P*b+I;m[ie]=i==="avg"?z/X:ee}}}return g}function c7(t,e,n,s,r=!1,i=!1){const o=et(s.outShape,"int32"),a=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,u=s.dilationWidth,h=s.effectiveFilterHeight,d=s.effectiveFilterWidth,f=s.padInfo.top,p=s.padInfo.left,g=et(e,n,t);for(let m=0;m<s.batchSize;++m)for(let y=0;y<s.inChannels;++y)for(let w=0;w<s.outHeight;++w){const b=w*a-f;let C=b;for(;C<0;)C+=c;const k=Math.min(s.inHeight,h+b);for(let $=0;$<s.outWidth;++$){const I=$*l-p;let T=I;for(;T<0;)T+=u;const R=Math.min(s.inWidth,d+I);let E=Number.NEGATIVE_INFINITY,A=-1;for(let F=C;F<k;F+=c){const P=F-b;for(let Z=T;Z<R;Z+=u){const H=Z-I,j=g.get(m,F,Z,y);j>E&&(E=j,r?A=i?((m*s.inHeight+F)*s.inWidth+Z)*s.inChannels+y:(F*s.inWidth+Z)*s.inChannels+y:A=P*d+H)}}o.set(A,m,w,$,y)}}return o}function u7(t,e,n,s,r,i){const o=r.strideDepth,a=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,u=r.dilationHeight,h=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,p=r.effectiveFilterWidth,g=r.padInfo.front,m=r.padInfo.top,y=r.padInfo.left,w=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=et(r.outShape,n),C=b.values,k=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],$=r.outShape[2]*r.outShape[3]*r.outShape[4],I=r.outShape[3]*r.outShape[4],T=r.outShape[4];for(let R=0;R<r.batchSize;++R){const E=R*k,A=R*s[0];for(let F=0;F<r.inChannels;++F)for(let P=0;P<r.outDepth;++P){const Z=P*o-g;let H=Z;for(;H<0;)H+=c;const j=Math.min(r.inDepth,d+Z),ee=E+P*$;for(let z=0;z<r.outHeight;++z){const X=z*a-m;let ie=X;for(;ie<0;)ie+=u;const de=Math.min(r.inHeight,f+X),he=ee+z*I;for(let fe=0;fe<r.outWidth;++fe){const ge=fe*l-y;let pe=ge;for(;pe<0;)pe+=h;const we=Math.min(r.inWidth,p+ge),ke=he+fe*T;let De=w,_e=0,Be=0;for(let qe=H;qe<j;qe+=c){const Ue=A+qe*s[1];for(let Ye=ie;Ye<de;Ye+=u){const ut=Ue+Ye*s[2];for(let it=pe;it<we;it+=h){const $t=ut+it*s[3],vt=t[$t+F];if(i==="max"&&vt>De?De=vt:i==="avg"&&(_e+=vt,Be++),isNaN(De))break}if(isNaN(De))break}if(isNaN(De))break}const Oe=ke+F;C[Oe]=i==="avg"?_e/Math.max(Be,1):De}}}}return b}function vpe(t,e){const n=et(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left;for(let g=0;g<e.batchSize;++g)for(let m=0;m<e.inChannels;++m)for(let y=0;y<e.outDepth;++y){const w=y*s-d;let b=w;for(;b<0;)b+=o;const C=Math.min(e.inDepth,c+w);for(let k=0;k<e.outHeight;++k){const $=k*r-f;let I=$;for(;I<0;)I+=a;const T=Math.min(e.inHeight,u+$);for(let R=0;R<e.outWidth;++R){const E=R*i-p;let A=E;for(;A<0;)A+=l;const F=Math.min(e.inWidth,h+E);let P=Number.NEGATIVE_INFINITY,Z=-1;for(let H=b;H<C;H+=o){const j=H-w;for(let ee=I;ee<T;ee+=a){const z=ee-$;for(let X=A;X<F;X+=l){const ie=X-E,de=t.get(g,H,ee,X,m);de>=P&&(P=de,Z=j*u*h+z*u+ie)}}}n.set(Z,g,y,k,R,m)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xpe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Re(r,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;L(ms(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=wi(r.shape,i,o,c,a,l);let h;if(u.filterWidth===1&&u.filterHeight===1&&yt(u.inShape,u.outShape))h=Ao({inputs:{x:r},backend:n});else{const d=n.data.get(r.dataId).values,f=Pe(r.shape),p=Y3(d,r.shape,r.dtype,f,u,"avg");h=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return h}const wpe={kernelName:Ly,backendName:"cpu",kernelFunc:xpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bpe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;Re(r,"avgPool3d");const u=ka(r.shape,i,o,1,a,l,c),h=n.data.get(r.dataId).values,d=u7(h,r.shape,r.dtype,Pe(r.shape),u,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}const Cpe={kernelName:My,backendName:"cpu",kernelFunc:bpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Spe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;Re([r,i],"avgPool3DGrad");const u=ka(i.shape,o,a,1,l,c),h=u.strideDepth,d=u.strideHeight,f=u.strideWidth,p=u.filterDepth,g=u.filterHeight,m=u.filterWidth,y=u.dilationDepth,w=u.dilationHeight,b=u.dilationWidth,C=u.effectiveFilterDepth,k=u.effectiveFilterHeight,$=u.effectiveFilterWidth,I=C-1-u.padInfo.front,T=$-1-u.padInfo.left,R=k-1-u.padInfo.top,E=et(i.shape,"float32"),A=1/(p*g*m),F=n.bufferSync(r);for(let P=0;P<u.batchSize;++P)for(let Z=0;Z<u.inChannels;++Z)for(let H=0;H<u.inDepth;++H)for(let j=0;j<u.inHeight;++j)for(let ee=0;ee<u.inWidth;++ee){const z=H-I,X=j-R,ie=ee-T;let de=0;for(let he=0;he<C;he+=y){const fe=(z+he)/h;if(!(fe<0||fe>=u.outDepth||Math.floor(fe)!==fe))for(let ge=0;ge<k;ge+=w){const pe=(X+ge)/d;if(!(pe<0||pe>=u.outHeight||Math.floor(pe)!==pe))for(let we=0;we<$;we+=b){const ke=(ie+we)/f;if(ke<0||ke>=u.outWidth||Math.floor(ke)!==ke)continue;const De=F.get(P,fe,pe,ke,Z);de+=De}}}E.set(de*A,P,H,j,ee,Z)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const Ipe={kernelName:Ek,backendName:"cpu",kernelFunc:Spe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kpe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i;Re([r,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=wi(o.shape,a,l,1,c),h=u.strideHeight,d=u.strideWidth,f=u.filterHeight,p=u.filterWidth,g=u.dilationHeight,m=u.dilationWidth,y=u.effectiveFilterHeight,w=u.effectiveFilterWidth,b=w-1-u.padInfo.left,C=y-1-u.padInfo.top,k=et(o.shape,"float32"),$=1/(f*p),I=n.data.get(r.dataId).values,T=et(r.shape,"float32",I);for(let R=0;R<u.batchSize;++R)for(let E=0;E<u.inChannels;++E)for(let A=0;A<u.inHeight;++A)for(let F=0;F<u.inWidth;++F){const P=A-C,Z=F-b;let H=0;for(let j=0;j<y;j+=g){const ee=(P+j)/h;if(!(ee<0||ee>=u.outHeight||Math.floor(ee)!==ee))for(let z=0;z<w;z+=m){const X=(Z+z)/d;if(X<0||X>=u.outWidth||Math.floor(X)!==X)continue;const ie=T.get(R,ee,X,E);H+=ie}}k.set(H*$,R,A,F,E)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const Tpe={kernelName:Tk,backendName:"cpu",kernelFunc:kpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Epe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,scale:i,offset:o,mean:a,variance:l}=e;L(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),L(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),L(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Re([r,a,l,i,o],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const u=n.data.get(r.dataId).values,h=n.data.get(a.dataId).values,d=n.data.get(l.dataId).values,f=i?n.data.get(i.dataId).values:new Float32Array([1]),p=o?n.data.get(o.dataId).values:new Float32Array([0]),g=new Float32Array(u.length),m=p.length,y=f.length,w=d.length,b=h.length;let C=0,k=0,$=0,I=0;for(let T=0;T<u.length;++T)g[T]=p[C++]+(u[T]-h[k++])*f[$++]/Math.sqrt(d[I++]+c),C>=m&&(C=0),k>=b&&(k=0),$>=y&&($=0),I>=w&&(I=0);return n.makeTensorInfo(r.shape,r.dtype,g)}const Npe={kernelName:Jy,backendName:"cpu",kernelFunc:Epe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _pe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,crops:o}=s;Re([r],"batchToSpaceND");const a=i.reduce((y,w)=>y*w),l=xg(r.shape,i,a),c=wg(l.length,i.length),u=bg(r.shape,i,a),h=o3(o,i.length),d=a3(u,o,i.length),f=Ot({inputs:{x:r},backend:n,attrs:{shape:l}}),p=Qs({inputs:{x:f},backend:n,attrs:{perm:c}}),g=Ot({inputs:{x:p},backend:n,attrs:{shape:u}}),m=vu({inputs:{x:g},backend:n,attrs:{begin:h,size:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),m}const $pe={kernelName:Vy,backendName:"cpu",kernelFunc:_pe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rpe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o}=s,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=G3(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const Ape={kernelName:Nk,backendName:"cpu",kernelFunc:Rpe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dpe(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,a=Xe(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Ppe={kernelName:R5,backendName:"cpu",kernelFunc:Dpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ope=It(Nm,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),Fpe={kernelName:Nm,backendName:"cpu",kernelFunc:Ope};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lpe=t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(ue(e.shape)),r=n.data.get(e.dataId),i=r.complexTensorInfos.real,o=r.complexTensorInfos.imag,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values;for(let c=0;c<a.length;c++){const u=a[c],h=l[c];s[c]=Math.hypot(u,h)}return n.makeOutput(s,e.shape,"float32")},Mpe={kernelName:Uy,backendName:"cpu",kernelFunc:Lpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yd(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.imag,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}const Bpe={kernelName:Hk,backendName:"cpu",kernelFunc:yd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vd(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,i=tt(r,e[0].shape)[0],o=e.map(g=>g.shape);s3(o,i);let a=Io(e.map(g=>g.shape),i);if(ue(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(g=>ue(g.shape)>0);if(l.length===1)return Ao({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const g=l.map(C=>yu({inputs:{input:C},backend:n})),m=l.map(C=>yd({inputs:{input:C},backend:n})),y=vd({inputs:g,backend:n,attrs:{axis:i}}),w=vd({inputs:m,backend:n,attrs:{axis:i}}),b=hr({inputs:{real:y,imag:w},backend:n});return g.forEach(C=>n.disposeIntermediateTensorInfo(C)),m.forEach(C=>n.disposeIntermediateTensorInfo(C)),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(w),b}const c=l.map(g=>{const y=[-1,ue(g.shape.slice(i))];return Ot({inputs:{x:g},backend:n,attrs:{shape:y}})}),u=c.map(g=>({vals:n.data.get(g.dataId).values,shape:g.shape}));a=Io(c.map(g=>g.shape),1);const h=c[0].shape[0]===1,d=m8(u,a,e[0].dtype,h),f=Io(l.map(g=>g.shape),i),p=n.makeTensorInfo(f,e[0].dtype,d);return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const Vpe={kernelName:zy,backendName:"cpu",kernelFunc:vd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h7(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s;Re([r,i],"conv2d");const h=Ta(l),d=Qn(r.shape,i.shape,o,c,a,u,!1,h),f=d.filterHeight,p=d.filterWidth,g=d.dilationHeight,m=d.dilationWidth,y=d.padInfo.left,w=d.padInfo.top,b=d.dataFormat==="channelsLast",C=new Zn(d.outShape,r.dtype),k=Pe(r.shape),$=Pe(i.shape),I=k[0],T=b?k[1]:k[2],R=b?k[2]:1,E=b?1:k[1],A=C.strides[0],F=b?C.strides[1]:C.strides[2],P=b?C.strides[2]:1,Z=b?1:C.strides[1],H=n.data.get(r.dataId).values,j=n.data.get(i.dataId).values,ee=C.values;for(let z=0;z<d.batchSize;++z){const X=z*I,ie=z*A;for(let de=0;de<d.outHeight;++de){const he=ie+de*F,fe=de*d.strideHeight-w;for(let ge=0;ge<f;++ge){const pe=fe+ge*g;if(pe<0||pe>=d.inHeight)continue;const we=ge*$[0],ke=X+pe*T;for(let De=0;De<d.outWidth;++De){const _e=he+De*P,Be=De*d.strideWidth-y;for(let Oe=0;Oe<p;++Oe){const qe=Be+Oe*m;if(qe<0||qe>=d.inWidth)continue;const Ue=we+Oe*$[1],Ye=ke+qe*R;let ut=Ue;for(let it=0;it<d.inChannels;++it){const $t=H[Ye+it*E];for(let vt=0;vt<d.outChannels;++vt)ee[_e+vt*Z]+=$t*j[ut+vt];ut+=d.outChannels}}}}}}return n.makeTensorInfo(C.shape,C.dtype,ee)}const Upe={kernelName:Wy,backendName:"cpu",kernelFunc:h7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zpe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s;Re([r,i],"conv2dBackpropFilter");const h=Ta(l),d=Qn(r.shape,u,o,1,a,c,!1,h),{strideHeight:f,strideWidth:p,filterHeight:g,filterWidth:m}=d,y=d.dataFormat==="channelsLast",w=new Zn(d.filterShape,"float32"),b=d.padInfo.left,C=d.padInfo.top,k=n.data.get(r.dataId).values,$=n.data.get(i.dataId).values,I=new Zn(r.shape,r.dtype,k),T=new Zn(i.shape,i.dtype,$);for(let R=0;R<g;++R){const E=Math.max(0,Math.ceil((C-R)/f)),A=Math.min(d.outHeight,(d.inHeight+C-R)/f);for(let F=0;F<m;++F){const P=Math.max(0,Math.ceil((b-F)/p)),Z=Math.min(d.outWidth,(d.inWidth+b-F)/p);for(let H=0;H<d.inChannels;++H)for(let j=0;j<d.outChannels;++j){let ee=0;for(let z=0;z<d.batchSize;++z)for(let X=E;X<A;++X){const ie=R+X*f-C;for(let de=P;de<Z;++de){const he=F+de*p-b;y?ee+=I.get(z,ie,he,H)*T.get(z,X,de,j):ee+=I.get(z,H,ie,he)*T.get(z,j,X,de)}}w.set(ee,R,F,H,j)}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const Wpe={kernelName:Rk,backendName:"cpu",kernelFunc:zpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jpe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s;Re([r,i],"conv2dBackpropInput");const h=Pe(i.shape),d=Pe(r.shape);let f=Ta(c);const p=Qn(o,i.shape,a,1,l,u,!1,f),g=new Zn(p.inShape,"float32"),m=g.values,y=n.data.get(r.dataId).values,w=n.data.get(i.dataId).values,[b,C,k]=h,{batchSize:$,filterHeight:I,filterWidth:T,inChannels:R,inHeight:E,inWidth:A,outChannels:F,outHeight:P,outWidth:Z,strideHeight:H,strideWidth:j}=p;f=p.dataFormat;const ee=I-1-p.padInfo.top,z=T-1-p.padInfo.left,X=f==="channelsLast",ie=g.strides[0],de=X?g.strides[1]:g.strides[2],he=X?g.strides[2]:1,fe=X?1:g.strides[1],ge=d[0],pe=X?d[1]:d[2],we=X?d[2]:1,ke=X?1:d[1];for(let De=0;De<$;++De)for(let _e=0;_e<R;++_e)for(let Be=0;Be<E;++Be){const Oe=Be-ee,qe=Math.max(0,Math.ceil(Oe/H)),Ue=Math.min(P,(I+Oe)/H);for(let Ye=0;Ye<A;++Ye){const ut=Ye-z,it=Math.max(0,Math.ceil(ut/j)),$t=Math.min(Z,(T+ut)/j);let vt=0;for(let Ut=qe;Ut<Ue;++Ut){const sr=Ut*H-Oe;for(let jn=it;jn<$t;++jn){const Vs=jn*j-ut,Gn=ge*De+pe*Ut+we*jn,xn=b*(I-1-sr)+C*(T-1-Vs)+k*_e;for(let Rt=0;Rt<F;++Rt){const kt=y[Gn+ke*Rt],ns=w[xn+Rt];vt+=kt*ns}}}const Bs=ie*De+de*Be+he*Ye+fe*_e;m[Bs]=vt}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const Gpe={kernelName:jy,backendName:"cpu",kernelFunc:jpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hpe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s;Re([r,i],"conv3d");const c=ql(r.shape,i.shape,o,l,a),{filterDepth:u,filterHeight:h,filterWidth:d,dilationDepth:f,dilationHeight:p,dilationWidth:g,padInfo:m}=c,y=m.front,w=m.left,b=m.top,C=new Zn(c.outShape,r.dtype),k=n.data.get(r.dataId).values,$=n.data.get(i.dataId).values,I=C.values,T=Pe(r.shape),R=Pe(i.shape);for(let E=0;E<c.batchSize;++E){const A=E*T[0],F=E*C.strides[0];for(let P=0;P<c.outDepth;++P){const Z=F+P*C.strides[1],H=P*c.strideDepth-y;for(let j=0;j<u;++j){const ee=H+j*f;if(ee<0||ee>=c.inDepth)continue;const z=j*R[0],X=A+ee*T[1];for(let ie=0;ie<c.outHeight;++ie){const de=Z+ie*C.strides[2],he=ie*c.strideHeight-b;for(let fe=0;fe<h;++fe){const ge=he+fe*p;if(ge<0||ge>=c.inHeight)continue;const pe=z+fe*R[1],we=X+ge*T[2];for(let ke=0;ke<c.outWidth;++ke){const De=de+ke*c.outChannels,_e=ke*c.strideWidth-w;for(let Be=0;Be<d;++Be){const Oe=_e+Be*g;if(Oe<0||Oe>=c.inWidth)continue;const qe=pe+Be*R[2],Ue=we+Oe*c.inChannels;let Ye=qe;for(let ut=0;ut<c.inChannels;++ut){const it=k[Ue+ut];for(let $t=0;$t<c.outChannels;++$t)I[De+$t]+=it*$[Ye+$t];Ye+=c.outChannels}}}}}}}}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const Kpe={kernelName:Gy,backendName:"cpu",kernelFunc:Hpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qpe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,filterShape:l}=s;Re([r,i],"conv3dBackpropFilterV2");const c=Pe(r.shape),u=Pe(i.shape),h=ql(r.shape,l,o,1,a),d=h.strideDepth,f=h.strideHeight,p=h.strideWidth,g=h.filterDepth,m=h.filterHeight,y=h.filterWidth,w=new Zn(h.filterShape,"float32"),b=w.values,[C,k,$,I]=w.strides,T=n.data.get(i.dataId).values,[R,E,A,F]=u,P=n.data.get(r.dataId).values,[Z,H,j,ee]=c,z=h.padInfo.front,X=h.padInfo.left,ie=h.padInfo.top;for(let de=0;de<g;++de){const he=Math.max(0,Math.ceil((z-de)/d)),fe=Math.min(h.outDepth,(h.inDepth+z-de)/d),ge=de*C;for(let pe=0;pe<m;++pe){const we=Math.max(0,Math.ceil((ie-pe)/f)),ke=Math.min(h.outHeight,(h.inHeight+ie-pe)/f),De=pe*k+ge;for(let _e=0;_e<y;++_e){const Be=Math.max(0,Math.ceil((X-_e)/p)),Oe=Math.min(h.outWidth,(h.inWidth+X-_e)/p),qe=_e*$+De;for(let Ue=0;Ue<h.inChannels;++Ue){const Ye=Ue*I+qe;for(let ut=0;ut<h.outChannels;++ut){let it=0;for(let $t=0;$t<h.batchSize;++$t){const vt=$t*Z,Bs=$t*R;for(let Ut=he;Ut<fe;++Ut){const jn=(de+Ut*d-z)*H+vt,Vs=Ut*E+Bs;for(let Gn=we;Gn<ke;++Gn){const Rt=(pe+Gn*f-ie)*j+jn,kt=Gn*A+Vs;for(let ns=Be;ns<Oe;++ns){const Oo=(_e+ns*p-X)*ee+Rt,nc=ns*F+kt;it+=P[Oo+Ue]*T[nc+ut]}}}}b[Ye+ut]=it}}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const Xpe={kernelName:Ak,backendName:"cpu",kernelFunc:qpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ype(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{pad:o,strides:a,inputShape:l}=s;Re([r],"conv3dBackpropInputV2");const c=Pe(r.shape),u=Pe(i.shape),h=ql(l,i.shape,a,1,o),d=new Zn(h.inShape,"float32"),f=d.values,[p,g,m,y]=d.strides,w=n.data.get(r.dataId).values,[b,C,k,$]=c,I=n.data.get(i.dataId).values,[T,R,E,A]=u,{batchSize:F,filterDepth:P,filterHeight:Z,filterWidth:H,inChannels:j,inDepth:ee,inHeight:z,inWidth:X,outChannels:ie,outDepth:de,outHeight:he,outWidth:fe,strideDepth:ge,strideHeight:pe,strideWidth:we}=h,ke=P-1-h.padInfo.front,De=Z-1-h.padInfo.top,_e=H-1-h.padInfo.left;for(let Be=0;Be<F;++Be)for(let Oe=0;Oe<j;++Oe)for(let qe=0;qe<ee;++qe){const Ue=qe-ke,Ye=Math.max(0,Math.ceil(Ue/ge)),ut=Math.min(de,(P+Ue)/ge);for(let it=0;it<z;++it){const $t=it-De,vt=Math.max(0,Math.ceil($t/pe)),Bs=Math.min(he,(Z+$t)/pe);for(let Ut=0;Ut<X;++Ut){const sr=Ut-_e,jn=Math.max(0,Math.ceil(sr/we)),Vs=Math.min(fe,(H+sr)/we);let Gn=0;for(let xn=Ye;xn<ut;++xn){const Rt=xn*ge-Ue;for(let kt=vt;kt<Bs;++kt){const ns=kt*pe-$t;for(let Xi=jn;Xi<Vs;++Xi){const Oo=Xi*we-sr,nc=b*Be+C*xn+k*kt+$*Xi,Yi=T*(P-1-Rt)+R*(Z-1-ns)+E*(H-1-Oo)+A*Oe;for(let Ji=0;Ji<ie;++Ji){const Zi=w[nc+Ji],Fo=I[Yi+Ji];Gn+=Zi*Fo}}}}f[p*Be+g*qe+m*it+y*Ut+Oe]=Gn}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}const Jpe={kernelName:Dk,backendName:"cpu",kernelFunc:Ype};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zpe=It(_m,t=>Math.cos(t)),Qpe={kernelName:_m,backendName:"cpu",kernelFunc:Zpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eme=It($m,t=>Math.cosh(t)),tme={kernelName:$m,backendName:"cpu",kernelFunc:eme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nme(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=s,[u,h,d,f]=r.shape,p=i.shape[0],[g,m]=a,y=et([p,g,m,f],"float32"),w=n.data.get(i.dataId).values,b=n.data.get(o.dataId).values,C=n.data.get(r.dataId).values,k=Pe(r.shape),$=Pe(y.shape);for(let I=0;I<p;I++){const T=I*4,R=w[T],E=w[T+1],A=w[T+2],F=w[T+3],P=b[I];if(P>=u)continue;const Z=g>1?(A-R)*(h-1)/(g-1):0,H=m>1?(F-E)*(d-1)/(m-1):0;for(let j=0;j<g;j++){const ee=g>1?R*(h-1)+j*Z:.5*(R+A)*(h-1);if(ee<0||ee>h-1){for(let z=0;z<m;z++)for(let X=0;X<f;X++){const ie=X+z*$[2]+j*$[1]+I*$[0];y.values[ie]=c}continue}if(l==="bilinear"){const z=Math.floor(ee),X=Math.ceil(ee),ie=ee-z;for(let de=0;de<m;de++){const he=m>1?E*(d-1)+de*H:.5*(E+F)*(d-1);if(he<0||he>d-1){for(let we=0;we<f;we++){const ke=we+de*$[2]+j*$[1]+I*$[0];y.values[ke]=c}continue}const fe=Math.floor(he),ge=Math.ceil(he),pe=he-fe;for(let we=0;we<f;we++){let ke=we+fe*k[2]+z*k[1]+P*k[0];const De=C[ke];ke=we+ge*k[2]+z*k[1]+P*k[0];const _e=C[ke];ke=we+fe*k[2]+X*k[1]+P*k[0];const Be=C[ke];ke=we+ge*k[2]+X*k[1]+P*k[0];const Oe=C[ke],qe=De+(_e-De)*pe,Ue=Be+(Oe-Be)*pe;ke=we+de*$[2]+j*$[1]+I*$[0],y.values[ke]=qe+(Ue-qe)*ie}}}else for(let z=0;z<m;++z){const X=m>1?E*(d-1)+z*H:.5*(E+F)*(d-1);if(X<0||X>d-1){for(let he=0;he<f;he++){const fe=he+z*$[2]+j*$[1]+I*$[0];y.values[fe]=c}continue}const ie=Math.round(X),de=Math.round(ee);for(let he=0;he<f;he++){const fe=he+ie*k[2]+de*k[1]+P*k[0],ge=he+z*$[2]+j*$[1]+I*$[0];y.values[ge]=C[fe]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const sme={kernelName:Ok,backendName:"cpu",kernelFunc:nme};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;Re(r,"cumprod");const l=Zt([i],r.shape.length);let c=r;l!=null&&(c=Qs({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=un(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const h=xr(c.dtype,"int32"),d=wk(ue(c.shape),h),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],g=a?(y,w)=>y+p-w-1:(y,w)=>y+w;for(let y=0;y<f.length;y+=p)for(let w=0;w<p;w++){const b=g(y,w);if(w===0)d[b]=o?1:f[b];else{const C=g(y,w-1);d[b]=o?f[C]*d[C]:f[b]*d[C]}}const m=n.makeTensorInfo(c.shape,h,d);if(l!=null){const y=Xl(l),w=Qs({inputs:{x:m},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(c),w}return m}const ime={kernelName:Pk,backendName:"cpu",kernelFunc:rme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ome(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;Re(r,"cumsum");const l=Zt([i],r.shape.length);let c=r;l!=null&&(c=Qs({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=un(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const h=xr(c.dtype,"int32"),d=fs(ue(c.shape),h),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],g=a?(y,w)=>y+p-w-1:(y,w)=>y+w;for(let y=0;y<f.length;y+=p)for(let w=0;w<p;w++){const b=g(y,w);if(w===0)d[b]=o?0:f[b];else{const C=g(y,w-1);d[b]=o?f[C]+d[C]:f[b]+d[C]}}const m=n.makeTensorInfo(c.shape,h,d);if(l!=null){const y=Xl(l),w=Qs({inputs:{x:m},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(c),w}return m}const ame={kernelName:Hy,backendName:"cpu",kernelFunc:ome};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o,binaryOutput:a}=s;if(r.shape.length===1){const l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=G3(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(i),u=d8(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const cme={kernelName:Fk,backendName:"cpu",kernelFunc:lme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ume(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:i,dataFormat:o}=s;L(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=r.shape[0],l=r.shape[1],c=r.shape[2],u=r.shape[3],h=l*i,d=c*i,f=u/(i*i),p=n.data.get(r.dataId).values,g=new Float32Array(a*h*d*f);let m=0;for(let y=0;y<a;++y)for(let w=0;w<h;++w){const b=Math.floor(w/i),C=w%i;for(let k=0;k<d;++k){const $=Math.floor(k/i),I=k%i,T=(C*i+I)*f;for(let R=0;R<f;++R){const A=R+T+u*($+c*(b+l*y));g[m++]=p[A]}}}return n.makeTensorInfo([a,h,d,f],r.dtype,g)}const hme={kernelName:Lk,backendName:"cpu",kernelFunc:ume};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d7(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;Re([r,i],"depthwiseConv2DNative");const u=Pe(r.shape),h=Pe(i.shape);let d=l;d==null&&(d=[1,1]),L(ms(o,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${d}'`);const f=Qn(r.shape,i.shape,o,d,a,c,!0),{filterHeight:p,filterWidth:g,dilationHeight:m,dilationWidth:y,padInfo:w}=f,b=w.left,C=w.top,k=f.outChannels/f.inChannels,$=new Zn(f.outShape,r.dtype),I=n.data.get(r.dataId).values,T=n.data.get(i.dataId).values,R=$.values;for(let E=0;E<f.batchSize;++E){const A=E*u[0],F=E*$.strides[0];for(let P=0;P<f.outHeight;++P){const Z=F+P*$.strides[1],H=P*f.strideHeight-C;for(let j=0;j<p;++j){const ee=H+j*m;if(ee<0||ee>=f.inHeight)continue;const z=j*h[0],X=A+ee*u[1];for(let ie=0;ie<f.outWidth;++ie){const de=Z+ie*$.strides[2],he=ie*f.strideWidth-b;for(let fe=0;fe<g;++fe){const ge=he+fe*y;if(ge<0||ge>=f.inWidth)continue;const pe=z+fe*h[1],we=X+ge*f.inChannels;let ke=de,De=pe;for(let _e=0;_e<f.inChannels;++_e){const Be=I[we+_e];for(let Oe=0;Oe<k;++Oe)R[ke+Oe]+=Be*T[De+Oe];ke+=k,De+=k}}}}}}return n.makeTensorInfo($.shape,$.dtype,$.values)}const dme={kernelName:Ky,backendName:"cpu",kernelFunc:d7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s;Re([r,i],"depthwiseConv2dNativeBackpropFilter");const h=Qn(r.shape,u,o,a,l,c,!0),{strideHeight:d,strideWidth:f,filterHeight:p,filterWidth:g}=h,m=new Zn(h.filterShape,"float32"),y=h.padInfo.left,w=h.padInfo.top,b=h.outChannels/h.inChannels,C=n.data.get(r.dataId).values,k=new Zn(r.shape,r.dtype,C),$=n.data.get(i.dataId).values,I=new Zn(i.shape,i.dtype,$);for(let T=0;T<p;++T){const R=Math.max(0,Math.ceil((w-T)/d)),E=Math.min(h.outHeight,(h.inHeight+w-T)/d);for(let A=0;A<g;++A){const F=Math.max(0,Math.ceil((y-A)/f)),P=Math.min(h.outWidth,(h.inWidth+y-A)/f);for(let Z=0;Z<h.outChannels;++Z){const H=Math.trunc(Z/b),j=Z%b;let ee=0;for(let z=0;z<h.batchSize;++z)for(let X=R;X<E;++X){const ie=T+X*d-w;for(let de=F;de<P;++de){const he=A+de*f-y;ee+=k.get(z,ie,he,H)*I.get(z,X,de,Z)}}m.set(ee,T,A,H,j)}}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const pme={kernelName:Mk,backendName:"cpu",kernelFunc:fme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mme(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s;Re([r,i],"depthwiseConv2DNativeBackpropInput");const h=Pe(r.shape),d=Pe(i.shape),f=Qn(u,i.shape,o,a,l,c,!0),p=new Zn(f.inShape,"float32"),g=p.values,[m,y,w]=p.strides,b=n.data.get(r.dataId).values,[C,k,$]=h,I=n.data.get(i.dataId).values,[T,R,E]=d,{batchSize:A,filterHeight:F,filterWidth:P,inChannels:Z,inHeight:H,inWidth:j,outChannels:ee,outHeight:z,outWidth:X,strideHeight:ie,strideWidth:de}=f,he=F-1-f.padInfo.top,fe=P-1-f.padInfo.left,ge=ee/Z;for(let pe=0;pe<A;++pe)for(let we=0;we<Z;++we)for(let ke=0;ke<H;++ke){const De=ke-he,_e=Math.max(0,Math.ceil(De/ie)),Be=Math.min(z,(F+De)/ie);for(let Oe=0;Oe<j;++Oe){const qe=Oe-fe,Ue=Math.max(0,Math.ceil(qe/de)),Ye=Math.min(X,(P+qe)/de);let ut=0;for(let it=_e;it<Be;++it){const $t=it*ie-De;for(let vt=Ue;vt<Ye;++vt){const Bs=vt*de-qe,Ut=C*pe+k*it+$*vt,sr=T*(F-1-$t)+R*(P-1-Bs)+E*we;for(let jn=0;jn<ge;++jn){const Vs=we*ge+jn,Gn=b[Ut+Vs],xn=I[sr+jn];ut+=Gn*xn}}}g[m*pe+y*ke+w*Oe+we]=ut}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const gme={kernelName:Bk,backendName:"cpu",kernelFunc:mme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yme(t){const{inputs:e,backend:n}=t,{x:s}=e,r=ue(s.shape),i=n.data.get(s.dataId).values,o=et([r,r],s.dtype),a=o.values;for(let c=0;c<i.length;c++)a[c*r+c]=i[c];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,o.dtype,o.values)}const vme={kernelName:A5,backendName:"cpu",kernelFunc:yme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xme={kernelName:qy,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r}=t,{strides:i,pad:o,dilations:a}=n,l=e,c=l.data.get(s.dataId).values,u=s.shape.length,h=l.data.get(r.dataId).values,d=r.shape.length,{batchSize:f,inHeight:p,inWidth:g,inChannels:m,outHeight:y,outWidth:w,padInfo:b,strideHeight:C,strideWidth:k,filterHeight:$,filterWidth:I,dilationHeight:T,dilationWidth:R,outShape:E}=pg(s.shape,r.shape,i,o,"NHWC",a),A=ue(E),F=E.length,P=an(s.dtype,A);for(let H=0;H<f;++H)for(let j=0;j<y;++j){const ee=j*C-b.top;for(let z=0;z<w;++z){const X=z*k-b.left;for(let ie=0;ie<m;++ie){let de=Number.MIN_SAFE_INTEGER;for(let fe=0;fe<$;++fe){const ge=ee+fe*T;if(ge>=0&&ge<p)for(let pe=0;pe<I;++pe){const we=X+pe*R;if(we>=0&&we<g){const ke=Co([H,ge,we,ie],u,Pe(s.shape)),De=Co([fe,pe,ie],d,Pe(r.shape)),_e=c[ke]+h[De];_e>de&&(de=_e)}}}const he=Co([H,j,z,ie],F,Pe(E));P[he]=de}}}return{dataId:l.write(Eu(P,s.dtype),E,s.dtype),shape:E,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wme={kernelName:AC,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:i}=t,{strides:o,pad:a,dilations:l}=n,c=e,u=Bi(s.shape,c.data.get(s.dataId).values),h=Bi(r.shape,c.data.get(r.dataId).values),{batchSize:d,inHeight:f,inWidth:p,inChannels:g,outHeight:m,outWidth:y,padInfo:w,strideHeight:b,strideWidth:C,filterHeight:k,filterWidth:$,dilationHeight:I,dilationWidth:T,outShape:R}=pg(s.shape,r.shape,o,a,"NHWC",l);L(i.rank===R.length,()=>`Error in ${AC}, dy must have the same rank as output ${R.length}, but got ${i.rank}`);const E=Bi(R,c.data.get(i.dataId).values),A=N5(r.shape,r.dtype);for(let P=0;P<d;++P)for(let Z=0;Z<m;++Z){const H=Z*b-w.top;for(let j=0;j<y;++j){const ee=j*C-w.left;for(let z=0;z<g;++z){let X=Number.MIN_SAFE_INTEGER,ie=0,de=0;for(let he=0;he<k;++he){const fe=H+he*I;if(fe>=0&&fe<f)for(let ge=0;ge<$;++ge){const pe=ee+ge*T;if(pe>=0&&pe<p){const we=u[P][fe][pe][z]+h[he][ge][z];we>X&&(X=we,ie=he,de=ge)}}}A[ie][de][z]+=E[P][Z][j][z]}}}return{dataId:c.write(Eu(A,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bme={kernelName:RC,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:i}=t,{strides:o,pad:a,dilations:l}=n,c=e,u=Bi(s.shape,c.data.get(s.dataId).values),h=Bi(r.shape,c.data.get(r.dataId).values),{batchSize:d,inHeight:f,inWidth:p,inChannels:g,outHeight:m,outWidth:y,padInfo:w,strideHeight:b,strideWidth:C,filterHeight:k,filterWidth:$,dilationHeight:I,dilationWidth:T,outShape:R}=pg(s.shape,r.shape,o,a,"NHWC",l);L(i.rank===R.length,()=>`Error in ${RC}, dy must have the same rank as output ${R.length}, but got ${i.rank}`);const E=Bi(R,c.data.get(i.dataId).values),A=N5(s.shape,s.dtype);for(let P=0;P<d;++P)for(let Z=0;Z<m;++Z){const H=Z*b-w.top;for(let j=0;j<y;++j){const ee=j*C-w.left;for(let z=0;z<g;++z){let X=Number.MIN_SAFE_INTEGER,ie=H<0?0:H,de=ee<0?0:ee;for(let he=0;he<k;++he){const fe=H+he*I;if(fe>=0&&fe<f)for(let ge=0;ge<$;++ge){const pe=ee+ge*T;if(pe>=0&&pe<p){const we=u[P][fe][pe][z]+h[he][ge][z];we>X&&(X=we,ie=fe,de=pe)}}}A[P][ie][de][z]+=E[P][Z][j][z]}}}return{dataId:c.write(Eu(A,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cme(t){const{inputs:e,backend:n,attrs:s}=t,{image:r}=e,{canvas:i,options:o}=s,{contextOptions:a,imageOptions:l}=o||{},c=(l==null?void 0:l.alpha)||1,u=(a==null?void 0:a.contextType)||"2d";if(u!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const h=i.getContext(u,(a==null?void 0:a.contextAttributes)||{});if(h==null)throw new Error(`Could not get the context with ${u} type.`);const[d,f]=r.shape.slice(0,2),p=r.shape.length===2?1:r.shape[2],g=n.data.get(r.dataId).values,m=r.dtype==="float32"?255:1,y=new Uint8ClampedArray(f*d*4);for(let b=0;b<d*f;++b){const C=[0,0,0,255*c];for(let $=0;$<p;$++){const I=g[b*p+$];if(r.dtype==="float32"){if(I<0||I>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${I}.`)}else if(r.dtype==="int32"&&(I<0||I>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${I}.`);p===1?(C[0]=I*m,C[1]=I*m,C[2]=I*m):C[$]=I*m}const k=b*4;y[k+0]=Math.round(C[0]),y[k+1]=Math.round(C[1]),y[k+2]=Math.round(C[2]),y[k+3]=Math.round(C[3])}i.width=f,i.height=d;const w=new ImageData(y,f,d);return h.putImageData(w,0,0),r}const Sme={kernelName:Mte,backendName:"cpu",kernelFunc:Cme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $g(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Re(r,"sum");let a;r.dtype==="bool"?a=Fl({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):a=Ao({inputs:{x:r},backend:n});const l=a.shape.length,c=tt(i,a.shape),u=Zt(c,l);let h=c,d=a;u!=null&&(d=Qs({inputs:{x:a},backend:n,attrs:{perm:u}}),h=un(h.length,l)),es("sum",h,d.shape.length);const[f,p]=Wn(d.shape,h),g=xr(d.dtype,"int32");let m=M2(n,f,g);const y=ue(p),w=n.data.get(m.dataId).values,b=n.data.get(d.dataId).values;for(let C=0;C<w.length;++C){const k=C*y;let $=0;for(let I=0;I<y;++I)$+=b[k+I];w[C]=$}if(o){const C=vn(m.shape,c),k=m;m=Ot({inputs:{x:m},backend:n,attrs:{shape:C}}),n.disposeIntermediateTensorInfo(k)}return n.disposeIntermediateTensorInfo(a),u!=null&&n.disposeIntermediateTensorInfo(d),m}const Ime={kernelName:Ev,backendName:"cpu",kernelFunc:$g};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kme(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,i=e,{allDims:o,summedDims:a,idDims:l}=m3(r,i.length);y3(o.length,l,i);const{path:c,steps:u}=v3(a,l),h=u.length;let d=null,f=o.length;const p=[];for(let g=0;g<h;++g){for(const m of u[g]){const{permutationIndices:y,expandDims:w}=g3(f,l[m]);let b;x3(y)?b=i[m]:(b=Qs({inputs:{x:i[m]},backend:n,attrs:{perm:y}}),p.push(b));const C=b.shape.slice();for(let k=0;k<w.length;++k)C.splice(w[k],0,1);yt(b.shape,C)||(b=Ot({inputs:{x:b},backend:n,attrs:{shape:C}}),p.push(b)),d===null?d=b:(d=rx({inputs:{a:b,b:d},backend:n}),p.push(d))}g<h-1&&(c[g]>=0&&(d=$g({inputs:{x:d},backend:n,attrs:{axis:c[g]-(o.length-f),keepDims:!1}}),p.push(d)),f--)}for(const g of p)g!==d&&n.disposeIntermediateTensorInfo(g);return d}const Tme={kernelName:Vk,backendName:"cpu",kernelFunc:kme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eme(t){const{inputs:e,backend:n}=t,{dy:s,y:r}=e;Re([s,r],"eluGrad");const i=new Float32Array(ue(r.shape)),o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values;for(let l=0;l<o.length;++l){const c=o[l];c>=0?i[l]=a[l]:i[l]=a[l]*(c+1)}return n.makeTensorInfo(r.shape,"float32",i)}const Nme={kernelName:Uk,backendName:"cpu",kernelFunc:Eme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _me=l3,$me=c3,Rme=u3,Ame=h3,Dme=d3,Pme=f3,Ome=It(Dm,t=>{const e=Math.sign(t),n=Math.abs(t),s=1/(1+_me*n);return e*(1-((((Pme*s+Dme)*s+Ame)*s+Rme)*s+$me)*s*Math.exp(-n*n))}),Fme={kernelName:Dm,backendName:"cpu",kernelFunc:Ome};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U2(t){const{inputs:e,backend:n,attrs:s}=t,{input:r}=e,{dim:i}=s,o=r.shape.length,a=r.shape.slice();let l=i;return i<0&&(L(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),a.splice(l,0,1),Ot({inputs:{x:r},backend:n,attrs:{shape:a}})}const Lme={kernelName:Yy,backendName:"cpu",kernelFunc:U2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mme=dn((t,e)=>t/e),J3=An(Rm,Mme),rS={kernelName:Rm,backendName:"cpu",kernelFunc:J3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f7(t,e,n){const s=t.shape,r=s[0],i=s[1],o=n.data.get(t.dataId),a=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,c=[r,i],u=ue(c),h=ds("float32",u),d=ds("float32",u);for(let m=0;m<r;m++){const y=vu({inputs:{x:a},backend:n,attrs:{begin:[m,0],size:[1,i]}}),w=vu({inputs:{x:l},backend:n,attrs:{begin:[m,0],size:[1,i]}}),b=hr({inputs:{real:y,imag:w},backend:n}),{real:C,imag:k}=Bme(b,e,n),$=xa(C,k);for(let I=0;I<i;I++){const T=p3($,I);h[m*i+I]=T.real,d[m*i+I]=T.imag}n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(b)}const f=n.makeTensorInfo(c,"float32",h),p=n.makeTensorInfo(c,"float32",d),g=hr({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),g}function Bme(t,e,n){const s=ue(t.shape),r=n.data.get(t.dataId),i=n.data.get(r.complexTensorInfos.real.dataId).values,o=n.data.get(r.complexTensorInfos.imag.dataId).values;if(Vme(s)){const a=iS(i,o,s,e,n),l=[t.shape[0],t.shape[1]];if(e){const c=n.makeTensorInfo(l,"float32",a.real),u=n.makeTensorInfo(l,"float32",a.imag),h=n.makeTensorInfo([],"float32",Hl(s,"float32")),d=Ao({inputs:{x:h},backend:n}),f=rS.kernelFunc({inputs:{a:c,b:h},backend:n}),p=rS.kernelFunc({inputs:{a:u,b:d},backend:n}),g=n.data.get(f.dataId).values,m=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),{real:g,imag:m}}return a}else{const a=xa(i,o),l=Ume(a,s,e);return TM(l)}}function Vme(t){return(t&t-1)===0}function iS(t,e,n,s,r){if(n===1)return{real:t,imag:e};const i=xa(t,e),o=n/2,a=EM(i),l=a.real,c=a.imag,u=[l.length],h=r.makeTensorInfo(u,"float32",l),d=r.makeTensorInfo(u,"float32",c),f=hr({inputs:{real:h,imag:d},backend:r}),p=NM(i),g=p.real,m=p.imag,y=[g.length],w=r.makeTensorInfo(y,"float32",g),b=r.makeTensorInfo(y,"float32",m),C=hr({inputs:{real:w,imag:b},backend:r}),k=iS(l,c,o,s,r),$=k.real,I=k.imag,T=[$.length],R=r.makeTensorInfo(T,"float32",$),E=r.makeTensorInfo(T,"float32",I),A=hr({inputs:{real:R,imag:E},backend:r}),F=iS(g,m,o,s,r),P=F.real,Z=F.imag,H=[P.length],j=r.makeTensorInfo(H,"float32",P),ee=r.makeTensorInfo(H,"float32",Z),z=hr({inputs:{real:j,imag:ee},backend:r}),X=$M(n,s),ie=[X.real.length],de=r.makeTensorInfo(ie,"float32",X.real),he=r.makeTensorInfo(ie,"float32",X.imag),fe=hr({inputs:{real:de,imag:he},backend:r}),ge=rx({inputs:{a:fe,b:z},backend:r}),pe=gd({inputs:{a:A,b:ge},backend:r}),we=X3({inputs:{a:A,b:ge},backend:r}),ke=yu({inputs:{input:pe},backend:r}),De=yu({inputs:{input:we},backend:r}),_e=yd({inputs:{input:pe},backend:r}),Be=yd({inputs:{input:we},backend:r}),Oe=vd({inputs:[ke,De],backend:r,attrs:{axis:0}}),qe=vd({inputs:[_e,Be],backend:r,attrs:{axis:0}}),Ue=r.data.get(Oe.dataId).values,Ye=r.data.get(qe.dataId).values;return r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(w),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(C),r.disposeIntermediateTensorInfo(R),r.disposeIntermediateTensorInfo(E),r.disposeIntermediateTensorInfo(A),r.disposeIntermediateTensorInfo(j),r.disposeIntermediateTensorInfo(ee),r.disposeIntermediateTensorInfo(z),r.disposeIntermediateTensorInfo(de),r.disposeIntermediateTensorInfo(he),r.disposeIntermediateTensorInfo(fe),r.disposeIntermediateTensorInfo(ge),r.disposeIntermediateTensorInfo(pe),r.disposeIntermediateTensorInfo(we),r.disposeIntermediateTensorInfo(ke),r.disposeIntermediateTensorInfo(_e),r.disposeIntermediateTensorInfo(De),r.disposeIntermediateTensorInfo(Be),r.disposeIntermediateTensorInfo(Oe),r.disposeIntermediateTensorInfo(qe),{real:Ue,imag:Ye}}function Ume(t,e,n){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let i=0,o=0;for(let a=0;a<e;a++){const l=RM(r*a,e,n),c=p3(t,a);i+=c.real*l.real-c.imag*l.imag,o+=c.real*l.imag+c.imag*l.real}n&&(i/=e,o/=e),_M(s,i,o,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zme(t){const{inputs:e,backend:n}=t,{input:s}=e,r=ue(s.shape),i=s.shape[s.shape.length-1],o=r/i,a=Ot({inputs:{x:s},backend:n,attrs:{shape:[o,i]}}),l=f7(a,!1,n),c=Ot({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const Wme={kernelName:zk,backendName:"cpu",kernelFunc:zme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z3(t){const{backend:e,attrs:n}=t,{shape:s,value:r,dtype:i}=n,o=i||Ad(r),a=an(o,ue(s));return Gme(a,r,o),e.makeTensorInfo(s,o,a)}const jme={kernelName:Wk,backendName:"cpu",kernelFunc:Z3};function Gme(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hme={kernelName:jk,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,r=n,i=ds(s.dtype,ue(s.shape)),[o,a,l,c]=s.shape,u=r.data.get(s.dataId).values;for(let d=0;d<o;d++){const f=d*l*a*c;for(let p=0;p<a;p++){const g=p*(l*c);for(let m=0;m<l;m++){const y=m*c;for(let w=0;w<c;w++){const b=Math.round(l-m-1),C=f+g+y+w;let k=u[C];if(b>=0&&b<l){const $=b*c,I=f+g+$+w;k=u[I]}i[C]=k}}}}return{dataId:r.write(i,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=s;let g=h7({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d}});if(o){const m=g;if(u==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const y=Ot({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});g=gd({inputs:{a:g,b:y},backend:n}),n.disposeIntermediateTensorInfo(y)}else g=gd({inputs:{a:g,b:o},backend:n});n.disposeIntermediateTensorInfo(m)}if(f){const m=g;if(u==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const y=Ot({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});g=V2(n,g,f,y,p),n.disposeIntermediateTensorInfo(y)}else g=V2(n,g,f,a,p);n.disposeIntermediateTensorInfo(m)}return g}const qme={kernelName:v2,backendName:"cpu",kernelFunc:Kme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=s;let g=d7({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d}});if(o){const m=g;g=gd({inputs:{a:g,b:o},backend:n}),n.disposeIntermediateTensorInfo(m)}if(f){const m=g;g=V2(n,g,f,a,p),n.disposeIntermediateTensorInfo(m)}return g}const Yme={kernelName:J5,backendName:"cpu",kernelFunc:Xme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jme(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,i=ue(s.shape),o=r.shape,a=o[o.length-1],[l,c,u,h]=JT(s,r);if(c===0)return n.makeTensorInfo(l,s.dtype,[]);const d=n.data.get(r.dataId).values,f=n.bufferSync(s),p=S8(d,f,s.dtype,c,a,u,h,s.shape,i);return n.makeTensorInfo(l,s.dtype,p.values)}const Zme={kernelName:D5,backendName:"cpu",kernelFunc:Jme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:i}=e,{axis:o,batchDims:a}=s;Re([r,i],"gatherV2");const l=tt(o,r.shape)[0],c=n.data.get(i.dataId).values,u=r.shape[l];for(let C=0;C<c.length;++C){const k=c[C];L(k<=u-1&&k>=0,()=>`GatherV2: the index value ${k} is not in [0, ${u-1}]`)}let h=a;a==null&&(h=0);const d=ue(i.shape),f=b3(r,i,l,h),p=Ot({inputs:{x:r},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),g=Ot({inputs:{x:i},backend:n,attrs:{shape:[f.batchSize,d/f.batchSize]}}),m=[f.batchSize,f.outerSize,d/f.batchSize,f.sliceSize],y=n.bufferSync(g),w=n.bufferSync(p),b=I8(w,y,m);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(f.outputShape,b.dtype,b.values)}const ege={kernelName:Zy,backendName:"cpu",kernelFunc:Qme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tge(t){const{inputs:e,backend:n}=t,{input:s}=e,r=ue(s.shape),i=s.shape[s.shape.length-1],o=r/i,a=Ot({inputs:{x:s},backend:n,attrs:{shape:[o,i]}}),l=f7(a,!0,n),c=Ot({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const nge={kernelName:Gk,backendName:"cpu",kernelFunc:tge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sge=It(Vm,t=>Number.isFinite(t)?1:0,"bool"),rge={kernelName:Vm,backendName:"cpu",kernelFunc:sge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ige=It(Um,t=>Math.abs(t)===1/0?1:0,"bool"),oge={kernelName:Um,backendName:"cpu",kernelFunc:ige};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const age=It(zm,t=>Number.isNaN(t)?1:0,"bool"),lge={kernelName:zm,backendName:"cpu",kernelFunc:age};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cge(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:i}=n,o=_8(s,r,i);return e.makeTensorInfo([o.length],"float32",o)}const uge={kernelName:P5,backendName:"cpu",kernelFunc:cge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hge=It(jm,t=>Math.log1p(t)),dge={kernelName:jm,backendName:"cpu",kernelFunc:hge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fge=dn((t,e)=>t&&e),pge=An(sv,fge,null,"bool"),mge={kernelName:sv,backendName:"cpu",kernelFunc:pge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gge=It(rv,t=>t?0:1,"bool"),yge={kernelName:rv,backendName:"cpu",kernelFunc:gge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vge=dn((t,e)=>t||e),xge=An(iv,vge,null,"bool"),wge={kernelName:iv,backendName:"cpu",kernelFunc:xge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=s;Re(r,"LRN");const c=r.shape[3],u=c-1,h=n.data.get(r.dataId).values,d=ue(r.shape),f=new Float32Array(d);function p(g){const m=g%c;let y=g-m+Math.max(0,m-i);const w=g-m+Math.min(m+i,u);let b=0;for(;y<=w;y++){const C=h[y];b+=C*C}return b}for(let g=0;g<d;g++){const m=p(g),y=h[g]*Math.pow(o+a*m,-l);f[g]=y}return n.makeTensorInfo(r.shape,r.dtype,f)}const Cge={kernelName:ov,backendName:"cpu",kernelFunc:bge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s;Re(o,"LRNGrad");const h=ue(o.shape),d=o.shape[3],f=n.data.get(o.dataId).values,p=n.data.get(r.dataId).values,g=n.data.get(i.dataId).values,m=new Float32Array(h),y=h;for(let w=0;w<y;w++){const b=w%d,C=w-b+Math.max(0,b-a),k=w-b+Math.min(d,b+a+1);let $=0;for(let I=C;I<k;I++)$+=Math.pow(p[I],2);$=c*$+l;for(let I=C;I<k;I++){let T=-2*c*u*p[I]*g[w]/$;w===I&&(T+=Math.pow($,-u)),T*=f[w],m[I]+=T}}return n.makeTensorInfo(o.shape,r.dtype,m)}const Ige={kernelName:Kk,backendName:"cpu",kernelFunc:Sge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p7(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:i,keepDims:o}=s,a=n;let l=r.shape;const c=l.length,u=tt(i,l);let h=u;const d=Zt(h,c);let f=a.data.get(r.dataId).values;if(d!=null){const C=new Array(c);for(let k=0;k<C.length;k++)C[k]=l[d[k]];f=K3(f,l,r.dtype,d,C),h=un(h.length,c),l=C}Re(r,"max"),es("max",h,c);const[p,g]=Wn(l,h),m=ue(g),y=R8(f,m,p,r.dtype),w=a.write(y,p,r.dtype);let b=p;return o&&(b=vn(p,u)),{dataId:w,shape:b,dtype:r.dtype}}const kge={kernelName:av,backendName:"cpu",kernelFunc:p7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Re(r,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;L(ms(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=wi(r.shape,i,o,c,a,l);let h;if(u.filterWidth===1&&u.filterHeight===1&&yt(u.inShape,u.outShape))h=Ao({inputs:{x:r},backend:n});else{const d=n.data.get(r.dataId).values,f=Pe(r.shape),p=Y3(d,r.shape,r.dtype,f,u,"max");h=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return h}const Ege={kernelName:lv,backendName:"cpu",kernelFunc:Tge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;Re(r,"maxPool3d");const u=ka(r.shape,i,o,1,a,l,c),h=n.data.get(r.dataId).values,d=u7(h,r.shape,r.dtype,Pe(r.shape),u,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}const _ge={kernelName:cv,backendName:"cpu",kernelFunc:Nge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ge(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;Re([r,i],"maxPool3DGrad");const u=ka(i.shape,o,a,1,l,c),h=n.bufferSync(i),d=vpe(h,u),f=u.strideDepth,p=u.strideHeight,g=u.strideWidth,m=u.dilationDepth,y=u.dilationHeight,w=u.dilationWidth,b=u.effectiveFilterDepth,C=u.effectiveFilterHeight,k=u.effectiveFilterWidth,$=b-1-u.padInfo.front,I=k-1-u.padInfo.left,T=C-1-u.padInfo.top,R=et(i.shape,"float32"),E=n.bufferSync(r);for(let A=0;A<u.batchSize;++A)for(let F=0;F<u.inChannels;++F)for(let P=0;P<u.inDepth;++P)for(let Z=0;Z<u.inHeight;++Z)for(let H=0;H<u.inWidth;++H){const j=P-$,ee=Z-T,z=H-I;let X=0;for(let ie=0;ie<b;ie+=m){const de=(j+ie)/f;if(!(de<0||de>=u.outDepth||Math.floor(de)!==de))for(let he=0;he<C;he+=y){const fe=(ee+he)/p;if(!(fe<0||fe>=u.outHeight||Math.floor(fe)!==fe))for(let ge=0;ge<k;ge+=w){const pe=(z+ge)/g;if(pe<0||pe>=u.outWidth||Math.floor(pe)!==pe)continue;const we=b*C*k-1-d.get(A,de,fe,pe,F),ke=ie*C*k+he*k+ge,De=we===ke?1:0;if(De===0)continue;const _e=E.get(A,de,fe,pe,F);X+=_e*De}}}R.set(X,A,P,Z,H,F)}return n.makeTensorInfo(R.shape,R.dtype,R.values)}const Rge={kernelName:Xk,backendName:"cpu",kernelFunc:$ge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Age(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i,output:o}=e,a=i;Re([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=s,d=wi(a.shape,l,c,1,u,h),f=n.data.get(a.dataId).values,p=et(d.outShape,a.dtype,c7(f,a.shape,a.dtype,d).values),g=d.strideHeight,m=d.strideWidth,y=d.dilationHeight,w=d.dilationWidth,b=d.effectiveFilterHeight,C=d.effectiveFilterWidth,k=C-1-d.padInfo.left,$=b-1-d.padInfo.top,I=et(a.shape,"float32"),T=n.data.get(r.dataId).values,R=et(r.shape,"float32",T);for(let E=0;E<d.batchSize;++E)for(let A=0;A<d.inChannels;++A)for(let F=0;F<d.inHeight;++F)for(let P=0;P<d.inWidth;++P){const Z=F-$,H=P-k;let j=0;for(let ee=0;ee<b;ee+=y){const z=(Z+ee)/g;if(!(z<0||z>=d.outHeight||Math.floor(z)!==z))for(let X=0;X<C;X+=w){const ie=(H+X)/m;if(ie<0||ie>=d.outWidth||Math.floor(ie)!==ie)continue;const de=b*C-1-p.get(E,z,ie,A),he=ee*C+X,fe=de===he?1:0;if(fe===0)continue;const ge=R.get(E,z,ie,A);j+=ge*fe}}I.set(j,E,F,P,A)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const Dge={kernelName:qk,backendName:"cpu",kernelFunc:Age};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pge(t,e,n,s,r){const i=Pe(e),o=Y3(t,e,n,i,r,"max"),a=c7(t,e,n,r,!0,s);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oge={kernelName:O5,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;Re(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,u=wi(s.shape,r,i,[1,1],o),[h,d]=Pge(c,s.shape,s.dtype,a,u),f=l.write(h,u.outShape,s.dtype),p=l.write(d,u.outShape,s.dtype);return[{dataId:f,shape:u.outShape,dtype:s.dtype},{dataId:p,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=tt(i,r.shape),c=Wn(r.shape,a)[1],u=ue(c),h=[],d=n.makeTensorInfo([],"float32",new Float32Array([u]));h.push(d);const f=Fl({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});h.push(f);const p=J3({inputs:{a:f,b:d},backend:n});h.push(p);const g=$g({inputs:{x:p},backend:n,attrs:{axis:i,keepDims:o}});return h.forEach(m=>n.disposeIntermediateTensorInfo(m)),g}const Lge={kernelName:uv,backendName:"cpu",kernelFunc:Fge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Re(r,"min");const a=tt(i,r.shape);let l=a;const c=Zt(l,r.shape.length);let u=r;c!=null&&(u=Qs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=un(l.length,r.shape.length)),es("min",l,u.shape.length);const[h,d]=Wn(u.shape,l),f=ue(d),p=fs(ue(h),u.dtype),g=n.data.get(u.dataId).values;for(let y=0;y<p.length;++y){const w=y*f;let b=g[w];for(let C=0;C<f;++C){const k=g[w+C];(Number.isNaN(k)||k<b)&&(b=k)}p[y]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const m=n.makeTensorInfo(h,u.dtype,p);if(o){const y=vn(h,a),w=Ot({inputs:{x:m},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(m),w}return m}const Bge={kernelName:hv,backendName:"cpu",kernelFunc:Mge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,mode:o}=s;Re(r,"mirrorPad");const a=i.map((b,C)=>b[0]+r.shape[C]+b[1]),l=i.map(b=>b[0]),c=i.map((b,C)=>b[0]+r.shape[C]),u=o==="reflect"?0:1,h=n.data.get(r.dataId).values,d=r.shape.length,f=Pe(r.shape),p=ue(a),g=a.length,m=Pe(a),y=ds(r.dtype,p);for(let b=0;b<p;b++){let C=Dd(b,g,m);for(let $=0;$<g;$++)C[$]<l[$]?C[$]=l[$]*2-C[$]-u:C[$]>=c[$]&&(C[$]=(c[$]-1)*2-C[$]+u);C=C.map(($,I)=>$-l[I]);const k=Co(C,d,f);y[b]=h[k]}return{dataId:n.write(y,a,r.dtype),shape:a,dtype:r.dtype}}const Uge={kernelName:dv,backendName:"cpu",kernelFunc:Vge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zge=dn((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),Wge=An(Km,zge),jge={kernelName:Km,backendName:"cpu",kernelFunc:Wge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m7(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:i}=s,o=r.shape.length;let a=i;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const l=tt([a],r.shape),c=p7({inputs:{x:r},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=vn(c.shape,l),h=Ot({inputs:{x:c},backend:n,attrs:{shape:u}}),d=X3({inputs:{a:r,b:h},backend:n}),f=x8({inputs:{x:d},backend:n}),p=$g({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),g=Ot({inputs:{x:p},backend:n,attrs:{shape:u}}),m=J3({inputs:{a:f,b:g},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),m}const Gge={kernelName:$v,backendName:"cpu",kernelFunc:m7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hge(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:i,seed:o,normalized:a}=s;Re(r,"multinomial");const l=a?r:m7({inputs:{logits:r},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],h=n.data.get(l.dataId).values,d=[c,i],f=fs(ue(d),"int32");for(let p=0;p<c;++p){const g=p*u,m=new Float32Array(u-1);m[0]=h[g];for(let b=1;b<m.length;++b)m[b]=m[b-1]+h[g+b];const y=FT.alea(o.toString()),w=p*i;for(let b=0;b<i;++b){const C=y();f[w+b]=m.length;for(let k=0;k<m.length;k++)if(C<m[k]){f[w+b]=k;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(d,"int32",f)}const Kge={kernelName:F5,backendName:"cpu",kernelFunc:Hge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qge=GT;function Xge(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s;Re(r,"NonMaxSuppression");const c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,{selectedIndices:h}=qge(c,u,o,a,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}const Yge={kernelName:Yk,backendName:"cpu",kernelFunc:Xge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jge=HT;function Zge(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s;Re(r,"NonMaxSuppressionPadded");const u=n.data.get(r.dataId).values,h=n.data.get(i.dataId).values,{selectedIndices:d,validOutputs:f}=Jge(u,h,o,a,l,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const Qge={kernelName:Jk,backendName:"cpu",kernelFunc:Zge};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e0e=KT;function t0e(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s;Re(r,"NonMaxSuppressionWithScore");const u=n.data.get(r.dataId).values,h=n.data.get(i.dataId).values,d=o,f=a,p=l,g=c,{selectedIndices:m,selectedScores:y}=e0e(u,h,d,f,p,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const n0e={kernelName:Zk,backendName:"cpu",kernelFunc:t0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s0e(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:i,depth:o,onValue:a,offValue:l}=s;Re(r,"oneHot");const c=ue(r.shape),u=new Float32Array(c*o);u.fill(l);const h=n.data.get(r.dataId).values;for(let d=0;d<c;++d)h[d]>=0&&h[d]<o&&(u[d*o+h[d]]=a);return n.makeTensorInfo([...r.shape,o],i,u)}const r0e={kernelName:gv,backendName:"cpu",kernelFunc:s0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z2(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=yu({inputs:{input:s},backend:n}),i=z2({inputs:{x:r},backend:n}),o=yd({inputs:{input:s},backend:n}),a=z2({inputs:{x:o},backend:n}),l=hr({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return Z3({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const i0e={kernelName:Dv,backendName:"cpu",kernelFunc:z2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g7(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=yu({inputs:{input:s},backend:n}),i=g7({inputs:{x:r},backend:n}),o=yd({inputs:{input:s},backend:n}),a=z2({inputs:{x:o},backend:n}),l=hr({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return Z3({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const o0e={kernelName:mv,backendName:"cpu",kernelFunc:g7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y7(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return U2({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{xk(i,u.shape,"All tensors passed to stack must have matching shapes"),L(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const h=U2({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(h),h}),c=vd({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const a0e={kernelName:yv,backendName:"cpu",kernelFunc:y7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,constantValue:o}=s;Re(r,"pad");const a=i.map((w,b)=>w[0]+r.shape[b]+w[1]),l=i.map(w=>w[0]),c=n.data.get(r.dataId).values,u=ue(r.shape),h=r.shape.length,d=Pe(r.shape),f=ue(a),p=a.length,g=Pe(a),m=ds(r.dtype,f);o!==0&&m.fill(o);for(let w=0;w<u;w++){const C=Dd(w,h,d).map(($,I)=>$+l[I]),k=Co(C,p,g);m[k]=c[w]}return{dataId:n.write(m,a,r.dtype),shape:a,dtype:r.dtype}}const v7={kernelName:vv,backendName:"cpu",kernelFunc:l0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c0e=dn((t,e)=>Math.pow(t,e)),u0e=An(Xm,c0e),h0e={kernelName:Xm,backendName:"cpu",kernelFunc:u0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d0e(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:i,indices:o}=e,a=r.map(m=>n.data.get(m.dataId).values),l=r.map(m=>m.shape),c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,[h,d,f]=L8(a,l,c,i.shape,i.dtype,u,o.shape),p=h.map(m=>n.makeTensorInfo([m.length],"int32",m)),g=n.makeTensorInfo(f,i.dtype,d);return p.concat([g])}const f0e={kernelName:L5,backendName:"cpu",kernelFunc:d0e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p0e(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:i}=e,o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=M8(o,s.shape,s.dtype,a,r.shape,l,i.shape),h=n.makeTensorInfo([c.length],"int32",c),d=n.makeTensorInfo([u.length],s.dtype,u);return[h,d]}const m0e={kernelName:M5,backendName:"cpu",kernelFunc:p0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g0e(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,h=n.data.get(o.dataId).values,d=a.map(m=>n.data.get(m.dataId).values),f=a.map(m=>m.shape),[p,g]=B8(c,r.shape,u,i.shape,i.dtype,h,o.shape,d,f,l);return n.makeTensorInfo(p,i.dtype,g)}const y0e={kernelName:B5,backendName:"cpu",kernelFunc:g0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v0e(t){const{backend:e,attrs:n}=t,{start:s,stop:r,dtype:i,step:o}=n,a=V8(s,r,o,i);return e.makeTensorInfo([a.length],i,a)}const x0e={kernelName:Qk,backendName:"cpu",kernelFunc:v0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w0e=It(Ym,t=>1/t),b0e={kernelName:Ym,backendName:"cpu",kernelFunc:w0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C0e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s;Re(r,"resizeBilinear");const l=Pe(r.shape),[c,u]=a,[h,d,f,p]=r.shape,g=n.data.get(r.dataId).values,m=new Float32Array(ue([h,c,u,p])),y=[i&&c>1?d-1:d,i&&u>1?f-1:f],w=[i&&c>1?c-1:c,i&&u>1?u-1:u];let b=0;const C=y[0]/w[0],k=y[1]/w[1];for(let $=0;$<h;$++)for(let I=0;I<c;I++){let T;o?T=C*(I+.5)-.5:T=C*I;const R=Math.max(0,Math.floor(T)),E=T-R,A=Math.min(d-1,Math.ceil(T)),F=$*l[0]+R*l[1],P=$*l[0]+A*l[1];for(let Z=0;Z<u;Z++){let H;o?H=k*(Z+.5)-.5:H=k*Z;const j=Math.max(0,Math.floor(H)),ee=H-j,z=Math.min(f-1,Math.ceil(H)),X=F+j*l[2],ie=P+j*l[2],de=F+z*l[2],he=P+z*l[2];for(let fe=0;fe<p;fe++){const ge=g[X+fe],pe=g[ie+fe],we=g[de+fe],ke=g[he+fe],De=ge+(we-ge)*ee,_e=pe+(ke-pe)*ee,Be=De+(_e-De)*E;m[b++]=Be}}}return n.makeTensorInfo([h,c,u,p],"float32",m)}const S0e={kernelName:Sv,backendName:"cpu",kernelFunc:C0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I0e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s;Re([i,r],"resizeBilinearGrad");const a=Pe(r.shape),[l,c,u,h]=r.shape,[,d,f]=i.shape,p=new Float32Array(l*c*u*h),g=[o&&d>1?c-1:c,o&&f>1?u-1:u],m=[o&&d>1?d-1:d,o&&f>1?f-1:f],y=g[0]/m[0],w=g[1]/m[1],b=n.data.get(i.dataId).values;let C=0;for(let k=0;k<l;k++){const $=k*a[0];for(let I=0;I<d;I++){const T=I*y,R=Math.floor(T),E=Math.min(Math.ceil(T),c-1),A=$+R*a[1],F=$+E*a[1],P=T-R,Z=1-P;for(let H=0;H<f;H++){const j=H*w,ee=Math.floor(j),z=Math.min(Math.ceil(j),u-1),X=j-ee,ie=1-X,de=A+ee*a[2],he=A+z*a[2],fe=F+ee*a[2],ge=F+z*a[2],pe=Z*ie,we=Z*X,ke=P*ie,De=P*X;for(let _e=0;_e<h;_e++){const Be=b[C++];p[de+_e]+=Be*pe,p[he+_e]+=Be*we,p[fe+_e]+=Be*ke,p[ge+_e]+=Be*De}}}}return n.makeTensorInfo([l,u,c,h],"float32",p)}const k0e={kernelName:nT,backendName:"cpu",kernelFunc:I0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T0e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s;Re(r,"resizeNearestNeighbor");const l=Pe(r.shape),[c,u]=a,[h,d,f,p]=r.shape,g=n.data.get(r.dataId).values,m=new Float32Array(h*c*u*p),y=[i&&c>1?d-1:d,i&&u>1?f-1:f],w=[i&&c>1?c-1:c,i&&u>1?u-1:u],b=y[0]/w[0],C=y[1]/w[1];let k=0;for(let $=0;$<h;$++){const I=$*l[0];for(let T=0;T<c;T++){const R=o?b*(T+.5):b*T;let E=Math.min(d-1,i?Math.round(R):Math.floor(R));o&&(E=Math.max(0,E));const A=I+E*l[1];for(let F=0;F<u;F++){const P=o?C*(F+.5):C*F;let Z=Math.min(f-1,i?Math.round(P):Math.floor(P));o&&(Z=Math.max(0,Z));const H=A+Z*l[2];for(let j=0;j<p;j++){const ee=g[H+j];m[k++]=ee}}}}return n.makeTensorInfo([h,c,u,p],r.dtype,m)}const E0e={kernelName:Cv,backendName:"cpu",kernelFunc:T0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N0e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s;Re([i,r],"resizeNearestNeighborGrad");const a=Pe(r.shape),l=Pe(i.shape),[c,u,h,d]=r.shape,[,f,p]=i.shape,g=new Float32Array(c*u*h*d),m=n.data.get(i.dataId).values,y=[o&&f>1?u-1:u,o&&p>1?h-1:h],w=[o&&f>1?f-1:f,o&&p>1?p-1:p],b=y[0]/w[0],C=y[1]/w[1],k=1/b,$=1/C,I=Math.ceil(k)*2+2,T=Math.ceil($)*2+2;for(let R=0;R<c;R++){const E=R*a[0];for(let A=0;A<u;A++){const F=E+A*a[1],P=Math.floor(A*k),Z=Math.floor(P-I/2);for(let H=0;H<h;H++){const j=F+H*a[2],ee=Math.floor(H*$),z=Math.floor(ee-T/2);for(let X=0;X<d;X++){let ie=0;for(let de=0;de<I;de++){const he=de+Z;if(he<0||he>=f)continue;const fe=E+he*l[1],ge=he*b,pe=Math.min(u-1,o?Math.round(ge):Math.floor(ge));if(A===pe)for(let we=0;we<T;we++){const ke=we+z;if(ke<0||ke>=p)continue;const De=fe+ke*l[2],_e=ke*C,Be=Math.min(h-1,o?Math.round(_e):Math.floor(_e));H===Be&&(ie+=m[De+X])}}g[j+X]=ie}}}}return n.makeTensorInfo(r.shape,r.dtype,g)}const _0e={kernelName:tT,backendName:"cpu",kernelFunc:N0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:i}=s;Re(r,"reverse");const o=r.shape.length,a=tt(i,r.shape);if(o===0)return Ao({inputs:{x:r},backend:n});const l=new Zn(r.shape,r.dtype),c=n.bufferSync(r);for(let u=0;u<l.size;u++){const h=l.indexToLoc(u),d=h.slice();a.forEach(f=>d[f]=r.shape[f]-1-d[f]),l.set(c.get(...d),...h)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const R0e={kernelName:Iv,backendName:"cpu",kernelFunc:$0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A0e={kernelName:cT,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:i,center:o}=e,a=n,l=ds(s.dtype,ue(s.shape)),[c,u,h,d]=s.shape,[f,p]=i3(o,u,h),g=255,m=Math.sin(r),y=Math.cos(r),w=a.data.get(s.dataId).values;for(let C=0;C<c;C++){const k=C*h*u*d;for(let $=0;$<u;$++){const I=$*(h*d);for(let T=0;T<h;T++){const R=T*d;for(let E=0;E<d;E++){const A=[c,$,T,E],F=A[2],P=A[1];let Z=(F-f)*y-(P-p)*m,H=(F-f)*m+(P-p)*y;Z=Math.round(Z+f),H=Math.round(H+p);let j=i;if(typeof i!="number"&&(E===3?j=g:j=i[E]),Z>=0&&Z<h&&H>=0&&H<u){const z=H*(h*d),X=Z*d,ie=k+z+X+E;j=w[ie]}const ee=k+I+R+E;l[ee]=j}}}}return{dataId:a.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D0e=It(Qm,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),P0e={kernelName:Qm,backendName:"cpu",kernelFunc:D0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O0e(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:i}=e,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=Ru(i,r,o),d=!0,f=n.bufferSync(r),p=n.bufferSync(i),g=Mc(f,p,o,h,c,l,a,u,0,d);return n.makeTensorInfo(o,g.dtype,g.values)}const F0e={kernelName:V5,backendName:"cpu",kernelFunc:O0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L0e(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<e?n=r+1:s=r;return s}function M0e(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<=e?n=r+1:s=r;return s}function B0e(t,e,n,s,r,i){const o=an("int32",n*r);for(let a=0;a<n;++a){const l=t.slice(a*s,(a+1)*s),c=a*r;for(let u=0;u<r;++u)o[c+u]=i==="left"?L0e(l,e[u+c]):M0e(l,e[u+c])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V0e(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:i}=e,{side:o}=s,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=B0e(a,l,r.shape[0],r.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",c)}const U0e={kernelName:z5,backendName:"cpu",kernelFunc:V0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z0e(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:i}=e;Re([s,r,i],"select");const o=s.shape.length,a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=xr(r.dtype,i.dtype),h=fs(ue(r.shape),u);let d=0;const f=o===0||o>1||r.shape.length===1?1:ue(r.shape.slice(1));for(let p=0;p<a.length;p++)for(let g=0;g<f;g++)a[p]===1?h[d++]=l[p]:h[d++]=c[p];return n.makeTensorInfo(r.shape,u,h)}const W0e={kernelName:kv,backendName:"cpu",kernelFunc:z0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j0e=Gv,G0e=Hv,H0e=It(tg,t=>t>=0?G0e*t:j0e*(Math.exp(t)-1)),K0e={kernelName:tg,backendName:"cpu",kernelFunc:H0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q0e=It(rg,t=>t<0?-1:t>0?1:0),X0e={kernelName:rg,backendName:"cpu",kernelFunc:q0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y0e=It(ng,t=>Math.sin(t)),J0e={kernelName:ng,backendName:"cpu",kernelFunc:Y0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z0e=It(sg,t=>Math.sinh(t)),Q0e={kernelName:sg,backendName:"cpu",kernelFunc:Z0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e1e=11920928955078125e-23,sR=Math.log(e1e)+2,t1e=It(og,t=>{const e=t>-sR,n=t<sR,s=Math.exp(t);let r;return n?r=s:e?r=t:r=Math.log(1+s),r}),n1e={kernelName:og,backendName:"cpu",kernelFunc:t1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,paddings:o}=s;Re([r],"spaceToBatchND");const a=ue(i),l=[[0,0]];l.push(...o);for(let $=1+i.length;$<r.shape.length;++$)l.push([0,0]);const c=v7.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),u=xg(c.shape,i,a,!1),h=wg(u.length,i.length,!1),d=bg(c.shape,i,a,!1),g=Ot({inputs:{x:c},backend:n,attrs:{shape:u}}),w=Qs({inputs:{x:g},backend:n,attrs:{perm:h}}),k=Ot({inputs:{x:w},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(w),k}const r1e={kernelName:Nv,backendName:"cpu",kernelFunc:s1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i1e(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values[0],[h,d,f,p,g]=j8(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(d,s.dtype,h),n.makeTensorInfo([d[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(m=>Number(m)))),n.makeTensorInfo([g.length],s.dtype,new Int32Array(g))]}const o1e={kernelName:W5,backendName:"cpu",kernelFunc:i1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a1e(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.data.get(r.dataId).values),a=n.data.get(s.dataId).values,l=Array.from(n.data.get(i.dataId).values),[c,u,h]=G8(a,s.shape,s.dtype,o,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}const l1e={kernelName:j5,backendName:"cpu",kernelFunc:a1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c1e(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=q3(o,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const u1e={kernelName:G5,backendName:"cpu",kernelFunc:c1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h1e(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=q3(o,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const d1e={kernelName:H5,backendName:"cpu",kernelFunc:h1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f1e(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:i,defaultValue:o}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:d}=Ru(i,r,a),f=!1,p=n.bufferSync(r);let g;switch(i.dtype){case"bool":{const m=n.bufferSync(i),y=!!n.data.get(o.dataId).values[0];g=Mc(p,m,a,d,u,c,l,h,y,f);break}case"float32":{const m=n.bufferSync(i),y=n.data.get(o.dataId).values[0];g=Mc(p,m,a,d,u,c,l,h,y,f);break}case"int32":{const m=n.bufferSync(i),y=n.data.get(o.dataId).values[0];g=Mc(p,m,a,d,u,c,l,h,y,f);break}case"string":{const m=n.bufferSync(i),y=Rl(n.data.get(o.dataId).values[0]);g=Mc(p,m,a,d,u,c,l,h,y,f);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return n.makeTensorInfo(a,g.dtype,g.values)}const p1e={kernelName:K5,backendName:"cpu",kernelFunc:f1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:i,axis:o}=s,a=tt(o,r.shape)[0],l=w3(r,i,a),c=new Array(r.shape.length).fill(0),u=r.shape.slice();return l.map(h=>{const d=[...u];d[a]=h;const f=vu({inputs:{x:r},backend:n,attrs:{begin:c,size:d}});return c[a]+=h,f})}const g1e={kernelName:_v,backendName:"cpu",kernelFunc:m1e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y1e={kernelName:sT,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,s=e;Re(n,"square");const r=s.data.get(n.dataId).values,i=new Float32Array(r.length);for(let a=0;a<r.length;++a){const l=r[a];i[a]=l*l}return{dataId:s.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v1e=It(fg,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),x1e={kernelName:fg,backendName:"cpu",kernelFunc:v1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=s;Re(r,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:g,sliceDim0:m,isSimpleSlice:y,begin:w,end:b,strides:C}=n3(r.shape,i,o,a,l,c,u,h,d);let k;if(g)k=Ot({inputs:{x:r},backend:n,attrs:{shape:p}});else if(m||y){L(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const $=QT(w,b,C),I=vu({inputs:{x:r},backend:n,attrs:{begin:w,size:$}});k=Ot({inputs:{x:I},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(I)}else{const $=n.bufferSync(r),I=q8(f,$,C,w);k=n.makeTensorInfo(p,I.dtype,I.values)}return k}const b1e={kernelName:iT,backendName:"cpu",kernelFunc:w1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C1e(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:h}=e,d=n.data.get(u.dataId).values,f=n.data.get(h.dataId).values,[p,g]=X8(d,f,r,i,o,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(h.shape,"int32",g)]}const S1e={kernelName:q5,backendName:"cpu",kernelFunc:C1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I1e(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],[c,u,h]=Y8(a,l,r),d=u.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}const k1e={kernelName:X5,backendName:"cpu",kernelFunc:I1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T1e(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(i.dataId).values,a=J8(o,r);return n.makeTensorInfo(i.shape,"int32",a)}const E1e={kernelName:Y5,backendName:"cpu",kernelFunc:T1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N1e=It(ug,t=>Math.tan(t)),_1e={kernelName:ug,backendName:"cpu",kernelFunc:N1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $1e=It(hg,t=>Math.tanh(t)),R1e={kernelName:hg,backendName:"cpu",kernelFunc:$1e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A1e(t){const{inputs:e,backend:n}=t,{tensor:s,indices:r,updates:i}=e,{sliceRank:o,numUpdates:a,sliceSize:l,strides:c,outputSize:u}=Ru(i,r,s.shape),h=!1,d=n.bufferSync(r),f=n.bufferSync(i),p=n.bufferSync(s),g=Mc(d,f,s.shape,u,l,a,o,c,p,h);return n.makeTensorInfo(s.shape,g.dtype,g.values)}const D1e={kernelName:U5,backendName:"cpu",kernelFunc:A1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:i}=s;Re(r,"tile");const o=Q8(n.bufferSync(r),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const O1e={kernelName:dg,backendName:"cpu",kernelFunc:P1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:i,sorted:o}=s;Re(r,"topk");const a=n.data.get(r.dataId).values,[l,c]=t7(a,r.shape,r.dtype,i,o);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const L1e={kernelName:oT,backendName:"cpu",kernelFunc:F1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M1e(t){const{inputs:e,attrs:n,backend:s}=t,{image:r,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=n,[u,h,d,f]=r.shape,[p,g]=c??[h,d],m=[u,p,g,f],y=Pe(r.shape),w=y[0],b=y[1],C=y[2],k=Pe(m),$=k[0],I=k[1],T=k[2],R=ds(r.dtype,ue(m));R.fill(l);const E=s.data.get(r.dataId).values,A=s.data.get(i.dataId).values;for(let P=0;P<u;++P){const Z=i.shape[0]===1?A:A.subarray(P*8,P*8+8);for(let H=0;H<p;++H)for(let j=0;j<g;++j)for(let ee=0;ee<f;++ee){let z;const X=Z[6]*j+Z[7]*H+1;if(X===0)continue;const ie=(Z[0]*j+Z[1]*H+Z[2])/X,de=(Z[3]*j+Z[4]*H+Z[5])/X,he=rR(ie,d,a),fe=rR(de,h,a);switch(o){case"nearest":z=j1e(E,h,d,w,b,C,P,fe,he,ee,l);break;case"bilinear":z=G1e(E,h,d,w,b,C,P,fe,he,ee,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const ge=P*$+H*I+j*T+ee;R[ge]=z}return s.makeTensorInfo(m,r.dtype,R)}return{dataId:s.write(R,m,r.dtype),shape:r.shape,dtype:r.dtype}}const B1e={kernelName:aT,backendName:"cpu",kernelFunc:M1e};function rR(t,e,n){switch(n){case"reflect":return V1e(t,e);case"wrap":return U1e(t,e);case"nearest":return W1e(t,e);case"constant":default:return z1e(t)}}function V1e(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=2*e;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-e?n+s:-n-1}else if(n>e-1)if(e<=1)n=0;else{const s=2*e;n-=s*Math.trunc(n/s),n>=e&&(n=s-n-1)}return iu(0,n,e-1)}function U1e(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=e-1;n+=e*(Math.trunc(-n/s)+1)}else if(n>e-1)if(e<=1)n=0;else{const s=e-1;n-=e*Math.trunc(n/s)}return iu(0,n,e-1)}function z1e(t,e){return t}function W1e(t,e){return iu(0,t,e-1)}function Gf(t,e,n,s,r,i,o,a,l,c,u){const h=o*s+a*r+l*i+c;return 0<=a&&a<e&&0<=l&&l<n?t[h]:u}function j1e(t,e,n,s,r,i,o,a,l,c,u){const h=Math.round(a),d=Math.round(l);return Gf(t,e,n,s,r,i,o,h,d,c,u)}function G1e(t,e,n,s,r,i,o,a,l,c,u){const h=Math.floor(a),d=Math.floor(l),f=h+1,p=d+1,g=(p-l)*Gf(t,e,n,s,r,i,o,h,d,c,u)+(l-d)*Gf(t,e,n,s,r,i,o,h,p,c,u),m=(p-l)*Gf(t,e,n,s,r,i,o,f,d,c,u)+(l-d)*Gf(t,e,n,s,r,i,o,f,p,c,u);return(f-a)*g+(a-h)*m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H1e(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:i}=e;Re(i,"unique");const o=s.data.get(i.dataId).values,{outputValues:a,outputShape:l,indices:c}=n7(o,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const K1e={kernelName:lT,backendName:"cpu",kernelFunc:H1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q1e(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const o=r.shape.length,a=r.shape[i],l=new Array(o-1);let c=0;for(let f=0;f<o;f++)f!==i&&(l[c++]=r.shape[f]);const u=new Array(o).fill(0),h=r.shape.slice();h[i]=1;const d=new Array(a);for(let f=0;f<d.length;f++){u[i]=f;const p=vu({inputs:{x:r},backend:n,attrs:{begin:u,size:h}});d[f]=Ot({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return d}const X1e={kernelName:Rv,backendName:"cpu",kernelFunc:q1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:i}=e,{numSegments:o}=s;Re(r,"unsortedSegmentSum");const a=r.shape.length,l=i.shape.length,c=[],u=[],h=a-l;let d=i;for(let p=0;p<h;++p){const g=U2({inputs:{input:d},backend:n,attrs:{dim:p+1}});d=g,u.push(g)}for(let p=0;p<o;++p){const g=Hl(p,"int32"),m=n.makeTensorInfo([],"int32",g),y=y8({inputs:{a:m,b:d},backend:n}),w=Fl({inputs:{x:y},backend:n,attrs:{dtype:"float32"}}),b=rx({inputs:{a:w,b:r},backend:n}),C=$g({inputs:{x:b},backend:n,attrs:{axis:0,keepDims:!1}});c.push(C),u.push(m),u.push(y),u.push(w),u.push(b),u.push(C)}const f=y7({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const J1e={kernelName:Av,backendName:"cpu",kernelFunc:Y1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z1e=[Hfe,Tde,qfe,Yfe,Ade,Zfe,epe,npe,rpe,ope,lpe,upe,dpe,mpe,ype,wpe,Cpe,Ipe,Tpe,jfe,Npe,$pe,Ape,Pde,Ppe,$de,Fde,Fpe,Ede,Mpe,Vpe,Upe,Wpe,Gpe,Kpe,Xpe,Jpe,Qpe,tme,sme,ime,ame,cme,hme,dme,pme,gme,vme,xme,wme,bme,Sme,Tme,Lfe,Nme,Lde,Fme,Mde,Lme,Vde,Wme,jme,Hme,zde,jde,qme,Yme,Zme,ege,Hde,qde,Nde,nge,Bpe,rge,oge,lge,Mfe,Yde,Zde,uge,efe,dge,mge,yge,wge,Cge,Ige,kge,nfe,Ege,_ge,Rge,Dge,Oge,Lge,Bge,rfe,Uge,jge,Kge,ofe,lfe,Yge,Qge,n0e,ufe,r0e,o0e,a0e,v7,h0e,Vfe,ffe,f0e,m0e,y0e,x0e,_de,rS,b0e,Ufe,zfe,Wfe,S0e,k0e,E0e,_0e,R0e,A0e,P0e,bfe,F0e,U0e,W0e,K0e,Sfe,X0e,J0e,Q0e,Ife,Gge,n1e,r1e,o1e,l1e,u1e,d1e,p1e,g1e,Efe,y1e,_fe,Rfe,x1e,b1e,S1e,k1e,E1e,Ofe,Ime,_1e,R1e,D1e,O1e,L1e,B1e,hfe,K1e,X1e,J1e,i0e];for(const t of Z1e)Z5(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $c={},z0={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Q1e(t,e){$c[t]=e}function Hi(t,e){if(!(t in $c)||e!=null){const s=t2e(t,e);if(s!==null)$c[t]=s;else return console.log("Could not get context for WebGL version",t),null}const n=$c[t];return n==null||n.isContextLost()?(delete $c[t],Hi(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),$c[t])}function e2e(t){if(!oe().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function t2e(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??e2e(t);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete $c[t]},!1),oe().getBool("SOFTWARE_WEBGL_ENABLED")&&(z0.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",z0)||n.getContext("experimental-webgl",z0):n.getContext("webgl2",z0)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Yp;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Yp||(Yp={}));var Mr;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(Mr||(Mr={}));var Yn;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Yn||(Yn={}));function Rg(t,e){return[e,t]}function n2e(t,e){return t*e}function W0(t){const e=ue(t),n=Math.ceil(e/4);return EC(n)}function Vd(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function s2e(t,e){const[n,s]=Vd(t,e);return n*s*4}function Q3(t,e){const n=t;let s,r,i,o,a,l,c,u,h,d;return oe().getNumber("WEBGL_VERSION")===2?(s=n.R32F,r=n.R16F,i=n.RGBA16F,o=n.RGBA32F,a=n.RED,c=4,u=1,h=n.HALF_FLOAT,d=n.FLOAT,l=n.RGBA8):(s=t.RGBA,r=t.RGBA,i=t.RGBA,o=n.RGBA,a=t.RGBA,c=4,u=4,h=e!=null?e.HALF_FLOAT_OES:null,d=t.FLOAT,l=t.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:h,textureTypeFloat:d}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Te(t,e){const n=e();return oe().getBool("DEBUG")&&r2e(t),n}function r2e(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+l2e(t,e))}const i2e=596e-10,o2e=65504;function a2e(t){return!!(oe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||i2e<Math.abs(t)&&Math.abs(t)<o2e)}function l2e(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function j0(t,e){return Ea(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function c2e(t,e){const n=Ea(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Te(t,()=>t.shaderSource(n,e)),Te(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function u2e(t,e){const n=Ea(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Te(t,()=>t.shaderSource(n,e)),Te(t,()=>t.compileShader(n)),oe().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw x7(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const h2e=/ERROR: [0-9]+:([0-9]+):/g;function x7(t,e){const n=h2e.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const s=+n[1],r=t.split(`
`),i=r.length.toString().length+2,o=r.map((h,d)=>zh((d+1).toString(),i)+h);let a=0;for(let h=0;h<o.length;h++)a=Math.max(o[h].length,a);const l=o.slice(0,s-1),c=o.slice(s-1,s),u=o.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${zh(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function d2e(t){return Ea(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function f2e(t,e){if(Te(t,()=>t.linkProgram(e)),!oe().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Mw(t,e){if(Te(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function p2e(t,e){const n=Ea(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Te(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),Te(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function m2e(t,e){const n=Ea(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Te(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),Te(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function g2e(t){return Ea(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function y2e(t,e){const n=oe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const s=`[${t}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(t>n||e>n){const s=`[${t}x${e}]`,r=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function v2e(t){return Ea(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function iR(t,e,n,s,r,i,o){const a=t.getAttribLocation(e,n);return a===-1?!1:(Te(t,()=>t.bindBuffer(t.ARRAY_BUFFER,s)),Te(t,()=>t.vertexAttribPointer(a,r,t.FLOAT,!1,i,o)),Te(t,()=>t.enableVertexAttribArray(a)),!0)}function x2e(t,e,n){I2e(t,n),Te(t,()=>t.activeTexture(t.TEXTURE0+n)),Te(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function w2e(t,e,n){return Ea(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function b2e(t,e,n){return t.getUniformLocation(e,n)}function C2e(t,e,n,s){Te(t,()=>x2e(t,e,s)),Te(t,()=>t.uniform1i(n,s))}function Bw(t,e,n){Te(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),Te(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function oR(t,e){Te(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),Te(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function G0(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+S2e(t,e))}function S2e(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Ea(t,e,n){const s=Te(t,()=>e());if(s==null)throw new Error(n);return s}function I2e(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+t.TEXTURE0;if(s<t.TEXTURE0||s>n){const r=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${r}.`)}}function xd(t,e=2){return ue(t.slice(0,t.length-e))}function wd(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function H0(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[xd(t),...wd(t)]),e}function k2e(t,e=!1){let n=oe().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=oe().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&oe().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),e&&(n=n*2,s=s*2,t=t.map((a,l)=>l>=t.length-2?vk(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=Gl(t).newShape);let r=ue(t),i=null;t.length<=1&&r<=n?i=[1,r]:t.length===2&&t[0]<=n&&t[1]<=n?i=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?i=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?i=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?i=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(i=[t[0],t[1]*t[2]*t[3]]);const o=i!=null&&Math.max(...i)>s&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||o)if(e){const a=xd(t);let l=2,c=2;t.length&&([l,c]=wd(t)),r=a*(l/2)*(c/2),i=EC(r).map(u=>u*2)}else i=EC(r);return i}function K0(t){return t%2===0}function W2(t,e){if(t=t.slice(-2),e=e.slice(-2),yt(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],s=e[e.length-1];if(n===s||K0(n)&&K0(s)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&K0(t[0])&&K0(e[0])}let Vw,Uw;function T2e(t){if(Vw==null){const e=Hi(t);Vw=e.getParameter(e.MAX_TEXTURE_SIZE)}return Vw}function E2e(t){if(Uw==null){const e=Hi(t);Uw=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Uw)}function N2e(t){if(t===0)return 0;let e;const n=Hi(t);return fi(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:fi(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function fi(t,e){return t.getExtension(e)!=null}function aR(t){try{if(Hi(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function _2e(t){if(t===0)return!1;const e=Hi(t);if(t===1){if(!fi(e,"OES_texture_float"))return!1}else if(!fi(e,"EXT_color_buffer_float"))return!1;return oS(e)}function $2e(t){if(t===0)return!1;const e=Hi(t);if(t===1){if(!fi(e,"OES_texture_float")||!fi(e,"WEBGL_color_buffer_float"))return!1}else{if(fi(e,"EXT_color_buffer_float"))return oS(e);const s="EXT_color_buffer_half_float";if(fi(e,s)){const r=e.getExtension(s);return R2e(e,r)}return!1}return oS(e)}function oS(t){const e=Q3(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),o}function R2e(t,e){const n=Q3(t,e),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(s),t.deleteFramebuffer(o),a}function A2e(t){return t!==2?!1:Hi(t).fenceSync!=null}function Ag(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&L(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ae=oe();Ae.registerFlag("HAS_WEBGL",()=>Ae.getNumber("WEBGL_VERSION")>0);Ae.registerFlag("WEBGL_VERSION",()=>aR(2)?2:aR(1)?1:0);Ae.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ae.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ae.get("WEBGL_VERSION")===2);Ae.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ae.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ae.registerFlag("WEBGL_PACK",()=>Ae.getBool("HAS_WEBGL"));Ae.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_CLIP",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_REDUCE",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_CONV_IM2COL",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>T2e(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>E2e(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Ae.getNumber("WEBGL_VERSION");return t===0?0:N2e(t)});Ae.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ae.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!mL());Ae.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>_2e(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ae.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ae.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ae.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>$2e(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_FENCE_API_ENABLED",()=>A2e(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ae.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ae.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Ae.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>mL()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Ae.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ae.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ae.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ae.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ae.registerFlag("WEBGL_EXP_CONV",()=>!1);Ae.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ae.getBool("IS_TEST"));Ae.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ae.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ae.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ae.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ms(){let t,e,n,s,r,i,o,a,l,c;return oe().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",s="in",r="texture",i="outputColor",o="out vec4 outputColor;",a=oe().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",s="varying",r="texture2D",i="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:s,texture2D:r,output:i,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pu(t,e,n="index"){const s=Pe(e);return s.map((r,i)=>{const o=`int ${t[i]} = ${n} / ${r}`,a=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${r}`:`index -= ${t[i]} * ${r}`;return`${o}; ${a};`}).join("")}function ix(t,e,n="index"){const s=Pe(e);return s.map((r,i)=>{const o=`int ${t[i]} = ${n} / outShapeStrides[${i}]`,a=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * outShapeStrides[${i}]`:`index -= ${t[i]} * outShapeStrides[${i}]`;return`${o}; ${a};`}).join("")}function D2e(t,e){const n=t.length,s=t.map(i=>`${e}[${i}]`),r=new Array(n-1);r[n-2]=s[n-1];for(let i=n-3;i>=0;--i)r[i]=`(${r[i+1]} * ${s[i+1]})`;return r}function P2e(t,e,n="index"){const s=t.map((i,o)=>o),r=D2e(s,e);return r.map((i,o)=>{const a=`int ${t[o]} = ${n} / ${r[o]}`,l=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${r[o]}`:`index -= ${t[o]} * ${r[o]}`;return`${a}; ${l};`}).join("")}function eE(t){const e=Pe(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function tE(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const w7=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:b7}=ble;function O2e(t,e,n){const s=[];if(t.forEach(f=>{const p=ue(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?s.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(s.push(`uniform sampler2D ${f.name};`),s.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:g}=nE(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(g.length){case 1:s.push(`uniform int ${f.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${f.name}Shape;`);break}s.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{s.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const r=s.join(`
`),i=t.map(f=>F2e(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,a=Ms(),l=B2e(a);let c,u,h=z2e(a);return e.isPacked?(c=L2e(e.logicalShape,o,n.enableShapeUniforms),u=U2e(a)):(c=M2e(e.logicalShape,o,n.enableShapeUniforms),u=V2e(a)),n.packedInputs&&(h+=H2e),[h,l,u,r,c,i,n.userCode].join(`
`)}function Ud(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return rye(t,e);case 1:return oye(t,e);case 2:return lye(t,e);case 3:return uye(t,e);case 4:return dye(t,e);case 5:return fye(t);case 6:return pye(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function C7(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return sye(t);case 1:return iye(t,e);case 2:return aye(t,e);case 3:return cye(t,e);default:return hye(t,e)}}function F2e(t,e,n=!1,s){let r="";n?r+=C7(t,s):r+=Ud(t,s);const i=t.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(n?r+=mye(t,e):r+=gye(t,e)),r}function L2e(t,e,n){switch(t.length){case 0:return S7();case 1:return K2e(t,e,n);case 2:return tye(t,e,n);case 3:return X2e(t,e,n);default:return J2e(t,e,n)}}function M2e(t,e,n){switch(t.length){case 0:return S7();case 1:return q2e(t,e,n);case 2:return nye(t,e,n);case 3:return Y2e(t,e,n);case 4:return Z2e(t,e,n);case 5:return Q2e(t,e);case 6:return eye(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function B2e(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function V2e(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function U2e(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function z2e(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${W2e}
    ${j2e}
    ${G2e}
  `}const W2e=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,j2e=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,G2e=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,H2e=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function S7(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function K2e(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function q2e(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function X2e(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),i=r*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function Y2e(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${ix(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const s=Pu(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function J2e(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2);let o=i,a="",l="b, r, c";for(let c=2;c<t.length-1;c++)o*=t[t.length-c-1],a=`
      int b${c} = index / ${o};
      index -= b${c} * ${o};
    `+a,l=`b${c}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${t.length}(${l});
    }
  `}function Z2e(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${ix(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Pu(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function Q2e(t,e){const n=Pu(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function eye(t,e){const n=Pu(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function tye(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(yt(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function nye(t,e,n){return yt(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Ou(t){return`offset${t}`}function sye(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),s=Ms();return`
    vec4 ${n}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function rye(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[r,i]=t.shapeInfo.texShape;if(r===1&&i===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=Ou(n);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function iye(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,i=Ms();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function oye(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${zd(t)}
      }
    `;const r=t.shapeInfo.texShape,i=r[0],o=r[1];if(o===1&&i===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Ou(n);return o===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function aye(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape,o=i[0],a=i[1],l=Ms();if(i!=null&&yt(n,i))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function lye(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape;if(i!=null&&yt(n,i)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const d=i[0],f=i[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:o,keptDims:a}=Gl(n),l=o;if(l.length<n.length){const d=Wd(t,l),f=["row","col"];return`
      ${Ud(d,e)}
      float ${r}(int row, int col) {
        return ${r}(${jd(f,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${zd(t)}
      }
    `;const c=i[0],u=i[1],h=Ou(s);return u===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${h};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${h};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${s}, uv);
  }
`}function cye(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){const d=n.slice(1),f=[1,2],p=Wd(t,d),g=["b","row","col"];return`
        ${C7(p,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${jd(g,f)});
        }
      `}const a=Ms();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const l=o[0],c=o[1],u=Math.ceil(n[2]/2),h=u*Math.ceil(n[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${h}, ${u}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function uye(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n[1]*n[2],o=n[2],{newShape:a,keptDims:l}=Gl(n),c=a;if(c.length<n.length){const g=Wd(t,c),m=["row","col","depth"];return`
        ${Ud(g,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${jd(m,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${zd(t)}
      }
    `;const u=t.shapeInfo.texShape,h=u[0],d=u[1],f=t.shapeInfo.flatOffset;if(d===i&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${d}.0, ${h}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(d===o&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${h}.0);
      return sampleTexture(${s}, uv);
    }
  `;const p=Ou(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${p};
        vec2 uv = uvFromFlat(${h}, ${d}, index);
        return sampleTexture(${s}, uv);
      }
  `}function hye(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=Ms();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${n}, uv);
    }
  `;const i=t.shapeInfo.logicalShape,o=i.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],h=Math.ceil(i[o-1]/2);let d=h*Math.ceil(i[o-2]/2),f="int b, int row, int col",p=`b * ${d} + (row / 2) * ${h} + (col / 2)`;for(let g=2;g<o-1;g++)f=`int b${g}, `+f,d*=i[o-g-1],p=`b${g} * ${d} + `+p;return`
    vec4 ${s}(${f}) {
      int index = ${p};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${r.texture2D}(${n}, uv);
    }
  `}function dye(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n[3],o=n[2]*i,a=n[1]*o,{newShape:l,keptDims:c}=Gl(n);if(l.length<n.length){const w=Wd(t,l),b=["row","col","depth","depth2"];return`
      ${Ud(w,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${jd(b,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${i}, 1)));
        ${zd(t)}
      }
    `;const u=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],f=h[1],p=`int stride2 = ${s}Shape[3];`,g=`int stride1 = ${s}Shape[2] * stride2;`,m=`int stride0 = ${s}Shape[1] * stride1;`;if(f===a&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${p}
        ${g}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(f===i&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${s}, uv);
      }
    `;const y=Ou(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${g}
      ${m}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${y});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${d}, ${f}, index + ${y});
      return sampleTexture(${s}, uv);
    }
  `}function fye(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[4],i=e[3]*r,o=e[2]*i,a=e[1]*o,{newShape:l,keptDims:c}=Gl(e);if(l.length<e.length){const g=Wd(t,l),m=["row","col","depth","depth2","depth3"];return`
      ${Ud(g)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${jd(m,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${i}, ${r})) +
          depth3;
        ${zd(t)}
      }
    `;const u=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],f=h[1];if(f===a&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===r&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=Ou(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${i} +
          depth2 * ${r} + depth3 + ${p};
      vec2 uv = uvFromFlat(${d}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function pye(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:i}=Gl(e);if(r.length<e.length){const m=Wd(t,r),y=["row","col","depth","depth2","depth3","depth4"];return`
      ${Ud(m)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${jd(y,i)});
      }
    `}const o=e[5],a=e[4]*o,l=e[3]*a,c=e[2]*l,u=e[1]*c;if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${zd(t)}
      }
    `;const h=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],p=d[1];if(p===u&&h==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===o&&h==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const g=Ou(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${g};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function zd(t){const e=t.name,n=ue(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function mye(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",i=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=b7(t.shapeInfo.logicalShape,e.logicalShape),l=_t(o),c=o-i;let u;const h=["x","y","z","w","u","v"];i===0?u="":o<2&&a.length>=1?u="coords = 0;":u=a.map(w=>`coords.${h[w+c]} = 0;`).join(`
`);let d="";o<2&&i>0?d="coords":d=t.shapeInfo.logicalShape.map((w,b)=>`coords.${h[b+c]}`).join(", ");let f="return outputValue;";const g=ue(t.shapeInfo.logicalShape)===1,y=ue(e.logicalShape)===1;if(i===1&&!g&&!y)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(g&&!y)o===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const w=i-2,b=i-1;a.indexOf(w)>-1&&a.indexOf(b)>-1?f="return vec4(outputValue.x);":a.indexOf(w)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(b)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${s}(${d});
      ${f}
    }
  `}function gye(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&yt(o,i))return`
      float ${r}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=_t(l),u=b7(t.shapeInfo.logicalShape,e.logicalShape),h=l-a;let d;const f=["x","y","z","w","u","v"];a===0?d="":l<2&&u.length>=1?d="coords = 0;":d=u.map(g=>`coords.${f[g+h]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((g,m)=>`coords.${f[m+h]}`).join(", "),`
    float ${r}() {
      ${c} coords = getOutputCoords();
      ${d}
      return get${s}(${p});
    }
  `}function _t(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function nE(t,e,n){const{newShape:s,keptDims:r}=Gl(e),i=e.length,o=t&&i===3&&e[0]===1,a=o?e.slice(1):s,l=!t&&i>1&&!yt(e,n)&&s.length<i||o;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:r}}function Wd(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function jd(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yye(t,e,n,s){const r=n.map((u,h)=>{const d={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(d.flatOffset=u.texData.slice.flatOffset),{name:e.variableNames[h],shapeInfo:d}}),i=r.map(u=>u.shapeInfo),o={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=O2e(r,o,e),l=u2e(t.gl,a),c=t.createProgram(l);return oe().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(c),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o},I7(t,e,c)))}function I7(t,e,n){const s=[],r=[];let i,o,a,l=null,c=null;c=t.getUniformLocation(n,"NAN",!1),oe().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const h of e.variableNames){const d={name:h,uniform:t.getUniformLocation(n,h,u),offset:t.getUniformLocation(n,`offset${h}`,u)};e.enableShapeUniforms&&(d.shape=t.getUniformLocation(n,`${h}Shape`,u),d.texShape=t.getUniformLocation(n,`${h}TexShape`,u)),s.push(d)}if(e.enableShapeUniforms&&(i=t.getUniformLocation(n,"outShape",u),a=t.getUniformLocation(n,"outShapeStrides",u),o=t.getUniformLocation(n,"outTexShape",u)),e.customUniforms)for(const h of e.customUniforms)r.push(t.getUniformLocation(n,h.name,u));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:c,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:o}}function lR(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,s)=>{const r=n.logicalShape,i=e[s],o=i.shape;if(!yt(r,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${o} must match`);if(n.isUniform&&i.isUniform)return;const a=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!yt(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function vye(t,e,n,s,r){e.program.enableShapeUniforms||(lR(e.inShapeInfos,n),lR([e.outShapeInfo],[s]));const i=s.texData.texture,o=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):t.setOutputMatrixTexture(i.texture,o[0],o[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),oe().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const c=n[l],{uniform:u,offset:h,shape:d,texShape:f}=e.variablesLocations[l];if(d){const{uniformShape:p}=nE(e.program.packedInputs,c.shape,c.texData.texShape);switch(p.length){case 1:t.gl.uniform1iv(d,new Int32Array(p));break;case 2:t.gl.uniform2iv(d,new Int32Array(p));break;case 3:t.gl.uniform3iv(d,new Int32Array(p));break;case 4:t.gl.uniform4iv(d,new Int32Array(p));break}}if(f&&t.gl.uniform2i(f,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(ue(c.shape)<2)t.gl.uniform1f(u,c.uniformValues[0]);else{let p=c.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),t.gl.uniform1fv(u,p)}continue}c.texData.slice!=null&&h!=null&&t.gl.uniform1i(h,c.texData.slice.flatOffset),t.setInputMatrixTexture(c.texData.texture.texture,u,l)}}const a=e.outShapeLocation;if(a)switch(s.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=Pe(s.shape);switch(s.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let l=0;l<e.program.customUniforms.length;++l){const c=e.program.customUniforms[l],u=e.customUniformLocations[l],h=r[l];if(c.type==="float")t.gl.uniform1fv(u,h);else if(c.type==="vec2")t.gl.uniform2fv(u,h);else if(c.type==="vec3")t.gl.uniform3fv(u,h);else if(c.type==="vec4")t.gl.uniform4fv(u,h);else if(c.type==="int")t.gl.uniform1iv(u,h);else if(c.type==="ivec2")t.gl.uniform2iv(u,h);else if(c.type==="ivec3")t.gl.uniform3iv(u,h);else if(c.type==="ivec4")t.gl.uniform4iv(u,h);else throw Error(`uniform type ${c.type} is not supported yet.`)}t.executeProgram()}function xye(t,e,n){let s="";e.concat(n).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:h}=nE(t.packedInputs,o.shape,l);let d="",f="",p="";if(u.length===1&&t.packedInputs){const k=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];d=`${k[0]>1}_${k[1]>1}`}else if(u.length===2&&!t.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!t.packedInputs){const k=Pe(u);p=`${k[0]===l[1]}_${k[k.length-1]===l[1]}`}const g=o.shape.length,m=u.length===2&&yt(o.shape,l),y=ue(o.shape)===1,w=fd(o.shape,n.shape),b=!t.packedInputs&&g===n.shape.length&&yt(l,n.texData.texShape),C=t.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${g}_${b}_${c?h:""}_${u.length}_${y}_${w}_${m}_${d}_${f}_${p}_${C}_${a}`}else{const l=o.isUniform?"uniform":o.texData.texShape;s+=`${o.shape}_${l}_${a}`}});const r=t.userCode;let i=t.constructor.name;return i+="_"+s+"_"+r+`${oe().getNumber("WEBGL_VERSION")}`,i}function ys(t){return oe().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wye{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Yp.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Ms();this.outputShape=e,this.enableShapeUniforms=ys(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?ix(["r","c","d"],e):Pu(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bye{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Yp.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Ms();this.outputShape=e,this.enableShapeUniforms=ys(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?ix(["r","c","d"],e):Pu(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cye{constructor(e){this.variableNames=["A"],this.outTexUsage=Mr.DOWNLOAD;const n=Ms();this.outputShape=e,this.userCode=`
      ${w7}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sye{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Mr.DOWNLOAD;const n=Ms();this.outputShape=e,this.userCode=`
      ${w7}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iye={R:0,G:1,B:2,A:3};class cR{constructor(e,n=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Ms();this.outputShape=e,this.enableShapeUniforms=ys(this.outputShape.length);let i="result";n&&(i="floor(result * 255. + 0.5)");let o="";for(let a=0;a<s.length;a++){const l=s[a];o+=`
          if(offset == ${a}) {
            result = values[${Iye[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?tE():eE(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${o}
        }
        ${r.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kye{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Ms();this.outputShape=e,this.enableShapeUniforms=ys(this.outputShape.length);let r="",i="result";n&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const l=o*2+a;r+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?tE():eE(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tye(t){const e=Ms(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return c2e(t,n)}function Eye(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return p2e(t,e)}function Nye(t){const e=new Uint16Array([0,1,2,2,1,3]);return m2e(t,e)}function Dg(t,e,n,s,r,i){y2e(e,n);const o=g2e(t),a=t.TEXTURE_2D;return Te(t,()=>t.bindTexture(a,o)),Te(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),Te(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),Te(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),Te(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),oe().getNumber("WEBGL_VERSION")===1?Te(t,()=>t.texImage2D(a,0,s,e,n,0,r,i,null)):Te(t,()=>t.texStorage2D(a,1,s,e,n)),Te(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function k7(t){return t.internalFormatFloat}function _ye(t,e,n,s){const[r,i]=Rg(e,n);return Dg(t,r,i,k7(s),s.textureFormatFloat,t.FLOAT)}function T7(t){return t.internalFormatHalfFloat}function $ye(t,e,n,s){const[r,i]=Rg(e,n);return Dg(t,r,i,T7(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function E7(t){return t.downloadTextureFormat}function Rye(t,e,n,s){const[r,i]=Rg(e,n);return Dg(t,r,i,E7(s),t.RGBA,t.UNSIGNED_BYTE)}function N7(t){return t.internalFormatPackedFloat}function Aye(t,e,n,s){const[r,i]=Vd(e,n);return Dg(t,r,i,N7(s),t.RGBA,t.FLOAT)}function _7(t){return t.internalFormatPackedHalfFloat}function Dye(t,e,n,s){const[r,i]=Vd(e,n);return Dg(t,r,i,_7(s),t.RGBA,s.textureTypeHalfFloat)}function Pye(t,e,n){return Te(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),iR(t,e,"clipSpacePos",n,3,20,0)&&iR(t,e,"uv",n,2,20,12)}function Oye(t,e,n,s,r,i){Te(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,a,l;r instanceof Uint8Array?(o=new Uint8Array(n*s*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(o=new Float32Array(n*s*4),a=t.FLOAT,l=i.internalFormatPackedFloat),o.set(r),oe().getNumber("WEBGL_VERSION")===2?Te(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,s,t.RGBA,a,o)):Te(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,s,0,t.RGBA,a,o)),Te(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Fye(t,e,n){Te(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?oe().getNumber("WEBGL_VERSION")===2?Te(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):Te(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):oe().getNumber("WEBGL_VERSION")===2?Te(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):Te(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),Te(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Lye(t,e,n,s){const r=t.createBuffer();Te(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,r));const a=4*4*e*n;return Te(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),Te(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),Te(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),r}function Mye(t,e,n){const s=t,r=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function Bye(t,e,n,s){const[r,i]=Rg(e,n),o=4,a=new Uint8Array(n2e(e*n,o));return Te(t,()=>t.readPixels(0,0,r,i,s.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function Vye(t,e,n,s,r,i,o,a){const l=t,c=new Float32Array(s2e(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function Uye(t,e,n){const s=new Float32Array(e*n*4);return Te(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zw{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=oe().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,Q1e(n,e)):this.gl=Hi(n),e=this.gl,oe().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>Te(i,()=>i.createVertexArray()),this.bindVertexArray=o=>Te(i,()=>i.bindVertexArray(o)),this.deleteVertexArray=o=>Te(i,()=>i.deleteVertexArray(o)),this.getVertexArray=()=>Te(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Te(e,()=>i.createVertexArrayOES()),this.bindVertexArray=o=>Te(e,()=>i.bindVertexArrayOES(o)),this.deleteVertexArray=o=>Te(e,()=>i.deleteVertexArrayOES(o)),this.getVertexArray=()=>Te(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),oe().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=j0(this.gl,i),fi(this.gl,o))this.textureHalfFloatExtension=j0(this.gl,o);else if(oe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),fi(this.gl,r))this.colorBufferHalfFloatExtension=j0(this.gl,r);else if(oe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",fi(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(fi(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Eye(this.gl),this.indexBuffer=Nye(this.gl),this.framebuffer=v2e(this.gl),this.textureConfig=Q3(this.gl,this.textureHalfFloatExtension)}get debug(){return oe().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Te(e,()=>e.finish()),Te(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Te(e,()=>e.deleteFramebuffer(this.framebuffer)),Te(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Te(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Te(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),_ye(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),$ye(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),Rye(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),Fye(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,s,r){this.throwIfDisposed(),Oye(this.gl,e,n,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),Dye(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),Aye(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(oR(this.gl,this.framebuffer),this.outputTexture=null),Te(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,s){return this.downloadMatrixDriver(e,()=>Bye(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,s,r,i,o){return Vye(this.gl,e,n,s,r,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return Mye(this.gl,e,n)}createBufferFromTexture(e,n,s){this.bindTextureToFrameBuffer(e);const r=Lye(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,s;if(oe().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const o=r.clientWaitSync(i,0,0);return o===r.ALREADY_SIGNALED||o===r.CONDITION_SATISFIED},n=i}else oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(e,n,s){return this.downloadMatrixDriver(e,()=>Uye(this.gl,n,s))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=Tye(n));const s=d2e(n);Te(n,()=>n.attachShader(s,this.vertexShader)),Te(n,()=>n.attachShader(s,e)),f2e(n,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&Mw(n,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;Te(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Pye(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(Te(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Mw(this.gl,this.program),Te(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,s=!0){return this.throwIfDisposed(),s?w2e(this.gl,e,n):b2e(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),Te(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),C2e(this.gl,e,n,s)}setOutputMatrixTexture(e,n,s){this.setOutputMatrixTextureDriver(e,s,n)}setOutputPackedMatrixTexture(e,n,s){this.throwIfDisposed();const[r,i]=Vd(n,s);this.setOutputMatrixTextureDriver(e,r,i)}setOutputMatrixWriteRegion(e,n,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,n)}setOutputPackedMatrixWriteRegion(e,n,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Mw(this.gl,this.program),G0(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Te(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Te(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=j0(this.gl,oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await K_(()=>this.disposed||this.isQueryAvailable(e,oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=zye(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in oe().platform&&(s=oe().platform.setTimeoutCustom.bind(oe().platform)),K_(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Bw(this.gl,e,this.framebuffer),this.debug&&G0(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Bw(this.gl,this.outputTexture,this.framebuffer),this.debug&&G0(this.gl)):oR(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,n,s){this.throwIfDisposed();const r=this.gl;Bw(r,e,this.framebuffer),this.debug&&G0(r),this.outputTexture=e,Te(r,()=>r.viewport(0,0,n,s)),Te(r,()=>r.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(e,n,s,r){this.throwIfDisposed(),Te(this.gl,()=>this.gl.scissor(e,n,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function zye(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Wye,bincountImpl:$7,bincountReduceImpl:jye,bitwiseAndImpl:Gye,castImpl:Hye,ceilImpl:Kye,concatImpl:qye,equalImpl:Xye,expImpl:Yye,expm1Impl:Jye,floorImpl:Zye,gatherNdImpl:Qye,gatherV2Impl:eve,greaterImpl:tve,greaterEqualImpl:nve,lessImpl:sve,lessEqualImpl:rve,linSpaceImpl:ive,logImpl:ove,maxImpl:ave,maximumImpl:lve,minimumImpl:cve,multiplyImpl:uve,negImpl:hve,notEqualImpl:dve,prodImpl:fve,raggedGatherImpl:pve,raggedRangeImpl:mve,raggedTensorToTensorImpl:gve,rangeImpl:yve,rsqrtImpl:vve,scatterImpl:xve,sigmoidImpl:wve,simpleAbsImpl:R7,sliceImpl:bve,sparseFillEmptyRowsImpl:Cve,sparseReshapeImpl:Sve,sparseSegmentReductionImpl:A7,sqrtImpl:Ive,staticRegexReplaceImpl:kve,stridedSliceImpl:Tve,stringNGramsImpl:Eve,stringSplitImpl:Nve,stringToHashBucketFastImpl:_ve,subImpl:$ve,tileImpl:Rve,topKImpl:Ave,transposeImpl:sE,uniqueImpl:Dve}=Ffe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D7(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function $s(t,e){return e===1?[t]:D7(t,e)}function Pve(t,e){if(t===1)return"rc";let n="";for(let s=0;s<t;s++)n+=e[s],s<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ove{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=ys(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=$s("rc",this.rank),s=_t(this.rank),r=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let i=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${e[e.length-1-o]},`+i;n.push(i)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P7{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=ys(this.outputShape.length);let s="";for(let r=0;r<4;r++){let i="thisRC = rc;";r%2===1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),s+=`
        ${i}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${Fve(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?tE():eE(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function Fve(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?P2e(["r","c","d"],"inputShape"):Pu(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lve{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,s){const r=hR(n,s),i=dR(e,r,s);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=uR(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[i].pop();return this.usedTextures[i].push(l),l}let a;return r===Yn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Yn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Yn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Yn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Yn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(e,n,s,r){if(this.freeTextures==null)return;const i=hR(s,r),o=dR(n,i,r);o in this.freeTextures||(this.freeTextures[o]=[]);const a=uR(n,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=oe().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[o],u=c&&c.indexOf(e);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[u]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Mve(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function uR(t,e,n,s,r){const i=Bve(e,s);let o;if(r){const[l,c]=Vd(t[0],t[1]);o=l*c}else{const[l,c]=Rg(t[0],t[1]);o=l*c}const a=Mve(n,i);return o*a}function Bve(t,e){switch(t){case Yn.PACKED_2X2_FLOAT32:return N7(e);case Yn.PACKED_2X2_FLOAT16:return _7(e);case Yn.UNPACKED_FLOAT32:return k7(e);case Yn.UNPACKED_FLOAT16:return T7(e);case Yn.PACKED_4X1_UNSIGNED_BYTE:return E7(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function Vve(t){return oe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Yn.PACKED_2X2_FLOAT32:Yn.UNPACKED_FLOAT32:t?Yn.PACKED_2X2_FLOAT16:Yn.UNPACKED_FLOAT16}function hR(t,e){if(t===Mr.UPLOAD)return Yn.PACKED_2X2_FLOAT32;if(t===Mr.RENDER||t==null)return Vve(e);if(t===Mr.DOWNLOAD||t===Mr.PIXELS)return Yn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function dR(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class po{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=ys(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Ci="if (isnan(x)) return x;",Uve="return x;",fR="return abs(x);",zve="return (x >= 0.0) ? x : (exp(x) - 1.0);",Wve=Ci+`
  return (x < 0.0) ? 0.0 : x;
`,jve=Ci+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Ha="return x;",Gve="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hve="return x;",Kve=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,qve=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Xve=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Yve="return 1.0 / (1.0 + exp(-1.0 * x));";class ol{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=ys(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jve{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=ys(this.outputShape.length);const n=e.length,s=$s("rc",n),r=_t(n),i=Pve(n,s),o=s.slice(-2),a=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zve=nM,Qve=1e-7,exe=1e-4,q0={};function txe(t){return t in q0||(q0[t]={}),q0[t]}const nxe=oe().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),sxe=600;function rxe(){return oe().global.screen==null?1024:oe().global.screen.height*oe().global.screen.width*window.devicePixelRatio*sxe/1024/1024}class ox extends yk{nextDataId(){return ox.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!oe().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof zw)n=e;else{const s=Hi(oe().getNumber("WEBGL_VERSION"),e);n=new zw(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=Hi(oe().getNumber("WEBGL_VERSION"));n=new zw(s),this.binaryCache=txe(oe().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Lve(this.gpgpu),this.numMBBeforeWarning=rxe(),this.texData=new S5(this,io())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,s,r,i,o){const a=this.makeTensorInfo(n,s),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[r,i]},l.texShape=[r,i];const c=H0(n),u=new cR(c,!1,o),h=this.runWebGLProgram(u,[a],s,[[r,i]]);return h.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),h.dataId}write(e,n,s){if((oe().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||oe().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:n,dtype:s,values:e,usage:Mr.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,s,r,i){if(oe().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:n,usage:Mr.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:i,slice:o,shape:a,isPacked:l}=n;if(o!=null){let d;l?d=new ol(a,Ha):d=new po(a,Ha);const f=this.runWebGLProgram(d,[{dataId:e,shape:a,dtype:r}],r),p=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),p}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const c=this.activeTimers!=null;let u;c&&(u=Hs());let h;if(r==="complex64"){const d=this.readSync(i.real.dataId),f=this.readSync(i.imag.dataId);h=xa(d,f)}else h=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=Hs()-u),this.convertAndCacheOnCPU(e,h)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(g=>p.push(g))}const n=this.texData.get(e),{values:s,shape:r,slice:i,dtype:o,complexTensorInfos:a,isPacked:l}=n;if(i!=null){let p;l?p=new ol(r,Ha):p=new po(r,Ha);const g=this.runWebGLProgram(p,[{dataId:e,shape:r,dtype:o}],o),m=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),m}if(s!=null)return this.convertAndCacheOnCPU(e);if(oe().getBool("DEBUG")&&!oe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&oe().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(o!=="complex64"&&oe().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const p=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(p.texture.texture,...W0(r))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let h;if(o==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),g=p[0],m=p[1];h=xa(g,m)}else if(c==null)h=this.getValuesFromTexture(e);else{const p=ue(r);h=this.gpgpu.downloadFloat32MatrixFromBuffer(c,p)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){const p=this.gpgpu.gl;Te(p,()=>p.deleteBuffer(c))}const d=this.convertAndCacheOnCPU(e,h),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(p=>p(d)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&io().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e,n={}){const s=this.texData.get(e),{values:r,shape:i,slice:o,dtype:a,isPacked:l,texture:c}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let f;l?f=new ol(i,Ha):f=new po(i,Ha);const p=this.runWebGLProgram(f,[{dataId:e,shape:i,dtype:a}],a),g=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),g}if(c==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,n.customTexShape),h=io().makeTensorFromTensorInfo(u),d=this.texData.get(u.dataId);return Object.assign({tensorRef:h},d.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>Rl(r));return et(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return et(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const s=e[n];if(!a2e(s))throw oe().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:s,isPacked:r}=this.texData.get(e),i=ue(n);if(oe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const d=this.decode(e),f=this.texData.get(d.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...W0(n)).subarray(0,i);return this.disposeIntermediateTensorInfo(d),p}const o=oe().getBool("WEBGL_PACK")&&r===!0,a=o?H0(n):n,l=o?new Sye(a):new Cye(a),c=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:e}],"float32"),u=this.texData.get(c.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(c),h}timerAvailable(){return oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const i=ou(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=ou(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,r&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);a.kernelMs=kte(l),a.getExtraProfileInfo=()=>l.map((c,u)=>({name:o[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Hs(),endMs:null}}endTimer(e){return oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Hs(),e)}async getQueryTime(e){if(oe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:s,texShape:r,usage:i,isPacked:o,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(n,r,i,o)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=nxe){return oe().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&ue(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){Or("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return Zve(e.shape,n)}packedUnaryOp(e,n,s){const r=new ol(e.shape,n),i=this.compileAndRun(r,[e],s);return io().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=R7(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(oe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,fR,e.dtype);const n=new po(e.shape,fR),s=this.compileAndRun(n,[e]);return io().makeTensorFromTensorInfo(s)}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&vm(s[0])){const i=s.map(o=>Sl(o));r=this.write(i,e,n)}else r=this.write(s,e,n);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:n}}makeOutput(e,n,s){return io().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,s),this)}unpackTensor(e){const n=new Jve(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new Ove(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const s=[xd(e.shape),...wd(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},i=[xd(n),...wd(n)],o=new P7(i,s),a=!0,l=[s],c=this.runWebGLProgram(o,[r],e.dtype,l,a);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(e,n){const s=this.texData.get(e),{isPacked:r,shape:i,dtype:o}=s;if(n!=null){const d=ue(i),f=n[0]*n[1]*4;L(d<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=H0(i);let l;r?l=new bye(a):l=new wye(a);const c=!0,u=[n??W0(a)],h=this.runWebGLProgram(l,[{shape:a,dtype:o,dataId:e}],o,u,c,n);return{dtype:o,shape:i,dataId:h.dataId}}runWebGLProgram(e,n,s,r,i=!1,o){const a=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Yp.DENSE){const y=o??W0(e.outputShape);l.texShape=y.map(w=>w*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),ue(a.shape)===0)return l.values=ds(a.dtype,0),a;const c=[],u=n.map(y=>{if(y.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let w=this.texData.get(y.dataId);if(w.texture==null){if(!e.packedInputs&&ue(y.shape)<=oe().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:y.shape,texData:null,isUniform:!0,uniformValues:w.values};e.packedInputs&&(w.isPacked=!0,w.shape=y.shape)}if(this.uploadToGPU(y.dataId),!!w.isPacked!=!!e.packedInputs)y=w.isPacked?this.unpackTensor(y):this.packTensor(y),c.push(y),w=this.texData.get(y.dataId);else if(w.isPacked&&!W2(w.shape,y.shape)){const b=y,C=y.shape;y.shape=w.shape,y=this.packedReshape(y,C),c.push(y),w=this.texData.get(y.dataId),b.shape=C}return{shape:y.shape,texData:w,isUniform:!1}});this.uploadToGPU(a.dataId);const h={shape:a.shape,texData:l,isUniform:!1},d=xye(e,u,h),f=this.getAndSaveBinary(d,()=>yye(this.gpgpu,e,u,h)),p=this.activeTimers!=null;let g;p&&(g=this.startTimer()),oe().get("ENGINE_COMPILE_ONLY")||vye(this.gpgpu,f,u,h,r),c.forEach(y=>this.disposeIntermediateTensorInfo(y)),p&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)}));const m=oe().getNumber("WEBGL_FLUSH_THRESHOLD");if(m>0){const y=Hs();y-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=y)}if(!oe().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const y=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),y}return a}compileAndRun(e,n,s,r,i=!1){return s=s||n[0].dtype,this.runWebGLProgram(e,n,s,r,i)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(oe().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=re(()=>{if(!oe().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=oe().getBool("DEBUG");oe().set("DEBUG",!1);const n=this.abs(gt(1e-8)).dataSync()[0];if(oe().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Qve:exe}uploadToGPU(e){const n=this.texData.get(e),{shape:s,dtype:r,values:i,texture:o,usage:a,isPacked:l}=n;if(o!=null)return;const c=this.activeTimers!=null;let u;c&&(u=Hs());let h=n.texShape;if(h==null&&(h=k2e(s,l),n.texShape=h),i!=null){const d=H0(s);let f,p=h[1],g=h[0];const m=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!m)&&([p,g]=Vd(h[0],h[1])),l?f=new kye(d,m):f=new cR(d,m);const y=m?[g,p]:h,w=this.makeTensorInfo(y,r),b=this.texData.get(w.dataId);m?b.usage=Mr.PIXELS:b.usage=Mr.UPLOAD,b.texShape=y,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(w.dataId),p,g,i);const C=[[g,p]],$=this.runWebGLProgram(f,[w],r,C,!0),I=this.texData.get($.dataId);n.texShape=I.texShape,n.isPacked=I.isPacked,n.usage=I.usage,oe().get("ENGINE_COMPILE_ONLY")?this.disposeData($.dataId):(n.texture=I.texture,n.values=null,this.texData.delete($.dataId)),this.disposeIntermediateTensorInfo(w),c&&(this.uploadWaitMs+=Hs()-u)}else{const d=this.acquireTexture(h,a,r,l);n.texture=d}}convertAndCacheOnCPU(e,n){const s=this.texData.get(e),{dtype:r}=s;return n!=null&&(s.values=ixe(n,r)),s.values}acquireTexture(e,n,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,r)}computeBytes(e,n){return e[0]*e[1]*g2(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(n),r(!0)}catch(i){throw i}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await bM(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(x7(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:s,infLoc:r,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:l}=I7(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=i,e.outShapeLocation=o,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,s){e.channels=e.channels||"RGBA";const{texture:r,height:i,width:o,channels:a}=e,l=io().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(r,n,s,i,o,a);return io().makeTensorFromDataId(c,n,s,l)}}ox.nextDataId=0;function ixe(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let s=0;s<n.length;++s)n[s]=Math.round(t[s]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gL()&&xL("webgl",()=>new ox,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rE=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class xu{constructor(e,n,s){this.variableNames=["A","B"],this.outputShape=Xe(n,s),this.enableShapeUniforms=ys(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fu=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Gd{constructor(e,n,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Xe(n,s);const i=this.outputShape.length;this.enableShapeUniforms=ys(i);let o="";if(r)if(i===0||ue(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${_t(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=$s("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function br(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const oxe={kernelName:Bm,backendName:"webgl",kernelFunc:br};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tc(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,i=n.makeTensorInfo(s.shape,"complex64"),o=n.texData.get(i.dataId),a=br({inputs:{x:s},backend:n}),l=br({inputs:{x:r},backend:n});return o.complexTensorInfos={real:a,imag:l},i}const axe={kernelName:$k,backendName:"webgl",kernelFunc:tc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O7="return (a < 0.) ? b * a : a;",F7=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function lxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:i}=s,o=n.makeTensorInfo([],"float32",Hl(i,"float32")),a=oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gd(F7,r.shape,o.shape):new xu(O7,r.shape,o.shape),l=n.runWebGLProgram(a,[r,o],"float32");return n.disposeIntermediateTensorInfo(o),l}const cxe={kernelName:ev,backendName:"webgl",kernelFunc:lxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L7="return (a < 0.) ? b * a : a;",M7=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function uxe(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e,i=oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gd(M7,s.shape,r.shape):new xu(L7,s.shape,r.shape);return n.runWebGLProgram(i,[s,r],"float32")}const hxe={kernelName:xv,backendName:"webgl",kernelFunc:uxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hd="if (isnan(x)) return x;";function ct({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:s}){return({inputs:r,backend:i})=>{const{x:o}=r,a=i,l=s||o.dtype;if(a.shouldExecuteOnCPU([o])&&n!=null){const h=a.texData.get(o.dataId),d=n(h.values,l);return a.makeTensorInfo(o.shape,l,d)}const c=oe().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let u;return c?u=new ol(o.shape,e):u=new po(o.shape,t),a.runWebGLProgram(u,[o],l)}}function ts({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:i}){return({inputs:o,backend:a})=>{const{a:l,b:c}=o,u=a;if(s&&l.dtype==="complex64"){const p=u.texData.get(l.dataId),g=u.texData.get(c.dataId),[m,y]=[[p.complexTensorInfos.real,g.complexTensorInfos.real],[p.complexTensorInfos.imag,g.complexTensorInfos.imag]].map(b=>{const[C,k]=b,$={dataId:C.dataId,dtype:C.dtype,shape:l.shape},I={dataId:k.dataId,dtype:k.dtype,shape:c.shape},T=new xu(t,l.shape,c.shape);return u.runWebGLProgram(T,[$,I],xr(C.dtype,k.dtype))}),w=tc({inputs:{real:m,imag:y},backend:u});return u.disposeIntermediateTensorInfo(m),u.disposeIntermediateTensorInfo(y),w}const h=i||xr(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&r!=null){const p=u.texData.get(l.dataId).values,g=u.texData.get(c.dataId).values,m=l.dtype==="string"?wa(p):p,y=l.dtype==="string"?wa(g):g,[w,b]=r(l.shape,c.shape,m,y,h),C=u.makeTensorInfo(b,h),k=u.texData.get(C.dataId);return k.values=w,C}const d=oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return d?f=new Gd(e,l.shape,c.shape,n):f=new xu(t,l.shape,c.shape),u.runWebGLProgram(f,[l,c],h)}}function Jp(t,e=!1){if(t==="linear")return e?Hve:Uve;if(t==="relu")return e?qve:Wve;if(t==="elu")return e?Kve:zve;if(t==="relu6")return e?Xve:jve;if(t==="prelu")return e?M7:L7;if(t==="leakyrelu")return e?F7:O7;if(t==="sigmoid")return e?Yve:Gve;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B7{constructor(e,n,s,r=!1,i=!1,o=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=ys(this.outputShape.length);const u=r?e[1]:e[2],h=Math.ceil(u/2),d=r?"i * 2, rc.y":"rc.y, i * 2",f=i?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",y="";a&&(l?m=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?m=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:m=`vec4 activation(vec4 x) {
          ${a}
        }`,y="result = activation(result);");const w=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let b="rc.x",C="rc.x";e[0]<n[0]?b=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(C=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${m}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${h}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${b};
        int batchB = ${C};
        for (int i = 0; i < ${h}; i++) {
          vec4 a = getMatrixA(batchA, ${d});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${g[0]});
          result += (${p[1]} * ${g[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${w}

        ${y}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pR={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class mR{constructor(e,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Xe(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gR="return a * b;";function iE(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,i=xr(s.dtype,r.dtype);if(s.dtype==="complex64"){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),c=new mR(pR.REAL,s.shape,r.shape),u=new mR(pR.IMAG,s.shape,r.shape),h=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],d=n.runWebGLProgram(c,h,"float32"),f=n.runWebGLProgram(u,h,"float32"),p=tc({inputs:{real:d,imag:f},backend:n});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),p}if(n.shouldExecuteOnCPU([s,r])){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),[c,u]=uve(s.shape,r.shape,a.values,l.values,i),h=n.makeTensorInfo(u,i),d=n.texData.get(h.dataId);return d.values=c,h}let o;return oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new Gd(gR,s.shape,r.shape):o=new xu(gR,s.shape,r.shape),n.runWebGLProgram(o,[s,r],i)}const dxe={kernelName:qm,backendName:"webgl",kernelFunc:iE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fxe(t,e,n){const s=[xd(t.shape),...wd(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},i=[xd(e),...wd(e)],o=new P7(i,s),a=!0,l=[s],c=n.runWebGLProgram(o,[r],t.dtype,l,a);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ce(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:i}=s,o=n,a=ue(r.shape),l=k5(i,a),c=ue(l);L(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const u=o.texData.get(r.dataId);return u.isPacked&&!W2(r.shape,l)&&!(u.texture!==null&&W2(u.shape,l))?fxe(r,l,o):(o.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const pxe={kernelName:bv,backendName:"webgl",kernelFunc:Ce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yR{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];const a=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(n!=null){const h=1/n;c=`sumValue += dot(values * ${cd(h)?h.toPrecision(2):h}, ones);`}let u="";i%s>0&&(u=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mxe{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const u=Math.floor(s/4)*4,h=s%4;let d=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let p="";i%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${h===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${h===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${h===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gxe(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],s=jv(n);e.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return e}function Lu(t,e,n,s){const r=gxe(t.shape);let i=t;for(let o=0;o<r.length;o++){const{inSize:a,windowSize:l,outSize:c}=r[o];let u,h;n==="mean"?u=o===0?new yR({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},a):new yR({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c}):u=new mxe({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},n),h=i,i=s.runWebGLProgram(u,[i],e),h.dataId!==t.dataId&&s.disposeIntermediateTensorInfo(h)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yxe{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[n[o]];this.outputShape=s,this.rank=s.length;const r=_t(this.rank),i=vxe(n);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function vxe(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<t.length;r++)s[t[r]]=n[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xxe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let u=0;u<s.length;u++)s[u]=e[n[u]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=_t(this.rank),i=D7("rc",this.rank),o=new Array(this.rank);for(let u=0;u<n.length;u++)o[n[u]]=i[u];const a=`vec2(${o.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ax(t,e,n){const s=oe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new xxe(t.shape,e):new yxe(t.shape,e);return n.runWebGLProgram(s,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wxe(t,e,n,s){const r=e,i=t.shape.length,o=tt(r,t.shape);let a=o;const l=Zt(a,i),c=l!=null;let u=t;c&&(u=ax(t,l,s),a=un(a.length,i)),es("sum",a,i);const[h,d]=Wn(u.shape,a);let f=h;n&&(f=vn(h,o));const p=ue(d),m=ue(t.shape)/p,y=Ce({inputs:{x:u},attrs:{shape:[m,p]},backend:s}),w=hT(t.dtype),b=Lu(y,w,"sum",s),C=Ce({inputs:{x:b},attrs:{shape:f},backend:s});return s.disposeIntermediateTensorInfo(y),s.disposeIntermediateTensorInfo(b),c&&s.disposeIntermediateTensorInfo(u),C}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lx(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;return wxe(r,i,o,n)}const bxe={kernelName:Ev,backendName:"webgl",kernelFunc:lx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fs(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{perm:i}=s,o=n,a=r.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=r.shape[i[u]];let c;if(o.shouldExecuteOnCPU([r])){const h=o.texData.get(r.dataId).values,d=sE(h,r.shape,r.dtype,i,l);c=o.makeTensorInfo(l,r.dtype);const f=o.texData.get(c.dataId);f.values=d}else c=ax(r,i,o);return c}const Cxe={kernelName:Wh,backendName:"webgl",kernelFunc:Fs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V7=1e3;function j2({a:t,b:e,transposeA:n,transposeB:s,backend:r,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const c=t.shape.length,u=e.shape.length,h=n?t.shape[c-2]:t.shape[c-1],d=s?e.shape[u-1]:e.shape[u-2],f=n?t.shape[c-1]:t.shape[c-2],p=s?e.shape[u-2]:e.shape[u-1],g=t.shape.slice(0,-2),m=e.shape.slice(0,-2),y=ue(g),w=ue(m),C=Xe(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,p]);L(h===d,()=>`Error in matMul: inner shapes (${h}) and (${d}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const k=n?[y,h,f]:[y,f,h],$=s?[w,p,d]:[w,d,p],I=Ce({inputs:{x:t},backend:r,attrs:{shape:k}}),T=Ce({inputs:{x:e},backend:r,attrs:{shape:$}}),R=[I,T],E=Math.max(y,w),A=n?I.shape[1]:I.shape[2],F=i!=null,P=o!=null,Z=l==="leakyrelu",H=l!=null?Jp(l,!0):null,j=F||P||Z||H!=null;let ee;if((f===1||p===1)&&A>V7&&j===!1){let X=I,ie=T;n&&(X=Fs({inputs:{x:I},backend:r,attrs:{perm:[0,2,1]}}),R.push(X)),s&&(ie=Fs({inputs:{x:T},backend:r,attrs:{perm:[0,2,1]}}),R.push(ie));const de=p!==1,he=p===1;let fe=X;de&&(fe=Ce({inputs:{x:X},backend:r,attrs:{shape:[E,A,1]}}),R.push(fe));const ge=p===1?2:1;let pe=ie;he&&(pe=Ce({inputs:{x:ie},backend:r,attrs:{shape:[E,1,A]}}),R.push(pe));const we=iE({inputs:{a:fe,b:pe},backend:r});ee=lx({inputs:{x:we},backend:r,attrs:{axis:ge,keepDims:!0}}),R.push(we)}else{const X=xr(t.dtype,e.dtype),ie=new B7(k,$,[E,f,p],n,s,F,H,P,Z),de=[I,T];if(i!=null&&de.push(i),P&&de.push(o),Z){const he=r.makeTensorInfo([],"float32",Hl(a,"float32"));de.push(he),R.push(he)}ee=r.runWebGLProgram(ie,de,X)}const z=Ce({inputs:{x:ee},backend:r,attrs:{shape:C}});R.push(ee);for(const X of R)r.disposeIntermediateTensorInfo(X);return z}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sxe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=s;return j2({a:r,b:i,transposeA:l,transposeB:c,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:h,activation:u})}const Ixe={kernelName:y2,backendName:"webgl",kernelFunc:Sxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vR="return abs(x);";function kxe(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const i=n.texData.get(s.dataId),o=R7(i.values);return n.makeTensorInfo(s.shape,s.dtype,o)}let r;return oe().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new ol(s.shape,vR):r=new po(s.shape,vR),n.runWebGLProgram(r,[s],s.dtype)}const Txe={kernelName:Py,backendName:"webgl",kernelFunc:kxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Exe=Ci+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Nxe=ct({opSnippet:Exe}),_xe={kernelName:xm,backendName:"webgl",kernelFunc:Nxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $xe=Ci+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Rxe=ct({opSnippet:$xe}),Axe={kernelName:wm,backendName:"webgl",kernelFunc:Rxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xR="return a + b;",Dxe=ts({opSnippet:xR,packedOpSnippet:xR,supportsComplex:!0,cpuKernelImpl:Wye}),Pxe={kernelName:Pd,backendName:"webgl",kernelFunc:Dxe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oxe{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const s=[];this.variableNames.forEach(i=>{s.push(`float v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fxe{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const s=[];this.variableNames.forEach(i=>{s.push(`vec4 v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b1(t){const{inputs:e,backend:n}=t,s=e;if(s.length===1)return br({inputs:{x:s[0]},backend:n});if(s.length>oe().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=b1({inputs:s.slice(0,l),backend:n}),u=b1({inputs:s.slice(l),backend:n});return b1({inputs:[c,u],backend:n})}const r=s.map(l=>l.dtype).reduce((l,c)=>xr(l,c)),i=s.map(l=>l.shape),a=oe().getBool("WEBGL_PACK")?new Fxe(s[0].shape,i):new Oxe(s[0].shape,i);return n.runWebGLProgram(a,s,r)}const Lxe={kernelName:Sk,backendName:"webgl",kernelFunc:b1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=tt(i,r.shape);let c=l;const u=Zt(c,a);let h=r;u!=null&&(h=Fs({inputs:{x:r},backend:n,attrs:{perm:u}}),c=un(c.length,a)),es("all",c,a);const[d,f]=Wn(h.shape,c),p=ue(f),g=Ce({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}}),m=Lu(g,g.dtype,"all",n);let y;if(o){const w=vn(d,l);y=Ce({inputs:{x:m},backend:n,attrs:{shape:w}})}else y=Ce({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),u!=null&&n.disposeIntermediateTensorInfo(h),y}const Bxe={kernelName:Ik,backendName:"webgl",kernelFunc:Mxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=tt(i,r.shape);let c=l;const u=Zt(c,a);let h=r;u!=null&&(h=Fs({inputs:{x:r},backend:n,attrs:{perm:u}}),c=un(c.length,a)),es("any",c,a);const[d,f]=Wn(h.shape,c),p=ue(f),g=Ce({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}}),m=Lu(g,g.dtype,"any",n);let y;if(o){const w=vn(d,l);y=Ce({inputs:{x:m},backend:n,attrs:{shape:w}})}else y=Ce({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),u!=null&&n.disposeIntermediateTensorInfo(h),y}const Uxe={kernelName:kk,backendName:"webgl",kernelFunc:Vxe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zxe{constructor(e,n,s){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:o}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wxe{constructor(e,n,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,L(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],o=Math.ceil(i/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,c=_t(l),u=$s("coords",l);let h,d;if(o===1){d=l+1;const T=_t(d);h=`
        ${T} sourceLocR = ${T}(${u.join()}, 0);
        ++${u[l-1]};
        ${T} sourceLocG = ${T}(${u.join()}, 0);
        ++${u[l-2]};
        ${T} sourceLocA = ${T}(${u.join()}, 0);
        --${u[l-1]};
        ${T} sourceLocB = ${T}(${u.join()}, 0);
        --${u[l-2]};`}else d=l,h=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,d),p="."+f[d-1],g=f.map(T=>"int "+T),m=$s("sourceLocR",d-1).concat("inIdx.r"),y=$s("sourceLocG",d-1).concat("inIdx.g"),w=$s("sourceLocB",d-1).concat("inIdx.b"),b=$s("sourceLocA",d-1).concat("inIdx.a"),C=s==="max"?"greaterThan":"lessThan",k=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${w.join()}),
                             getBestIndicesAChannel(${b.join()})));`,$=`vec4(
            getAChannel(${m.join()}),
            hasNextCol ? getAChannel(${y.join()}) : 0.,
            hasNextRow ? getAChannel(${w.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,I=r?"":`
      float getBestIndicesAChannel(${g.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${g.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${I}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${h}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${$};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${k}
          vec4 candidate = ${$};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${C}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U7(t,e,n,s=null){let r=e.shape[0],i=e.shape[1];s!=null&&(r=s.shape[0],i=s.shape[1]);const o=jv(i),a={windowSize:o,inSize:i,batchSize:r,outSize:Math.ceil(i/o)},l=new zxe(a,n,s==null),c=[e];s!=null&&c.push(s);const u=t.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;const h=U7(t,e,n,u);return t.disposeIntermediateTensorInfo(u),h}function z7(t,e,n,s=null){const r=s!=null?s.shape:e.shape,i=r[r.length-1],o=jv(i),a=new Wxe(r,o,n,s==null),l=s==null?[e]:[e,s],c=t.runWebGLProgram(a,l,"int32");if(c.shape.length===e.shape.length){const u=z7(t,e,n,c);return t.disposeIntermediateTensorInfo(c),u}return c}function W7(t,e,n,s){const r=[n];if(es("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!oe().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],o=t.texData.get(e.dataId),a=o!==null&&o.isPacked;let l=e;a&&(l=t.unpackTensor(e),i.push(l));const[c,u]=Wn(l.shape,r),h=ue(u),d=Ce({inputs:{x:l},backend:t,attrs:{shape:[-1,h]}});i.push(d);const f=U7(t,d,s);i.push(f);const p=Ce({inputs:{x:f},backend:t,attrs:{shape:c}});return i.forEach(g=>t.disposeIntermediateTensorInfo(g)),p}return z7(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;let o=tt(i,r.shape);const a=Zt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=Fs({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=un(o.length,l.shape.length)),es("argMax",[o[0]],l.shape.length);const u=W7(n,l,o[0],"max");return c.forEach(h=>n.disposeIntermediateTensorInfo(h)),u}const Gxe={kernelName:Oy,backendName:"webgl",kernelFunc:jxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;let o=tt(i,r.shape);const a=Zt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=Fs({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=un(o.length,l.shape.length)),es("argMin",[o[0]],l.shape.length);const u=W7(n,l,o[0],"min");return c.forEach(h=>n.disposeIntermediateTensorInfo(h)),u}const Kxe={kernelName:Fy,backendName:"webgl",kernelFunc:Hxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qxe=Ci+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Xxe=ct({opSnippet:qxe}),Yxe={kernelName:bm,backendName:"webgl",kernelFunc:Xxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jxe=Ci+"return log(x + sqrt(x * x + 1.0));",Zxe=ct({opSnippet:Jxe}),Qxe={kernelName:Cm,backendName:"webgl",kernelFunc:Zxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ewe=Ci+`
  return atan(x);
`,twe=ct({opSnippet:ewe}),nwe={kernelName:Sm,backendName:"webgl",kernelFunc:twe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const swe=rE+`
  return atan(a, b);
`,rwe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Fu+`
  return result;
`,iwe=ts({opSnippet:swe,packedOpSnippet:rwe}),owe={kernelName:km,backendName:"webgl",kernelFunc:iwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const awe=Ci+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,lwe=ct({opSnippet:awe}),cwe={kernelName:Im,backendName:"webgl",kernelFunc:lwe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zp{constructor(e,n,s,r=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const g=n==="avg",m=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,y=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let w="0.0";if(g||(w="-1.0 / 1e-20"),s){const T=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${T} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?i?m:y:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const b="max";let C=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(C="avgValue / max(count, 1.0)");const k=Math.floor(o/4)*4,$=o%4,I=`
      if (${g}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${w};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${w});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${h};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${k}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${I}
          }

          int xC = xCCorner + ${k};
          if (${$===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${I}
          } else if (${$===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${I}
          } else if (${$===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${I}
          }
        }
        setOutput(${C});
      }
    `}}class oE{constructor(e,n,s,r=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideDepth,l=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,h=e.dilationHeight,d=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,g=e.effectiveFilterWidth,m=e.padInfo.front,y=e.padInfo.top,w=e.padInfo.left;this.outputShape=e.outShape;const b=n==="avg";let C="0.0";if(b||(C="-1.0 / 1e-20"),s){const E=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${m}, ${y}, ${w});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${h}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${g};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${E} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${g} +
                      wR * ${g} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const k="max";let $=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&($="avgValue / max(count, 1.0)");const I=Math.floor(o/4)*4,T=o%4,R=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${k}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${m}, ${y}, ${w});
      const float initializationValue = ${C};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${C});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${h}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${I}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${R}
            }

            int xC = xCCorner + ${I};
            if (${T===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${R}
            } else if (${T===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${R}
            } else if (${T===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${R}
            }
          }
        }
        setOutput(${$});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uwe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Ag(r,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;L(ms(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=wi(r.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&yt(u.inShape,u.outShape))return br({inputs:{x:r},backend:n});const h=new Zp(u,"avg",!1);return n.runWebGLProgram(h,[r],"float32")}const hwe={kernelName:Ly,backendName:"webgl",kernelFunc:uwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dwe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s,u=[1,1,1],h=ka(r.shape,i,o,u,a,l,c),d=new oE(h,"avg",!1);return n.runWebGLProgram(d,[r],"float32")}const fwe={kernelName:My,backendName:"webgl",kernelFunc:dwe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pwe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=l-1-e.padInfo.top,h=c-1-e.padInfo.left,d=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${h});
      const float avgMultiplier = float(${d});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class mwe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,h=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=h-1-e.padInfo.front,g=d-1-e.padInfo.top,m=f-1-e.padInfo.left,y=1/(n*s*r);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${g}, ${m});
      const float avgMultiplier = float(${y});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gwe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,h=[1,1,1],d=ka(o.shape,a,l,h,c,u),f=new mwe(d);return n.runWebGLProgram(f,[r],o.dtype)}const ywe={kernelName:Ek,backendName:"webgl",kernelFunc:gwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vwe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i;Ag([r,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=wi(o.shape,a,l,1,c),h=new pwe(u);return n.runWebGLProgram(h,[r],o.dtype)}const xwe={kernelName:Tk,backendName:"webgl",kernelFunc:vwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wwe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i}=e,{transposeA:o,transposeB:a}=s;return j2({a:r,b:i,transposeA:o,transposeB:a,backend:n})}const bwe={kernelName:By,backendName:"webgl",kernelFunc:wwe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cwe{constructor(e,n,s,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Xe(e,n),Xe(e,s);let a="0.0";r!=null&&(Xe(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";i!=null&&(Xe(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Swe{constructor(e,n,s,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Xe(e,n),Xe(e,s);let a="vec4(0.0)";r!=null&&(Xe(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(Xe(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iwe=({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:r,variance:i,offset:o,scale:a}=t;L(r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),L(o==null||r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),L(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[s,r,i];let u=null;o!=null&&(u=o.shape,c.push(o));let h=null;a!=null&&(h=a.shape,c.push(a));const d=oe().getBool("WEBGL_PACK_NORMALIZATION")?new Swe(s.shape,r.shape,i.shape,u,h,l):new Cwe(s.shape,r.shape,i.shape,u,h,l);return e.runWebGLProgram(d,c,c[0].dtype)},kwe={kernelName:Jy,backendName:"webgl",kernelFunc:Iwe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Twe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=_t(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=Ewe(this.rank);let r;const i=e.map((o,a)=>`sourceLoc.${aS[a]} = start[${a}] + coords.${aS[a]};`);r=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const aS=["x","y","z","w","u","v"];function Ewe(t){if(t===1)return"sourceLoc";if(t<=6)return aS.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nwe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=_t(this.rank),s=$s("coords",this.rank),r=$s("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,o=`getChannel(getSource(${r.join()}), ${i})`,a=`
      result.x = ${o};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${o};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${o};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${o};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((u,h)=>`start[${h}]`).join()});`:e.map((u,h)=>`${r[h]} = ${s[h]} + start[${h}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _we(t,e,n,s){const r=s.texData.get(t.dataId),i=s.makeTensorInfo(n,t.dtype),o=s.texData.get(i.dataId);Object.assign(o,r),o.refCount=1,o.shape=n,o.dtype=t.dtype;let a=t3(e,Pe(t.shape));r.slice&&(a+=r.slice.flatOffset),o.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||t.dataId};const l=s.dataRefCount.get(o.slice.origDataId)||1;return s.dataRefCount.set(o.slice.origDataId,l+1),i}function Kd(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,size:o}=s,[a,l]=Wv(r,i,o);if(ZT(r,a,l),ue(l)===0)return n.makeTensorInfo(l,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||r.dtype==="string"){const h=n.texData.get(r.dataId),d=bve(h.values,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,d)}const{isPacked:c}=n.texData.get(r.dataId),u=e3(r.shape,a,l);if(c||!u){const h=oe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Nwe(l):new Twe(l),d=[a];return n.runWebGLProgram(h,[r],r.dtype,d)}return n.uploadToGPU(r.dataId),_we(r,a,l,n)}const $we={kernelName:Tv,backendName:"webgl",kernelFunc:Kd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rwe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,crops:o}=s;L(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((w,b)=>w*b),l=xg(r.shape,i,a),c=wg(l.length,i.length),u=bg(r.shape,i,a),h=o3(o,i.length),d=a3(u,o,i.length),f=[],p=Ce({inputs:{x:r},backend:n,attrs:{shape:l}}),g=Fs({inputs:{x:p},backend:n,attrs:{perm:c}}),m=Ce({inputs:{x:g},backend:n,attrs:{shape:u}}),y=Kd({inputs:{x:m},backend:n,attrs:{begin:h,size:d}});return f.push(p),f.push(g),f.push(m),f.forEach(w=>n.disposeIntermediateTensorInfo(w)),y},Awe={kernelName:Vy,backendName:"webgl",kernelFunc:Rwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dwe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o}=s,a=n.readSync(r.dataId),l=n.readSync(i.dataId),c=$7(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const Pwe={kernelName:Nk,backendName:"webgl",kernelFunc:Dwe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Owe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Fwe=`
  return float(int(a.r) & int(b.r));
`;function Lwe(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,i=oe().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=oe().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,r])||o===1){const l=n.texData.get(s.dataId).values,c=n.texData.get(r.dataId).values,[u,h]=Gye(s.shape,r.shape,l,c,s.dtype),d=n.makeTensorInfo(h,s.dtype),f=n.texData.get(d.dataId);return f.values=u,d}let a;return i?a=new Gd(Owe,s.shape,r.shape,!1):a=new xu(Fwe,s.shape,r.shape),n.runWebGLProgram(a,[s,r],s.dtype)}const Mwe={kernelName:_k,backendName:"webgl",kernelFunc:Lwe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bwe(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,i=n.readSync(s.dataId),o=n.readSync(r.dataId),a=Xe(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Vwe={kernelName:R5,backendName:"webgl",kernelFunc:Bwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uwe="return float(a != b);",j7=ts({opSnippet:Uwe,cpuKernelImpl:dve,dtype:"bool"}),zwe={kernelName:pv,backendName:"webgl",kernelFunc:j7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pg(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return br({inputs:{x:r.complexTensorInfos.real},backend:n})}const Wwe={kernelName:eT,backendName:"webgl",kernelFunc:Pg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jwe="return float(int(x));";function Gwe(t,e){const n=new po(t.shape,jwe),s=e.runWebGLProgram(n,[t],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lS(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return br({inputs:{x:r},backend:n});const o=Bn(r.shape),a=lS({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),l=tc({inputs:{real:a,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(a),l}if(r.dtype==="complex64"){const o=Pg({inputs:{input:r},backend:n}),a=lS({inputs:{x:o},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(o),a}if(!T5(r.dtype,i)){const o=br({inputs:{x:r},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(n.shouldExecuteOnCPU([r])){const o=n.texData.get(r.dataId).values,[a,l,c]=Hye(o,r.shape,r.dtype,i);return n.makeTensorInfo(a,l,c)}if(i==="int32")return Gwe(r,n);if(i==="bool"){const o=n.makeTensorInfo([],"bool",ds("bool",1)),l=j7({inputs:{a:r,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${i}`)}const Hwe={kernelName:Tm,backendName:"webgl",kernelFunc:lS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wR="return ceil(x);",Kwe=ct({opSnippet:wR,packedOpSnippet:wR,cpuKernelImpl:Kye}),qwe={kernelName:Em,backendName:"webgl",kernelFunc:Kwe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xwe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ywe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jwe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{clipValueMin:i,clipValueMax:o}=s;let a;oe().getBool("WEBGL_PACK_CLIP")?a=new Ywe(r.shape):a=new Xwe(r.shape);const l=[[i],[o]];return n.runWebGLProgram(a,[r],r.dtype,l)}const Zwe={kernelName:Nm,backendName:"webgl",kernelFunc:Jwe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qwe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bR(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function ebe(t){const{inputs:e,backend:n}=t,{x:s}=e,r=n.texData.get(s.dataId),i=new Qwe(s.shape),o=[bR(s,r.complexTensorInfos.real),bR(s,r.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}const tbe={kernelName:Uy,backendName:"webgl",kernelFunc:ebe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nbe{constructor(e){this.outputShape=[],this.outputShape=Io(e,1),this.variableNames=e.map((o,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const a=n[o-1];s.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const r=n.length,i=n[n.length-1];s.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sbe{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Io(e,n);const s=this.outputShape,r=s.length,i=_t(r),o=$s("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((g,m)=>`T${m}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let g=1;g<l.length;g++)l[g]=l[g-1]+e[g][n];const c=a[n],u=a.slice(-2),h=a.join();let d=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${h}), vec2(${u.join()}));
        }`;for(let g=1;g<l.length;g++){const m=l[g-1];d+=`
        if (${c} < ${l[g]}  && ${c} >= ${l[g-1]}) {
          return getChannel(
            getT${g}(${X0(a,c,m)}),
            vec2(${X0(u,c,m)}));
        }`}const f=l.length,p=l[l.length-1];d+=`
        return getChannel(
          getT${f}(${X0(a,c,p)}),
          vec2(${X0(u,c,p)}));`,this.userCode=`
      float getValue(${a.map(g=>"int "+g)}) {
        ${d}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[r-1]} = ${o[r-1]} + 1;
        if (${o[r-1]} < ${s[r-1]}) {
          result.g = getValue(${o});
        }

        ${o[r-2]} = ${o[r-2]} + 1;
        if (${o[r-2]} < ${s[r-2]}) {
          result.a = getValue(${o});
        }

        ${o[r-1]} = ${o[r-1]} - 1;
        if (${o[r-2]} < ${s[r-2]} &&
            ${o[r-1]} < ${s[r-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function X0(t,e,n){const s=t.indexOf(e);return t.map((i,o)=>o===s?`${i} - ${n}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cx(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return br({inputs:{x:r.complexTensorInfos.imag},backend:n})}const rbe={kernelName:Hk,backendName:"webgl",kernelFunc:cx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hf(t,e,n){const s=t[0].dtype;if(s==="complex64"){const f=t.map(w=>Pg({inputs:{input:w},backend:n})),p=t.map(w=>cx({inputs:{input:w},backend:n})),g=Hf(f,e,n),m=Hf(p,e,n),y=tc({inputs:{real:g,imag:m},backend:n});return f.forEach(w=>n.disposeIntermediateTensorInfo(w)),p.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),y}let r=n.shouldExecuteOnCPU(t);if(s==="string"&&(r=!0),r){const f=t.map(C=>{const $=[-1,ue(C.shape.slice(e))];return Ce({inputs:{x:C},backend:n,attrs:{shape:$}})}),p=f.map(C=>({vals:n.readSync(C.dataId),shape:C.shape})),g=Io(f.map(C=>C.shape),1),m=f[0].shape[0]===1,y=qye(p,g,s,m),w=Io(t.map(C=>C.shape),e),b=n.makeTensorInfo(w,s,y);return f.forEach(C=>n.disposeIntermediateTensorInfo(C)),b}const i=t.filter(f=>ue(f.shape)>0),o=oe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const f=o?new po(t[0].shape,Ha):new ol(t[0].shape,Ha);return n.runWebGLProgram(f,t,s)}const a=oe().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>a){const f=[];for(let g=0;g<i.length;g+=a){const m=i.slice(g,g+a);f.push(Hf(m,e,n))}const p=Hf(f,e,n);for(const g of f)n.disposeIntermediateTensorInfo(g);return p}if(o){const f=new sbe(i.map(p=>p.shape),e);return n.runWebGLProgram(f,i,s)}const{tensors2D:l,outShape:c}=ibe(i,e,n),u=new nbe(l.map(f=>f.shape)),h=n.runWebGLProgram(u,l,s);l.forEach(f=>n.disposeIntermediateTensorInfo(f));const d=Ce({inputs:{x:h},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(h),d}function ibe(t,e,n){const s=Io(t.map(i=>i.shape),e);return{tensors2D:t.map(i=>Ce({inputs:{x:i},attrs:{shape:[-1,ue(i.shape.slice(e))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G7(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,i=tt(r,e[0].shape)[0],o=e.map(c=>c.shape);s3(o,i);const a=Io(e.map(c=>c.shape),i);if(ue(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(c=>ue(c.shape)>0);return l.length===1?br({inputs:{x:l[0]},backend:n}):Hf(l,i,n)}const obe={kernelName:zy,backendName:"webgl",kernelFunc:G7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H7{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,h=e.dilationWidth,d=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,g=e.inChannels%4,m=e.dataFormat==="channelsLast",y=m?1:2,w=m?2:3,b=m?3:1;let C="",k="";s&&(r?C=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?C=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:C=`
          float activation(float x) {
            ${s}
          }
        `,k="result = activation(result);");const $=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${C}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${y}], coords[${w}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${h};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${m}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${g===1}) {

              if (${m}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${g===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${m}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${g===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${m}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${$}
        ${k}
        setOutput(result);
      }
    `}}class abe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,h=e.filterDepth,d=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,g=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${a});
      const ivec3 pads = ivec3(${n}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${h}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${g===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${g===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${g===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K7{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ys(this.outputShape.length);const o=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,h=u;let d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let m=0;m<u;m++)d+=`
           vec4 xTexelC${m*2};
           int xTexelC${m*2}Ready;
           vec4 xTexelC${m*2+1};
           int xTexelC${m*2+1}Ready;
           vec4 xC${m};`;d+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let m=0;m<u;m++)d+=`
           xTexelC${m*2} = vec4(0.0);
           xTexelC${m*2}Ready = 0;
           xTexelC${m*2+1} = vec4(0.0);
           xTexelC${m*2+1}Ready = 0;
           xC${m} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let m=0;m<(h+1)/2;m++){const y=m*2;if(d+=`
           xC = xCCorner + ${y*l};
           `,a===1){if(y<u&&(o%2===1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }
               `,l===1&&y>0?d+=`
                 xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                   } else {
                     xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xC${y} = xTexelC${y};
                 `,y+1<u)){const w=o%2===0?vk(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${w};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                     xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${y+1}.zw = vec2(0.0);
                     }
                     xTexelC${y+1}Ready = 1;
                   }
                   `,l>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                     } else {
                      xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                     }
                     `:d+=`
                     xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                     `):w===1?d+=`
                     xC${y+1} = xTexelC${y};
                     `:d+=`
                     xCOffset = xC + ${w};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                       xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${y+1}.zw = vec2(0.0);
                       }
                       xTexelC${y+1}Ready = 1;
                     }

                     xC${y+1} = xTexelC${y+1};
                     `}}else y<u&&(o%2===1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.0);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
               `,y+1<u&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(
                   xTexelC${y}.xy, xTexelC${y+1}.xy);
               `,y+1<u&&(d+=`
                   xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                 `)));y<u&&(d+=`
             wTexel = getW(r, ${y}, d1, d2);
             dotProd += xC${y}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${y}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,y+1<u&&(d+=`
               wTexel = getW(r, ${y+1}, d1, d2);
               dotProd += xC${y+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${y+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   `,d+=`
     }
   `,d+=`
     }
   `;let f="",p="";s&&(r?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:i?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:f=`vec4 activation(vec4 x) {
           ${s}
         }`,p="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${g}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lbe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=ys(this.outputShape.length);const{dataFormat:s}=n,r=Ms(),i=s==="channelsLast",o=i?1:2,a=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let h=0;h<=1;h++)c+=`
          blockIndex = rc.z + ${h};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+h}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+h}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G2(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function q7({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const l=t.shape,c=s.texData.get(t.dataId),u=n.inChannels,h=l[0]*l[1]*l[2],d=n.outChannels,f=n.dataFormat==="channelsLast",p=!1,g=!1;let m;const y=[];if(i!=null){const C=G2(i.shape,f);C!=null&&(i=Ce({inputs:{x:i},backend:s,attrs:{shape:C}}),y.push(i))}if(r!=null){const C=G2(r.shape,f);C!=null&&(r=Ce({inputs:{x:r},backend:s,attrs:{shape:C}}),y.push(r))}if(!((h===1||d===1)&&u>V7)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&yt(c.shape.slice(-3),l.slice(-3))){const C=l[0]*l[1]*(l[2]+1),k={dataId:t.dataId,shape:[1,C,n.inChannels],dtype:t.dtype},$=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,L(W2(c.shape,k.shape),()=>`packed reshape ${c.shape} to ${k.shape} isn't free`);const I=Ce({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});y.push(I);const T=j2({a:k,b:I,backend:s,transposeA:p,transposeB:g,bias:r,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),R=s.texData.get(T.dataId);L(R.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=$,R.shape=n.outShape,m=br({inputs:{x:T},backend:s}),m.shape=n.outShape,y.push(T)}else{const C=n.outHeight*n.outWidth,k=Ce({inputs:{x:t},backend:s,attrs:{shape:f?[n.batchSize,C,n.inChannels]:[n.batchSize,n.inChannels,C]}}),$=Ce({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),I=j2({a:f?k:$,b:f?$:k,transposeA:!f,transposeB:g,backend:s,bias:r,activation:a,preluActivationWeights:i,leakyreluAlpha:o});m=Ce({inputs:{x:I},backend:s,attrs:{shape:n.outShape}}),y.push(k),y.push($),y.push(I)}for(const C of y)s.disposeIntermediateTensorInfo(C);return m}function X7({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:h,outHeight:d,dataFormat:f}=n,p=f==="channelsLast",g=l*c*u,m=d*h,y=[n.batchSize,g,m],w=!0,b=!1,C=[];if(i!=null){const z=G2(i.shape,p);z!=null&&(i=Ce({inputs:{x:i},backend:s,attrs:{shape:z}}),C.push(i))}if(r!=null){const z=G2(r.shape,p);z!=null&&(r=Ce({inputs:{x:r},backend:s,attrs:{shape:z}}),C.push(r))}const k=Ce({inputs:{x:e},backend:s,attrs:{shape:[1,g,ue(e.shape)/g]}});C.push(k);const $=new lbe(y,n),I=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],T=s.runWebGLProgram($,[t],"float32",I),R=Ce({inputs:{x:T},backend:s,attrs:{shape:y}});C.push(T),C.push(R);const E=r!=null,A=i!=null,F=a==="leakyrelu",P=a?Jp(a,!0):null,Z=new B7(p?R.shape:k.shape,p?k.shape:R.shape,p?[n.batchSize,m,n.outChannels]:[n.batchSize,n.outChannels,m],w,b,E,P,A,F),H=p?[R,k]:[k,R];if(r&&H.push(r),A&&H.push(i),F){const z=s.makeTensorInfo([],"float32",Hl(o,"float32"));H.push(z),C.push(z)}const j=s.runWebGLProgram(Z,H,"float32"),ee=Ce({inputs:{x:j},backend:s,attrs:{shape:n.outShape}});C.push(j);for(const z of C)s.disposeIntermediateTensorInfo(z);return ee}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s,h=Ta(l),d=Qn(r.shape,i.shape,o,c,a,u,!1,h);let f;if(d.filterHeight===1&&d.filterWidth===1&&d.dilationHeight===1&&d.dilationWidth===1&&d.strideHeight===1&&d.strideWidth===1&&(d.padInfo.type==="SAME"||d.padInfo.type==="VALID"))f=q7({x:r,filter:i,convInfo:d,backend:n});else if(d.strideWidth<=2&&h==="channelsLast"&&oe().getBool("WEBGL_EXP_CONV")){const g=new K7(d),m=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];f=n.runWebGLProgram(g,[r,i],"float32",m)}else if(oe().getBool("WEBGL_CONV_IM2COL"))f=X7({x:r,filter:i,convInfo:d,backend:n});else{const g=new H7(d);f=n.runWebGLProgram(g,[r,i],"float32")}const p=Ce({inputs:{x:f},backend:n,attrs:{shape:d.outShape}});return n.disposeIntermediateTensorInfo(f),p}const ube={kernelName:Wy,backendName:"webgl",kernelFunc:cbe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hbe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class dbe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=s-1-e.padInfo.left,c=o?1:2,u=o?2:3,h=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${h}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class fbe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class pbe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,c=s-1-e.padInfo.top,u=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s,h=Ta(l),d=Qn(r.shape,u,o,1,a,c,!1,h),f=new hbe(d);return n.runWebGLProgram(f,[r,i],"float32")}const gbe={kernelName:Rk,backendName:"webgl",kernelFunc:mbe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ybe{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=ys(this.outputShape.length);const n=e.filterHeight,s=e.filterWidth,r=n-1-e.padInfo.top,i=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vbe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s,h=Ta(c),d=Qn(o,i.shape,a,1,l,u,!1,h);if(oe().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&h==="channelsLast"){const f=[[d.strideHeight,d.strideWidth]],p=new ybe(d);return n.runWebGLProgram(p,[r,i],"float32",f)}else{const f=new dbe(d);return n.runWebGLProgram(f,[r,i],"float32")}}const xbe={kernelName:jy,backendName:"webgl",kernelFunc:vbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s,c=ql(r.shape,i.shape,o,l,a),u=new abe(c);return n.runWebGLProgram(u,[r,i],"float32")}const bbe={kernelName:Gy,backendName:"webgl",kernelFunc:wbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,filterShape:l}=s,c=ql(r.shape,l,o,1,a),u=new fbe(c);return n.runWebGLProgram(u,[r,i],"float32")}const Sbe={kernelName:Ak,backendName:"webgl",kernelFunc:Cbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ibe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{pad:o,strides:a,inputShape:l}=s,c=ql(l,i.shape,a,1,o),u=new pbe(c);return n.runWebGLProgram(u,[r,i],"float32")}const kbe={kernelName:Dk,backendName:"webgl",kernelFunc:Ibe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tbe=Hd+`
  return cos(x);
`,Ebe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Fu}
  return result;
`,Nbe=ct({opSnippet:Tbe,packedOpSnippet:Ebe}),_be={kernelName:_m,backendName:"webgl",kernelFunc:Nbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $be=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Rbe=ct({opSnippet:$be}),Abe={kernelName:$m,backendName:"webgl",kernelFunc:Rbe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dbe{constructor(e,n,s,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,l,c]=e,[u]=n,[h,d]=s;this.outputShape=[u,h,d,c];const f=r==="bilinear"?1:0,[p,g]=[`${a-1}.0`,`${l-1}.0`],[m,y,w]=h>1?[`${(a-1)/(h-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[b,C,k]=d>1?[`${(l-1)/(d-1)}`,"(x2-x1) * width_ratio",`x1*${g} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${g}`];this.userCode=`
      const float height_ratio = float(${m});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${y};
        float width_scale = ${C};

        float in_y = ${w};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${k};
        if( in_x < 0.0 || in_x > ${g} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pbe=t=>{const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=s,u=new Dbe(r.shape,i.shape,a,l,c);return n.runWebGLProgram(u,[r,i,o],"float32")},Obe={kernelName:Ok,backendName:"webgl",kernelFunc:Pbe};var Qp;(function(t){t.Prod="*",t.Sum="+"})(Qp||(Qp={}));class CR{constructor(e,n,s,r){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===Qp.Prod?"1.0":"0.0",a=s?o:`getX(${SR(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";s?(c=r?`end != ${l-1}`:"end != 0",u=r?"end + 1":"end - 1"):(c=r?`end + pow2 < ${l}`:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${_t(i)} coords = getOutputCoords();
        int end = ${IR(i,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${IR(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${SR(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function SR(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function IR(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y7(t,e,n,s,r,i){const o=e.shape.length,a=Zt([s],o);let l=e;a!=null&&(l=Fs({inputs:{x:e},backend:n,attrs:{perm:a}}));const c=un(1,o)[0];if(c!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const u=l.shape[c];let h=br({inputs:{x:l},backend:n});for(let d=0;d<=Math.ceil(Math.log2(u))-1;d++){const f=new CR(t,l.shape,!1,i),p=[[d]],g=h;h=n.runWebGLProgram(f,[h],h.dtype,p),n.disposeIntermediateTensorInfo(g)}if(r){const d=new CR(t,l.shape,r,i),f=h;h=n.runWebGLProgram(d,[h],h.dtype),n.disposeIntermediateTensorInfo(f)}if(a!=null){const d=Xl(a),f=Fs({inputs:{x:h},backend:n,attrs:{perm:d}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(l),f}return h}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;return Y7(Qp.Prod,r,n,i,o,a)}const Lbe={kernelName:Pk,backendName:"webgl",kernelFunc:Fbe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;return Y7(Qp.Sum,r,n,i,o,a)}const Bbe={kernelName:Hy,backendName:"webgl",kernelFunc:Mbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o,binaryOutput:a}=s;if(r.shape.length===1){const l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=$7(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(i),u=jye(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const Ube={kernelName:Fk,backendName:"webgl",kernelFunc:Vbe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zbe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:i,dataFormat:o}=s,a=r.shape[0],l=o==="NHWC"?r.shape[1]:r.shape[2],c=o==="NHWC"?r.shape[2]:r.shape[3],u=o==="NHWC"?r.shape[3]:r.shape[1],h=l*i,d=c*i,f=u/(i*i),p=o==="NHWC"?[a,h,d,f]:[a,f,h,d],g=new zbe(p,i,o);return n.runWebGLProgram(g,[r],r.dtype)}const jbe={kernelName:Lk,backendName:"webgl",kernelFunc:Wbe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class J7{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ys(this.outputShape.length);const o=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let c="",u="";s&&(r?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,u="result = activation(result);");const h=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${h}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z7{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ys(this.outputShape.length);const o=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,h=e.filterWidth,d=h;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<h;y++)f+=`
          vec4 xTexelC${y*2};
          int xTexelC${y*2}Ready;
          vec4 xTexelC${y*2+1};
          int xTexelC${y*2+1}Ready;
          vec4 xC${y};`;f+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let y=0;y<h;y++)f+=`
          xTexelC${y*2} = vec4(0.0);
          xTexelC${y*2}Ready = 0;
          xTexelC${y*2+1} = vec4(0.0);
          xTexelC${y*2+1}Ready = 0;
          xC${y} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let y=0;y<(d+1)/2;y++){const w=y*2;if(f+=`
          xC = xCCorner + ${w*c};
          `,l===1){if(w<h&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                  xTexelC${w} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${w}.zw = vec2(0.0);
                  }
                  xTexelC${w}Ready = 1;
                }
              `,c===1&&w>0?f+=`
                xC${w} = vec4(xTexelC${w-2}.zw, xTexelC${w}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${w} = vec4(previous.zw, xTexelC${w}.xy);
                  } else {
                    xC${w} = vec4(0.0, 0.0, xTexelC${w}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                  xTexelC${w} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${w}.zw = vec2(0.0);
                  }
                  xTexelC${w}Ready = 1;
                }

                xC${w} = xTexelC${w};
                `,w+1<h)){const b=a%2===0?vk(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                    xTexelC${w+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${w+1}.zw = vec2(0.0);
                    }
                    xTexelC${w+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${w+1} = vec4(previous.zw, xTexelC${w+1}.xy);
                    } else {
                     xC${w+1} = vec4(0.0, 0.0, xTexelC${w+1}.xy);
                    }
                    `:f+=`
                    xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.xy);
                    `):b===1?f+=`
                    xC${w+1} = xTexelC${w};
                    `:f+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                      xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${w+1}.zw = vec2(0.0);
                      }
                      xTexelC${w+1}Ready = 1;
                    }

                    xC${w+1} = xTexelC${w+1};
                    `}}else w<h&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                  xTexelC${w} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${w}.zw = vec2(0.0);
                  }
                  xTexelC${w}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${w+1}Ready == 0) {
                  xTexelC${w+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${w+1}.zw = vec2(0.0);
                  }
                  xTexelC${w+1}Ready = 1;
                }

                xC${w} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
              `,w+1<h&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${w+1} = vec4(xTexelC${w+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                  xTexelC${w} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${w}.zw = vec2(0.0);
                  }
                  xTexelC${w}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                  xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${w+1}.zw = vec2(0.);
                  }
                  xTexelC${w+1}Ready = 1;
                }

                xC${w} = vec4(
                  xTexelC${w}.xy, xTexelC${w+1}.xy);
              `,w+1<h&&(f+=`
                  xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
                `)));w<h&&(f+=`
            wTexel = getW(r, ${w}, d1, q);
            dotProd += xC${w} * vec4(wTexel.xz, wTexel.xz);
          `,w+1<h&&(f+=`
              wTexel = getW(r, ${w+1}, d1, q);
              dotProd += xC${w+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p="",g="";s&&(r?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:p=`vec4 activation(vec4 x) {
          ${s}
        }`,g="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${m}
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;let u=l;u==null&&(u=[1,1]),L(ms(o,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const h=Qn(r.shape,i.shape,o,u,a,c,!0);let d;oe().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?d=new Z7(h):d=new J7(h);const f=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return n.runWebGLProgram(d,[r,i],"float32",f)}const Hbe={kernelName:Ky,backendName:"webgl",kernelFunc:Gbe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kbe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class qbe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=n-1-e.padInfo.top,a=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s,h=Qn(r.shape,u,o,a,l,c,!0),d=new Kbe(h);return n.runWebGLProgram(d,[r,i],"float32")}const Ybe={kernelName:Mk,backendName:"webgl",kernelFunc:Xbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jbe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s,h=Qn(u,i.shape,o,a,l,c,!0),d=new qbe(h);return n.runWebGLProgram(d,[r,i],"float32")}const Zbe={kernelName:Bk,backendName:"webgl",kernelFunc:Jbe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qbe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eCe(t){const{inputs:e,backend:n}=t,{x:s}=e,r=[...s.shape,...s.shape],i=ue(s.shape),o=Ce({inputs:{x:s},backend:n,attrs:{shape:[i]}}),a=new Qbe(i),l=n.runWebGLProgram(a,[o],o.dtype),c=Ce({inputs:{x:l},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}const tCe={kernelName:A5,backendName:"webgl",kernelFunc:eCe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nCe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:s,padInfo:r,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=e,{top:h,left:d}=r;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${h}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s,c=pg(r.shape,i.shape,o,a,"NHWC",l);let u;const h=new nCe(c);u=n.runWebGLProgram(h,[r,i],"float32");const d=Ce({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),d}const rCe={kernelName:qy,backendName:"webgl",kernelFunc:sCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iCe(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,i=e,{allDims:o,summedDims:a,idDims:l}=m3(r,i.length);y3(o.length,l,i);const{path:c,steps:u}=v3(a,l),h=u.length;let d=null,f=o.length;const p=[];for(let g=0;g<h;++g){for(const m of u[g]){const{permutationIndices:y,expandDims:w}=g3(f,l[m]);let b;x3(y)?b=i[m]:(b=Fs({inputs:{x:i[m]},backend:n,attrs:{perm:y}}),p.push(b));const C=b.shape.slice();for(let k=0;k<w.length;++k)C.splice(w[k],0,1);yt(b.shape,C)||(b=Ce({inputs:{x:b},backend:n,attrs:{shape:C}}),p.push(b)),d===null?d=b:(d=iE({inputs:{a:b,b:d},backend:n}),p.push(d))}g<h-1&&(c[g]>=0&&(d=lx({inputs:{x:d},backend:n,attrs:{axis:c[g]-(o.length-f),keepDims:!1}}),p.push(d)),f--)}for(const g of p)g!==d&&n.disposeIntermediateTensorInfo(g);return d}const oCe={kernelName:Vk,backendName:"webgl",kernelFunc:iCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aCe="return (x >= 0.0) ? x : (exp(x) - 1.0);",lCe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,cCe=ct({opSnippet:aCe,packedOpSnippet:lCe}),uCe={kernelName:Am,backendName:"webgl",kernelFunc:cCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hCe="return (b >= 0.0) ? a : a * (b + 1.0);",dCe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,fCe=t=>{const{inputs:e,backend:n}=t,{dy:s,y:r}=e,i=oe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gd(dCe,s.shape,r.shape):new xu(hCe,s.shape,r.shape);return n.runWebGLProgram(i,[s,r],s.dtype)},pCe={kernelName:Uk,backendName:"webgl",kernelFunc:fCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mCe=`
  return vec4(equal(a, b));
`,gCe="return float(a == b);",yCe=ts({opSnippet:gCe,packedOpSnippet:mCe,dtype:"bool",cpuKernelImpl:Xye}),vCe={kernelName:Xy,backendName:"webgl",kernelFunc:yCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xCe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${l3};
  float a1 = ${c3};
  float a2 = ${u3};
  float a3 = ${h3};
  float a4 = ${d3};
  float a5 = ${f3};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,wCe=ct({opSnippet:xCe}),bCe={kernelName:Dm,backendName:"webgl",kernelFunc:wCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CCe=Hd+`
  return exp(x);
`,SCe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Q7=ct({opSnippet:CCe,packedOpSnippet:SCe,cpuKernelImpl:Yye,dtype:"float32"}),ICe={kernelName:Pm,backendName:"webgl",kernelFunc:Q7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cS(t){const{inputs:e,attrs:n,backend:s}=t,{dim:r}=n,{input:i}=e,o=i.shape.length,a=i.shape.slice();let l=r;return r<0&&(L(-(o+1)<=r,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+r+1),a.splice(l,0,1),Ce({inputs:{x:i},backend:s,attrs:{shape:a}})}const kCe={kernelName:Yy,backendName:"webgl",kernelFunc:cS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kR="return exp(x) - 1.0;",TCe=ct({opSnippet:kR,packedOpSnippet:kR,cpuKernelImpl:Jye}),ECe={kernelName:Om,backendName:"webgl",kernelFunc:TCe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TR{constructor(e,n,s){this.variableNames=["real","imag"];const r=n[1];this.outputShape=n;const i=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=s?`${r}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eB(t,e,n){const s=n.texData.get(t.dataId),r=ue(t.shape),i=t.shape[t.shape.length-1],o=r/i,a=Ce({inputs:{x:t},backend:n,attrs:{shape:[o,i]}}),l=a.shape,c=new TR("real",l,e),u=new TR("imag",l,e),h=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],d=n.runWebGLProgram(c,h,"float32"),f=n.runWebGLProgram(u,h,"float32"),p=tc({inputs:{real:d,imag:f},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f);const g=Ce({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NCe(t){const{inputs:e,backend:n}=t,{input:s}=e;return eB(s,!1,n)}const _Ce={kernelName:zk,backendName:"webgl",kernelFunc:NCe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Ce{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Og(t){const{backend:e,attrs:n}=t,{shape:s,value:r}=n;let{dtype:i}=n;if(i=i||Ad(r),i==="string"){const o=an(i,ue(s));return o.fill(r),e.makeTensorInfo(s,i,o)}else{const o=new $Ce(s,r),a=[[r]];return e.runWebGLProgram(o,[],i,a)}}const RCe={kernelName:Wk,backendName:"webgl",kernelFunc:Og};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ACe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DCe={kernelName:jk,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,r=new ACe(n.shape);return s.runWebGLProgram(r,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ER="return floor(x);",PCe=ct({opSnippet:ER,packedOpSnippet:ER,cpuKernelImpl:Zye}),OCe={kernelName:Fm,backendName:"webgl",kernelFunc:PCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FCe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,LCe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,MCe=ts({opSnippet:FCe,packedOpSnippet:LCe,dtype:"int32"}),BCe={kernelName:Lm,backendName:"webgl",kernelFunc:MCe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VCe{constructor(e){this.variableNames=["A"];const n=Ms(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UCe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Ms(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zCe={kernelName:Vte,backendName:"webgl",kernelFunc:WCe};let oh,Ww=oe().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function WCe(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:r}=e;const{numChannels:i}=s,o=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,c]=o?[r.videoWidth,r.videoHeight]:[r.width,r.height],u=[c,l],h=[c,l,i];if(a||o){const g=oe().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(oh==null||g!==Ww)&&(Ww=g,oh=document.createElement("canvas").getContext("2d",{willReadFrequently:Ww})),oh.canvas.width=l,oh.canvas.height=c,oh.drawImage(r,0,0,l,c),r=oh.canvas}const d=n.makeTensorInfo(u,"int32");n.texData.get(d.dataId).usage=Mr.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),r);const f=oe().getBool("WEBGL_PACK")?new UCe(h):new VCe(h),p=n.runWebGLProgram(f,[d],"int32");return n.disposeData(d.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=s,g=Ta(u),m=Qn(r.shape,i.shape,l,h,c,d,!1,g);let y;const w=[],b=o!=null,C=a!=null,k=f==="leakyrelu",$=()=>{const T=[r,i],R=(E,A)=>{if(A==="NCHW"&&E.shape.length===1&&E.shape[0]!==1){const F=Ce({inputs:{x:E},backend:n,attrs:{shape:[E.shape[0],1,1]}});return w.push(F),F}return E};if(b&&T.push(R(o,u)),C&&T.push(R(a,u)),k){const E=n.makeTensorInfo([],"float32",Hl(p,"float32"));T.push(E),w.push(E)}return T};if(m.filterHeight===1&&m.filterWidth===1&&m.dilationHeight===1&&m.dilationWidth===1&&m.strideHeight===1&&m.strideWidth===1&&(m.padInfo.type==="SAME"||m.padInfo.type==="VALID"))y=q7({x:r,filter:i,convInfo:m,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else if(m.strideWidth<=2&&g==="channelsLast"&&oe().getBool("WEBGL_EXP_CONV")){const T=f?Jp(f,!0):null,R=new K7(m,b,T,C,k),E=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],A=$();y=n.runWebGLProgram(R,A,"float32",E)}else if(oe().getBool("WEBGL_CONV_IM2COL"))y=X7({x:r,filter:i,convInfo:m,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else{const T=f?Jp(f,!1):null,R=new H7(m,b,T,C,k),E=$();y=n.runWebGLProgram(R,E,"float32")}const I=Ce({inputs:{x:y},backend:n,attrs:{shape:m.outShape}});return w.push(y),w.forEach(T=>n.disposeIntermediateTensorInfo(T)),I}const GCe={kernelName:v2,backendName:"webgl",kernelFunc:jCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dilations:u,dimRoundingMode:h,activation:d,leakyreluAlpha:f}=s,p=[];let g=u;g==null&&(g=[1,1]),L(ms(l,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);const m=Qn(r.shape,i.shape,l,g,c,h,!0),y=oe().getBool("WEBGL_PACK_DEPTHWISECONV")&&m.strideWidth<=2&&m.outChannels/m.inChannels===1,w=d?Jp(d,y):null,b=[r,i],C=o!=null,k=a!=null,$=d==="leakyrelu";if(C&&b.push(o),k&&b.push(a),$){const E=n.makeTensorInfo([],"float32",Hl(f,"float32"));b.push(E),p.push(E)}let I;y?I=new Z7(m,C,w,k,$):I=new J7(m,C,w,k,$);const T=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],R=n.runWebGLProgram(I,b,"float32",T);return p.forEach(E=>n.disposeIntermediateTensorInfo(E)),R}const KCe={kernelName:J5,backendName:"webgl",kernelFunc:HCe};class qCe{constructor(e,n,s,r){this.sliceDim=e,this.strides=n,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const i=_t(s.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XCe(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,i=r.shape,o=i[i.length-1],a=ue(s.shape),[l,c,u,h]=JT(s,r),d=Ce({inputs:{x:r},backend:n,attrs:{shape:[c,o]}}),f=Ce({inputs:{x:s},backend:n,attrs:{shape:[ue(s.shape)/u,u]}});if(n.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const y=n.readSync(r.dataId),w=n.bufferSync(s),b=Qye(y,w,s.dtype,c,o,u,h,s.shape,a);return n.makeTensorInfo(l,s.dtype,b.values)}const p=new qCe(o,h,[c,u],s.shape),g=n.runWebGLProgram(p,[f,d],f.dtype),m=Ce({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),m}const YCe={kernelName:D5,backendName:"webgl",kernelFunc:XCe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JCe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=_t(this.rank),r=ZCe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function ZCe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<t.length;r++)r===2?s.push("index"):s.push(`${n[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tB(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:i}=e,{axis:o,batchDims:a}=s,l=tt(o,r.shape)[0];if(oe().get("DEBUG")){const w=n.readSync(i.dataId),b=r.shape[l];for(let C=0;C<w.length;++C){const k=w[C];L(k<=b-1&&k>=0,()=>`GatherV2: the index value ${k} is not in [0, ${b-1}]`)}}const c=b3(r,i,l,a),u=ue(i.shape),h=[],d=Ce({inputs:{x:r},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=Ce({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});h.push(d),h.push(f);const p=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const w=n.bufferSync(f),b=n.bufferSync(d),C=eve(b,w,p);return h.forEach(k=>n.disposeIntermediateTensorInfo(k)),n.makeTensorInfo(c.outputShape,C.dtype,C.values)}const g=new JCe(d.shape,p),m=n.runWebGLProgram(g,[d,f],d.dtype);h.push(m);const y=Ce({inputs:{x:m},backend:n,attrs:{shape:c.outputShape}});return h.forEach(w=>n.disposeIntermediateTensorInfo(w)),y}const QCe={kernelName:Zy,backendName:"webgl",kernelFunc:tB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eSe="return float(a > b);",tSe=`
  return vec4(greaterThan(a, b));
`,nSe=ts({opSnippet:eSe,packedOpSnippet:tSe,cpuKernelImpl:tve,dtype:"bool"}),sSe={kernelName:Qy,backendName:"webgl",kernelFunc:nSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rSe="return float(a >= b);",iSe=`
  return vec4(greaterThanEqual(a, b));
`,oSe=ts({opSnippet:rSe,packedOpSnippet:iSe,dtype:"bool",cpuKernelImpl:nve}),aSe={kernelName:Mm,backendName:"webgl",kernelFunc:oSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lSe(t){const{inputs:e,backend:n}=t,{input:s}=e;return eB(s,!0,n)}const cSe={kernelName:Gk,backendName:"webgl",kernelFunc:lSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uSe="return float(!isnan(x) && !isinf(x));",hSe=ct({opSnippet:uSe,dtype:"bool"}),dSe={kernelName:Vm,backendName:"webgl",kernelFunc:hSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fSe="return float(isinf(x));",pSe=ct({opSnippet:fSe,dtype:"bool"}),mSe={kernelName:Um,backendName:"webgl",kernelFunc:pSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gSe="return float(isnan(x));",ySe=ct({opSnippet:gSe,dtype:"bool"}),vSe={kernelName:zm,backendName:"webgl",kernelFunc:ySe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xSe="return float(a < b);",wSe=`
  return vec4(lessThan(a, b));
`,bSe=ts({opSnippet:xSe,packedOpSnippet:wSe,cpuKernelImpl:sve,dtype:"bool"}),CSe={kernelName:tv,backendName:"webgl",kernelFunc:bSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SSe="return float(a <= b);",ISe=`
  return vec4(lessThanEqual(a, b));
`,kSe=ts({opSnippet:SSe,packedOpSnippet:ISe,cpuKernelImpl:rve,dtype:"bool"}),TSe={kernelName:nv,backendName:"webgl",kernelFunc:kSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ESe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:i}=n,o=ive(s,r,i);return e.makeTensorInfo([o.length],"float32",o)}const NSe={kernelName:P5,backendName:"webgl",kernelFunc:ESe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Se=Hd+`
  return x < 0.0 ? 0./0. : log(x);
`,$Se=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,RSe=ct({opSnippet:_Se,packedOpSnippet:$Se,cpuKernelImpl:ove}),ASe={kernelName:Wm,backendName:"webgl",kernelFunc:RSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DSe=Hd+`
  return log(1.0 + x);
`,PSe=ct({opSnippet:DSe}),OSe={kernelName:jm,backendName:"webgl",kernelFunc:PSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FSe="return float(a >= 1.0 && b >= 1.0);",LSe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,MSe=ts({opSnippet:FSe,packedOpSnippet:LSe,dtype:"bool"}),BSe={kernelName:sv,backendName:"webgl",kernelFunc:MSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VSe="return float(!(x >= 1.0));",USe=ct({opSnippet:VSe}),zSe={kernelName:rv,backendName:"webgl",kernelFunc:USe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WSe="return float(a >= 1.0 || b >= 1.0);",jSe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,GSe=ts({opSnippet:WSe,packedOpSnippet:jSe,dtype:"bool"}),HSe={kernelName:iv,backendName:"webgl",kernelFunc:GSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KSe{constructor(e,n,s,r,i){this.variableNames=["x"],this.outputShape=[];const o=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qSe{constructor(e,n,s,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XSe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=s,c=oe().getBool("WEBGL_PACK_NORMALIZATION")?new qSe(r.shape,i,o,a,l):new KSe(r.shape,i,o,a,l);return n.runWebGLProgram(c,[r],r.dtype)},YSe={kernelName:ov,backendName:"webgl",kernelFunc:XSe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JSe{constructor(e,n,s,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=s,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZSe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s,h=new JSe(r.shape,a,l,c,u);return n.runWebGLProgram(h,[r,i,o],r.dtype)},QSe={kernelName:Kk,backendName:"webgl",kernelFunc:ZSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eIe(t,e,n,s){const r=ue(e),o=ue(t.shape)/r,a=Ce({inputs:{x:t},attrs:{shape:[o,r]},backend:s}),l=Lu(a,t.dtype,"max",s),c=Ce({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nB(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:i,keepDims:o}=s,a=r.shape.length,l=tt(i,r.shape);let c=l;const u=Zt(c,a),h=u!=null,d=n.shouldExecuteOnCPU([r]);let f=r;if(h){if(d){const b=n.texData.get(f.dataId).values,C=new Array(a);for(let I=0;I<C.length;I++)C[I]=r.shape[u[I]];const k=sE(b,r.shape,r.dtype,u,C);f=n.makeTensorInfo(C,r.dtype);const $=n.texData.get(f.dataId);$.values=k}else f=ax(r,u,n);c=un(c.length,a)}es("max",c,a);const[p,g]=Wn(f.shape,c);let m=p;o&&(m=vn(p,l));let y;if(d){const b=n.texData.get(f.dataId).values,C=ave(b,ue(g),m,r.dtype);y=n.makeTensorInfo(m,r.dtype);const k=n.texData.get(y.dataId);k.values=C}else y=eIe(f,g,m,n);return h&&n.disposeIntermediateTensorInfo(f),y}const tIe={kernelName:av,backendName:"webgl",kernelFunc:nB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nIe=rE+`
  return max(a, b);
`,sIe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Fu+`
  return result;
`,rIe=ts({opSnippet:nIe,packedOpSnippet:sIe,cpuKernelImpl:lve}),iIe={kernelName:Gm,backendName:"webgl",kernelFunc:rIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Ag(r,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;L(ms(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=wi(r.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&yt(u.inShape,u.outShape))return br({inputs:{x:r},backend:n});const h=new Zp(u,"max",!1);return n.runWebGLProgram(h,[r],r.dtype)}const aIe={kernelName:lv,backendName:"webgl",kernelFunc:oIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dataFormat:l,dimRoundingMode:c}=s,u=[1,1,1],h=ka(r.shape,i,o,u,a,c,l),d=new oE(h,"max",!1);return n.runWebGLProgram(d,[r],r.dtype)}const cIe={kernelName:cv,backendName:"webgl",kernelFunc:lIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uIe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,l=o-1-e.padInfo.left,c=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class hIe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,h=l-1-e.padInfo.front,d=c-1-e.padInfo.top,f=u-1-e.padInfo.left,p=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${h}, ${d}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dIe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,h=[1,1,1],d=ka(o.shape,a,l,h,c,u),f=new oE(d,"max",!0),p=n.runWebGLProgram(f,[o],o.dtype),g=new hIe(d),m=n.runWebGLProgram(g,[r,p],o.dtype);return n.disposeIntermediateTensorInfo(p),m}const fIe={kernelName:Xk,backendName:"webgl",kernelFunc:dIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pIe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i,output:o}=e,a=i;Ag([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=s,d=wi(a.shape,l,c,1,u,h),f=!0,p=new Zp(d,"max",f),g=n.runWebGLProgram(p,[a],a.dtype),m=new uIe(d),y=n.runWebGLProgram(m,[r,g],a.dtype);return n.disposeIntermediateTensorInfo(g),y}const mIe={kernelName:qk,backendName:"webgl",kernelFunc:pIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gIe(t,e,n,s){let r=new Zp(n,"max",!1);const i=s.runWebGLProgram(r,[t],"float32");r=new Zp(n,"max",!0,!0,e);const o=s.runWebGLProgram(r,[t],"float32");return[i,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yIe={kernelName:O5,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;L(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];L(ms(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=wi(s.shape,r,i,c,o),[h,d]=gIe(s,a,u,l);return[h,d]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vIe(t,e,n,s){const r=ue(e),o=ue(t.shape)/r,a=Ce({inputs:{x:t},attrs:{shape:[o,r]},backend:s}),l=Lu(a,"float32","mean",s),c=Ce({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xIe={kernelName:uv,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:r,axis:i}=e,o=n,a=s.shape.length,l=tt(i,s.shape);let c=l;const u=Zt(c,a),h=u!=null,d=o.shouldExecuteOnCPU([s]),f=[];let p=s;if(h){if(d){const C=o.texData.get(p.dataId).values,k=new Array(a);for(let T=0;T<k.length;T++)k[T]=s.shape[u[T]];const $=sE(C,s.shape,s.dtype,u,k);p=o.makeTensorInfo(k,s.dtype);const I=o.texData.get(p.dataId);I.values=$}else p=ax(s,u,o);f.push(p),c=un(c.length,a)}es("sum",c,a);const[g,m]=Wn(p.shape,c);let y=g;r&&(y=vn(g,l));const w=vIe(p,m,y,o);for(const b of f)o.disposeIntermediateTensorInfo(b);return w}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=tt(i,r.shape);let c=l;const u=Zt(c,a);let h=r;u!=null&&(h=Fs({inputs:{x:r},backend:n,attrs:{perm:u}}),c=un(c.length,r.shape.length)),es("min",c,a);const[d,f]=Wn(h.shape,c),p=ue(f),g=Ce({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}}),m=Lu(g,g.dtype,"min",n);let y;if(o){const w=vn(d,l);y=Ce({inputs:{x:m},backend:n,attrs:{shape:w}})}else y=Ce({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),u!=null&&n.disposeIntermediateTensorInfo(h),y}const bIe={kernelName:hv,backendName:"webgl",kernelFunc:wIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CIe=rE+`
  return min(a, b);
`,SIe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Fu+`
  return result;
`,IIe=ts({opSnippet:CIe,packedOpSnippet:SIe,cpuKernelImpl:cve}),kIe={kernelName:Hm,backendName:"webgl",kernelFunc:IIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TIe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=n.map((u,h)=>u[0]+e[h]+u[1]);const r=e.length,i=_t(r),o=n.map(u=>u[0]).join(","),a=n.map((u,h)=>u[0]+e[h]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EIe{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,g)=>p[0]+e[g]+p[1]);const r=e.length,i=_t(r),o=n.map(p=>p[0]).join(","),a=n.map((p,g)=>p[0]+e[g]).join(","),l=$s("rc",r),c=$s("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,h=r===1?"source":`vec2(${c.slice(-2).join()})`,d=s==="reflect"?0:1;let f="";if(r===1){const p=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${h});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${h});
        }
      `}else{const p=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${h});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${h});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${p}
          result[2] = getChannel(getX(${c.join()}), ${h});
          ${l[r-1]} += 1;
          if(${u}) {
            ${p}
            result[3] = getChannel(getX(${c.join()}), ${h});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NIe=({inputs:t,backend:e,attrs:n})=>{const{x:s}=t,{paddings:r,mode:i}=n,o=oe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new EIe(s.shape,r,i):new TIe(s.shape,r,i);return e.runWebGLProgram(o,[s],s.dtype)},_Ie={kernelName:dv,backendName:"webgl",kernelFunc:NIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ie=`if (b == 0.0) return NAN;
  return mod(a, b);`,RIe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Fu+`
  return result;
`,AIe=ts({opSnippet:$Ie,packedOpSnippet:RIe}),DIe={kernelName:Km,backendName:"webgl",kernelFunc:AIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PIe{constructor(e,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OIe=`
if (a == b) {
  return 1.0;
};
return a / b;`,FIe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,sB=ts({opSnippet:OIe,packedOpSnippet:FIe,checkOutOfBounds:!0}),LIe={kernelName:Rm,backendName:"webgl",kernelFunc:sB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NR="return a - b;",rB=ts({opSnippet:NR,packedOpSnippet:NR,supportsComplex:!0,cpuKernelImpl:$ve}),MIe={kernelName:cg,backendName:"webgl",kernelFunc:rB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iB(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:i}=s,o=tt([i],r.shape),a=nB({inputs:{x:r},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=vn(a.shape,o),c=Ce({inputs:{x:a},backend:n,attrs:{shape:l}}),u=rB({inputs:{a:r,b:c},backend:n}),h=Q7({inputs:{x:u},backend:n}),d=lx({inputs:{x:h},backend:n,attrs:{axis:o,keepDims:!1}}),f=Ce({inputs:{x:d},backend:n,attrs:{shape:l}}),p=sB({inputs:{a:h,b:f},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),p}const BIe={kernelName:$v,backendName:"webgl",kernelFunc:iB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VIe(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:i,seed:o,normalized:a}=s,l=a?r:iB({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),c=l.shape[0],u=l.shape[1],h=new PIe(c,u,i),d=[[o]],f=n.runWebGLProgram(h,[l],"int32",d);return a||n.disposeIntermediateTensorInfo(l),f}const UIe={kernelName:F5,backendName:"webgl",kernelFunc:VIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zIe=Ci+`
  return -x;
`,WIe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function jIe(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])){const i=n.texData.get(s.dataId),[o,a]=hve(i.values,s.shape,s.dtype);return n.makeTensorInfo(a,s.dtype,o)}let r;return oe().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new ol(s.shape,WIe):r=new po(s.shape,zIe),n.runWebGLProgram(r,[s],s.dtype)}const GIe={kernelName:fv,backendName:"webgl",kernelFunc:jIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HIe=GT;function KIe(t){Or("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s,c=n.readSync(r.dataId),u=n.readSync(i.dataId),{selectedIndices:h}=HIe(c,u,o,a,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}const qIe={kernelName:Yk,backendName:"webgl",kernelFunc:KIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XIe=HT;function YIe(t){Or("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s,u=n.readSync(r.dataId),h=n.readSync(i.dataId),{selectedIndices:d,validOutputs:f}=XIe(u,h,o,a,l,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const JIe={kernelName:Jk,backendName:"webgl",kernelFunc:YIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZIe=KT;function QIe(t){Or("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s,u=n.readSync(r.dataId),h=n.readSync(i.dataId),d=o,f=a,p=l,g=c,{selectedIndices:m,selectedScores:y}=ZIe(u,h,d,f,p,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const eke={kernelName:Zk,backendName:"webgl",kernelFunc:QIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tke{constructor(e,n,s,r){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nke=t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:i,depth:o,onValue:a,offValue:l}=s,c=ue(r.shape),u=new tke(c,o,a,l),h=Ce({inputs:{x:r},backend:n,attrs:{shape:[c]}}),d=n.runWebGLProgram(u,[h],i);n.disposeIntermediateTensorInfo(h);const f=[...r.shape,o],p=Ce({inputs:{x:d},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(d),p},ske={kernelName:gv,backendName:"webgl",kernelFunc:nke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H2(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="complex64"){const r=Pg({inputs:{input:s},backend:n}),i=H2({inputs:{x:r},backend:n}),o=cx({inputs:{input:s},backend:n}),a=H2({inputs:{x:o},backend:n}),l=tc({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return Og({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const rke={kernelName:Dv,backendName:"webgl",kernelFunc:H2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oB(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=Pg({inputs:{input:s},backend:n}),i=oB({inputs:{x:r},backend:n}),o=cx({inputs:{input:s},backend:n}),a=H2({inputs:{x:o},backend:n}),l=tc({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return Og({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const ike={kernelName:mv,backendName:"webgl",kernelFunc:oB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oke(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return cS({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{xk(i,u.shape,"All tensors passed to stack must have matching shapes"),L(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const h=cS({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(h),h}),c=G7({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const ake={kernelName:yv,backendName:"webgl",kernelFunc:oke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lke{constructor(e,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,u)=>c[0]+e[u]+c[1]);const r=e.length,i=_t(r),o=n.map(c=>c[0]).join(","),a=n.map((c,u)=>c[0]+e[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cke{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((g,m)=>g[0]+e[m]+g[1]);const r=e.length,i=_t(r),o=n.map(g=>g[0]).join(","),a=n.map((g,m)=>g[0]+e[m]).join(","),l=$s("rc",r),c=$s("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,h=r===1?"source":`vec2(${c.slice(-2).join()})`,d=[`${i} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${u}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${u}) {`],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let g=0,m=r===1?2:4;g<m;g++)p+=`
        ${d[g]}
        if (${f}) {
          result[${g}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${g}] = getChannel(getX(${c.join()}), ${h});
        }
      `;p+=r===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aB=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,constantValue:o}=s;if(ue(r.shape)===0){const c=i.map((u,h)=>u[0]+r.shape[h]+u[1]);return Og({backend:n,attrs:{shape:c,value:o,dtype:r.dtype}})}const a=oe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new cke(r.shape,i,o):new lke(r.shape,i,o),l=[[o]];return n.runWebGLProgram(a,[r],r.dtype,l)},uke={kernelName:vv,backendName:"webgl",kernelFunc:aB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hke=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,dke=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Fu+`
  return result;
`,fke=ts({opSnippet:hke,packedOpSnippet:dke}),pke={kernelName:Xm,backendName:"webgl",kernelFunc:fke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=[],c=tt(i,r.shape);let u=c;const h=Zt(u,a);let d=r;h!=null&&(d=Fs({inputs:{x:r},backend:n,attrs:{perm:h}}),u=un(u.length,a),l.push(d)),es("prod",u,a);let f;if(n.shouldExecuteOnCPU([d])){const p=n.texData.get(d.dataId).values,{outVals:g,outShape:m,outDtype:y}=fve(d.shape,d.dtype,p,u);f=n.makeTensorInfo(m,y,g)}else{const[p,g]=Wn(d.shape,u),m=ue(g),y=Ce({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),w=hT(r.dtype),b=Lu(y,w,"prod",n);f=Ce({inputs:{x:b},backend:n,attrs:{shape:p}}),l.push(y),l.push(b)}if(o){l.push(f);const p=vn(f.shape,c);f=Ce({inputs:{x:f},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const gke={kernelName:wv,backendName:"webgl",kernelFunc:mke};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yke(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=s,l=r.map(y=>n.readSync(y.dataId)),c=r.map(y=>y.shape),u=n.readSync(i.dataId),h=n.readSync(o.dataId),[d,f,p]=pve(l,c,u,i.shape,i.dtype,h,o.shape,a),g=d.map(y=>n.makeTensorInfo([y.length],"int32",y)),m=n.makeTensorInfo(p,i.dtype,f);return g.concat([m])}const vke={kernelName:L5,backendName:"webgl",kernelFunc:yke};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xke(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:i}=e,o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=mve(o,s.shape,s.dtype,a,r.shape,l,i.shape),h=n.makeTensorInfo([c.length],"int32",c),d=n.makeTensorInfo([u.length],s.dtype,u);return[h,d]}const wke={kernelName:M5,backendName:"webgl",kernelFunc:xke};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bke(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.readSync(r.dataId),u=n.readSync(i.dataId),h=n.readSync(o.dataId),d=a.map(m=>n.readSync(m.dataId)),f=a.map(m=>m.shape),[p,g]=gve(c,r.shape,u,i.shape,i.dtype,h,o.shape,d,f,l);return n.makeTensorInfo(p,i.dtype,g)}const Cke={kernelName:B5,backendName:"webgl",kernelFunc:bke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lB=t=>{const{backend:e,attrs:n}=t,{start:s,stop:r,step:i,dtype:o}=n,a=yve(s,r,i,o);return e.makeTensorInfo([a.length],o,a)},Ske={kernelName:Qk,backendName:"webgl",kernelFunc:lB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ike="return 1.0 / x;",kke=ct({opSnippet:Ike}),Tke={kernelName:Ym,backendName:"webgl",kernelFunc:kke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eke=Ci+`
  return (x < 0.0) ? 0.0 : x;
`,Nke=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,_ke=ct({opSnippet:Eke,packedOpSnippet:Nke}),$ke={kernelName:Jm,backendName:"webgl",kernelFunc:_ke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rke=Ci+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Ake=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Dke=ct({opSnippet:Rke,packedOpSnippet:Ake}),Pke={kernelName:Zm,backendName:"webgl",kernelFunc:Dke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oke{constructor(e,n,s,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],h=[r&&n>1?n-1:n,r&&s>1?s-1:s];let d;i?d="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/h[0]},
          ${u[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fke{constructor(e,n,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],h=[r&&n>1?n-1:n,r&&s>1?s-1:s];let d;i?d="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/h[0]},
          ${u[1]/h[1]},
          ${u[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lke(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s,[l,c]=a,u=oe().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Fke(r.shape,l,c,i,o):new Oke(r.shape,l,c,i,o);return n.runWebGLProgram(u,[r],"float32")}const Mke={kernelName:Sv,backendName:"webgl",kernelFunc:Lke};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bke{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,i]=n,[,o,a]=e,l=[s&&o>1?r-1:r,s&&a>1?i-1:i],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],u=l[0]/c[0],h=l[1]/c[1],d=1/u,f=1/h,p=Math.ceil(d)*2+2,g=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${h});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vke(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s,a=new Bke(i.shape,r.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const Uke={kernelName:nT,backendName:"webgl",kernelFunc:Vke};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zke{constructor(e,n,s,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],h=[r&&n>1?n-1:n,r&&s>1?s-1:s],d=r?"0.5":"0.0";let f;i?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/h[0]},
          ${u[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wke{constructor(e,n,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],h=[r&&n>1?n-1:n,r&&s>1?s-1:s],d=r?"0.5":"0.0";let f;i?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/h[0]},
          ${u[1]/h[1]},
          ${u[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jke(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s,[l,c]=a,u=oe().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Wke(r.shape,l,c,i,o):new zke(r.shape,l,c,i,o);return n.runWebGLProgram(u,[r],r.dtype)}const Gke={kernelName:Cv,backendName:"webgl",kernelFunc:jke};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hke{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,i]=n,[,o,a]=e,l=[s&&o>1?r-1:r,s&&a>1?i-1:i],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],u=l[0]/c[0],h=l[1]/c[1],d=1/u,f=1/h,p=Math.ceil(d)*2+2,g=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${h});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kke(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s,a=new Hke(i.shape,r.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const qke={kernelName:tT,backendName:"webgl",kernelFunc:Kke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xke{constructor(e,n){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,i=e.map((a,l)=>r(l)).join(","),o=_t(s);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yke{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=$s("rc",s),i=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,o=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,a=_t(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${i}){
            result.g = ${c(r.slice())};
          }
          if(${o}) {
            result.b = ${u(r.slice())};
            if(${i}) {
              result.a = ${h(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return d(p)}function c(p){return p[s-1]="("+p[s-1]+" + 1)",d(p)}function u(p){return p[s-2]="("+p[s-2]+" + 1)",d(p)}function h(p){return p[s-1]="("+p[s-1]+" + 1)",p[s-2]="("+p[s-2]+" + 1)",d(p)}function d(p){const g=e.map((w,b)=>f(b,p)),m=g.join(","),y=g.slice(-2).join(",");return`getChannel(getX(${m}), vec2(${y}))`}function f(p,g){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${g[p]} - 1`:`${g[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:i}=s,o=r.shape.length,a=tt(i,r.shape);if(o===0)return br({inputs:{x:r},backend:n});const l=oe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Yke(r.shape,a):new Xke(r.shape,a);return n.runWebGLProgram(l,[r],r.dtype)}const Zke={kernelName:Iv,backendName:"webgl",kernelFunc:Jke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qke{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let i="";typeof n=="number"?i=`float outputValue = ${n.toFixed(2)};`:i=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eTe={kernelName:cT,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:i,center:o}=e,a=n,l=new Qke(s.shape,i),[c,u]=i3(o,s.shape[1],s.shape[2]),h=[[c,u,Math.sin(r),Math.cos(r)]];return a.runWebGLProgram(l,[s],s.dtype,h)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tTe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,nTe=ct({opSnippet:tTe}),sTe={kernelName:Qm,backendName:"webgl",kernelFunc:nTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rTe="return inversesqrt(x);",iTe=ct({opSnippet:rTe,cpuKernelImpl:vve}),oTe={kernelName:eg,backendName:"webgl",kernelFunc:iTe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aE{constructor(e,n,s,r,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const c=_t(i.length),u=_t(o.length);let h="";s===1?h="i":s===2&&(h="i, j");const d=`getIndices(${h})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let g="";l&&(g="coords[0], coords[1]");const m=`getDefaultValue(${g})`,y=n>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${y};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${m}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aTe{constructor(e,n,s,r,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const c=_t(i.length),u=_t(o.length);let h="";s===1?h="i":s===2&&(h="i, j");const d=`getIndices(${h})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let g="";l&&(g="coords[0], coords[1]");const m=`getDefaultValue(${g})`,y=n>1?"strides[j]":"strides",w=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${d});
              flattenedIndex += index.xz * ${y};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${w};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${m}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lTe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:i}=e,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=Ru(i,r,o),d=[h/c,c];if(h===0)return n.makeTensorInfo(o,r.dtype);const f=Ce({inputs:{x:r},backend:n,attrs:{shape:[l,a]}}),p=Ce({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));let m;oe().getBool("WEBGL_PACK")?m=new aTe(l,a,f.shape.length,p.shape.length,u,d):m=new aE(l,a,f.shape.length,p.shape.length,u,d);const y=n.runWebGLProgram(m,[p,f,g],p.dtype),w=Ce({inputs:{x:y},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(g),w}const cTe={kernelName:V5,backendName:"webgl",kernelFunc:lTe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uTe{constructor(e,n,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=oe().getNumber("WEBGL_VERSION")===2?i:o,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hTe(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:i}=e,{side:o}=s,a=new uTe(r.shape[0],r.shape[1],i.shape[1],o),l=[[r.shape[1]]];return n.runWebGLProgram(a,[r,i],"int32",l)}const dTe={kernelName:z5,backendName:"webgl",kernelFunc:hTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fTe{constructor(e,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let r,i;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)i="resRC",r="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<n.length;u++)c.push(`${a[u]}`),u<e&&l.push(`${a[u]}`);r=l.join(),i=c.join()}const o=_t(s);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pTe(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:i}=e,o=new fTe(s.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(o,[s,r,i],xr(r.dtype,i.dtype))}const mTe={kernelName:kv,backendName:"webgl",kernelFunc:pTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gTe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${Gv};
  float scale = ${Hv};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,yTe=ct({opSnippet:gTe}),vTe={kernelName:tg,backendName:"webgl",kernelFunc:yTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xTe=Hd+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,wTe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,bTe=ct({opSnippet:xTe,packedOpSnippet:wTe,cpuKernelImpl:wve}),CTe={kernelName:ig,backendName:"webgl",kernelFunc:bTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const STe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,ITe=ct({opSnippet:STe}),kTe={kernelName:rg,backendName:"webgl",kernelFunc:ITe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TTe=Hd+`
  return sin(x);
`,ETe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Fu}
  return result;
`,NTe=ct({opSnippet:TTe,packedOpSnippet:ETe}),_Te={kernelName:ng,backendName:"webgl",kernelFunc:NTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Te=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,RTe=ct({opSnippet:$Te}),ATe={kernelName:sg,backendName:"webgl",kernelFunc:RTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DTe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,PTe=ct({opSnippet:DTe}),OTe={kernelName:og,backendName:"webgl",kernelFunc:PTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FTe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,paddings:o}=s;L(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((y,w)=>y*w),l=[[0,0]];l.push(...o);for(let y=1+i.length;y<r.shape.length;++y)l.push([0,0]);const c=[],u=aB({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),h=xg(u.shape,i,a,!1),d=wg(h.length,i.length,!1),f=bg(u.shape,i,a,!1),p=Ce({inputs:{x:u},backend:n,attrs:{shape:h}}),g=Fs({inputs:{x:p},backend:n,attrs:{perm:d}}),m=Ce({inputs:{x:g},backend:n,attrs:{shape:f}});return c.push(u),c.push(p),c.push(g),c.forEach(y=>n.disposeIntermediateTensorInfo(y)),m},LTe={kernelName:Nv,backendName:"webgl",kernelFunc:FTe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MTe(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=n.readSync(o.dataId)[0],[h,d,f,p,g]=Cve(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(d,s.dtype,h),n.makeTensorInfo([d[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(m=>Number(m)))),n.makeTensorInfo([g.length],s.dtype,new Int32Array(g))]}const BTe={kernelName:W5,backendName:"webgl",kernelFunc:MTe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VTe(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.readSync(r.dataId)),a=n.readSync(s.dataId),l=Array.from(n.readSync(i.dataId)),[c,u,h]=Sve(a,s.shape,s.dtype,o,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}const UTe={kernelName:j5,backendName:"webgl",kernelFunc:VTe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zTe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=A7(o,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const WTe={kernelName:G5,backendName:"webgl",kernelFunc:zTe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jTe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=A7(o,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const GTe={kernelName:H5,backendName:"webgl",kernelFunc:jTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HTe(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:i,defaultValue:o}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:d}=Ru(i,r,a),f=!1;if(i.dtype==="string"){const y=n.bufferSync(r),w=n.bufferSync(i),b=Rl(n.readSync(o.dataId)[0]),C=xve(y,w,a,d,u,c,l,h,b,f);return n.makeTensorInfo(a,C.dtype,C.values)}const p=new aE(c,l,r.shape.length,i.shape.length,h,[d,1],f),g=n.runWebGLProgram(p,[i,r,o],i.dtype),m=Ce({inputs:{x:g},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(g),m}const KTe={kernelName:K5,backendName:"webgl",kernelFunc:HTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qTe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:i,axis:o}=s,a=tt(o,r.shape)[0],l=w3(r,i,a),c=r.shape.length,u=new Array(c).fill(0),h=r.shape.slice();return l.map(d=>{const f=[...h];f[a]=d;const p=Kd({inputs:{x:r},backend:n,attrs:{begin:u,size:f}});return u[a]+=d,p})}const XTe={kernelName:_v,backendName:"webgl",kernelFunc:qTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _R="return sqrt(x);",YTe=ct({opSnippet:_R,packedOpSnippet:_R,cpuKernelImpl:Ive}),JTe={kernelName:ag,backendName:"webgl",kernelFunc:YTe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZTe="return x * x;",QTe=ct({opSnippet:ZTe}),e3e={kernelName:sT,backendName:"webgl",kernelFunc:QTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $R="return (a - b) * (a - b);",t3e=ts({opSnippet:$R,packedOpSnippet:$R}),n3e={kernelName:lg,backendName:"webgl",kernelFunc:t3e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const i=n.readSync(r.dataId),o=wa(i),a=kve(o,"string",s);return n.makeTensorInfo(r.shape,"string",a)}const r3e={kernelName:rT,backendName:"webgl",kernelFunc:s3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i3e({inputs:t,attrs:e,backend:n}){const{x:s}=t,r=Ci+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new po(s.shape,r);return n.runWebGLProgram(i,[s],s.dtype)}const o3e={kernelName:fg,backendName:"webgl",kernelFunc:i3e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a3e{constructor(e,n,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,i=_t(s.length),o=_t(s.length);let a="";if(r===1)a="coords * strides + begin";else{let l=0;a=s.map((c,u)=>(l++,s.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=s,{finalShapeSparse:f,finalShape:p,isIdentity:g,sliceDim0:m,isSimpleSlice:y,begin:w,end:b,strides:C}=n3(r.shape,i,o,a,l,c,u,h,d);let k;if(g)k=Ce({inputs:{x:r},backend:n,attrs:{shape:p}});else if(m||y){L(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const I=QT(w,b,C),T=Kd({inputs:{x:r},backend:n,attrs:{begin:w,size:I}});k=Ce({inputs:{x:T},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(T)}else if(n.shouldExecuteOnCPU([r])){const T=n.readSync(r.dataId),R=et(r.shape,r.dtype,T),E=Tve(f,R,C,w);k=n.makeTensorInfo(p,r.dtype,E.values)}else{const T=new a3e(w,C,f);k=n.runWebGLProgram(T,[r],r.dtype)}const $=Ce({inputs:{x:k},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(k),$}const c3e={kernelName:iT,backendName:"webgl",kernelFunc:l3e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u3e(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:h}=e,d=n.readSync(u.dataId),f=n.readSync(h.dataId),[p,g]=Eve(d,f,r,i,o,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(h.shape,"int32",g)]}const h3e={kernelName:q5,backendName:"webgl",kernelFunc:u3e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d3e(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],[c,u,h]=Nve(a,l,r),d=u.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}const f3e={kernelName:X5,backendName:"webgl",kernelFunc:d3e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p3e(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),a=_ve(o,r);return n.makeTensorInfo(i.shape,"int32",a)}const m3e={kernelName:Y5,backendName:"webgl",kernelFunc:p3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g3e="return tan(x);",y3e=ct({opSnippet:g3e}),v3e={kernelName:ug,backendName:"webgl",kernelFunc:y3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x3e=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,w3e=ct({opSnippet:x3e}),b3e={kernelName:hg,backendName:"webgl",kernelFunc:w3e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C3e(t){const{inputs:e,backend:n,attrs:s}=t,{tensor:r,indices:i,updates:o}=e,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=Ru(o,i,r.shape),d=[h/c,c];if(h===0)return n.makeTensorInfo(r.shape,i.dtype);const f=Ce({inputs:{x:i},backend:n,attrs:{shape:[l,a]}}),p=Ce({inputs:{x:o},backend:n,attrs:{shape:[l,c]}}),g=Ce({inputs:{x:r},backend:n,attrs:{shape:d}}),m=new aE(l,a,f.shape.length,p.shape.length,u,d,!1,!0),y=n.runWebGLProgram(m,[p,f,g],g.dtype),w=Ce({inputs:{x:y},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),w}const S3e={kernelName:U5,backendName:"webgl",kernelFunc:C3e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I3e{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[o]*n[o];this.outputShape=s,this.rank=s.length;const r=_t(this.rank),i=k3e(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function k3e(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<t.length;r++)s.push(`imod(${n[r]}, ${t[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cB(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:i}=s;if(r.dtype==="string"||r.shape.length>5){const l=n.readSync(r.dataId),c=r.dtype==="string"?l.map(d=>Rl(d)):l,u=et(r.shape,r.dtype,c),h=Rve(u,i);return n.makeTensorInfo(h.shape,h.dtype,h.values)}const o=new I3e(r.shape,i);return n.runWebGLProgram(o,[r],r.dtype)}const T3e={kernelName:dg,backendName:"webgl",kernelFunc:cB};class E3e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class N3e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wc(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function RR(t){let e=1;for(;e<t;)e*=2;return e}function _3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:i,sorted:o}=s,a=oe().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=oe().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=r.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([r])||u<a||i>l){const E=n.readSync(r.dataId),[A,F]=Ave(E,c,r.dtype,i,o);return[n.makeTensorInfo(A.shape,A.dtype,A.values),n.makeTensorInfo(F.shape,F.dtype,F.values)]}if(i===0)return c[c.length-1]=0,[n.makeTensorInfo(c,r.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[r,Og({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const h=n.texData.get(r.dataId),d=h!==null&&h.isPacked,f=d?n.unpackTensor(r):r,g=ue(c)/u,m=Ce({inputs:{x:f},attrs:{shape:[g,u]},backend:n});d&&wc(n,f);const y=RR(i),w=RR(u);let b=null;const C=()=>b===null?[m,m]:[m,b],k=(E,A,F)=>{const P=C(),Z=new E3e(F),j=[[u],[b===null?1:0],[Number.NEGATIVE_INFINITY],[E],[A]],ee=b;b=n.runWebGLProgram(Z,P,"int32",j),wc(n,ee)};for(let E=1;E<y;E*=2){const A=E*2;for(let F=E;F>=1;F/=2)k(A,F,[g,w])}for(let E=w;E>y;E/=2){const A=C(),F=new N3e([g,E/2]),Z=[[u],[b===null?1:0],[y]],H=b;b=n.runWebGLProgram(F,A,"int32",Z),wc(n,H);const j=y/2,ee=j*2;for(let z=j;z>=1;z/=2)k(ee,z,b.shape)}let $=b;b=Kd({inputs:{x:b},backend:n,attrs:{begin:0,size:[g,i]}}),wc(n,$);let I=tB({inputs:{x:m,indices:b},backend:n,attrs:{axis:1,batchDims:1}});wc(n,m);const T=c.slice(0,-1);T.push(i),$=b,b=Ce({inputs:{x:b},attrs:{shape:T},backend:n}),wc(n,$);const R=I;return I=Ce({inputs:{x:I},attrs:{shape:T},backend:n}),wc(n,R),[I,b]}const $3e={kernelName:oT,backendName:"webgl",kernelFunc:_3e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R3e{constructor(e,n,s,r,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A3e(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=s,[u,h,d,f]=r.shape,[p,g]=c??[h,d],m=[u,p,g,f],y=new R3e(h,d,o,a,l,m);return n.runWebGLProgram(y,[r,i],"float32")}const D3e={kernelName:aT,backendName:"webgl",kernelFunc:A3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P3e(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:i}=e;Ag(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=s.readSync(i.dataId),{outputValues:a,outputShape:l,indices:c}=Dve(o,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const O3e={kernelName:lT,backendName:"webgl",kernelFunc:P3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F3e(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const o=r,a=o.shape.length,l=r.shape[i],c=new Array(a-1);let u=0;for(let g=0;g<a;g++)g!==i&&(c[u++]=o.shape[g]);const h=[],d=new Array(a).fill(0),f=o.shape.slice();f[i]=1;const p=new Array(l);for(let g=0;g<p.length;g++){d[i]=g;const m=Kd({inputs:{x:o},backend:n,attrs:{begin:d,size:f}}),y=Ce({inputs:{x:m},backend:n,attrs:{shape:c}});p[g]=y,h.push(m)}return h.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const L3e={kernelName:Rv,backendName:"webgl",kernelFunc:F3e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M3e{constructor(e,n){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/s);this.outputShape=[r,a];const l="0.0",c="sumValue",u=Math.floor(s/4)*4,h=s%4,d=`
        sumValue += dot(values, segFilter);
    `;let f="";i%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let p="";i%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${h===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${d}
        } else if (${h===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${d}
        } else if (${h===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${d}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B3e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:i}=e,{numSegments:o}=s,a=r.shape.length,l=[];let c=0;const u=Zt([c],a);let h=r;u!=null&&(h=Fs({inputs:{x:r},backend:n,attrs:{perm:u}}),l.push(h),c=un(1,a)[0]);const d=jM(h.shape,c,o),f=ue([h.shape[c]]),p=Ce({inputs:{x:h},backend:n,attrs:{shape:[-1,f]}});l.push(p);const g=hT(r.dtype),m=(C,k,$,I,T)=>{const R=C.shape[0],E=C.shape[1],A=WM(E,T),F={windowSize:A,inSize:E,batchSize:R,numSegments:T},P=new M3e(F,k),Z=n.compileAndRun(P,[C,$],I);if(l.push(Z),Z.shape[1]===T)return Z;const H=lB({backend:n,attrs:{start:0,stop:T,step:1,dtype:"float32"}}),j=cB({inputs:{x:H},backend:n,attrs:{reps:[E/A]}});return l.push(H),l.push(j),m(Z,k,j,I,T)},y=m(p,"unsortedSegmentSum",i,g,o),w=Ce({inputs:{x:y},backend:n,attrs:{shape:d}});let b=w;if(u!=null){l.push(w);const C=Xl(u);b=Fs({inputs:{x:b},backend:n,attrs:{perm:C}})}return l.forEach(C=>n.disposeIntermediateTensorInfo(C)),b}const V3e={kernelName:Av,backendName:"webgl",kernelFunc:B3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U3e=[Ixe,Txe,_xe,Axe,Pxe,Lxe,Bxe,Uxe,Gxe,Kxe,Yxe,Qxe,nwe,owe,cwe,hwe,fwe,ywe,xwe,bwe,kwe,Awe,Pwe,Mwe,Vwe,Hwe,qwe,Zwe,axe,tbe,obe,ube,gbe,xbe,bbe,Sbe,kbe,_be,Abe,Obe,Lbe,Bbe,Ube,jbe,Hbe,Ybe,Zbe,tCe,rCe,oCe,uCe,pCe,vCe,bCe,ICe,kCe,ECe,_Ce,RCe,DCe,OCe,BCe,zCe,GCe,KCe,YCe,QCe,sSe,aSe,oxe,cSe,rbe,dSe,mSe,vSe,cxe,CSe,TSe,NSe,ASe,OSe,BSe,zSe,HSe,YSe,QSe,tIe,iIe,aIe,cIe,fIe,mIe,yIe,xIe,bIe,kIe,_Ie,DIe,UIe,dxe,GIe,qIe,JIe,eke,zwe,ske,ike,ake,uke,pke,hxe,gke,vke,wke,Cke,Ske,Wwe,LIe,Tke,$ke,Pke,pxe,Mke,Uke,Gke,qke,Zke,eTe,sTe,oTe,cTe,dTe,mTe,vTe,CTe,kTe,_Te,ATe,$we,BIe,OTe,LTe,BTe,UTe,WTe,GTe,KTe,XTe,JTe,e3e,n3e,r3e,o3e,c3e,h3e,f3e,m3e,MIe,bxe,v3e,b3e,S3e,T3e,$3e,D3e,Cxe,O3e,L3e,V3e,rke];for(const t of U3e)Z5(t);function z3e({onPredictionChange:t}){const e=J.useRef(null),n=J.useRef(null),s=J.useRef(!1),r=J.useRef(null),i=J.useRef(null),[o,a]=J.useState(null),[l,c]=J.useState([]),[u,h]=J.useState(""),d=["Bună ziua","Mulțumesc","Salut"],f=.5,[p,g]=J.useState(!1),m=async()=>{try{const C=await sde("../../cuvintejs/model.json");a(C),g(!0)}catch(C){console.error("Eroare la incarcarea modelului:",C)}};function y(C){let k=[];C.poseLandmarks?k=C.poseLandmarks.map(R=>[R.x,R.y,R.z,R.visibility]).flat():k=Array(132).fill(0);let $=[];C.faceLandmarks?$=C.faceLandmarks.slice(0,468).map(E=>[E.x,E.y,E.z]).flat():$=Array(1404).fill(0);let I=[];C.leftHandLandmarks?I=C.leftHandLandmarks.map(R=>[R.x,R.y,R.z]).flat():I=Array(63).fill(0);let T=[];return C.rightHandLandmarks?T=C.rightHandLandmarks.map(R=>[R.x,R.y,R.z]).flat():T=Array(63).fill(0),[...k,...$,...I,...T]}function w(C,k){return C.filter(($,I)=>!Object.values(k).includes(I))}function b(C){const k=n.current,$=k.getContext("2d");if($.save(),$.clearRect(0,0,k.width,k.height),$.drawImage(C.image,0,0,k.width,k.height),$.lineWidth=5,C.poseLandmarks){const I=w(C.poseLandmarks,[0,1,2,3,4,5,6,7,8,9,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]);zs.drawLandmarks($,I.filter((T,R)=>Object.values(ei.POSE_LANDMARKS_LEFT).includes(R)),{visibilityMin:.65,color:"white",fillColor:"rgb(86, 227, 159)"}),zs.drawLandmarks($,I.filter((T,R)=>Object.values(ei.POSE_LANDMARKS_RIGHT).includes(R)),{visibilityMin:.65,color:"white",fillColor:"rgb(0, 217, 231)"})}if(C.rightHandLandmarks&&(zs.drawConnectors($,C.rightHandLandmarks,ei.HAND_CONNECTIONS,{color:"white"}),zs.drawLandmarks($,C.rightHandLandmarks,{color:"white",fillColor:"rgb(0,217,231)",lineWidth:2,radius:I=>zs.lerp(I.from.z,-.15,.1,10,1)})),C.leftHandLandmarks&&(zs.drawConnectors($,C.leftHandLandmarks,ei.HAND_CONNECTIONS,{color:"white"}),zs.drawLandmarks($,C.leftHandLandmarks,{color:"white",fillColor:"rgb(86, 227, 159)",lineWidth:2,radius:I=>zs.lerp(I.from.z,-.15,.1,10,1)})),C.faceLandmarks&&(zs.drawConnectors($,C.faceLandmarks,ei.FACEMESH_TESSELATION,{color:"#C0C0C070",lineWidth:1}),zs.drawConnectors($,C.faceLandmarks,ei.FACEMESH_RIGHT_EYE,{color:"rgb(0,217,231)"}),zs.drawConnectors($,C.faceLandmarks,ei.FACEMESH_RIGHT_EYEBROW,{color:"rgb(0,217,231)"}),zs.drawConnectors($,C.faceLandmarks,ei.FACEMESH_LEFT_EYE,{color:"rgb(86, 227, 159)"}),zs.drawConnectors($,C.faceLandmarks,ei.FACEMESH_LEFT_EYEBROW,{color:"rgb(86, 227, 159)"}),zs.drawConnectors($,C.faceLandmarks,ei.FACEMESH_FACE_OVAL,{color:"#E0E0E0",lineWidth:5}),zs.drawConnectors($,C.faceLandmarks,ei.FACEMESH_LIPS,{color:"#E0E0E0",lineWidth:5})),$.restore(),o){const I=y(C);c(T=>{const R=[I,...T.slice(0,59)];if(R.length===60){const E=o.predict(Gc([R])).arraySync()[0];if(E){const A=Gc(E).argMax().dataSync()[0];if(E[A]>f){const F=d[A];h(F)}}}return R})}else console.log("Model is not loaded yet")}return J.useEffect(()=>{u&&t(u)},[u,t]),J.useEffect(()=>{if(m(),p&&s.current===!1){const C=new ei.Holistic({locateFile:k=>`https://cdn.jsdelivr.net/npm/@mediapipe/holistic/${k}`});if(C.setOptions({modelComplexity:1,selfieMode:!1,smoothLandmarks:!0,enableSegmentation:!0,smoothSegmentation:!0,refineFaceLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),C.onResults(b),typeof e.current<"u"&&e.current!==null){const k=new bte.Camera(e.current,{onFrame:async()=>{if(e.current)try{await C.send({image:e.current})}catch($){console.error("Eroare la trimiterea video-ului spre MediaPipe: ",$)}},width:1920,height:1080});k.start(),r.current=C,i.current=k}s.current=!0}return()=>{s.current=!1,i.current&&i.current.stop(),r.current&&r.current.close(),o&&o.dispose()}},[p]),U.jsxs("div",{style:{width:"960px",height:"540px"},children:[U.jsx("video",{className:"rounded-xl",ref:e,style:{display:"none"}}),U.jsx("canvas",{className:"rounded-3xl",ref:n,width:"1920",height:"1080",style:{maxWidth:"100%"}})]})}const W3e="modulepreload",j3e=function(t){return"/"+t},AR={},lr=function(e,n,s){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));r=Promise.all(n.map(a=>{if(a=j3e(a),a in AR)return;AR[a]=!0;const l=a.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${c}`))return;const u=document.createElement("link");if(u.rel=l?"stylesheet":W3e,l||(u.as="script",u.crossOrigin=""),u.href=a,o&&u.setAttribute("nonce",o),document.head.appendChild(u),l)return new Promise((h,d)=>{u.addEventListener("load",h),u.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${a}`)))})}))}return r.then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})};var G3e=function(e,n,s){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("script");typeof n=="function"&&(s=n,n={}),n=n||{},s=s||function(){},i.type=n.type||"text/javascript",i.charset=n.charset||"utf8",i.async="async"in n?!!n.async:!0,i.src=e,n.attrs&&H3e(i,n.attrs),n.text&&(i.text=""+n.text);var o="onload"in i?DR:K3e;o(i,s),i.onload||DR(i,s),r.appendChild(i)};function H3e(t,e){for(var n in e)t.setAttribute(n,e[n])}function DR(t,e){t.onload=function(){this.onerror=this.onload=null,e(null,t)},t.onerror=function(){this.onerror=this.onload=null,e(new Error("Failed to load "+this.src),t)}}function K3e(t,e){t.onreadystatechange=function(){this.readyState!="complete"&&this.readyState!="loaded"||(this.onreadystatechange=null,e(null,t))}}var q3e=function(e){return X3e(e)&&!Y3e(e)};function X3e(t){return!!t&&typeof t=="object"}function Y3e(t){var e=Object.prototype.toString.call(t);return e==="[object RegExp]"||e==="[object Date]"||Q3e(t)}var J3e=typeof Symbol=="function"&&Symbol.for,Z3e=J3e?Symbol.for("react.element"):60103;function Q3e(t){return t.$$typeof===Z3e}function eEe(t){return Array.isArray(t)?[]:{}}function em(t,e){return e.clone!==!1&&e.isMergeableObject(t)?bd(eEe(t),t,e):t}function tEe(t,e,n){return t.concat(e).map(function(s){return em(s,n)})}function nEe(t,e){if(!e.customMerge)return bd;var n=e.customMerge(t);return typeof n=="function"?n:bd}function sEe(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[]}function PR(t){return Object.keys(t).concat(sEe(t))}function uB(t,e){try{return e in t}catch{return!1}}function rEe(t,e){return uB(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))}function iEe(t,e,n){var s={};return n.isMergeableObject(t)&&PR(t).forEach(function(r){s[r]=em(t[r],n)}),PR(e).forEach(function(r){rEe(t,r)||(uB(t,r)&&n.isMergeableObject(e[r])?s[r]=nEe(r,n)(t[r],e[r],n):s[r]=em(e[r],n))}),s}function bd(t,e,n){n=n||{},n.arrayMerge=n.arrayMerge||tEe,n.isMergeableObject=n.isMergeableObject||q3e,n.cloneUnlessOtherwiseSpecified=em;var s=Array.isArray(e),r=Array.isArray(t),i=s===r;return i?s?n.arrayMerge(t,e,n):iEe(t,e,n):em(e,n)}bd.all=function(e,n){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(s,r){return bd(s,r,n)},{})};var oEe=bd,hB=oEe,aEe=Object.create,ux=Object.defineProperty,lEe=Object.getOwnPropertyDescriptor,cEe=Object.getOwnPropertyNames,uEe=Object.getPrototypeOf,hEe=Object.prototype.hasOwnProperty,dEe=(t,e)=>{for(var n in e)ux(t,n,{get:e[n],enumerable:!0})},dB=(t,e,n,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of cEe(e))!hEe.call(t,r)&&r!==n&&ux(t,r,{get:()=>e[r],enumerable:!(s=lEe(e,r))||s.enumerable});return t},lE=(t,e,n)=>(n=t!=null?aEe(uEe(t)):{},dB(!t||!t.__esModule?ux(n,"default",{value:t,enumerable:!0}):n,t)),fEe=t=>dB(ux({},"__esModule",{value:!0}),t),fB={};dEe(fB,{callPlayer:()=>_Ee,getConfig:()=>EEe,getSDK:()=>TEe,isBlobUrl:()=>REe,isMediaStream:()=>$Ee,lazy:()=>yEe,omit:()=>NEe,parseEndTime:()=>SEe,parseStartTime:()=>CEe,queryString:()=>kEe,randomString:()=>IEe,supportsWebKitPresentationMode:()=>AEe});var hx=fEe(fB),pEe=lE(J),mEe=lE(G3e),gEe=lE(hB);const yEe=t=>pEe.default.lazy(async()=>{const e=await t();return typeof e.default=="function"?e:e.default}),vEe=/[?&#](?:start|t)=([0-9hms]+)/,xEe=/[?&#]end=([0-9hms]+)/,uS=/(\d+)(h|m|s)/g,wEe=/^\d+$/;function pB(t,e){if(t instanceof Array)return;const n=t.match(e);if(n){const s=n[1];if(s.match(uS))return bEe(s);if(wEe.test(s))return parseInt(s)}}function bEe(t){let e=0,n=uS.exec(t);for(;n!==null;){const[,s,r]=n;r==="h"&&(e+=parseInt(s,10)*60*60),r==="m"&&(e+=parseInt(s,10)*60),r==="s"&&(e+=parseInt(s,10)),n=uS.exec(t)}return e}function CEe(t){return pB(t,vEe)}function SEe(t){return pB(t,xEe)}function IEe(){return Math.random().toString(36).substr(2,5)}function kEe(t){return Object.keys(t).map(e=>`${e}=${t[e]}`).join("&")}function jw(t){return window[t]?window[t]:window.exports&&window.exports[t]?window.exports[t]:window.module&&window.module.exports&&window.module.exports[t]?window.module.exports[t]:null}const ah={},TEe=function(e,n,s=null,r=()=>!0,i=mEe.default){const o=jw(n);return o&&r(o)?Promise.resolve(o):new Promise((a,l)=>{if(ah[e]){ah[e].push({resolve:a,reject:l});return}ah[e]=[{resolve:a,reject:l}];const c=u=>{ah[e].forEach(h=>h.resolve(u))};if(s){const u=window[s];window[s]=function(){u&&u(),c(jw(n))}}i(e,u=>{u?(ah[e].forEach(h=>h.reject(u)),ah[e]=null):s||c(jw(n))})})};function EEe(t,e){return(0,gEe.default)(e.config,t.config)}function NEe(t,...e){const n=[].concat(...e),s={},r=Object.keys(t);for(const i of r)n.indexOf(i)===-1&&(s[i]=t[i]);return s}function _Ee(t,...e){if(!this.player||!this.player[t]){let n=`ReactPlayer: ${this.constructor.displayName} player could not call %c${t}%c – `;return this.player?this.player[t]||(n+="The method was not available"):n+="The player was not available",console.warn(n,"font-weight: bold",""),null}return this.player[t](...e)}function $Ee(t){return typeof window<"u"&&typeof window.MediaStream<"u"&&t instanceof window.MediaStream}function REe(t){return/^blob:/.test(t)}function AEe(t=document.createElement("video")){const e=/iPhone|iPod/.test(navigator.userAgent)===!1;return t.webkitSupportsPresentationMode&&typeof t.webkitSetPresentationMode=="function"&&e}var cE=Object.defineProperty,DEe=Object.getOwnPropertyDescriptor,PEe=Object.getOwnPropertyNames,OEe=Object.prototype.hasOwnProperty,FEe=(t,e)=>{for(var n in e)cE(t,n,{get:e[n],enumerable:!0})},LEe=(t,e,n,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of PEe(e))!OEe.call(t,r)&&r!==n&&cE(t,r,{get:()=>e[r],enumerable:!(s=DEe(e,r))||s.enumerable});return t},MEe=t=>LEe(cE({},"__esModule",{value:!0}),t),mB={};FEe(mB,{AUDIO_EXTENSIONS:()=>uE,DASH_EXTENSIONS:()=>_B,FLV_EXTENSIONS:()=>$B,HLS_EXTENSIONS:()=>dE,MATCH_URL_DAILYMOTION:()=>kB,MATCH_URL_FACEBOOK:()=>xB,MATCH_URL_FACEBOOK_WATCH:()=>wB,MATCH_URL_KALTURA:()=>NB,MATCH_URL_MIXCLOUD:()=>TB,MATCH_URL_MUX:()=>vB,MATCH_URL_SOUNDCLOUD:()=>gB,MATCH_URL_STREAMABLE:()=>bB,MATCH_URL_TWITCH_CHANNEL:()=>IB,MATCH_URL_TWITCH_VIDEO:()=>SB,MATCH_URL_VIDYARD:()=>EB,MATCH_URL_VIMEO:()=>yB,MATCH_URL_WISTIA:()=>CB,MATCH_URL_YOUTUBE:()=>hS,VIDEO_EXTENSIONS:()=>hE,canPlay:()=>VEe});var BEe=MEe(mB),OR=hx;const hS=/(?:youtu\.be\/|youtube(?:-nocookie|education)?\.com\/(?:embed\/|v\/|watch\/|watch\?v=|watch\?.+&v=|shorts\/|live\/))((\w|-){11})|youtube\.com\/playlist\?list=|youtube\.com\/user\//,gB=/(?:soundcloud\.com|snd\.sc)\/[^.]+$/,yB=/vimeo\.com\/(?!progressive_redirect).+/,vB=/stream\.mux\.com\/(?!\w+\.m3u8)(\w+)/,xB=/^https?:\/\/(www\.)?facebook\.com.*\/(video(s)?|watch|story)(\.php?|\/).+$/,wB=/^https?:\/\/fb\.watch\/.+$/,bB=/streamable\.com\/([a-z0-9]+)$/,CB=/(?:wistia\.(?:com|net)|wi\.st)\/(?:medias|embed)\/(?:iframe\/)?([^?]+)/,SB=/(?:www\.|go\.)?twitch\.tv\/videos\/(\d+)($|\?)/,IB=/(?:www\.|go\.)?twitch\.tv\/([a-zA-Z0-9_]+)($|\?)/,kB=/^(?:(?:https?):)?(?:\/\/)?(?:www\.)?(?:(?:dailymotion\.com(?:\/embed)?\/video)|dai\.ly)\/([a-zA-Z0-9]+)(?:_[\w_-]+)?(?:[\w.#_-]+)?/,TB=/mixcloud\.com\/([^/]+\/[^/]+)/,EB=/vidyard.com\/(?:watch\/)?([a-zA-Z0-9-_]+)/,NB=/^https?:\/\/[a-zA-Z]+\.kaltura.(com|org)\/p\/([0-9]+)\/sp\/([0-9]+)00\/embedIframeJs\/uiconf_id\/([0-9]+)\/partner_id\/([0-9]+)(.*)entry_id.([a-zA-Z0-9-_].*)$/,uE=/\.(m4a|m4b|mp4a|mpga|mp2|mp2a|mp3|m2a|m3a|wav|weba|aac|oga|spx)($|\?)/i,hE=/\.(mp4|og[gv]|webm|mov|m4v)(#t=[,\d+]+)?($|\?)/i,dE=/\.(m3u8)($|\?)/i,_B=/\.(mpd)($|\?)/i,$B=/\.(flv)($|\?)/i,dS=t=>{if(t instanceof Array){for(const e of t)if(typeof e=="string"&&dS(e)||dS(e.src))return!0;return!1}return(0,OR.isMediaStream)(t)||(0,OR.isBlobUrl)(t)?!0:uE.test(t)||hE.test(t)||dE.test(t)||_B.test(t)||$B.test(t)},VEe={youtube:t=>t instanceof Array?t.every(e=>hS.test(e)):hS.test(t),soundcloud:t=>gB.test(t)&&!uE.test(t),vimeo:t=>yB.test(t)&&!hE.test(t)&&!dE.test(t),mux:t=>vB.test(t),facebook:t=>xB.test(t)||wB.test(t),streamable:t=>bB.test(t),wistia:t=>CB.test(t),twitch:t=>SB.test(t)||IB.test(t),dailymotion:t=>kB.test(t),mixcloud:t=>TB.test(t),vidyard:t=>EB.test(t),kaltura:t=>NB.test(t),file:dS};var fE=Object.defineProperty,UEe=Object.getOwnPropertyDescriptor,zEe=Object.getOwnPropertyNames,WEe=Object.prototype.hasOwnProperty,jEe=(t,e)=>{for(var n in e)fE(t,n,{get:e[n],enumerable:!0})},GEe=(t,e,n,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of zEe(e))!WEe.call(t,r)&&r!==n&&fE(t,r,{get:()=>e[r],enumerable:!(s=UEe(e,r))||s.enumerable});return t},HEe=t=>GEe(fE({},"__esModule",{value:!0}),t),RB={};jEe(RB,{default:()=>qEe});var KEe=HEe(RB),ar=hx,Ws=BEe,qEe=[{key:"youtube",name:"YouTube",canPlay:Ws.canPlay.youtube,lazyPlayer:(0,ar.lazy)(()=>lr(()=>import("./YouTube-FgzRpTFQ.js").then(t=>t.Y),[]))},{key:"soundcloud",name:"SoundCloud",canPlay:Ws.canPlay.soundcloud,lazyPlayer:(0,ar.lazy)(()=>lr(()=>import("./SoundCloud-DCwkb2Zi.js").then(t=>t.S),[]))},{key:"vimeo",name:"Vimeo",canPlay:Ws.canPlay.vimeo,lazyPlayer:(0,ar.lazy)(()=>lr(()=>import("./Vimeo-BrM_nSnS.js").then(t=>t.V),[]))},{key:"mux",name:"Mux",canPlay:Ws.canPlay.mux,lazyPlayer:(0,ar.lazy)(()=>lr(()=>import("./Mux-BVp8LrXw.js").then(t=>t.M),[]))},{key:"facebook",name:"Facebook",canPlay:Ws.canPlay.facebook,lazyPlayer:(0,ar.lazy)(()=>lr(()=>import("./Facebook-CYDTkpaD.js").then(t=>t.F),[]))},{key:"streamable",name:"Streamable",canPlay:Ws.canPlay.streamable,lazyPlayer:(0,ar.lazy)(()=>lr(()=>import("./Streamable-Br8iW9md.js").then(t=>t.S),[]))},{key:"wistia",name:"Wistia",canPlay:Ws.canPlay.wistia,lazyPlayer:(0,ar.lazy)(()=>lr(()=>import("./Wistia-DGVaqYDe.js").then(t=>t.W),[]))},{key:"twitch",name:"Twitch",canPlay:Ws.canPlay.twitch,lazyPlayer:(0,ar.lazy)(()=>lr(()=>import("./Twitch-BX9gEruj.js").then(t=>t.T),[]))},{key:"dailymotion",name:"DailyMotion",canPlay:Ws.canPlay.dailymotion,lazyPlayer:(0,ar.lazy)(()=>lr(()=>import("./DailyMotion-JO60sTrV.js").then(t=>t.D),[]))},{key:"mixcloud",name:"Mixcloud",canPlay:Ws.canPlay.mixcloud,lazyPlayer:(0,ar.lazy)(()=>lr(()=>import("./Mixcloud-BSgDbsjg.js").then(t=>t.M),[]))},{key:"vidyard",name:"Vidyard",canPlay:Ws.canPlay.vidyard,lazyPlayer:(0,ar.lazy)(()=>lr(()=>import("./Vidyard-4nfpagZJ.js").then(t=>t.V),[]))},{key:"kaltura",name:"Kaltura",canPlay:Ws.canPlay.kaltura,lazyPlayer:(0,ar.lazy)(()=>lr(()=>import("./Kaltura-wjZ1dUYH.js").then(t=>t.K),[]))},{key:"file",name:"FilePlayer",canPlay:Ws.canPlay.file,canEnablePIP:t=>Ws.canPlay.file(t)&&(document.pictureInPictureEnabled||(0,ar.supportsWebKitPresentationMode)())&&!Ws.AUDIO_EXTENSIONS.test(t),lazyPlayer:(0,ar.lazy)(()=>lr(()=>import("./FilePlayer-U_l8K66V.js").then(t=>t.F),[]))}],FR=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function XEe(t,e){return!!(t===e||FR(t)&&FR(e))}function YEe(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!XEe(t[n],e[n]))return!1;return!0}function JEe(t,e){e===void 0&&(e=YEe);var n,s=[],r,i=!1;function o(){for(var a=[],l=0;l<arguments.length;l++)a[l]=arguments[l];return i&&n===this&&e(a,s)||(r=t.apply(this,a),i=!0,n=this,s=a),r}return o}const ZEe=Object.freeze(Object.defineProperty({__proto__:null,default:JEe},Symbol.toStringTag,{value:"Module"})),QEe=UR(ZEe);var e4e=typeof Element<"u",t4e=typeof Map=="function",n4e=typeof Set=="function",s4e=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function C1(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;var n,s,r;if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(s=n;s--!==0;)if(!C1(t[s],e[s]))return!1;return!0}var i;if(t4e&&t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(i=t.entries();!(s=i.next()).done;)if(!e.has(s.value[0]))return!1;for(i=t.entries();!(s=i.next()).done;)if(!C1(s.value[1],e.get(s.value[0])))return!1;return!0}if(n4e&&t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(i=t.entries();!(s=i.next()).done;)if(!e.has(s.value[0]))return!1;return!0}if(s4e&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(e)){if(n=t.length,n!=e.length)return!1;for(s=n;s--!==0;)if(t[s]!==e[s])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf&&typeof t.valueOf=="function"&&typeof e.valueOf=="function")return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString&&typeof t.toString=="function"&&typeof e.toString=="function")return t.toString()===e.toString();if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(e,r[s]))return!1;if(e4e&&t instanceof Element)return!1;for(s=n;s--!==0;)if(!((r[s]==="_owner"||r[s]==="__v"||r[s]==="__o")&&t.$$typeof)&&!C1(t[r[s]],e[r[s]]))return!1;return!0}return t!==t&&e!==e}var AB=function(e,n){try{return C1(e,n)}catch(s){if((s.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw s}},DB={exports:{}},r4e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",i4e=r4e,o4e=i4e;function PB(){}function OB(){}OB.resetWarningCache=PB;var a4e=function(){function t(s,r,i,o,a,l){if(l!==o4e){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:OB,resetWarningCache:PB};return n.PropTypes=n,n};DB.exports=a4e();var l4e=DB.exports,c4e=Object.create,dx=Object.defineProperty,u4e=Object.getOwnPropertyDescriptor,h4e=Object.getOwnPropertyNames,d4e=Object.getPrototypeOf,f4e=Object.prototype.hasOwnProperty,p4e=(t,e)=>{for(var n in e)dx(t,n,{get:e[n],enumerable:!0})},FB=(t,e,n,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of h4e(e))!f4e.call(t,r)&&r!==n&&dx(t,r,{get:()=>e[r],enumerable:!(s=u4e(e,r))||s.enumerable});return t},m4e=(t,e,n)=>(n=t!=null?c4e(d4e(t)):{},FB(!t||!t.__esModule?dx(n,"default",{value:t,enumerable:!0}):n,t)),g4e=t=>FB(dx({},"__esModule",{value:!0}),t),LB={};p4e(LB,{defaultProps:()=>x4e,propTypes:()=>v4e});var MB=g4e(LB),y4e=m4e(l4e);const{string:os,bool:js,number:lh,array:Gw,oneOfType:_f,shape:Ar,object:Cs,func:On,node:LR}=y4e.default,v4e={url:_f([os,Gw,Cs]),playing:js,loop:js,controls:js,volume:lh,muted:js,playbackRate:lh,width:_f([os,lh]),height:_f([os,lh]),style:Cs,progressInterval:lh,playsinline:js,pip:js,stopOnUnmount:js,light:_f([js,os,Cs]),playIcon:LR,previewTabIndex:lh,previewAriaLabel:os,fallback:LR,oEmbedUrl:os,wrapper:_f([os,On,Ar({render:On.isRequired})]),config:Ar({soundcloud:Ar({options:Cs}),youtube:Ar({playerVars:Cs,embedOptions:Cs,onUnstarted:On}),facebook:Ar({appId:os,version:os,playerId:os,attributes:Cs}),dailymotion:Ar({params:Cs}),vimeo:Ar({playerOptions:Cs,title:os}),mux:Ar({attributes:Cs,version:os}),file:Ar({attributes:Cs,tracks:Gw,forceVideo:js,forceAudio:js,forceHLS:js,forceSafariHLS:js,forceDisableHls:js,forceDASH:js,forceFLV:js,hlsOptions:Cs,hlsVersion:os,dashVersion:os,flvVersion:os}),wistia:Ar({options:Cs,playerId:os,customControls:Gw}),mixcloud:Ar({options:Cs}),twitch:Ar({options:Cs,playerId:os}),vidyard:Ar({options:Cs})}),onReady:On,onStart:On,onPlay:On,onPause:On,onBuffer:On,onBufferEnd:On,onEnded:On,onError:On,onDuration:On,onSeek:On,onPlaybackRateChange:On,onPlaybackQualityChange:On,onProgress:On,onClickPreview:On,onEnablePIP:On,onDisablePIP:On},as=()=>{},x4e={playing:!1,loop:!1,controls:!1,volume:null,muted:!1,playbackRate:1,width:"640px",height:"360px",style:{},progressInterval:1e3,playsinline:!1,pip:!1,stopOnUnmount:!0,light:!1,fallback:null,wrapper:"div",previewTabIndex:0,previewAriaLabel:"",oEmbedUrl:"https://noembed.com/embed?url={url}",config:{soundcloud:{options:{visual:!0,buying:!1,liking:!1,download:!1,sharing:!1,show_comments:!1,show_playcount:!1}},youtube:{playerVars:{playsinline:1,showinfo:0,rel:0,iv_load_policy:3,modestbranding:1},embedOptions:{},onUnstarted:as},facebook:{appId:"1309697205772819",version:"v3.3",playerId:null,attributes:{}},dailymotion:{params:{api:1,"endscreen-enable":!1}},vimeo:{playerOptions:{autopause:!1,byline:!1,portrait:!1,title:!1},title:null},mux:{attributes:{},version:"2"},file:{attributes:{},tracks:[],forceVideo:!1,forceAudio:!1,forceHLS:!1,forceDASH:!1,forceFLV:!1,hlsOptions:{},hlsVersion:"1.1.4",dashVersion:"3.1.3",flvVersion:"1.5.0",forceDisableHls:!1},wistia:{options:{},playerId:null,customControls:null},mixcloud:{options:{hide_cover:1}},twitch:{options:{},playerId:null},vidyard:{options:{}}},onReady:as,onStart:as,onPlay:as,onPause:as,onBuffer:as,onBufferEnd:as,onEnded:as,onError:as,onDuration:as,onSeek:as,onPlaybackRateChange:as,onPlaybackQualityChange:as,onProgress:as,onClickPreview:as,onEnablePIP:as,onDisablePIP:as};var w4e=Object.create,Fg=Object.defineProperty,b4e=Object.getOwnPropertyDescriptor,C4e=Object.getOwnPropertyNames,S4e=Object.getPrototypeOf,I4e=Object.prototype.hasOwnProperty,k4e=(t,e,n)=>e in t?Fg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,T4e=(t,e)=>{for(var n in e)Fg(t,n,{get:e[n],enumerable:!0})},BB=(t,e,n,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of C4e(e))!I4e.call(t,r)&&r!==n&&Fg(t,r,{get:()=>e[r],enumerable:!(s=b4e(e,r))||s.enumerable});return t},VB=(t,e,n)=>(n=t!=null?w4e(S4e(t)):{},BB(!t||!t.__esModule?Fg(n,"default",{value:t,enumerable:!0}):n,t)),E4e=t=>BB(Fg({},"__esModule",{value:!0}),t),pn=(t,e,n)=>(k4e(t,typeof e!="symbol"?e+"":e,n),n),UB={};T4e(UB,{default:()=>fx});var N4e=E4e(UB),MR=VB(J),_4e=VB(AB),zB=MB,$4e=hx;const R4e=5e3;class fx extends MR.Component{constructor(){super(...arguments),pn(this,"mounted",!1),pn(this,"isReady",!1),pn(this,"isPlaying",!1),pn(this,"isLoading",!0),pn(this,"loadOnReady",null),pn(this,"startOnPlay",!0),pn(this,"seekOnPlay",null),pn(this,"onDurationCalled",!1),pn(this,"handlePlayerMount",e=>{if(this.player){this.progress();return}this.player=e,this.player.load(this.props.url),this.progress()}),pn(this,"getInternalPlayer",e=>this.player?this.player[e]:null),pn(this,"progress",()=>{if(this.props.url&&this.player&&this.isReady){const e=this.getCurrentTime()||0,n=this.getSecondsLoaded(),s=this.getDuration();if(s){const r={playedSeconds:e,played:e/s};n!==null&&(r.loadedSeconds=n,r.loaded=n/s),(r.playedSeconds!==this.prevPlayed||r.loadedSeconds!==this.prevLoaded)&&this.props.onProgress(r),this.prevPlayed=r.playedSeconds,this.prevLoaded=r.loadedSeconds}}this.progressTimeout=setTimeout(this.progress,this.props.progressFrequency||this.props.progressInterval)}),pn(this,"handleReady",()=>{if(!this.mounted)return;this.isReady=!0,this.isLoading=!1;const{onReady:e,playing:n,volume:s,muted:r}=this.props;e(),!r&&s!==null&&this.player.setVolume(s),this.loadOnReady?(this.player.load(this.loadOnReady,!0),this.loadOnReady=null):n&&this.player.play(),this.handleDurationCheck()}),pn(this,"handlePlay",()=>{this.isPlaying=!0,this.isLoading=!1;const{onStart:e,onPlay:n,playbackRate:s}=this.props;this.startOnPlay&&(this.player.setPlaybackRate&&s!==1&&this.player.setPlaybackRate(s),e(),this.startOnPlay=!1),n(),this.seekOnPlay&&(this.seekTo(this.seekOnPlay),this.seekOnPlay=null),this.handleDurationCheck()}),pn(this,"handlePause",e=>{this.isPlaying=!1,this.isLoading||this.props.onPause(e)}),pn(this,"handleEnded",()=>{const{activePlayer:e,loop:n,onEnded:s}=this.props;e.loopOnEnded&&n&&this.seekTo(0),n||(this.isPlaying=!1,s())}),pn(this,"handleError",(...e)=>{this.isLoading=!1,this.props.onError(...e)}),pn(this,"handleDurationCheck",()=>{clearTimeout(this.durationCheckTimeout);const e=this.getDuration();e?this.onDurationCalled||(this.props.onDuration(e),this.onDurationCalled=!0):this.durationCheckTimeout=setTimeout(this.handleDurationCheck,100)}),pn(this,"handleLoaded",()=>{this.isLoading=!1})}componentDidMount(){this.mounted=!0}componentWillUnmount(){clearTimeout(this.progressTimeout),clearTimeout(this.durationCheckTimeout),this.isReady&&this.props.stopOnUnmount&&(this.player.stop(),this.player.disablePIP&&this.player.disablePIP()),this.mounted=!1}componentDidUpdate(e){if(!this.player)return;const{url:n,playing:s,volume:r,muted:i,playbackRate:o,pip:a,loop:l,activePlayer:c,disableDeferredLoading:u}=this.props;if(!(0,_4e.default)(e.url,n)){if(this.isLoading&&!c.forceLoad&&!u&&!(0,$4e.isMediaStream)(n)){console.warn(`ReactPlayer: the attempt to load ${n} is being deferred until the player has loaded`),this.loadOnReady=n;return}this.isLoading=!0,this.startOnPlay=!0,this.onDurationCalled=!1,this.player.load(n,this.isReady)}!e.playing&&s&&!this.isPlaying&&this.player.play(),e.playing&&!s&&this.isPlaying&&this.player.pause(),!e.pip&&a&&this.player.enablePIP&&this.player.enablePIP(),e.pip&&!a&&this.player.disablePIP&&this.player.disablePIP(),e.volume!==r&&r!==null&&this.player.setVolume(r),e.muted!==i&&(i?this.player.mute():(this.player.unmute(),r!==null&&setTimeout(()=>this.player.setVolume(r)))),e.playbackRate!==o&&this.player.setPlaybackRate&&this.player.setPlaybackRate(o),e.loop!==l&&this.player.setLoop&&this.player.setLoop(l)}getDuration(){return this.isReady?this.player.getDuration():null}getCurrentTime(){return this.isReady?this.player.getCurrentTime():null}getSecondsLoaded(){return this.isReady?this.player.getSecondsLoaded():null}seekTo(e,n,s){if(!this.isReady){e!==0&&(this.seekOnPlay=e,setTimeout(()=>{this.seekOnPlay=null},R4e));return}if(n?n==="fraction":e>0&&e<1){const i=this.player.getDuration();if(!i){console.warn("ReactPlayer: could not seek using fraction – duration not yet available");return}this.player.seekTo(i*e,s);return}this.player.seekTo(e,s)}render(){const e=this.props.activePlayer;return e?MR.default.createElement(e,{...this.props,onMount:this.handlePlayerMount,onReady:this.handleReady,onPlay:this.handlePlay,onPause:this.handlePause,onEnded:this.handleEnded,onLoaded:this.handleLoaded,onError:this.handleError}):null}}pn(fx,"displayName","Player");pn(fx,"propTypes",zB.propTypes);pn(fx,"defaultProps",zB.defaultProps);var A4e=Object.create,Lg=Object.defineProperty,D4e=Object.getOwnPropertyDescriptor,P4e=Object.getOwnPropertyNames,O4e=Object.getPrototypeOf,F4e=Object.prototype.hasOwnProperty,L4e=(t,e,n)=>e in t?Lg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,M4e=(t,e)=>{for(var n in e)Lg(t,n,{get:e[n],enumerable:!0})},WB=(t,e,n,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of P4e(e))!F4e.call(t,r)&&r!==n&&Lg(t,r,{get:()=>e[r],enumerable:!(s=D4e(e,r))||s.enumerable});return t},Mg=(t,e,n)=>(n=t!=null?A4e(O4e(t)):{},WB(!t||!t.__esModule?Lg(n,"default",{value:t,enumerable:!0}):n,t)),B4e=t=>WB(Lg({},"__esModule",{value:!0}),t),fn=(t,e,n)=>(L4e(t,typeof e!="symbol"?e+"":e,n),n),jB={};M4e(jB,{createReactPlayer:()=>q4e});var V4e=B4e(jB),dh=Mg(J),U4e=Mg(hB),Hw=Mg(QEe),BR=Mg(AB),Kf=MB,GB=hx,z4e=Mg(N4e);const W4e=(0,GB.lazy)(()=>lr(()=>import("./Preview-pF8_zXOb.js").then(t=>t.P),[])),j4e=typeof window<"u"&&window.document&&typeof document<"u",G4e=typeof zn<"u"&&zn.window&&zn.window.document,H4e=Object.keys(Kf.propTypes),K4e=j4e||G4e?dh.Suspense:()=>null,$f=[],q4e=(t,e)=>{var n;return n=class extends dh.Component{constructor(){super(...arguments),fn(this,"state",{showPreview:!!this.props.light}),fn(this,"references",{wrapper:s=>{this.wrapper=s},player:s=>{this.player=s}}),fn(this,"handleClickPreview",s=>{this.setState({showPreview:!1}),this.props.onClickPreview(s)}),fn(this,"showPreview",()=>{this.setState({showPreview:!0})}),fn(this,"getDuration",()=>this.player?this.player.getDuration():null),fn(this,"getCurrentTime",()=>this.player?this.player.getCurrentTime():null),fn(this,"getSecondsLoaded",()=>this.player?this.player.getSecondsLoaded():null),fn(this,"getInternalPlayer",(s="player")=>this.player?this.player.getInternalPlayer(s):null),fn(this,"seekTo",(s,r,i)=>{if(!this.player)return null;this.player.seekTo(s,r,i)}),fn(this,"handleReady",()=>{this.props.onReady(this)}),fn(this,"getActivePlayer",(0,Hw.default)(s=>{for(const r of[...$f,...t])if(r.canPlay(s))return r;return e||null})),fn(this,"getConfig",(0,Hw.default)((s,r)=>{const{config:i}=this.props;return U4e.default.all([Kf.defaultProps.config,Kf.defaultProps.config[r]||{},i,i[r]||{}])})),fn(this,"getAttributes",(0,Hw.default)(s=>(0,GB.omit)(this.props,H4e))),fn(this,"renderActivePlayer",s=>{if(!s)return null;const r=this.getActivePlayer(s);if(!r)return null;const i=this.getConfig(s,r.key);return dh.default.createElement(z4e.default,{...this.props,key:r.key,ref:this.references.player,config:i,activePlayer:r.lazyPlayer||r,onReady:this.handleReady})})}shouldComponentUpdate(s,r){return!(0,BR.default)(this.props,s)||!(0,BR.default)(this.state,r)}componentDidUpdate(s){const{light:r}=this.props;!s.light&&r&&this.setState({showPreview:!0}),s.light&&!r&&this.setState({showPreview:!1})}renderPreview(s){if(!s)return null;const{light:r,playIcon:i,previewTabIndex:o,oEmbedUrl:a,previewAriaLabel:l}=this.props;return dh.default.createElement(W4e,{url:s,light:r,playIcon:i,previewTabIndex:o,previewAriaLabel:l,oEmbedUrl:a,onClick:this.handleClickPreview})}render(){const{url:s,style:r,width:i,height:o,fallback:a,wrapper:l}=this.props,{showPreview:c}=this.state,u=this.getAttributes(s),h=typeof l=="string"?this.references.wrapper:void 0;return dh.default.createElement(l,{ref:h,style:{...r,width:i,height:o},...u},dh.default.createElement(K4e,{fallback:a},c?this.renderPreview(s):this.renderActivePlayer(s)))}},fn(n,"displayName","ReactPlayer"),fn(n,"propTypes",Kf.propTypes),fn(n,"defaultProps",Kf.defaultProps),fn(n,"addCustomPlayer",s=>{$f.push(s)}),fn(n,"removeCustomPlayers",()=>{$f.length=0}),fn(n,"canPlay",s=>{for(const r of[...$f,...t])if(r.canPlay(s))return!0;return!1}),fn(n,"canEnablePIP",s=>{for(const r of[...$f,...t])if(r.canEnablePIP&&r.canEnablePIP(s))return!0;return!1}),n};var X4e=Object.create,px=Object.defineProperty,Y4e=Object.getOwnPropertyDescriptor,J4e=Object.getOwnPropertyNames,Z4e=Object.getPrototypeOf,Q4e=Object.prototype.hasOwnProperty,eNe=(t,e)=>{for(var n in e)px(t,n,{get:e[n],enumerable:!0})},HB=(t,e,n,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of J4e(e))!Q4e.call(t,r)&&r!==n&&px(t,r,{get:()=>e[r],enumerable:!(s=Y4e(e,r))||s.enumerable});return t},tNe=(t,e,n)=>(n=t!=null?X4e(Z4e(t)):{},HB(!t||!t.__esModule?px(n,"default",{value:t,enumerable:!0}):n,t)),nNe=t=>HB(px({},"__esModule",{value:!0}),t),KB={};eNe(KB,{default:()=>oNe});var sNe=nNe(KB),fS=tNe(KEe),rNe=V4e;const iNe=fS.default[fS.default.length-1];var oNe=(0,rNe.createReactPlayer)(fS.default,iNe);const aNe=pS(sNe);function lNe({isAdmin:t}){const[e,n]=J.useState([]),[s,r]=J.useState(null),[i,o]=J.useState(""),[a,l]=J.useState({}),c=om(),u=async()=>{const m=kC(TC,"videos/");try{const y=await Zee(m),w=await Promise.all(y.items.map(async C=>{const k=await C5(C),$=await Yee(C);return{name:C.name.replace(".mp4",""),description:$.customMetadata.description||"Nu exista instructiuni pentru acest cuvant",url:k,ref:C}}));n(w);const b=w.reduce((C,k,$)=>(C[k.name]=$,C),{});l(b)}catch(y){console.error("Error fetching videos:",y)}},h=async m=>{if(!m){alert("Nu s-a scris nimic in campul de editare!");return}try{const y={customMetadata:{description:i}},w=kC(TC,`videos/${m.name}.mp4`);await Jee(w,y),n(b=>b.map(C=>C.name===m.name?{...C,description:i}:C))}catch(y){console.log("Error updating video metadata: ",y)}},d=m=>{s===m?(h(m),r(null)):r(m)},f=m=>{o(m.target.value)},p=m=>{l(y=>({...y,[m]:y[m]+1}))},g=m=>{c("/Practice",{state:{videoName:m.name}})};return J.useEffect(()=>{u()},[]),U.jsx("div",{className:"w-full flex flex-col items-center gap-4 p-4",children:e.map((m,y)=>U.jsxs(Le.div,{className:"w-9/10 h-96 bg-tertiary-color rounded-[30px] flex items-center",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:y*.1},children:[U.jsxs(Le.div,{className:"w-5/10 h-full flex flex-col items-center",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.5+y*.1},children:[U.jsx("h1",{className:"my-4",children:m.name}),U.jsx("div",{className:"w-9/10 h-8/10 bg-white rounded-3xl shadow-lg overflow-hidden",children:U.jsx("div",{className:"w-full h-full",children:U.jsx(aNe,{url:m.url,width:"100%",height:"100%",controls:!0,light:!1,style:{backgroundColor:"black"},onEnded:()=>p(m.name)},a[m.name])})})]}),U.jsxs(Le.div,{className:"w-5/10 h-9/10 mr-4 rounded-xl bg-blue-300",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.8+y*.1},children:[U.jsxs("div",{className:"w-full h-1/2",children:[U.jsx("h1",{className:"pt-4 pl-4 text-4xl font-bold mb-2",children:"Instrucțiuni:"}),s===m?U.jsx(Le.textarea,{initial:{backgroundColor:s===m?"bg-blue-300":"var(--tertiary-color)",paddingLeft:s===m?"1rem":"2rem"},animate:{backgroundColor:s===m?"var(--tertiary-color)":"bg-blue-300",paddingLeft:s===m?"2rem":"1rem"},className:"w-full h-full placeholder:text-white placeholder-text-xl bg-transparent border-none outline-none rounded-md",type:"text",placeholder:m.description,value:i,onChange:w=>f(w)}):U.jsx("p",{className:"pl-4 text-xl",children:m.description})]}),U.jsxs("div",{className:"w-full h-1/2 flex items-end justify-end pr-4 pb-4 gap-4",children:[U.jsx(vl,{children:s===m&&U.jsx(Le.button,{className:"flex items-center justify-center w-64 h-12 bg-secondary-color rounded-xl text-xl font-bold pb-1",whileHover:{scale:[null,1.3,1.2]},initial:{scale:1},animate:{scale:[null,1.2,1]},exit:{opacity:0},transition:{duration:.2},type:"button",onClick:()=>r(null),children:"Anulați"})}),t&&U.jsx(Le.button,{className:"flex items-center justify-center w-64 h-12 bg-secondary-color rounded-xl text-xl font-bold pb-1",whileHover:{scale:[null,1.3,1.2]},transition:{duration:.2},type:"button",onClick:()=>d(m),children:s===m?"Trimiteți":"Modificati instrucțiunile"}),U.jsx(Le.button,{className:"flex items-center justify-center w-48 h-12 bg-secondary-color rounded-xl text-xl font-bold pb-1",whileHover:{scale:[null,1.3,1.2]},transition:{duration:.2},type:"button",onClick:()=>g(m),children:"Exersați cuvântul"})]})]})]},y))})}const cNe=Rd(lNe);function uNe(){var h;const[t,e]=J.useState(""),s=((h=Ul().state)==null?void 0:h.videoName)||"",[r,i]=J.useState(!1),[o,a]=J.useState({}),l=async d=>{try{if(d){const p=sl(d).id,g=await fetch(`https://europe-west1-proiect-licenta-fc2a8.cloudfunctions.net/api/user/${p}`),m=await g.json();g.ok?!m.userData.firstName&&!m.userData.lastName?a({firstName:"",lastName:"",username:m.userData.username,email:m.userData.email,role:m.userData.role,id:m.userData.uid,progress:m.userData.progress}):m.userData.firstName?m.userData.lastName?a({firstName:m.userData.firstName,lastName:m.userData.lastName,username:m.userData.username,email:m.userData.email,role:m.userData.role,id:m.userData.uid,progress:m.userData.progress}):a({firstName:m.userData.firstName,lastName:"",username:m.userData.username,email:m.userData.email,role:m.userData.role,id:m.userData.uid,progress:m.userData.progress}):a({firstName:"",lastName:m.userData.lastName,username:m.userData.username,email:m.userData.email,role:m.userData.role,id:m.userData.uid,progress:m.userData.progress}):console.error("Failed to fetch user data: ",m.error)}else throw new Error("Token not found.")}catch(f){console.error("Error fetching user: ",f)}};function c(d){const f={ă:"a",â:"a",î:"i",ș:"s",ț:"t",Ă:"A",Â:"A",Î:"I",Ș:"S",Ț:"T"};return d.replace(/[ăâîșțĂÂÎȘȚ]/g,p=>f[p])}const u=async d=>{e(d),c(t).toLowerCase()===s.toLowerCase()&&!r&&setTimeout(async()=>{try{(await fetch(`https://europe-west1-proiect-licenta-fc2a8.cloudfunctions.net/api/user/${o.id}/progress`,{method:"PATCH"})).ok&&(alert("Ati ghicit cuvântul, felicitări!"),i(!0),l(localStorage.getItem("token")))}catch(p){console.error("Error updating user progress: ",p)}},100)};return J.useEffect(()=>{const d=localStorage.getItem("token");l(d)},[]),U.jsx("div",{className:"w-full h-full absolute flex flex-row justify-center items-center gap-4",children:U.jsxs(Le.div,{className:"w-full h-9/10 mx-4 rounded-[30px] bg-tertiary-color",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.2},children:[U.jsxs("div",{className:"w-full h-2/3 pt-4 gap-4 flex flex-col items-center",children:[U.jsx("h1",{className:"text-3xl font-bold underline",children:"Detectarea cuvintelor mimate"}),U.jsx(z3e,{onPredictionChange:u})]}),U.jsx("div",{className:"w-full h-1/3 pt-4 gap-4 flex flex-col items-center",children:U.jsxs(Le.div,{className:"w-1/2 h-full pt-4 mb-8 rounded-3xl bg-blue-300 gap-4 flex flex-col items center",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.3},children:[U.jsx("h1",{className:"text-4xl text-center",children:"Bun venit pe pagina de detectare a limbajului semnelor"}),U.jsx("h1",{className:"text-xl text-center",children:"Vă rugăm să vă centrați în cadrul camerei video în așa fel încât să se vadă jumătatea de sus a corpului. După care încercați să reproduceți mișcarea prezentată în videoclipul cuvântului selectat."}),U.jsxs("h1",{className:"text-2xl text-center",children:["Cuvânt detectat: ",t]}),U.jsxs("h1",{children:["Scor: ",o.progress]})]})})]})})}const hNe=Rd(uNe),qB="data:image/jpeg;base64,UklGRmILAABXRUJQVlA4IFYLAAAQlgCdASpYAlgCPlEokkajoqGhItVIUHAKCWlu4XaeXfJxoyUjPtv+M7SPMvWN382hfZTiRn4XpPCn+y11X7d6DfpM+DgSAO9fyvNWnleatPK81aeV5q08rzVp5XmrTyvNWnleatPK81aeV5q08rzVp5XmrTyvNWnleatPK81aeU3O1m7MZHFDpq08rzVp5XmrTyvNWej1/cnoPXa4/Egqb5hAGkGaf17mbEXA19Muq7GGQjRxV5q08rzVp4ggJgPM2jI5Mv2mrPDqrFF9DOKvNWnleatPK8k7VirlVb0XmrTymbxzqvnkB4dc8JUwBo8/zi0OmrTyvNWegiBzWjlfzi0OmrVjLfAB8YZSJo4q81aeV5qmTDVUE4srzVp5Xmqb5JYKRo4q81aeV5qnTYNLgiPCqt7+Jyn3bre5Cq08rzVp5XmrPbdsLNDHZtaiwLAgKDPYnz2xQKuR2DCkq6q7pCe0Rc3CkMmXct3HhAWrLb62A48NRxV5q08rzVowcKSudAreszYy7nwQpNy6hR9vYIim5vnQ71/K81aeV5NM0YbvZzno1aeV5qmPWgKZqHi6eCvNWnleatPK5yoJDTjWF681aeVzedcgpSrcv8D0I0cVeatNvWkEeAeEm3DY+EaOKvNAV5Wrmf81MdT+cWh01aeV5oLqE0aIlqA8Hv5XmrTw3rOxhEY1dq81aeV5q08rmSlKa5xFk2HxFodNWnhzoxgmnqPKtTVp5XmrTyvJowuAjraHGMPPoAdgAodNWnlLXMB28fIYS/R+lwuaHTVp5XmrTxCVMNS7ygeRaHTVp4cCPYmMDmZXmrTyvNWniGX+r6ev5XmrTyzENXQiatPK81aeV5qoXke2Onr+V5q08SB6nHXyvNWnleatPKZtOv8cDvX8rzVn3bAimp6/leatPK81Z9V4dWYhGdWnleatN1wQoPO1WnleatPK81aeIaL5MhGjirzQ0Uze/y6fgehGjirzVpu87OouHlI9fyvNVCJpA+yKvNWnleatPK81yk02jbUbyvNWm63zZYbGq08rzVp5XmrTyufZoiiiqSEOmrTw3DfDnwfitb45q08rzVp5XmrTyucAXBZlc87wgEIy34k4mrq+7Gsnv5XmrTyvNWnleaqG0vQmgzKSZJJFTiaPpzttXFvleatPK81aeV5q06y99NFS3qOpRTxxF7CRyr+8M7vzC5hTtVwb31CtYHoRo4q81aeV5oatt2kXka6y9UG+DZP8eBtUqcfF0/A9CNHFXmrPqFkon2QsnUCtxtXNN7Mkb2YcTl792eEnfKLKNeLBbeJE1PwPQjRxV5J0zPr/95RWE5QlOqHFRKYA3wbKBdS3+fSbQfFdsU4bKHdPHWjYco/nFodNEU09QorpL8AA8B5qwXHXEy6RIFAIad14oMgqo8IVcTJeIUas9bKX24KbnDW5M4tDpJ3SmNHdkVp+cNDIQjRuT9bacycTEjiQxGxQFDeRVDLGgAjRxHN1OKNH/3wlTAKHGw2MfHSjotDpq08s5iL+V5rq+3KjSyPCAozgijAWv0BLKNgO9fyvNWnleatPK81UIl8dqskT9dsAVmzn/gehGjirzVp5XmrTyvNVBaRxiuAA/v0loAAABn/NfpG7Rx8H0VPpE0bNRRTFaSpvaKtGfYRrW3iStMSEQpnkyC62c1nh4t6y+TRjYZb+nFS325kOpRtNgDbncEYff1aRcorNRrUfGiRCT34uDDquKbMJ4/xAIOZnMtX4HNIPSseu7p29W1xB8ufYQBj8lmrobIpefHmUbrIcJqX7eBvu/mQl1zlOjLN/i9gTvF9aZis4QW633pRPWdYVTGUepJzdkxwG7RER24gy7/VLrmVdGce3UTQ4EPpYnUmYM1zcQiONVmY46kVwTx6hb1rvygn87wC0enlzNUC+bwnWVrUVFNs0JEqQJfEGYSH4LncTtIS843HuH9cYI+leA1eWPFIOVVbwQw1q0K1TDz+3YQk4lQ5bedqjeUjPjd9hXy+ZTPodwafruHHCcYR1PYCuX80tC2vYzmXaLoiP4wSxbRBPaVwCP8RAdOEJDIcjbsgO1FcU4t7FH1r9qyRhenMe/nXO6LdDBsV8bDWWnSUFR32jDAPDJTOA+9Ai3JSRJb63wZlI5dBHHJaq9HgumG0W+rjl2VVvvnwt3O/XflsqZ1dHdcYGzmxd582yDOJwZmbZc+FUeKIrJQMU/Qi55Kx0T6x6gs5v7g75KvbbHl44A6gNzIYAtksjrQNPQzOcO4kfX/opXvhEO8brPB+Ib9pNDP3bbnWmynKE5VM1o3KRCRWurUsAyC6Pdo7gqv1j226PytUCmh+sh4zJr5qyN+v8ooOhCnIR6JdacBsStXAp8tVQiKLBgSBFusZCpen1gVoJT2B9Qi6E1A9ENNo5EKYJwhzfz4pAWyih7s+GWN/Ndr1a3vCRyonGES6JBCBv19jIoTNOR1mXbWCZF4+bv7M5M0DmAOq7sVeUGm4+Ov0Z1xyKnWg9wd8MZruIZ48Sxial9Ko8ENm02EzUOy8N9JT1der4DWLi89RUCsSODvzrMadGUEVWD3kmPc8ON5FpPIw9iNM2UZ2QpAN+ZBFXMtyV5lHqc8MVcGHroqplAn1J0JzBaSanRKVQSCNIZXC+PXtvGUjkCnBKgceivPKPt9dmh+UWO5WBlfGQW+/pR7XKsz82KYobANg/rxRW6g6ofsfgNrElrBOgAkbJhMSQnotXf6CwObHXNCxl9klTNkVV6xhEuT3b72EgwZmoyrBvqAAV6/msxfFYqnTFdon1UrouQnxQF/304I2I2UDIA7INrmOdZXL2qqj2zGu55Kn50D/Nb2VlQkH7stCsz4mDqSUoRuEXO5oS0JHsZEKiSW+9unI48B64uc68s7lgi3xB6SMRraDTRhmCI2oAP+Aa2ngGr0QM+OdLAjGIXy86fIgFBHUm2Tv4vBmV1Fge1bzDUMTLJhffKQ/T9E3Jrdh30VAvGJlnqmfyWz1MSDiaravtaJzQjbPNB1GVdzYIh69EEwMa1nnUNrw84oZviwCzQlqMP7YNfjBIhaSxAtJENXtKVyAMKHD/LjQAIWAVIAd84i9xe38ZoJCrmb8T8uFU9tMrNyfdFsPq7XXv6P4RAH7kL8shxxoDskue18833bxfj25iKCJ4SHe1X48kYo1wDmO9WR/kUETZbPbNrwMRE8mw33544P8UqmCo3GMBqdjaRWOopIzBe34oVpKB4GsuDeaRUMhUS2aOXUWgyuMHZlfVNiXmDiFOe8QrobMWqY6Gwb3ZRDIuoN8NHE/yEojBtei640nVRLJ/vWRY5SbYEFedA3i6SZnzcrDh7R0GdGJ8NpzvDot1FnPOKRDQBUApNU+v37s9zh+sGuCAYA9PG9vRgdSgoAmjqZDowuDuJFqJDbrOMQoDwBdzy5t0Dc7/e6WEniQe4pv1miS2tuGih+pTz0cIJvvTUPYz+FBEruhdpdVR7h8hv3+eQEx8sdTMZsyPc0BTZiZf0SGv/zvEi2BaR8QlhwxRXilX21+76BoDCYwuYnjpx5xqa28SS2+8gTIqdSDoz4UFEJAp2255Fqqrs1e7iHZYWhghXVeBWOEaO6Hs5iXr/wPdunJR2nujvHe4Ao16zTgGbX92VLjKxIPCptW+XnkT0oBvh+cdt1vffi1TCAqEYrSd8YvVmfamEfzTcZtbI6M55L8jmgmJ9U180Q+LVqtV3C/ZBiZIZQtxaWc4xLDTLAa0Q+OYx7MCHyxPgQ8+LwSrvh2ZouLyjWH4ptrtMAlZEOBNMPFAEtGfPuDCNHq38K6pok1X9o9MNlE1anBvDHhNzV/GQAiUQzIV95MtxrcNlB34YqM3q5MA9wZZcAAA";function dNe(){const[t,e]=J.useState(!1),[n,s]=J.useState(!1),[r,i]=J.useState(!1),[o,a]=J.useState(!1),[l,c]=J.useState(null),[u,h]=J.useState({firstName:"",lastName:"",username:"",email:"",role:""}),d=()=>{e(!t)},f=async()=>{console.log("am intrat in submit");try{const b=localStorage.getItem("token"),k=sl(b).id,$=await fetch(`https://europe-west1-proiect-licenta-fc2a8.cloudfunctions.net/api/user/${k}/firstName`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:u.firstName})});if($.ok){const I=await $.json();console.log(I.message)}else{const I=await $.json();console.error("Failed to update first name: ",I.error)}}catch(b){console.error("Error updating first name: ",b)}finally{e(!1),w(l)}},p=()=>{s(!n)},g=async()=>{try{const b=localStorage.getItem("token"),k=sl(b).id,$=await fetch(`https://europe-west1-proiect-licenta-fc2a8.cloudfunctions.net/api/user/${k}/lastName`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({lastName:u.lastName})});if($.ok){const I=await $.json();console.log(I.message)}else{const I=await $.json();console.error("Failed to update last name: ",I.error)}}catch(b){console.error("Error updating last name: ",b)}finally{s(!1),w(l)}},m=()=>{i(!r)},y=async()=>{try{const b=localStorage.getItem("token"),k=sl(b).id,$=await fetch(`https://europe-west1-proiect-licenta-fc2a8.cloudfunctions.net/api/user/${k}/username`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:u.username})});if($.ok){const I=await $.json();console.log(I.message)}else{const I=await $.json();alert("Failed to update username: "+I.error),console.error("Failed to update username: ",I.error)}}catch(b){console.error("Error updating username: ",b)}finally{i(!1),w(l)}},w=async b=>{try{if(b){const k=sl(b).id,$=await fetch(`https://europe-west1-proiect-licenta-fc2a8.cloudfunctions.net/api/user/${k}`),I=await $.json();$.ok?!I.userData.firstName&&!I.userData.lastName?h({firstName:"",lastName:"",username:I.userData.username,email:I.userData.email,role:I.userData.role}):I.userData.firstName?I.userData.lastName?h({firstName:I.userData.firstName,lastName:I.userData.lastName,username:I.userData.username,email:I.userData.email,role:I.userData.role}):h({firstName:I.userData.firstName,lastName:"",username:I.userData.username,email:I.userData.email,role:I.userData.role}):h({firstName:"",lastName:I.userData.lastName,username:I.userData.username,email:I.userData.email,role:I.userData.role}):console.error("Failed to fetch user data: ",I.error)}else throw new Error("Token not found.")}catch(C){console.error("Error fetching user: ",C)}};return J.useEffect(()=>{c(localStorage.getItem("token"));const b=localStorage.getItem("token");b&&w(b)},[]),U.jsxs("div",{className:"w-full h-full absolute flex flex-row justify-center items-center gap-4",children:[U.jsxs(Le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.2},className:"w-1/3 ml-4 h-9/10 bg-tertiary-color rounded-[30px] flex flex-col items-center",children:[U.jsx(Le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.5},className:"w-56 h-56 mt-6 bg-[#89abf5] rounded-full flex justify-center items-center",children:U.jsx("img",{className:"h-9/10 w-9/10 rounded-full",src:qB,alt:"Avatar"})}),U.jsx(Le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.6},className:"text-center",children:U.jsx("h1",{className:"text-4xl font-bold mt-4",children:u.username})}),U.jsx(Le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.7},onAnimationComplete:()=>a(!0),className:"text-center",children:U.jsx("h1",{className:"text-2xl font-bold mt-4",children:"Rangul curent: Newbie"})})]}),U.jsxs(Le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.3},className:"w-2/3 h-9/10 mr-4 pt-2 bg-tertiary-color rounded-[30px] flex flex-col items-center",children:[U.jsxs(Le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.5},className:"w-9/10 h-1/10 my-4 bg-[#89abf5] rounded-2xl flex items-center justify-between",children:[U.jsxs("h1",{className:"text-2xl font-bold ml-4",children:["Prenume: ",U.jsx(Le.input,{initial:{backgroundColor:t?"#89abf5":"var(--tertiary-color)",paddingLeft:t?"0":"0.5rem"},animate:{backgroundColor:t?"var(--tertiary-color)":"#89abf5",paddingLeft:t?"0.5rem":"0"},transition:{duration:.2},className:"bg-transparent border-none outline-none rounded-md",placeholder:u.firstName,value:u.firstName,onChange:b=>h({...u,firstName:b.target.value}),disabled:!t})]}),U.jsx(vl,{children:t&&U.jsx(Le.button,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.2,1]},exit:{opacity:0,scale:.95},transition:{duration:.2,delay:o?0:.5},whileHover:{scale:[null,1.3,1.2]},className:"w-2/10 h-12 rounded-xl ml-32 text-xl font-bold bg-secondary-color",onClick:()=>f(),children:"Schimbați prenumele"})}),U.jsx(Le.button,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:o?0:.5},whileHover:{scale:[null,1.3,1.2]},className:"w-2/10 h-12 rounded-xl text-xl font-bold mr-4 bg-secondary-color",onClick:()=>d(),children:t?"Anulați":"Schimbați prenumele"})]}),U.jsxs(Le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.6},className:"w-9/10 h-1/10 my-2 bg-[#89abf5] rounded-2xl flex items-center justify-between",children:[U.jsxs("h1",{className:"text-2xl font-bold ml-4",children:["Nume: ",U.jsx(Le.input,{initial:{backgroundColor:n?"#89abf5":"var(--tertiary-color)",paddingLeft:n?0:"0.5rem"},animate:{backgroundColor:n?"var(--tertiary-color)":"#89abf5",paddingLeft:n?"0.5rem":0},className:"bg-transparent border-none outline-none rounded-md",placeholder:u.lastName,value:u.lastName,onChange:b=>h({...u,lastName:b.target.value}),disabled:!n})]}),U.jsx(vl,{children:n&&U.jsx(Le.button,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.2,1]},exit:{opacity:0,scale:.95},transition:{duration:.2,delay:o?0:.5},whileHover:{scale:[null,1.3,1.2]},className:"w-2/10 h-12 rounded-xl ml-32 text-xl font-bold bg-secondary-color",onClick:()=>g(),children:"Schimbați numele"})}),U.jsx(Le.button,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:o?0:.5},whileHover:{scale:[null,1.3,1.2]},className:"w-2/10 h-12 rounded-xl text-xl font-bold mr-4 bg-secondary-color",onClick:()=>p(),children:n?"Anulați":"Schimbați numele"})]}),U.jsxs(Le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.7},className:"w-9/10 h-1/10 my-4 bg-[#89abf5] rounded-2xl flex items-center justify-between",children:[U.jsxs("h1",{className:"text-2xl font-bold ml-4",children:["Username: ",U.jsx(Le.input,{initial:{backgroundColor:r?"#89abf5":"var(--tertiary-color)",paddingLeft:r?0:"0.5rem"},animate:{backgroundColor:r?"var(--tertiary-color)":"#89abf5",paddingLeft:r?"0.5rem":0},className:"bg-transparent border-none outline-none rounded-md",placeholder:u.username,value:u.username,onChange:b=>h({...u,username:b.target.value}),disabled:!r})]}),U.jsx(vl,{children:r&&U.jsx(Le.button,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.2,1]},exit:{opacity:0,scale:.95},transition:{duration:.2,delay:o?0:.5},whileHover:{scale:[null,1.3,1.2]},className:"w-2/10 h-12 rounded-xl ml-32 text-xl font-bold bg-secondary-color",onClick:()=>y(),children:"Schimbați username-ul"})}),U.jsx(Le.button,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:o?0:.5},whileHover:{scale:[null,1.3,1.2]},className:"w-2/10 h-12 rounded-xl text-xl font-bold mr-4 bg-secondary-color",onClick:()=>m(),children:r?"Anulați":"Schimbați username-ul"})]}),U.jsx(Le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.8},className:"w-9/10 h-1/10 my-2 bg-[#89abf5] rounded-2xl flex items-center justify-between",children:U.jsxs("h1",{className:"text-2xl font-bold ml-4",children:["Email: ",u.email]})}),U.jsx(Le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.9},className:"w-9/10 h-1/10 my-4 bg-[#89abf5] rounded-2xl flex items-center justify-between",children:U.jsxs("h1",{className:"text-2xl font-bold ml-4",children:["Rol: ",u.role]})})]})]})}const fNe=Rd(dNe),pNe="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M12.5535%202.49392C12.4114%202.33852%2012.2106%202.25%2012%202.25C11.7894%202.25%2011.5886%202.33852%2011.4465%202.49392L7.44648%206.86892C7.16698%207.17462%207.18822%207.64902%207.49392%207.92852C7.79963%208.20802%208.27402%208.18678%208.55352%207.88108L11.25%204.9318V16C11.25%2016.4142%2011.5858%2016.75%2012%2016.75C12.4142%2016.75%2012.75%2016.4142%2012.75%2016V4.9318L15.4465%207.88108C15.726%208.18678%2016.2004%208.20802%2016.5061%207.92852C16.8118%207.64902%2016.833%207.17462%2016.5535%206.86892L12.5535%202.49392Z'%20fill='%231C274C'/%3e%3cpath%20d='M3.75%2015C3.75%2014.5858%203.41422%2014.25%203%2014.25C2.58579%2014.25%202.25%2014.5858%202.25%2015V15.0549C2.24998%2016.4225%202.24996%2017.5248%202.36652%2018.3918C2.48754%2019.2919%202.74643%2020.0497%203.34835%2020.6516C3.95027%2021.2536%204.70814%2021.5125%205.60825%2021.6335C6.47522%2021.75%207.57754%2021.75%208.94513%2021.75H15.0549C16.4225%2021.75%2017.5248%2021.75%2018.3918%2021.6335C19.2919%2021.5125%2020.0497%2021.2536%2020.6517%2020.6516C21.2536%2020.0497%2021.5125%2019.2919%2021.6335%2018.3918C21.75%2017.5248%2021.75%2016.4225%2021.75%2015.0549V15C21.75%2014.5858%2021.4142%2014.25%2021%2014.25C20.5858%2014.25%2020.25%2014.5858%2020.25%2015C20.25%2016.4354%2020.2484%2017.4365%2020.1469%2018.1919C20.0482%2018.9257%2019.8678%2019.3142%2019.591%2019.591C19.3142%2019.8678%2018.9257%2020.0482%2018.1919%2020.1469C17.4365%2020.2484%2016.4354%2020.25%2015%2020.25H9C7.56459%2020.25%206.56347%2020.2484%205.80812%2020.1469C5.07435%2020.0482%204.68577%2019.8678%204.40901%2019.591C4.13225%2019.3142%203.9518%2018.9257%203.85315%2018.1919C3.75159%2017.4365%203.75%2016.4354%203.75%2015Z'%20fill='%231C274C'/%3e%3c/svg%3e";function mNe(){const[t,e]=J.useState(void 0),[n,s]=J.useState(""),r=o=>{const a=o.target.files[0];console.log(a),a&&e(a)},i=async()=>{if(!t){s("Nu s-a ales niciun fișier"),alert("Alertă: "+n);return}const o=10*1024*1024;if(t.size>o){alert("Fișierul depășește limita de 10MB.");return}if(t.type!=="video/mp4"){alert("Doar fișiere de tip .mp4 sunt permise.");return}const l=kC(TC,`videos/${t.name}`),u=Xee(l,t,{customMetadata:{description:""}});u.on("state_changed",h=>{const d=h.bytesTransferred/h.totalBytes*100;console.log("Upload is "+d+"% done")},h=>{console.error("Error uploading file: ",h),alert("Eroare la încărcarea fișierului")},()=>{C5(u.snapshot.ref).then(h=>{console.log("File available at: ",h),alert("Fișierul a fost încărcat cu succes")})})};return U.jsxs("div",{className:"tall:h-6/10 tall:w-1/2 h-5/10 w-2/3 bg-[#89abf5] rounded-2xl m-0 pt-2 flex flex-col gap-y-4",children:[U.jsx("h1",{className:"tall:text-2xl text-sm font-bold text-center",children:"Încărcați Videoclipul"}),U.jsxs("div",{className:"tall:h-1/2 h-6/10 flex flex-col items-center",children:[U.jsxs("div",{className:"w-2/3 h-9/10 pb-4 rounded-xl border-2 relative border-dashed flex flex-col",children:[U.jsx("img",{className:"w-9/10 h-9/10 self-center",src:pNe,alt:"Upload"}),U.jsx("p",{className:"text-sm text-center",children:"Încărcați videoclipul aici"}),U.jsx("input",{className:"opacity-0 absolute w-full h-full cursor-pointer top-0 left-0",type:"file",onChange:r})]}),U.jsx("button",{className:"tall:mt-4 tall:px-4 tall:py-2 mt-1 px-1 py-0.5 bg-secondary-color text-white text-sm font-bold rounded-lg",onClick:i,children:"Încărcați"})]}),n&&U.jsx("p",{className:"text-center mt-8",children:n})]})}function gNe(){const[t,e]=J.useState([{uid:"1",username:"john_doe",email:"john.doe@example.com",firstName:"John",lastName:"Doe",role:"Admin"},{uid:"2",username:"jane_smith",email:"jane.smith@example.com",firstName:"Jane",lastName:"Smith",role:"User"},{uid:"3",username:"mike_jones",email:"mike.jones@example.com",firstName:"Mike",lastName:"Jones",role:"Admin"},{uid:"4",username:"anna_brown",email:"anna.brown@example.com",firstName:"Anna",lastName:"Brown",role:"User"},{uid:"5",username:"sam_wilson",email:"sam.wilson@example.com",firstName:"Sam",lastName:"Wilson",role:"Admin"},{uid:"6",username:"emily_clark",email:"emily.clark@example.com",firstName:"Emily",lastName:"Clark",role:"User"},{uid:"7",username:"david_white",email:"david.white@example.com",firstName:"David",lastName:"White",role:"Admin"},{uid:"8",username:"lisa_thomas",email:"lisa.thomas@example.com",firstName:"Lisa",lastName:"Thomas",role:"User"},{uid:"9",username:"peter_green",email:"peter.green@example.com",firstName:"Peter",lastName:"Green",role:"Admin"},{uid:"10",username:"sophia_harris",email:"sophia.harris@example.com",firstName:"Sophia",lastName:"Harris",role:"User"},{uid:"11",username:"alex_smith",email:"alex.smith@example.com",firstName:"Alex",lastName:"Smith",role:"Admin"}]),[n,s]=J.useState({uid:"",firstName:"",lastName:"",username:"",email:"",role:""}),[r,i]=J.useState(""),[o,a]=J.useState("asc"),[l,c]=J.useState(null),[u,h]=J.useState({}),d=async()=>{try{const b=await fetch("https://europe-west1-proiect-licenta-fc2a8.cloudfunctions.net/api/users"),C=await b.json();if(b.ok){const k=C.map($=>({uid:$.uid,username:$.username,email:$.email,firstName:$.firstName||"",lastName:$.lastName||"",role:$.role}));e(k)}}catch(b){console.error("Error fetching all users: ",b)}},f=async()=>{const b=localStorage.getItem("token");try{if(b){const k=sl(b).id,$=await fetch(`https://europe-west1-proiect-licenta-fc2a8.cloudfunctions.net/api/user/${k}`,{method:"GET"}),I=await $.json();$.ok?!I.userData.firstName&&!I.userData.lastName?s({uid:I.userData.uid,firstName:"",lastName:"",username:I.userData.username,email:I.userData.email,role:I.userData.role}):I.userData.firstName?I.userData.lastName?s({uid:I.userData.uid,firstName:I.userData.firstName,lastName:I.userData.lastName,username:I.userData.username,email:I.userData.email,role:I.userData.role}):s({uid:I.userData.uid,firstName:I.userData.firstName,lastName:"",username:I.userData.username,email:I.userData.email,role:I.userData.role}):s({uid:I.userData.uid,firstName:"",lastName:I.userData.lastName,username:I.userData.username,email:I.userData.email,role:I.userData.role}):console.error("Failed to fetch user data: ",I.error)}else throw new Error("Token not found.")}catch(C){console.error("Error fetching user: ",C)}},p=b=>{r===b?a(o==="asc"?"desc":"asc"):(i(b),a("asc"));const C=[...t].sort((k,$)=>o==="asc"?k[b].localeCompare($[b],void 0,{sensitivity:"base"}):$[b].localeCompare(k[b],void 0,{sensitivity:"base"}));e(C)},g=(b,C)=>{l===b?(c(null),h({})):(c(b),h(C))},m=(b,C)=>{h({...u,[C]:b.target.value})},y=async()=>{const b=l;try{if((await fetch(`https://europe-west1-proiect-licenta-fc2a8.cloudfunctions.net/api/user/${b}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:u.username,firstName:u.firstName,lastName:u.lastName,role:u.role})})).ok)l===n.uid&&f(),d(),c(null),h({});else throw alert("Failed to update user."),new Error("Failed to update user")}catch(C){console.error("Error updating user:",C)}},w=async()=>{const b=l;console.log(b);try{if((await fetch(`https://europe-west1-proiect-licenta-fc2a8.cloudfunctions.net/api/user/${b}`,{method:"DELETE"})).ok)d(),c(null),h({});else throw alert("Failed to delete user."),new Error("Failed to delete user")}catch(C){console.error("Error deleting user:",C)}};return J.useEffect(()=>{f(),d()},[]),U.jsxs("div",{className:"w-full h-full absolute flex flex-col items-center gap-4",children:[U.jsx(Le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.1},className:"h-3/5 mt-14 rounded-[30px] flex flex-row justify-center bg-tertiary-color",style:{width:"97%"},children:U.jsx("div",{className:"w-9/10 my-6 flex flex-col items-center rounded-3xl overflow-hidden no-scrollbar",children:U.jsx(dX,{children:U.jsxs(Le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.3},className:"w-full h-full bg-[#89abf5] no-scrollbar flex flex-col items-center overflow-x-hidden",children:[U.jsx("h1",{className:"my-2",children:"(Click on the table headers to sort entries by field)"}),U.jsxs("table",{className:"min-w-full rounded-xl border-spacing-0 border-separate",children:[U.jsx("thead",{className:"sticky top-0",children:U.jsxs("tr",{className:"rounded-xl",children:[U.jsxs("th",{className:"w-2/10 py-2 px-4 bg-secondary-color text-left cursor-pointer rounded-tl-3xl",onClick:()=>p("username"),children:["Username ",r==="username"&&(o==="asc"?"▲":"▼")]}),U.jsxs("th",{className:"w-2/10 py-2 px-4 bg-secondary-color text-left cursor-pointer",onClick:()=>p("email"),children:["Email ",r==="email"&&(o==="asc"?"▲":"▼")]}),U.jsxs("th",{className:"w-1/10 py-2 px-4 bg-secondary-color text-left cursor-pointer",onClick:()=>p("firstName"),children:["First Name ",r==="firstName"&&(o==="asc"?"▲":"▼")]}),U.jsxs("th",{className:"w-1/10 py-2 px-4 bg-secondary-color text-left cursor-pointer",onClick:()=>p("lastName"),children:["Last Name ",r==="lastName"&&(o==="asc"?"▲":"▼")]}),U.jsxs("th",{className:"w-2/10 py-2 px-4 bg-secondary-color text-left cursor-pointer",onClick:()=>p("role"),children:["Role ",r==="role"&&(o==="asc"?"▲":"▼")]}),U.jsx("th",{className:"py-2 px-4 bg-secondary-color text-left rounded-tr-3xl",children:"Edit"})]})}),U.jsx("tbody",{children:t.map((b,C)=>U.jsxs(Le.tr,{layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"h-16 odd:bg-[#89abf599] even:bg-[#89abf5] last:rounded-bl-3xl",children:[U.jsx("td",{className:"py-2 px-4 border-0 border-b-2 border-solid border-b-blue-300",children:l===b.uid?U.jsx(Le.input,{initial:{backgroundColor:l===b.uid?"#89abf5":"var(--tertiary-color)",paddingLeft:l===b.uid?"0":"0.5rem"},animate:{backgroundColor:l===b.uid?"var(--tertiary-color)":"#89abf5",paddingLeft:l===b.uid?"0.5rem":"0"},transition:{duration:.2},className:"bg-transparent border-none outline-none rounded-md",placeholder:"Username",value:u.username,onChange:k=>m(k,"username")}):b.username}),U.jsx("td",{className:"py-2 px-4 border-0 border-b-2 border-solid border-b-blue-300",children:b.email}),U.jsx("td",{className:"py-2 px-4 border-0 border-b-2 border-solid border-b-blue-300",children:l===b.uid?U.jsx(Le.input,{initial:{backgroundColor:l===b.uid?"#89abf5":"var(--tertiary-color)",paddingLeft:l===b.uid?"0":"0.5rem"},animate:{backgroundColor:l===b.uid?"var(--tertiary-color)":"#89abf5",paddingLeft:l===b.uid?"0.5rem":"0"},transition:{duration:.2},className:"bg-transparent border-none outline-none rounded-md",placeholder:"First Name",value:u.firstName,onChange:k=>m(k,"firstName")}):b.firstName}),U.jsx("td",{className:"py-2 px-4 border-0 border-b-2 border-solid border-b-blue-300",children:l===b.uid?U.jsx(Le.input,{initial:{backgroundColor:l===b.uid?"#89abf5":"var(--tertiary-color)",paddingLeft:l===b.uid?"0":"0.5rem"},animate:{backgroundColor:l===b.uid?"var(--tertiary-color)":"#89abf5",paddingLeft:l===b.uid?"0.5rem":"0"},transition:{duration:.2},className:"bg-transparent border-none outline-none rounded-md",placeholder:"Last Name",value:u.lastName,onChange:k=>m(k,"lastName")}):b.lastName}),U.jsx("td",{className:"py-2 px-4 border-0 border-b-2 border-solid border-b-blue-300",children:l===b.uid?U.jsx(Le.input,{initial:{backgroundColor:l===b.uid?"#89abf5":"var(--tertiary-color)",paddingLeft:l===b.uid?"0":"0.5rem"},animate:{backgroundColor:l===b.uid?"var(--tertiary-color)":"#89abf5",paddingLeft:l===b.uid?"0.5rem":"0"},transition:{duration:.2},className:"bg-transparent border-none outline-none rounded-md",placeholder:"Role",value:u.role,onChange:k=>m(k,"role")}):b.role}),U.jsx("td",{className:"py-2 px-4 border-0 border-b-2 border-solid border-b-blue-300",children:U.jsxs("div",{className:"flex justify-between",children:[U.jsx("button",{onClick:()=>g(b.uid,b),children:l===b.uid?"Anulare":"Editați parametri"}),U.jsx(vl,{children:l===b.uid&&U.jsxs(U.Fragment,{children:[U.jsx(Le.button,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.2,1]},exit:{opacity:0,scale:.95},transition:{duration:.2},whileHover:{scale:[null,1.3,1.2]},onClick:()=>y(),children:"Trimiteți"}),U.jsx(Le.button,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.2,1]},exit:{opacity:0,scale:.95},transition:{duration:.2},whileHover:{scale:[null,1.3,1.2]},className:"mr-4",onClick:()=>w(),children:"Ștergeți"})]})})]})})]},b.uid))})]})]})})})}),U.jsxs(Le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.2},className:"h-2/5 mb-14 rounded-[30px] px-24 flex items-center justify-between bg-tertiary-color",style:{width:"97%"},children:[U.jsxs("div",{className:"flex flex-col items-center pb-4",children:[U.jsx(Le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.5},className:"tall:w-56 tall:h-56 w-24 h-24 scale-25 mt-6 bg-[#89abf5] rounded-full flex justify-center items-center",children:U.jsx("img",{className:"h-9/10 w-9/10 rounded-full",src:qB,alt:"Avatar"})}),U.jsxs(Le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.6},className:"text-center",children:[U.jsx("h1",{className:"text-4xl font-bold mt-4",children:n.username}),U.jsx("h1",{className:"text-2xl font-bold mt-4",children:n.role})]})]}),U.jsxs(Le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:[null,1.02,1]},transition:{duration:.2,delay:.6},className:"w-1/3 h-full flex flex-col items-center justify-center",children:[U.jsxs("div",{className:"w-full",children:[U.jsx("h1",{className:"text-l text-center",children:"Încărcați videoclipuri LMG"}),U.jsx("h1",{className:"text-sm text-center",children:"Fișierul trebuie să fie de format .mp4 și să nu depășească 10MB."})]}),U.jsx(mNe,{})]})]})]})}const yNe=Rd(gNe),vNe=Cr.div`
`;function xNe(){const t=Ul(),e=["/Login"],[n,s]=J.useState(!1),[r,i]=J.useState(!1),[o,a]=J.useState(!0),[l,c]=J.useState({firstName:"",lastName:"",username:"",email:"",role:""}),u=async d=>{try{if(d){const p=sl(d).id,g=await fetch(`https://europe-west1-proiect-licenta-fc2a8.cloudfunctions.net/api/user/${p}`),m=await g.json();g.ok?!m.userData.firstName&&!m.userData.lastName?c({firstName:"",lastName:"",username:m.userData.username,email:m.userData.email,role:m.userData.role}):m.userData.firstName?m.userData.lastName?c({firstName:m.userData.firstName,lastName:m.userData.lastName,username:m.userData.username,email:m.userData.email,role:m.userData.role}):c({firstName:m.userData.firstName,lastName:"",username:m.userData.username,email:m.userData.email,role:m.userData.role}):c({firstName:"",lastName:m.userData.lastName,username:m.userData.username,email:m.userData.email,role:m.userData.role}):console.error("Failed to fetch user data: ",m.error)}else throw new Error("Token not found.")}catch(f){console.error("Error fetching user: ",f)}},h=async d=>{try{const f=await fetch("https://europe-west1-proiect-licenta-fc2a8.cloudfunctions.net/api/verify-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:d})});if(f.ok){const p=await f.json();sl(d).role==="admin"?s(!0):s(!1)}else s(!1)}catch(f){console.error("Error verifying token: ",f),s(!1)}finally{a(!1)}};return J.useEffect(()=>{const d=localStorage.getItem("token");d&&t.pathname!=="/Login"?(h(d),u(d)):(s(!1),a(!1))},[r]),o?U.jsx("div",{children:"Loading..."}):U.jsxs(U.Fragment,{children:[!e.includes(t.pathname)&&U.jsx(dte,{isAdmin:n,setIsLoggedIn:i,firstName:l.firstName,lastName:l.lastName}),U.jsx(vNe,{className:"w-screen h-screen flex justify-center items-center",children:U.jsx(vl,{mode:"wait",children:U.jsxs(EW,{location:t,children:[U.jsx(Ho,{exact:!0,path:"/",element:U.jsx(Cf,{children:U.jsx(vte,{})})}),U.jsx(Ho,{exact:!0,path:"/Login",element:U.jsx(gte,{setIsLoggedIn:i})}),U.jsx(Ho,{exact:!0,path:"/About",element:U.jsx(Cf,{children:U.jsx(wte,{})})}),U.jsx(Ho,{exact:!0,path:"/Dictionary",element:U.jsx(Cf,{isAdmin:n,children:U.jsx(cNe,{})})}),U.jsx(Ho,{exact:!0,path:"/Practice",element:U.jsx(Cf,{children:U.jsx(hNe,{})})}),U.jsx(Ho,{exact:!0,path:"/UserProfile",element:U.jsx(Cf,{children:U.jsx(fNe,{})})}),n?U.jsx(Ho,{exact:!0,path:"/Admin",element:U.jsx(yNe,{})}):U.jsx(Ho,{exact:!0,path:"/Admin",element:U.jsx(cP,{to:"/",replace:!0})})]},t.pathname)})})]})}Kw.createRoot(document.getElementById("root")).render(U.jsx(OW,{children:U.jsx(xNe,{})}));export{lr as _,pS as g,BEe as p,J as r,hx as u};
